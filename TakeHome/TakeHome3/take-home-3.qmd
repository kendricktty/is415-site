---
title: "TH3: Prototyping Modules for Geospatial Analytics Shiny Application"
subtitle: "Take Home Exercise 3"
author: "Kendrick Teo"
date: "2024-10-14"
date-modified: "last-modified"

execute: 
  eval: true
  echo: true
  freeze: true
---

## TH3.1 Introduction

The objective of Take-Home Exercise 3 is to prototype a module to be built for the Geospatial Analytics project, which is on building a hedonic pricing model for house prices in Johor Bahru. As the group member in charge of building the model itself, I have decided to base this exercise on the geographically weighted regression model. 

At the time of writing, my group has yet to complete geocoding our dataset, so the regression prototype for this exercise will instead be used to model condominium prices in Singapore in 2015, using the dataset from hands-on exercise 9/10. However, unlike the hands-on exercise, this exercise will have an added challenge - instead of predicting prices from point data, we will instead aggregate and predict the price data by planning area.

## TH3.2 Loading the data

The datasets to be used in this exercise are:

-   URA Master Plan Subzone Boundary in Shapefile format (i.e. `MP14_SUBZONE_WEB_PL`), and
-   `condo_resale_2015.csv`.

```{r}
pacman::p_load(olsrr, ggstatsplot, sf, tmap, tidyverse, gtsummary, performance, see, sfdep, tidygeocoder)
```
```{r}
property_transaction_data <- read_csv('shiny/data/aspatial/Open Transaction Data.csv')
head(property_transaction_data)
```

```{r}
property_transaction_data <- property_transaction_data %>%
  geocode(street = `Road Name`, city = `Mukim`, method = 'osm', lat = `latitude`, long = `longitude`) %>%
  st_as_sf(coords = c("longitude", "latitude"), crs = 4326)

write_rds((property_transaction_data, "shiny/data/property_transaction_sf.rds"))
```

```{r}
test_address <- tibble::tribble(
  ~name,            ~addr,
  "House",       "Jalan Tembusu 15 Plentong"
)
lat_long <- test_address %>% geocode(addr, method='osm', lat=latitude, long=longitude)
print(lat_long)
```