{
  "hash": "ca227b0248a0a9ec09f3ab4e259ee5fc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"TH1: Geospatial Analytics for Social Good\"\nimage: \"../../_site/HandsOn/Hands-on_Ex03/hands-on-3_files/figure-html/unnamed-chunk-42-1.png\"\nsubtitle: \"Take Home Exercise 1: Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar\"\nauthor: \"Kendrick Teo\"\ndate: \"2024-09-07\"\ndate-modified: \"last-modified\"\n\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n\n\n\n## TH1.1 Setting the Scene\n\nMillions of people have their lives shattered by armed conflict every year. One of these is the [**Myanmar Civil War**](https://en.wikipedia.org/wiki/Myanmar_civil_war_(2021%E2%80%93present)), a significant escalation of the long-running [Myanmar Conflict](https://en.wikipedia.org/wiki/Myanmar_conflict) in response to the [2021 coup d'etat](https://en.wikipedia.org/wiki/2021_Myanmar_coup_d%27%C3%A9tat).\n\nGeospatial analtyics holds the potential to address complex problems facing society, such as this one. This study serves to discover the sptial and spatio-temporal distribution (spread) of the armed conflict in Myanmar by applying spatial point pattern analysis (SPPA) methods.\n\n## TH1.2 The Data\n\nArmed conflict data in Myanmar between 2010 and 2023 was downloaded from the [Armed Conflict Location & Event Database (ACLED)](https://acleddata.com/), an independent, impartial, international non-profit organization collecting data on violent conflicts and protests in all countries and territories in the world. We will be superimposing these locations with the geogrpahical boundary and subdivisions of the country, from the **Myanmar Information Management Unit** (MIMU).\n\nWe are interested in conflict events from 2019 onwards - starting from a year before the COVID-19 pandemic and 2 years before the 2021 coup - cumulating into the civil war of today.\n\n## TH1.3 Importing and transforming armed conflict data and administrative boundary data into `sf` and `tibble` dataframes\n\n### TH1.3.1 Loading R packages and aspatial data\n\nThe `R` packages we will use today are:\n\n- `sf`\n- `tmap`\n- `spatstat`\n- `raster`\n- `maptools`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, raster, spatstat, tmap, tidyverse)\nacled_mya <- read_csv(\"data/ACLED_Myanmar.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 47832 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(acled_mya)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 31\n  event_id_cnty event_date        year time_precision disorder_type   event_type\n  <chr>         <chr>            <dbl>          <dbl> <chr>           <chr>     \n1 MMR56099      31 December 2023  2023              1 Political viol… Explosion…\n2 MMR56222      31 December 2023  2023              1 Political viol… Explosion…\n3 MMR56370      31 December 2023  2023              1 Political viol… Battles   \n4 MMR56376      31 December 2023  2023              1 Demonstrations  Protests  \n5 MMR56380      31 December 2023  2023              1 Strategic deve… Strategic…\n6 MMR56869      31 December 2023  2023              1 Strategic deve… Strategic…\n# ℹ 25 more variables: sub_event_type <chr>, actor1 <chr>, assoc_actor_1 <chr>,\n#   inter1 <dbl>, actor2 <chr>, assoc_actor_2 <chr>, inter2 <dbl>,\n#   interaction <dbl>, civilian_targeting <chr>, iso <dbl>, region <chr>,\n#   country <chr>, admin1 <chr>, admin2 <chr>, admin3 <chr>, location <chr>,\n#   latitude <dbl>, longitude <dbl>, geo_precision <dbl>, source <chr>,\n#   source_scale <chr>, notes <chr>, fatalities <dbl>, tags <chr>,\n#   timestamp <dbl>\n```\n\n\n:::\n:::\n\n\n\n\n\n### TH1.3.2 Loading and plotting geospatial data\n\nThree representations of Myanmar's geography exist on the MIMU repository - `Admin1` subdivides the country into its states and regions only, while `Admin2` subdivides the country by its smaller districts, and `Admin3` its townships. Further, the ACLED labels each incident with all 3 representations. For simplicity and ease of understanding, we shall use the `Admin1` representation.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmmr_admin1 <- st_read(dsn = \"data/mmr_polbnda_adm1_250k_mimu_1\", layer = \"mmr_polbnda_adm1_250k_mimu_1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda_adm1_250k_mimu_1' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/TakeHome/TakeHome1/data/mmr_polbnda_adm1_250k_mimu_1' \n  using driver `ESRI Shapefile'\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nmmr_admin1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\nFirst 10 features:\n   OBJECTID          ST ST_PCODE           ST_RG          ST_MMR PCode_V\n1         1  Ayeyarwady   MMR017          Region  ဧရာဝတီတိုင်းဒေသကြီး     9.4\n2         2        Bago   MMR111          Region    ပဲခူးတိုင်းဒေသကြီး     9.4\n3         4        Chin   MMR004           State       ချင်းပြည်နယ်     9.4\n4         5      Kachin   MMR001           State       ကချင်ပြည်နယ်     9.4\n5         6       Kayah   MMR002           State       ကယားပြည်နယ်     9.4\n6         7       Kayin   MMR003           State        ကရင်ပြည်နယ်     9.4\n7         8      Magway   MMR009          Region   မကွေးတိုင်းဒေသကြီး     9.4\n8         9    Mandalay   MMR010          Region မန္တလေးတိုင်းဒေသကြီး     9.4\n9        10         Mon   MMR011           State         မွန်ပြည်နယ်     9.4\n10       11 Nay Pyi Taw   MMR018 Union Territory        နေပြည်တော်     9.4\n                         geometry\n1  MULTIPOLYGON (((95.20798 15...\n2  MULTIPOLYGON (((96.17964 19...\n3  MULTIPOLYGON (((93.36931 24...\n4  MULTIPOLYGON (((97.59674 28...\n5  MULTIPOLYGON (((97.1759 19....\n6  MULTIPOLYGON (((97.81508 16...\n7  MULTIPOLYGON (((94.11699 22...\n8  MULTIPOLYGON (((96.14023 23...\n9  MULTIPOLYGON (((97.73689 15...\n10 MULTIPOLYGON (((96.32013 20...\n```\n\n\n:::\n\n```{.r .cell-code}\nqtm(mmr_admin1)\n```\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### TH1.3.3 Creating `sf` data frame from aspatial data\n\nThe ACLED `tibble` contains coordinates, making it useful for plotting on our map as points. We can therefore use it to create an `sf` data frame using which we can plot our points on a map. The EPSG format of the import coordinates should be [`4326`](https://epsg.io/4326), corresponding to the WGS84 Geographic Coordinate System.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_mya_sf <- st_as_sf(acled_mya, coords = c(\"longitude\", \"latitude\"), crs = 4326)\n```\n:::\n\n\n\n\n\nThe EPSG area code for Myanmar is [`4239`](https://epsg.io/4239), while the WGS 84-compatible code is [`32647`](https://epsg.io/32647). Since we're creating an `owin` object later, we need to first convert our coordinate system.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_mya_sf <- acled_mya_sf %>% st_transform(crs = 32647)\nmmr_admin1 <- mmr_admin1 %>% st_transform(crs = 32647)\ntm_shape(mmr_admin1) + tm_polygons() + tm_shape(acled_mya_sf) + tm_dots(size = 0.05)\n```\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\nAdditionally, since the data is timestamped, we are able to plot and compare the frequency of conflict events *over time*. Before we do, though, we need to standardise the date stamps, then compartmentalise them into their year, month and day components, so that we can perform spatial-temporal point patterns analysis (STPPA) later. \n\nA visualisation of the spatial-temporial distribution of points can be found in **Annex A**. Notice the consistent appearance throughout the entire study period of a large cluster of points towards the west of the country - roughly the location of Rahkine state on the border with Bangladesh.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_mya_sf <- acled_mya_sf %>%\n    mutate(event_date = dmy(event_date)) %>%\n    mutate(DayOfYear = yday(event_date)) %>%\n    mutate(Month_num = format(event_date, \"%Y-%m\")) %>%  # Year-Month format\n    mutate(Month_fac = factor(format(event_date, \"%B %Y\"))) %>% # Full month\n    mutate(Quarter = paste0(year(event_date), \"-\", quarter(event_date), \"Q\"))  # Quarter format\n```\n:::\n\n\n\n\n\n### TH1.3.4 Final steps to prepare for KDE\n\nFinally, before moving on to our KDE, \n\n#### TH1.3.4.1 Using `owin` to confine study area within Myanmar borders\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmmr_admin1_owin <- as.owin(mmr_admin1)\nplot(mmr_admin1_owin)\n```\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# summary(mmr_admin1_owin)\n```\n:::\n\n\n\n\n\n#### TH1.3.4.2 Converting ACLED `sf` object to `ppp` for KDE\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_mya_ppp <- as.ppp(acled_mya_sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_mya_sf): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\n# plot(acled_mya_ppp)\n# acled_mya_ppp\n```\n:::\n\n\n\n\n\n#### TH1.3.4.3 Handling duplicates\n\nFirst, we check if there are duplicated points in the ACLED `ppp`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(acled_mya_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(multiplicity(acled_mya_ppp) > 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\n\n\n#### TH1.3.4.4 Combining point events object and `owin`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_mya_ppp = acled_mya_ppp[mmr_admin1_owin]\n# plot(acled_mya_ppp)\n```\n:::\n\n\n\n\n\n## TH1.4 Interlude: A brief history of Myanmar's ethnic groups\n\n## TH1.5 First Order SPPA - KDE\n\nKernel density estimation (KDE) serves to compute the *intensity* of a point distribution. It has two general steps: first to compute the point intensity, followed by spatial interpolation using a kernel function. Using KDE, we can determine the general region of Myanmar with the highest incidence of armed conflict.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde <- density(acled_mya_ppp, sigma=bw.diggle, edge=TRUE, kernel=\"epanechnikov\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in density.ppp(acled_mya_ppp, sigma = bw.diggle, edge = TRUE, kernel =\n\"epanechnikov\"): Bandwidth selection will be based on Gaussian kernel\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(kde)\n```\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Create a list to store KDE results and track quarters for each quarter\n# kde_results <- list()\n# quarters <- unique(acled_mya_ppp$Quarter)\n# for (quarter in quarters) {\n#   acled_mya_quarters_subset <- acled_mya_ppp[acled_mya_ppp$Quarter == quarter]\n#   # Compute KDE and append to list\n#   kde_results[[as.character(quarter)]] <- density(acled_mya_quarters_subset)\n# }\n\n# for (quarter in quarters) {\n#   plot(kde_results[[as.character(quarter)]], main = paste(\"KDE for \", quarter))\n# }\n```\n:::\n\n\n\n\n\n## References\n\n1. Raleigh, C., Kishi, R. & Linke, A. Political instability patterns are obscured by conflict dataset scope conditions, sources, and coding choices. Humanit Soc Sci Commun 10, 74 (2023). https://doi.org/10.1057/s41599-023-01559-4\n\n## Annex A: Spatial-temporal distribution of armed conflict occurrences in Myanmar between 2019 and 2023\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(mmr_admin1) + tm_polygons() + tm_shape(acled_mya_sf) + tm_dots(size = 0.1) + tm_facets(by=\"Quarter\", free.coords=FALSE, drop.units=TRUE, ncol=3, nrow=1)\n```\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=======================\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n===========\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n============\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-11-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n===========\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-11-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n============\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-11-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n===========\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](take-home-1_files/figure-html/unnamed-chunk-11-7.png){width=672}\n:::\n:::",
    "supporting": [
      "take-home-1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}