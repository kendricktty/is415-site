<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kendrick Teo">
<meta name="dcterms.date" content="2024-10-10">

<title>HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques – IS415 - Kendrick</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">IS415 - Kendrick</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../InClass/ICE1/in-class-1.html">
 <span class="dropdown-text">CE1: Geospatial Data Science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../InClass/ICE2/in-class-2.html">
 <span class="dropdown-text">CE2: Working with Master Plan Planning Subzone Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../InClass/ICE3/in-class-3.html">
 <span class="dropdown-text">CE3: Spatial Point Pattern Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../InClass/ICE4/in-class-4.html">
 <span class="dropdown-text">CE4/HX4: Spatial-Temporal Point Pattern Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../InClass/ICE5/in-class-5.html">
 <span class="dropdown-text">CE5: Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../InClass/ICE5/in-class-6.html">
 <span class="dropdown-text">CE6: Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../InClass/ICE7/in-class-7.html">
 <span class="dropdown-text">CE7: Geographical Segmentation with Spatially Constrained Clustering Techniques</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-On Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../HandsOn/Hands-on_Ex01/hands-on-1.html">
 <span class="dropdown-text">HX1: Geospatial Data Wrangling with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn/Hands-on_Ex02/hands-on-2.html">
 <span class="dropdown-text">HX2: Thematic Mapping and Geovisualisation with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn/Hands-on_Ex03/hands-on-3.html">
 <span class="dropdown-text">HX3: Spatial Point Pattern Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../InClass/ICE4/in-class-4.html">
 <span class="dropdown-text">HX4/CE4: Spatial-Temporal Point Pattern Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn/Hands-on_Ex05/hands-on-5.html">
 <span class="dropdown-text">HX5: Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn/hands-on-6.html">
 <span class="dropdown-text">HX6: Methods of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn/hands-on-7.html">
 <span class="dropdown-text">HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn/hands-on-8.html">
 <span class="dropdown-text">HX8: Spatially Constrained Clustering Analysis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../TakeHome/TakeHome1/take-home-1.html">
 <span class="dropdown-text">TH1: The Myanmar Civil War</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../TakeHome/TakeHome2/take-home-2.html">
 <span class="dropdown-text">TH2: Drug Abuse in Thailand</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#hx7.1-overview-and-analytical-question" id="toc-hx7.1-overview-and-analytical-question" class="nav-link active" data-scroll-target="#hx7.1-overview-and-analytical-question">HX7.1 Overview and Analytical Question</a></li>
  <li><a href="#hx7.2-installing-and-loading-r-packages-and-data" id="toc-hx7.2-installing-and-loading-r-packages-and-data" class="nav-link" data-scroll-target="#hx7.2-installing-and-loading-r-packages-and-data">HX7.2 Installing and loading R packages and Data</a></li>
  <li><a href="#hx7.3-data-preparation" id="toc-hx7.3-data-preparation" class="nav-link" data-scroll-target="#hx7.3-data-preparation">HX7.3 Data Preparation</a></li>
  <li><a href="#hx7.4-exploratory-data-analysis" id="toc-hx7.4-exploratory-data-analysis" class="nav-link" data-scroll-target="#hx7.4-exploratory-data-analysis">HX7.4 Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#hx7.4.1-graphical" id="toc-hx7.4.1-graphical" class="nav-link" data-scroll-target="#hx7.4.1-graphical">HX7.4.1 Graphical</a></li>
  <li><a href="#hx7.4.2-using-choropleth-maps" id="toc-hx7.4.2-using-choropleth-maps" class="nav-link" data-scroll-target="#hx7.4.2-using-choropleth-maps">HX7.4.2 Using choropleth maps</a></li>
  </ul></li>
  <li><a href="#hx7.5-correlation-analysis" id="toc-hx7.5-correlation-analysis" class="nav-link" data-scroll-target="#hx7.5-correlation-analysis">HX7.5 Correlation analysis</a></li>
  <li><a href="#hx7.6-extracting-clustering-variables" id="toc-hx7.6-extracting-clustering-variables" class="nav-link" data-scroll-target="#hx7.6-extracting-clustering-variables">HX7.6 Extracting clustering variables</a></li>
  <li><a href="#hx7.7-data-standardisation" id="toc-hx7.7-data-standardisation" class="nav-link" data-scroll-target="#hx7.7-data-standardisation">HX7.7 Data Standardisation</a>
  <ul class="collapse">
  <li><a href="#hx7.7.1-min-max-standardisation" id="toc-hx7.7.1-min-max-standardisation" class="nav-link" data-scroll-target="#hx7.7.1-min-max-standardisation">HX7.7.1 Min-max standardisation</a></li>
  <li><a href="#hx7.7.2-z-score-standardisation" id="toc-hx7.7.2-z-score-standardisation" class="nav-link" data-scroll-target="#hx7.7.2-z-score-standardisation">HX7.7.2 Z-score standardisation</a></li>
  <li><a href="#hx7.7.3-visualising-standardised-clustering-variables" id="toc-hx7.7.3-visualising-standardised-clustering-variables" class="nav-link" data-scroll-target="#hx7.7.3-visualising-standardised-clustering-variables">HX7.7.3 Visualising standardised clustering variables</a></li>
  <li><a href="#hx7.7.4-computing-proximity-matrix" id="toc-hx7.7.4-computing-proximity-matrix" class="nav-link" data-scroll-target="#hx7.7.4-computing-proximity-matrix">HX7.7.4 Computing proximity matrix</a></li>
  </ul></li>
  <li><a href="#hx7.8-computing-hierarchical-clustering" id="toc-hx7.8-computing-hierarchical-clustering" class="nav-link" data-scroll-target="#hx7.8-computing-hierarchical-clustering">HX7.8 Computing hierarchical clustering</a></li>
  <li><a href="#hx7.9-selecting-optimal-clustering-algorithm" id="toc-hx7.9-selecting-optimal-clustering-algorithm" class="nav-link" data-scroll-target="#hx7.9-selecting-optimal-clustering-algorithm">HX7.9 Selecting optimal clustering algorithm</a></li>
  <li><a href="#hx7.10-determining-optimal-clusters" id="toc-hx7.10-determining-optimal-clusters" class="nav-link" data-scroll-target="#hx7.10-determining-optimal-clusters">HX7.10 Determining optimal clusters</a>
  <ul class="collapse">
  <li><a href="#hx7.10.1-gap-statistic-method" id="toc-hx7.10.1-gap-statistic-method" class="nav-link" data-scroll-target="#hx7.10.1-gap-statistic-method">HX7.10.1 Gap statistic method</a></li>
  <li><a href="#hx7.10.2-interpretation" id="toc-hx7.10.2-interpretation" class="nav-link" data-scroll-target="#hx7.10.2-interpretation">HX7.10.2 Interpretation</a></li>
  </ul></li>
  <li><a href="#hx7.11-visually-driven-hierarchical-clustering-analysis" id="toc-hx7.11-visually-driven-hierarchical-clustering-analysis" class="nav-link" data-scroll-target="#hx7.11-visually-driven-hierarchical-clustering-analysis">HX7.11 Visually-driven hierarchical clustering analysis</a>
  <ul class="collapse">
  <li><a href="#hx7.11.1-transforming-data-frame-into-matrix" id="toc-hx7.11.1-transforming-data-frame-into-matrix" class="nav-link" data-scroll-target="#hx7.11.1-transforming-data-frame-into-matrix">HX7.11.1 Transforming data frame into matrix</a></li>
  <li><a href="#hx7.11.2-interactive-cluster-heatmap" id="toc-hx7.11.2-interactive-cluster-heatmap" class="nav-link" data-scroll-target="#hx7.11.2-interactive-cluster-heatmap">HX7.11.2 Interactive cluster heatmap</a></li>
  </ul></li>
  <li><a href="#hx7.12-mapping-the-clusters-formed" id="toc-hx7.12-mapping-the-clusters-formed" class="nav-link" data-scroll-target="#hx7.12-mapping-the-clusters-formed">HX7.12 Mapping the clusters formed</a></li>
  <li><a href="#hx7.13-saving-modified-sf-to-disk-as-rds" id="toc-hx7.13-saving-modified-sf-to-disk-as-rds" class="nav-link" data-scroll-target="#hx7.13-saving-modified-sf-to-disk-as-rds">HX7.13 Saving modified <code>sf</code> to disk as RDS</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques</h1>
<p class="subtitle lead">Hands-On Exercise 7</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kendrick Teo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 10, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 12, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="hx7.1-overview-and-analytical-question" class="level2">
<h2 class="anchored" data-anchor-id="hx7.1-overview-and-analytical-question">HX7.1 Overview and Analytical Question</h2>
<p>This hands-on exercise is on delineating a homogeneous region using geographically-referenced multivariate data. Today, we return to <a href="https://en.wikipedia.org/wiki/Myanmar">Myanmar</a> to divide the state of Shan into homogeneous regions using a key statistic: whether the population uses info-communication technologies like mobile phones and computers at home.</p>
</section>
<section id="hx7.2-installing-and-loading-r-packages-and-data" class="level2">
<h2 class="anchored" data-anchor-id="hx7.2-installing-and-loading-r-packages-and-data">HX7.2 Installing and loading R packages and Data</h2>
<p>Today’s R packages to be used are:</p>
<ul>
<li>Spatial data handling
<ul>
<li>sf, rgdal and spdep</li>
</ul></li>
<li>Attribute data handling
<ul>
<li>tidyverse, especially readr, ggplot2 and dplyr</li>
</ul></li>
<li>Choropleth mapping
<ul>
<li>tmap</li>
</ul></li>
<li>Multivariate data visualisation and analysis
<ul>
<li>coorplot, ggpubr, and heatmaply</li>
</ul></li>
<li>Cluster analysis
<ul>
<li>cluster</li>
</ul></li>
<li>ClustGeo</li>
</ul>
<p>Today’s dataset will be <code>Shan-ICT.csv</code>, an extract from the <a href="https://myanmar.unfpa.org/en/publications/2014-population-and-housing-census-myanmar-data-sheet">2014 Myanmar Population and Housing Census</a> containing, as its name suggests, data on ICT use. We will superimpose this against township boundary data (admin 3) in Myanmar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(spdep, tmap, sf, ClustGeo, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggpubr, cluster, factoextra, NbClust,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               heatmaply, corrplot, psych, tidyverse, GGally)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"myanmar_township_boundaries"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter only boundaries of Shan state</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Shan (East)"</span>, <span class="st">"Shan (North)"</span>, <span class="st">"Shan (South)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `myanmar_township_boundaries' from data source 
  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 330 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.17275 ymin: 9.671252 xmax: 101.1699 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ict <span class="ot">&lt;-</span> <span class="fu">read_csv</span> (<span class="st">"data/aspatial/Shan-ICT.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 55 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): District Pcode, District Name, Township Pcode, Township Name
dbl (7): Total households, Radio, Television, Land line phone, Mobile phone,...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> District Pcode     District Name      Township Pcode     Township Name     
 Length:55          Length:55          Length:55          Length:55         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 Total households     Radio         Television    Land line phone 
 Min.   : 3318    Min.   :  115   Min.   :  728   Min.   :  20.0  
 1st Qu.: 8711    1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  
 Median :13685    Median : 2497   Median : 6117   Median : 695.0  
 Mean   :18369    Mean   : 4487   Mean   :10183   Mean   : 929.9  
 3rd Qu.:23471    3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  
 Max.   :82604    Max.   :30176   Max.   :62388   Max.   :6736.0  
  Mobile phone      Computer      Internet at home
 Min.   :  150   Min.   :  20.0   Min.   :   8.0  
 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0  
 Median : 3559   Median : 244.0   Median : 316.0  
 Mean   : 6470   Mean   : 575.5   Mean   : 760.2  
 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5  
 Max.   :48461   Max.   :6705.0   Max.   :9746.0  </code></pre>
</div>
</div>
</section>
<section id="hx7.3-data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="hx7.3-data-preparation">HX7.3 Data Preparation</h2>
<p>If we directly use the measurement of the number of households, we may lead to biased data. In general, townships with relatively higher total numbers of households will also lead to higher number of households owning ICT devices. To overcome this problem, we will need to derive the penetration rate of each ICT variable as below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ict_derived <span class="ot">&lt;-</span> ict <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Radio</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Television</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Computer</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">DT_PCODE</span><span class="st">`</span> <span class="ot">=</span><span class="st">`</span><span class="at">District Pcode</span><span class="st">`</span>,<span class="st">`</span><span class="at">DT</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">District Name</span><span class="st">`</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TS_PCODE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Pcode</span><span class="st">`</span>, <span class="st">`</span><span class="at">TS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Name</span><span class="st">`</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TT_HOUSEHOLDS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Radio</span><span class="st">`</span>, <span class="st">`</span><span class="at">TV</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Television</span><span class="st">`</span>, </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span>, <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Computer</span><span class="st">`</span>, <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict_derived)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   DT_PCODE              DT              TS_PCODE              TS           
 Length:55          Length:55          Length:55          Length:55         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 TT_HOUSEHOLDS       RADIO             TV           LLPHONE      
 Min.   : 3318   Min.   :  115   Min.   :  728   Min.   :  20.0  
 1st Qu.: 8711   1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  
 Median :13685   Median : 2497   Median : 6117   Median : 695.0  
 Mean   :18369   Mean   : 4487   Mean   :10183   Mean   : 929.9  
 3rd Qu.:23471   3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  
 Max.   :82604   Max.   :30176   Max.   :62388   Max.   :6736.0  
     MPHONE         COMPUTER         INTERNET         RADIO_PR     
 Min.   :  150   Min.   :  20.0   Min.   :   8.0   Min.   : 2.105  
 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0   1st Qu.:13.895  
 Median : 3559   Median : 244.0   Median : 316.0   Median :21.095  
 Mean   : 6470   Mean   : 575.5   Mean   : 760.2   Mean   :21.568  
 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5   3rd Qu.:26.807  
 Max.   :48461   Max.   :6705.0   Max.   :9746.0   Max.   :48.452  
     TV_PR         LLPHONE_PR       MPHONE_PR       COMPUTER_PR    
 Min.   :11.60   Min.   : 0.278   Min.   : 3.642   Min.   :0.3278  
 1st Qu.:45.02   1st Qu.: 2.284   1st Qu.:19.014   1st Qu.:1.1832  
 Median :51.72   Median : 3.759   Median :30.527   Median :1.8970  
 Mean   :50.95   Mean   : 5.109   Mean   :31.405   Mean   :2.4393  
 3rd Qu.:60.64   3rd Qu.: 6.972   3rd Qu.:42.843   3rd Qu.:2.9897  
 Max.   :84.25   Max.   :18.149   Max.   :73.543   Max.   :9.2402  
  INTERNET_PR     
 Min.   : 0.1041  
 1st Qu.: 0.8617  
 Median : 2.2829  
 Mean   : 3.0644  
 3rd Qu.: 4.1281  
 Max.   :11.7985  </code></pre>
</div>
</div>
</section>
<section id="hx7.4-exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="hx7.4-exploratory-data-analysis">HX7.4 Exploratory Data Analysis</h2>
<section id="hx7.4.1-graphical" class="level3">
<h3 class="anchored" data-anchor-id="hx7.4.1-graphical">HX7.4.1 Graphical</h3>
<p>The following code chunk plots the distribution of the ownership of various ICT devices in the state. A histogram is useful to identify the overall distribution of data, while a boxplot helps us detect outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"lightgreen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we can expect from a not-so-developed country like Myanmar, the ownership of radios is skewed left, i.e.&nbsp;not a lot of the population owns a radio.</p>
<p>We can also plot the distribution of our derived variables, i.e.&nbsp;the penetration rate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When penetration rate, rather than absolute numbers, is plotted, we can see a much more normalised distribution. The average radio penetration rate in Shan state would lie somewhere around <code>230-240</code>.</p>
<p>We can do the same for multiple variables and create multiple plots side by side.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>llphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>mphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>computer <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>internet <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(radio, tv, llphone, mphone, computer, internet, </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hx7.4.2-using-choropleth-maps" class="level3">
<h3 class="anchored" data-anchor-id="hx7.4.2-using-choropleth-maps">HX7.4.2 Using choropleth maps</h3>
<p>EDA can also be performed by drawing choropleth maps. To start, as always, we perform a <em>left join</em> between the geospatial data object and the <code>ict_derived</code> dataframe using the unique identifier <code>TS_PCODE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(shan_sf, ict_derived, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"TS_PCODE"</span><span class="ot">=</span><span class="st">"TS_PCODE"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|echo: false</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Write to disk so that we can retrieve it later</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_rds(shan_sf, 'data/rds/shan_sf.rds')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now create our choropleth map using the combined dataset. By plotting the total number of households in one map and the total absolute number of households owning radios, we are able to showcase the inherent bias we encounter by using only absolute numbers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>TT_HOUSEHOLDS.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"TT_HOUSEHOLDS"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Total households"</span>) <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>RADIO.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"RADIO"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Number Radio "</span>) <span class="sc">+</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TT_HOUSEHOLDS.map, RADIO.map,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In comparison…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="fu">c</span>(<span class="st">"TT_HOUSEHOLDS"</span>, <span class="st">"RADIO_PR"</span>),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">style=</span><span class="st">"jenks"</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_facets</span>(<span class="at">sync =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))<span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">outer.margins=</span><span class="dv">0</span>, <span class="at">asp=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="hx7.5-correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="hx7.5-correlation-analysis">HX7.5 Correlation analysis</h2>
<p>A key part of data analytics is correlation analysis. When performing machine learning tasks, for example, we avoid incorporating too many correlated features lest it impacts the performance of our model.</p>
<p><code>corrplot.mixed()</code> visualises the correlation coefficients between each of our input variables, similarly to how we can use <code>seaborn</code> to draw a correlation heatmap in Python.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cluster_vars.cor <span class="ot">=</span> <span class="fu">cor</span>(ict_derived[,<span class="dv">12</span><span class="sc">:</span><span class="dv">17</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cluster_vars.cor,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The correlation matrix above shows a high degree of correlation between <code>COMPUTER_PR</code> and <code>INTERNET_PR</code>. This indicates that we should only use one, and not both, in our cluster analysis later.</p>
</section>
<section id="hx7.6-extracting-clustering-variables" class="level2">
<h2 class="anchored" data-anchor-id="hx7.6-extracting-clustering-variables">HX7.6 Extracting clustering variables</h2>
<p>And now for the fun part: hierarchy cluster analysis. First, we extract the clustering variables needed from the <code>shan_sf</code> data frame. We will not extract <code>INTERNET_PR</code> since, as we know, it is highly correlated with <code>COMPUTER_PR</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> shan_sf <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"TS.x"</span>, <span class="st">"RADIO_PR"</span>, <span class="st">"TV_PR"</span>, <span class="st">"LLPHONE_PR"</span>, <span class="st">"MPHONE_PR"</span>, <span class="st">"COMPUTER_PR"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
1    Mongmit 28.61852 55.41313   3.530618  26.06944    1.215939
2    Pindaya 41.74647 50.51300   1.983584  16.23917    1.288190
3    Ywangan 48.45215 26.05734   1.193591  12.02856    0.441465
4   Pinlaung 23.16499 54.17189   2.854454  24.94903    1.376255
5     Mabein 44.94903 70.86423   7.275255  39.26089    1.645042
6      Kalaw 28.07624 61.16204   4.206478  40.87951    2.963160
7      Pekon 31.86118 53.58494   3.983270  21.48476    1.897032
8   Lawksawk 38.71017 63.00035   3.151366  32.05686    2.176677
9  Nawnghkio 34.93359 54.79456   3.844960  32.30201    1.576465
10   Kyaukme 21.09548 60.11773   3.958267  37.24930    3.094709</code></pre>
</div>
</div>
<p>Next, we change the unique identifier of each row to reference township name instead of row number.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(cluster_vars) <span class="ot">&lt;-</span> cluster_vars<span class="sc">$</span><span class="st">"TS.x"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Mongmit     Mongmit 28.61852 55.41313   3.530618  26.06944    1.215939
Pindaya     Pindaya 41.74647 50.51300   1.983584  16.23917    1.288190
Ywangan     Ywangan 48.45215 26.05734   1.193591  12.02856    0.441465
Pinlaung   Pinlaung 23.16499 54.17189   2.854454  24.94903    1.376255
Mabein       Mabein 44.94903 70.86423   7.275255  39.26089    1.645042
Kalaw         Kalaw 28.07624 61.16204   4.206478  40.87951    2.963160
Pekon         Pekon 31.86118 53.58494   3.983270  21.48476    1.897032
Lawksawk   Lawksawk 38.71017 63.00035   3.151366  32.05686    2.176677
Nawnghkio Nawnghkio 34.93359 54.79456   3.844960  32.30201    1.576465
Kyaukme     Kyaukme 21.09548 60.11773   3.958267  37.24930    3.094709</code></pre>
</div>
</div>
<p>Then, we delete the original <code>TS.x</code> field we referred to a few moments ago.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>shan_ict <span class="ot">&lt;-</span> <span class="fu">select</span>(cluster_vars, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan_ict, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Mongmit   28.61852 55.41313   3.530618  26.06944    1.215939
Pindaya   41.74647 50.51300   1.983584  16.23917    1.288190
Ywangan   48.45215 26.05734   1.193591  12.02856    0.441465
Pinlaung  23.16499 54.17189   2.854454  24.94903    1.376255
Mabein    44.94903 70.86423   7.275255  39.26089    1.645042
Kalaw     28.07624 61.16204   4.206478  40.87951    2.963160
Pekon     31.86118 53.58494   3.983270  21.48476    1.897032
Lawksawk  38.71017 63.00035   3.151366  32.05686    2.176677
Nawnghkio 34.93359 54.79456   3.844960  32.30201    1.576465
Kyaukme   21.09548 60.11773   3.958267  37.24930    3.094709</code></pre>
</div>
</div>
</section>
<section id="hx7.7-data-standardisation" class="level2">
<h2 class="anchored" data-anchor-id="hx7.7-data-standardisation">HX7.7 Data Standardisation</h2>
<p>Multiple values with widely varying ranges will be used in cluster analysis. It would thus be imperative to standardise the input values first. There are many ways to do this, two of which -min-max and Z-score standardisation will be performed today.</p>
<section id="hx7.7.1-min-max-standardisation" class="level3">
<h3 class="anchored" data-anchor-id="hx7.7.1-min-max-standardisation">HX7.7.1 Min-max standardisation</h3>
<p>In the code chunk below, <code>normalize()</code> of the <code>heatmaply</code> package is used to standardisze the clustering variables by using Min-Max method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>shan_ict.std <span class="ot">&lt;-</span> <span class="fu">normalize</span>(shan_ict)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan_ict.std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    RADIO_PR          TV_PR          LLPHONE_PR       MPHONE_PR     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.2544   1st Qu.:0.4600   1st Qu.:0.1123   1st Qu.:0.2199  
 Median :0.4097   Median :0.5523   Median :0.1948   Median :0.3846  
 Mean   :0.4199   Mean   :0.5416   Mean   :0.2703   Mean   :0.3972  
 3rd Qu.:0.5330   3rd Qu.:0.6750   3rd Qu.:0.3746   3rd Qu.:0.5608  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
  COMPUTER_PR     
 Min.   :0.00000  
 1st Qu.:0.09598  
 Median :0.17607  
 Mean   :0.23692  
 3rd Qu.:0.29868  
 Max.   :1.00000  </code></pre>
</div>
</div>
</section>
<section id="hx7.7.2-z-score-standardisation" class="level3">
<h3 class="anchored" data-anchor-id="hx7.7.2-z-score-standardisation">HX7.7.2 Z-score standardisation</h3>
<p>Z-score standardisation can be performed easily by using <code>scale()</code> of Base R. <strong>It should only be used if we can safely assume normal distribution.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>shan_ict.z <span class="ot">&lt;-</span> <span class="fu">scale</span>(shan_ict)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(shan_ict.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            vars  n mean sd median trimmed  mad   min  max range  skew kurtosis
RADIO_PR       1 55    0  1  -0.04   -0.06 0.94 -1.85 2.55  4.40  0.48    -0.27
TV_PR          2 55    0  1   0.05    0.04 0.78 -2.47 2.09  4.56 -0.38    -0.23
LLPHONE_PR     3 55    0  1  -0.33   -0.15 0.68 -1.19 3.20  4.39  1.37     1.49
MPHONE_PR      4 55    0  1  -0.05   -0.06 1.01 -1.58 2.40  3.98  0.48    -0.34
COMPUTER_PR    5 55    0  1  -0.26   -0.18 0.64 -1.03 3.31  4.34  1.80     2.96
              se
RADIO_PR    0.13
TV_PR       0.13
LLPHONE_PR  0.13
MPHONE_PR   0.13
COMPUTER_PR 0.13</code></pre>
</div>
</div>
<p>Notice that <code>describe()</code> from the <code>psych</code> package is used here instead of <code>summary()</code> since it provides us the standard deviation.</p>
</section>
<section id="hx7.7.3-visualising-standardised-clustering-variables" class="level3">
<h3 class="anchored" data-anchor-id="hx7.7.3-visualising-standardised-clustering-variables">HX7.7.3 Visualising standardised clustering variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values without standardisation"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Standardisation gives us data distributions more closely resembling a normal distribution. The same effect can also be seen if we draw a line plot as below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#ff7d04"</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values without standardisation"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#ff7d04"</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#ff7d04"</span>) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hx7.7.4-computing-proximity-matrix" class="level3">
<h3 class="anchored" data-anchor-id="hx7.7.4-computing-proximity-matrix">HX7.7.4 Computing proximity matrix</h3>
<p>We need a proximity matrix to pass into our hierarchical clustering computation function later. Today, we will use <code>dist(method = 'euclidean')</code> from base R to compute a simple <em>euclidean</em> proximity matrix. There are five other options available: maximum, manhattan, canberra, binary and minkowski.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(shan_ict, <span class="at">method =</span> <span class="st">'euclidean'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>proxmat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Mongmit   Pindaya   Ywangan  Pinlaung    Mabein     Kalaw
Pindaya    17.186828                                                  
Ywangan    38.188259 25.731610                                        
Pinlaung    5.746286 20.863519 40.005492                              
Mabein     26.337099 31.345776 52.914689 31.266966                    
Kalaw      16.005997 30.251785 49.953297 18.196406 19.814085          
Pekon       5.961977 11.791580 33.650410  9.461225 28.226877 21.191531
Lawksawk   14.011550 20.432952 43.216535 19.257320 13.036525 14.001101
Nawnghkio   8.907103 18.064047 37.787702 13.927495 20.463154 12.774787
Kyaukme    14.402475 31.101487 50.589191 13.967966 26.488283  7.942225
Muse       56.301629 70.411252 89.944137 57.158335 45.327410 41.246033
Laihka     14.187227 29.861288 49.183321 10.110150 34.500222 19.734633
Mongnai    11.586190 25.849346 42.271934  6.452387 35.886053 20.034668
Mawkmai    43.492968 43.799577 39.703752 39.811227 69.324602 56.259200
Kutkai      9.761092 21.281775 36.011861  7.807733 34.055064 20.493018
Mongton    19.267961 28.335574 36.123257 16.342143 42.516902 26.787522
Mongyai    25.672744 28.741816 33.312853 22.056339 51.640426 38.674701
Mongkaing  50.361965 48.171125 36.498429 47.629056 74.717454 62.524500
Lashio     25.129457 39.898167 60.217475 26.251735 23.128227 10.669059
Mongpan    19.332063 33.572896 48.368125 19.278316 30.152942 11.469105
Matman     40.125041 35.439039 25.522031 38.240610 63.753975 53.763884
Tachileik  52.963213 63.551774 80.744220 55.501039 36.532538 37.364459
Narphan    40.615714 47.450209 45.295769 37.126895 63.034312 46.353759
Mongkhet   34.945980 39.174783 40.897731 30.586058 61.030557 46.552013
Hsipaw     11.818050 24.598884 38.863147  7.655260 36.642787 21.236711
Monghsat   21.420854 31.471506 43.298028 16.044703 47.048135 31.796188
Mongmao    24.254541 40.221719 54.285957 21.758854 38.491867 19.518913
Nansang    10.491839 27.544246 47.277637  8.549572 28.792364 12.430500
Laukkaing  56.827732 72.685355 90.882520 56.381750 52.067373 42.777791
Pangsang   27.267383 42.824958 55.682263 24.447146 41.854016 22.403998
Namtu      17.962251 22.540822 44.466868 17.004533 36.616094 30.727427
Monghpyak  17.776325 22.130579 36.744835 22.220020 21.269450 16.708436
Konkyan    40.339082 50.086933 52.812533 36.544693 61.351206 44.475859
Mongping   26.512574 31.064850 33.794020 22.975261 51.816310 37.564739
Hopong     13.693111 22.306050 35.285844  9.814855 39.800917 26.416294
Nyaungshwe  9.938590 21.652463 40.711649 13.812050 21.021337  9.566782
Hsihseng   13.149728 17.200796 34.291035 11.161846 38.120187 28.711074
Mongla     38.430076 54.942389 72.816301 37.259678 40.609124 26.026411
Hseni      18.937188 33.798982 53.444679 20.447572 21.361240  3.852842
Kunlong    22.412169 35.547066 53.163089 19.476257 39.661508 27.301375
Hopang     28.105362 44.326362 59.619312 26.596924 36.855167 18.514704
Namhkan    38.602794 54.381859 71.443173 38.278835 37.956035 24.639577
Kengtung   24.645691 38.568322 57.323173 26.348638 21.947071  8.829335
Langkho    16.426299 32.328133 50.778892 16.844228 25.384371  6.719580
Monghsu    10.915790 19.835391 34.042789  8.086834 36.719820 23.734578
Taunggyi   39.984278 50.375471 69.798323 42.954386 22.624011 25.226066
Pangwaun   38.151246 51.213162 58.013146 35.637963 52.344632 33.835194
Kyethi     20.292551 17.554012 28.729358 18.947065 44.207679 36.017247
Loilen     14.548666 29.361143 46.951621  9.156527 37.506406 21.719877
Manton     43.064070 40.242888 30.616379 40.583081 67.401120 56.016577
Mongyang   30.951302 47.593982 63.071590 28.603834 41.188352 23.356349
Kunhing    17.350424 31.823811 44.967218 14.158836 37.582140 19.763683
Mongyawng  21.421738 33.292193 57.056521 23.555497 19.349994 17.343078
Tangyan    19.592520 20.843740 32.477002 16.950567 44.859948 34.806617
Namhsan    23.778494 22.841073 28.616305 21.433352 48.833873 38.588676
               Pekon  Lawksawk Nawnghkio   Kyaukme      Muse    Laihka
Pindaya                                                               
Ywangan                                                               
Pinlaung                                                              
Mabein                                                                
Kalaw                                                                 
Pekon                                                                 
Lawksawk   15.751129                                                  
Nawnghkio  11.315370  9.082891                                        
Kyaukme    20.212206 18.629066 15.704230                              
Muse       61.456144 51.013288 53.368806 43.475768                    
Laihka     18.223667 24.674469 21.188187 12.824979 52.665211          
Mongnai    15.160031 24.171260 18.221245 14.245669 57.197975 10.053457
Mawkmai    41.600669 56.752693 49.515047 51.202846 92.693007 42.996554
Kutkai     11.498048 22.464646 14.744053 17.093318 59.290743 14.467198
Mongton    20.814888 31.107742 22.581118 22.928509 63.471074 21.207320
Mongyai    24.252301 39.126989 31.957938 33.927780 76.391399 26.413364
Mongkaing  48.023965 62.518712 54.669447 58.605094 99.566496 52.296309
Lashio     30.380011 22.075270 23.055346 12.995255 31.315288 23.864533
Mongpan    24.330037 22.854223 17.284425 11.037831 44.749969 21.076951
Matman     36.825761 51.539711 44.405061 50.552285 92.911283 44.325453
Tachileik  57.339528 44.182621 47.045533 42.915493 22.119950 54.908985
Narphan    41.684901 52.369580 43.559661 42.030003 77.040234 39.232592
Mongkhet   34.208722 48.741102 41.410280 40.903553 81.644931 32.497428
Hsipaw     14.537542 24.935081 17.609570 16.395741 59.103355 12.842987
Monghsat   22.564279 35.231496 28.983220 25.325370 66.376026 15.893517
Mongmao    29.370625 31.464777 25.776465 14.609228 45.182530 18.599082
Nansang    16.037607 18.878869 15.113185  6.032773 48.935308  7.878999
Laukkaing  62.482399 54.883928 55.265554 42.874978 14.926996 50.739700
Pangsang   32.181214 34.591486 28.710769 17.535273 46.024292 21.419291
Namtu      16.502707 26.095300 25.752713 27.087277 65.916927 18.586794
Monghpyak  19.093173 14.231691  9.303711 21.764419 53.943485 29.322640
Konkyan    42.148797 52.031264 43.934272 39.379911 70.486973 35.175354
Mongping   25.968288 39.647081 31.614719 33.028984 74.444948 27.282761
Hopong     13.886577 27.491604 20.488286 21.884211 64.868011 15.748857
Nyaungshwe 13.931874 10.417830  4.326545 12.650414 50.588581 20.171653
Hsihseng   10.530573 25.711202 20.988026 25.027059 67.766886 17.589761
Mongla     44.120998 39.318472 38.140808 24.158966 25.680556 31.593218
Hseni      24.398001 17.150398 16.405304  8.120593 38.130567 20.449010
Kunlong    24.936301 31.830406 28.504608 21.563037 54.724297 12.268682
Hopang     33.638582 32.116462 27.984188 15.491633 37.744407 23.078652
Namhkan    44.277120 37.941126 36.733575 24.781990 23.867060 34.243665
Kengtung   29.767761 20.938215 20.829647 13.623356 33.008211 25.823950
Langkho    21.921623 19.030257 15.651662  5.167279 41.364173 16.094435
Monghsu    11.384636 24.204063 17.009168 20.077712 63.321624 16.328926
Taunggyi   44.066133 30.496838 34.479200 31.260547 25.081471 42.536916
Pangwaun   42.381347 45.302765 38.167478 30.831407 54.197887 35.178203
Kyethi     16.243575 31.774604 26.721607 32.814177 75.716745 25.583275
Loilen     18.194596 26.529318 21.926405 14.692675 56.043400  5.969478
Manton     40.382131 55.113000 47.577296 52.286003 94.149778 45.830232
Mongyang   36.358788 36.337684 32.332123 18.859489 38.959919 22.971502
Kunhing    21.346379 27.868953 20.615773 14.500266 53.300162 14.203682
Mongyawng  24.843910 17.907229 22.061209 18.155295 42.237358 21.199976
Tangyan    16.779937 32.314701 26.907880 30.678359 73.693741 22.429176
Namhsan    20.716559 36.284062 29.974967 34.785944 77.852971 27.379672
             Mongnai   Mawkmai    Kutkai   Mongton   Mongyai Mongkaing
Pindaya                                                               
Ywangan                                                               
Pinlaung                                                              
Mabein                                                                
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Nawnghkio                                                             
Kyaukme                                                               
Muse                                                                  
Laihka                                                                
Mongnai                                                               
Mawkmai    37.450873                                                  
Kutkai      9.115307 36.495519                                        
Mongton    13.167061 31.335220 10.706341                              
Mongyai    20.323607 17.870499 18.894166 15.979790                    
Mongkaing  45.600842 13.329995 42.896133 36.550032 26.284016          
Lashio     27.086983 63.860773 28.982513 34.711584 46.636472 70.865819
Mongpan    17.809554 50.999632 18.518173 20.031803 34.639710 56.356780
Matman     37.633870 14.783545 34.086349 30.304574 18.695158 13.551424
Tachileik  56.395232 91.938755 56.899109 60.876740 75.029555 96.714087
Narphan    32.931700 27.375350 31.427683 21.597925 24.882845 28.565085
Mongkhet   27.576855 11.558388 27.391673 22.322828 10.498924 22.260577
Hsipaw      5.268195 35.134601  5.146282  9.069766 17.733790 42.377868
Monghsat   12.525968 27.509705 15.432012 15.098053 12.735225 37.560376
Mongmao    18.829603 48.552853 20.469232 20.657001 33.561300 55.231959
Nansang     9.279567 46.241938 13.004549 19.958124 28.855962 54.216609
Laukkaing  55.156800 88.251110 58.038112 60.466190 73.268347 95.411795
Pangsang   20.425746 48.414757 22.833583 21.077938 34.330638 54.840662
Namtu      20.935473 42.795451 22.528268 30.871751 27.802761 52.504057
Monghpyak  25.326470 53.671695 20.661627 25.804282 37.001575 56.821089
Konkyan    32.882831 33.901411 31.060810 24.825265 28.787384 38.092091
Mongping   20.299615 19.431049 18.275266 11.986993  6.538727 25.718572
Hopong      9.153795 30.284362  7.345899 10.621031 12.462791 37.937916
Nyaungshwe 16.963695 50.299026 15.215482 21.972196 32.713541 55.732112
Hsihseng   14.236728 32.929477 12.821054 19.464317 16.227126 41.159788
Mongla     35.410985 68.688950 38.840984 41.106668 53.528615 76.148327
Hseni      21.681639 58.253670 22.937894 28.675945 40.823212 64.804408
Kunlong    20.292529 44.653763 20.454010 27.002165 29.936066 53.991284
Hopang     24.300945 56.124281 26.331986 27.350305 40.873288 62.617673
Namhkan    37.005669 70.647792 39.248568 41.453594 55.062819 77.139688
Kengtung   27.228711 63.254638 27.919573 32.938387 46.039706 69.274693
Langkho    17.467678 53.108019 18.051419 23.670878 35.895672 59.742714
Monghsu     8.411238 33.207962  6.260859 10.704894 15.486049 40.071816
Taunggyi   44.855282 81.074692 45.033382 50.840925 63.594105 86.621117
Pangwaun   31.213429 50.068857 32.180465 25.750434 39.407696 53.695736
Kyethi     21.050453 27.885535 18.423422 22.252947 13.779420 35.206533
Loilen      5.841263 38.873386 13.156529 17.616001 22.479239 48.218190
Manton     39.154062 10.908779 36.182684 31.020581 19.559882  8.175337
Mongyang   26.039387 55.883162 28.533223 29.560023 41.431237 63.191325
Kunhing    11.055197 39.843973 10.884990 11.403609 23.899570 46.503971
Mongyawng  27.577546 62.004321 28.103383 37.522688 44.578964 70.098284
Tangyan    18.037471 26.266006 16.661820 19.888460 10.908506 34.856123
Namhsan    21.810003 21.519289 19.132762 19.676188  7.735900 28.866231
              Lashio   Mongpan    Matman Tachileik   Narphan  Mongkhet
Pindaya                                                               
Ywangan                                                               
Pinlaung                                                              
Mabein                                                                
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Nawnghkio                                                             
Kyaukme                                                               
Muse                                                                  
Laihka                                                                
Mongnai                                                               
Mawkmai                                                               
Kutkai                                                                
Mongton                                                               
Mongyai                                                               
Mongkaing                                                             
Lashio                                                                
Mongpan    17.233279                                                  
Matman     62.811049 49.481014                                        
Tachileik  31.195286 41.103849 89.012935                              
Narphan    52.563854 37.113393 31.205193 76.029566                    
Mongkhet   53.444463 41.217123 20.302855 82.050164 21.728718          
Hsipaw     29.086435 17.952054 34.445451 57.618780 29.540170 25.380950
Monghsat   37.786793 28.330992 31.359911 67.709508 27.821548 16.798445
Mongmao    21.423677 13.159966 50.159903 47.295568 33.142618 37.535820
Nansang    18.447950 14.477393 45.806573 48.677266 39.813308 36.099219
Laukkaing  33.465738 43.558047 90.372094 32.506329 70.882887 76.906406
Pangsang   23.672516 14.023910 50.629940 48.131907 31.630314 37.558139
Namtu      36.588437 35.291394 41.665397 65.956458 49.436143 35.599713
Monghpyak  26.209281 18.785699 47.046845 44.404411 44.840651 46.263265
Konkyan    48.551312 36.587588 39.240306 73.092980 15.882353 25.424424
Mongping   45.452548 31.847482 20.165224 72.708969 18.864567 11.380917
Hopong     34.531042 23.943845 29.184351 63.245718 29.440441 21.299485
Nyaungshwe 20.158191 13.729734 46.091883 44.581335 42.794086 41.708639
Hsihseng   36.900833 29.587811 30.402806 65.887060 37.752977 25.670338
Mongla     17.995877 25.320001 70.817595 34.733155 53.146949 57.440292
Hseni       7.941836 12.066550 56.464051 35.490063 47.412297 48.188406
Kunlong    29.523103 28.803320 46.827436 59.570536 41.307823 34.168641
Hopang     17.063913 13.562913 57.355355 40.382035 39.785908 45.151070
Namhkan    17.327153 24.034131 71.542102 29.591660 53.685519 59.619944
Kengtung    5.985893 14.221554 61.301033 29.590429 50.540025 53.135998
Langkho    11.518145  9.498486 51.886151 40.233622 42.065204 42.808061
Monghsu    32.571557 21.625326 30.813805 60.502113 31.192379 24.773318
Taunggyi   19.514541 31.981385 77.845810 15.084117 68.420905 71.280752
Pangwaun   36.245608 23.252209 52.343600 54.060474 26.464997 40.702947
Kyethi     44.710266 35.889620 23.383079 72.887329 37.490376 23.325039
Loilen     26.892310 20.725000 40.656282 57.375476 35.479137 28.476895
Manton     64.666493 50.796808  5.952318 91.023039 28.026395 18.133894
Mongyang   20.933700 19.493467 58.561776 44.879027 40.139475 44.540621
Kunhing    25.510832 13.785278 40.366587 53.226397 28.162645 29.249814
Mongyawng  17.270139 27.515989 60.180824 43.210118 57.276394 52.291815
Tangyan    42.984475 34.039128 24.278233 71.984066 34.884991 20.149393
Namhsan    47.204024 36.477086 18.009747 75.403913 31.654695 17.090848
              Hsipaw  Monghsat   Mongmao   Nansang Laukkaing  Pangsang
Pindaya                                                               
Ywangan                                                               
Pinlaung                                                              
Mabein                                                                
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Nawnghkio                                                             
Kyaukme                                                               
Muse                                                                  
Laihka                                                                
Mongnai                                                               
Mawkmai                                                               
Kutkai                                                                
Mongton                                                               
Mongyai                                                               
Mongkaing                                                             
Lashio                                                                
Mongpan                                                               
Matman                                                                
Tachileik                                                             
Narphan                                                               
Mongkhet                                                              
Hsipaw                                                                
Monghsat   12.178922                                                  
Mongmao    18.599483 24.717708                                        
Nansang    12.024428 20.192690 16.499494                              
Laukkaing  56.906099 62.644910 40.400848 48.060074                    
Pangsang   20.504337 25.637933  5.760801 19.336162 40.804016          
Namtu      22.944658 23.178673 36.503882 21.761884 66.406286 39.297391
Monghpyak  23.767919 35.684917 29.188846 22.752638 56.584279 31.511651
Konkyan    29.674316 26.825060 28.187425 37.470456 63.592043 27.481900
Mongping   16.892101 14.095392 30.557166 28.736626 70.813447 30.833123
Hopong      6.286179 10.045714 24.416253 16.766291 62.848557 26.151075
Nyaungshwe 16.992664 28.637238 23.045003 13.118943 52.024345 25.777823
Hsihseng   13.654610 15.349551 31.198001 19.353779 67.074564 33.552974
Mongla     37.347509 42.900536 21.624705 28.945119 20.255831 21.788123
Hseni      23.148538 33.122632 18.467099 13.645492 39.174585 21.466375
Kunlong    20.510051 20.231862 22.443391 18.301388 52.188657 25.849342
Hopang     24.872536 31.764824  7.829342 19.647091 33.167199  9.257672
Namhkan    38.279302 45.510875 22.332205 30.289487 19.646063 23.138484
Kengtung   28.408582 38.372138 20.758055 19.367980 35.148520 22.985484
Langkho    18.305109 27.952329 13.450170  9.939859 41.041270 16.765920
Monghsu     5.855724 13.724737 24.243599 15.359962 61.901766 26.052971
Taunggyi   46.231183 56.288102 38.733906 36.504897 34.598041 40.559730
Pangwaun   29.812447 34.353898 18.740057 32.612960 47.063605 15.748757
Kyethi     19.517677 19.050609 37.789657 27.302385 74.999415 39.689963
Loilen      9.804789 11.865144 19.026490  9.423028 53.557527 20.794433
Manton     35.960008 31.715603 50.379786 47.655544 90.738406 50.475214
Mongyang   26.710497 31.264797  9.106281 21.849285 32.619219 10.837735
Kunhing     9.077517 16.538834 10.391040 12.820940 50.041640 12.318870
Mongyawng  29.470967 36.440429 29.640789 19.111990 45.480044 33.616703
Tangyan    16.769794 14.459626 34.714183 24.970235 72.240954 36.476893
Namhsan    19.447928 16.956962 37.171448 29.416284 76.045960 38.565526
               Namtu Monghpyak   Konkyan  Mongping    Hopong Nyaungshwe
Pindaya                                                                
Ywangan                                                                
Pinlaung                                                               
Mabein                                                                 
Kalaw                                                                  
Pekon                                                                  
Lawksawk                                                               
Nawnghkio                                                              
Kyaukme                                                                
Muse                                                                   
Laihka                                                                 
Mongnai                                                                
Mawkmai                                                                
Kutkai                                                                 
Mongton                                                                
Mongyai                                                                
Mongkaing                                                              
Lashio                                                                 
Mongpan                                                                
Matman                                                                 
Tachileik                                                              
Narphan                                                                
Mongkhet                                                               
Hsipaw                                                                 
Monghsat                                                               
Mongmao                                                                
Nansang                                                                
Laukkaing                                                              
Pangsang                                                               
Namtu                                                                  
Monghpyak  34.657799                                                   
Konkyan    47.837690 46.339594                                         
Mongping   32.166441 35.476537 24.202901                               
Hopong     20.682668 26.795563 30.449287 13.400139                     
Nyaungshwe 27.141464 10.397300 43.235040 31.932583 20.932532           
Hsihseng   13.189940 28.537627 38.349700 19.964389  9.165458  22.580242
Mongla     48.349434 40.803397 46.809747 51.261580 43.231105  34.760273
Hseni      32.741448 20.026876 44.884563 39.558453 28.641193  13.086310
Kunlong    23.360474 35.744661 32.911433 30.905385 21.906817  28.513095
Hopang     40.824516 30.426577 34.818522 37.927212 30.977356  24.719891
Namhkan    50.632466 37.950202 48.159596 52.374815 44.413246  33.332428
Kengtung   38.533554 22.147613 47.482621 44.280821 34.047382  17.775714
Langkho    30.503473 20.027496 38.695022 34.396455 23.963685  12.826577
Monghsu    20.964684 23.217823 33.172187 15.890478  4.340665  17.382799
Taunggyi   51.872748 33.417439 65.056905 62.153039 51.376415  32.509619
Pangwaun   51.703554 38.195144 26.397576 34.037881 34.600673  35.292324
Kyethi     18.690932 32.816234 40.010989 18.743974 13.649038  28.806872
Loilen     19.424075 29.699681 33.419820 23.199959 12.474445  20.640432
Manton     44.858230 50.220840 36.666876 20.048082 31.058885  48.879874
Mongyang   41.326052 35.817599 32.939338 38.780686 32.335704  29.429500
Kunhing    29.643996 25.074435 25.374202 21.259619 14.515617  18.997131
Mongyawng  26.224331 28.556475 52.238580 45.559190 32.659925  21.812104
Tangyan    17.869483 33.526416 36.746064 16.167411 10.682328  28.414692
Namhsan    24.095555 35.270492 35.220115 13.023777 13.270541  31.591750
            Hsihseng    Mongla     Hseni   Kunlong    Hopang   Namhkan
Pindaya                                                               
Ywangan                                                               
Pinlaung                                                              
Mabein                                                                
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Nawnghkio                                                             
Kyaukme                                                               
Muse                                                                  
Laihka                                                                
Mongnai                                                               
Mawkmai                                                               
Kutkai                                                                
Mongton                                                               
Mongyai                                                               
Mongkaing                                                             
Lashio                                                                
Mongpan                                                               
Matman                                                                
Tachileik                                                             
Narphan                                                               
Mongkhet                                                              
Hsipaw                                                                
Monghsat                                                              
Mongmao                                                               
Nansang                                                               
Laukkaing                                                             
Pangsang                                                              
Namtu                                                                 
Monghpyak                                                             
Konkyan                                                               
Mongping                                                              
Hopong                                                                
Nyaungshwe                                                            
Hsihseng                                                              
Mongla     47.866210                                                  
Hseni      31.274375 22.682048                                        
Kunlong    23.185967 34.646200 27.619175                              
Hopang     37.001334 14.702444 16.280878 27.134451                    
Namhkan    49.209476  7.721355 21.211323 37.573885 14.618632          
Kengtung   37.072441 20.245004  6.612817 31.714187 16.429921 17.563015
Langkho    27.627441 22.901675  6.666133 22.452741 13.424847 22.440029
Monghsu     9.782470 42.451868 26.228462 23.989665 30.184458 43.132637
Taunggyi   52.814240 29.709863 23.819389 47.129032 32.995252 25.729147
Pangwaun   43.306326 31.918643 33.070182 39.245403 20.698364 31.044067
Kyethi      8.404049 55.602500 38.833498 29.855859 44.048114 56.786202
Loilen     15.884853 33.867408 22.710984 16.653599 24.289326 36.490647
Manton     33.487758 71.251416 58.463341 47.976855 57.752046 72.186149
Mongyang   38.259743 14.666661 21.019929 24.722785  6.925859 16.772448
Kunhing    22.015490 30.647566 20.647448 19.377551 17.296164 31.492119
Mongyawng  30.951462 31.557550 17.386004 24.039800 29.051360 32.121112
Tangyan     7.027241 52.680849 37.307575 26.807983 41.222167 54.264078
Namhsan    12.574240 56.402740 41.196125 31.040560 44.051555 57.642717
            Kengtung   Langkho   Monghsu  Taunggyi  Pangwaun    Kyethi
Pindaya                                                               
Ywangan                                                               
Pinlaung                                                              
Mabein                                                                
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Nawnghkio                                                             
Kyaukme                                                               
Muse                                                                  
Laihka                                                                
Mongnai                                                               
Mawkmai                                                               
Kutkai                                                                
Mongton                                                               
Mongyai                                                               
Mongkaing                                                             
Lashio                                                                
Mongpan                                                               
Matman                                                                
Tachileik                                                             
Narphan                                                               
Mongkhet                                                              
Hsipaw                                                                
Monghsat                                                              
Mongmao                                                               
Nansang                                                               
Laukkaing                                                             
Pangsang                                                              
Namtu                                                                 
Monghpyak                                                             
Konkyan                                                               
Mongping                                                              
Hopong                                                                
Nyaungshwe                                                            
Hsihseng                                                              
Mongla                                                                
Hseni                                                                 
Kunlong                                                               
Hopang                                                                
Namhkan                                                               
Kengtung                                                              
Langkho    10.716213                                                  
Monghsu    31.691914 22.184918                                        
Taunggyi   18.628225 28.827478 48.691951                              
Pangwaun   33.748335 29.538434 34.338498 49.761245                    
Kyethi     44.426274 35.091512 14.661572 59.957407 47.662610          
Loilen     28.222935 18.410672 13.155208 45.591617 33.169981 23.232965
Manton     63.199123 53.595620 33.076503 80.308034 51.079265 27.203299
Mongyang   21.708047 17.535413 32.395988 37.458247 22.525026 45.386726
Kunhing    24.595083 14.638284 14.678891 42.998509 22.909986 27.895182
Mongyawng  20.387199 18.611584 31.285089 28.773864 47.533116 38.771518
Tangyan    42.995076 33.202048 12.742203 59.265262 44.705580  4.779331
Namhsan    46.620497 36.820978 15.322576 63.149232 44.858030  6.867929
              Loilen    Manton  Mongyang   Kunhing Mongyawng   Tangyan
Pindaya                                                               
Ywangan                                                               
Pinlaung                                                              
Mabein                                                                
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Nawnghkio                                                             
Kyaukme                                                               
Muse                                                                  
Laihka                                                                
Mongnai                                                               
Mawkmai                                                               
Kutkai                                                                
Mongton                                                               
Mongyai                                                               
Mongkaing                                                             
Lashio                                                                
Mongpan                                                               
Matman                                                                
Tachileik                                                             
Narphan                                                               
Mongkhet                                                              
Hsipaw                                                                
Monghsat                                                              
Mongmao                                                               
Nansang                                                               
Laukkaing                                                             
Pangsang                                                              
Namtu                                                                 
Monghpyak                                                             
Konkyan                                                               
Mongping                                                              
Hopong                                                                
Nyaungshwe                                                            
Hsihseng                                                              
Mongla                                                                
Hseni                                                                 
Kunlong                                                               
Hopang                                                                
Namhkan                                                               
Kengtung                                                              
Langkho                                                               
Monghsu                                                               
Taunggyi                                                              
Pangwaun                                                              
Kyethi                                                                
Loilen                                                                
Manton     41.906087                                                  
Mongyang   24.676592 58.570558                                        
Kunhing    13.039336 41.049230 18.889405                              
Mongyawng  26.175211 62.943339 30.421734 29.535984                    
Tangyan    19.660826 27.182672 42.106366 24.974161 37.752279          
Namhsan    24.215271 21.048485 45.097869 27.079121 43.002019  6.367613</code></pre>
</div>
</div>
</section>
</section>
<section id="hx7.8-computing-hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="hx7.8-computing-hierarchical-clustering">HX7.8 Computing hierarchical clustering</h2>
<p>Several packages exist in R to perform hierarchical clustering, but today, <code>hclust()</code> from R stats will be used. It employs an agglomeration method to compute clusters and supports the following eight clustering algorithms: <code>ward.D</code>, <code>ward.D2</code>, <code>single</code>, <code>complete</code>, <code>average</code> (UPGMA), <code>mcquitty</code> (WPGMA), <code>median</code> (WPGMC) and <code>centroid</code> (UPGMC).</p>
<p>The code chunk below performs hierarchical cluster analysis using ward.D method. The hierarchical clustering output is stored in an object of class <code>hclust</code>, which describes the tree produced by the clustering process. We will then plot the tree using <code>plot()</code> from R graphics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method =</span> <span class="st">'ward.D'</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hx7.9-selecting-optimal-clustering-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="hx7.9-selecting-optimal-clustering-algorithm">HX7.9 Selecting optimal clustering algorithm</h2>
<p>A key challenge in performing hierarchical clustering is in identifying stronger clustering structures. A function, <code>agnes()</code> from the <code>cluster</code> package, can be used to solve this issue - it functions like <code>hclust()</code>, but can also be used to return the <strong>agglomerative coefficient</strong>, which measures the extent to which clustering exists. As the coefficient approaches <code>1</code>, the data suggests a stronger clustering structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agnes</span>(shan_ict, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(m, ac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.8131144 0.6628705 0.8950702 0.9427730 </code></pre>
</div>
</div>
<p>From the output above, Ward’s method provides the strongest clustering structure among the four methods assessed. Hence, we will use Ward’s method in subsequent analyses.</p>
</section>
<section id="hx7.10-determining-optimal-clusters" class="level2">
<h2 class="anchored" data-anchor-id="hx7.10-determining-optimal-clusters">HX7.10 Determining optimal clusters</h2>
<p>The next obstacle is in determining the optimal clusters to retain. Three commonly used methods are used to determine optimal clusters: the <strong>elbow method</strong>, the <strong>average silhouette method</strong> and the <strong>gap statistic method</strong>.</p>
<section id="hx7.10.1-gap-statistic-method" class="level3">
<h3 class="anchored" data-anchor-id="hx7.10.1-gap-statistic-method">HX7.10.1 Gap statistic method</h3>
<p>This method compares the total within intra-cluster variation for different numbers of clusters <span class="math inline">\(k\)</span> with their expected values under null reference distribution of the data. The estimate of the optimal clusters will be value that maximises the gap statistic (i.e., that yields the largest gap statistic). This means that the clustering structure is far away from the random uniform distribution of points.</p>
<p><code>clusGap()</code> of the <code>cluster</code> package will be used to compute the gap statistic, and <code>fviz_gap_stat()</code> of the <code>factoextra</code> package will be used to plot the optimal numbers of clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(shan_ict, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> hcut, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nstart =</span> <span class="dv">25</span>, </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K.max =</span> <span class="dv">10</span>, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gap_stat, <span class="at">method =</span> <span class="st">"firstmax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Clustering Gap statistic ["clusGap"] from call:
clusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)
B=50 simulated reference sets, k = 1..10; spaceH0="scaledPCA"
 --&gt; Number of clusters (method 'firstmax'): 1
          logW   E.logW       gap     SE.sim
 [1,] 6.104544 6.378209 0.2736651 0.04460994
 [2,] 5.827444 6.048127 0.2206824 0.03880130
 [3,] 5.689680 5.899965 0.2102844 0.03362652
 [4,] 5.559639 5.778070 0.2184311 0.03784781
 [5,] 5.453876 5.675437 0.2215615 0.03897071
 [6,] 5.363009 5.585192 0.2221833 0.03973087
 [7,] 5.288334 5.503748 0.2154145 0.04054939
 [8,] 5.224095 5.429034 0.2049390 0.04198644
 [9,] 5.155439 5.358210 0.2027705 0.04421874
[10,] 5.074827 5.291273 0.2164465 0.04540947</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_gap_stat</span>(gap_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With the highest gap statistic of around <code>0.275</code>, the recommended value of <span class="math inline">\(k\)</span> is <code>1</code>, i.e.&nbsp;we are apparently encouraged to retain only one cluster. However, this is illogical - instead, the next best value of <span class="math inline">\(k\)</span>, with the second highest gap statistic, is <code>6</code>.</p>
</section>
<section id="hx7.10.2-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="hx7.10.2-interpretation">HX7.10.2 Interpretation</h3>
<p>In the dendrogram from <strong>HX7.5</strong>, each leaf corresponds to one observation. As we move up the tree, observations that are similar to each other are combined into branches, which are themselves fused at a higher height. The height of the fusion (which is provided on the y-axis) indicates the (dis)similarity between two observations. The higher the height, the less similar the observations are. We cannot use the proximity of two observations along the <em>x-axis</em> as a basis of comparision for their similarity.</p>
<p>It is also possible to draw the dendrogram with a border around the selected clusters by using <code>rect.hclust()</code> of R stats. The argument border is used to specify the border colors for the rectangles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">6</span>, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="hx7.11-visually-driven-hierarchical-clustering-analysis" class="level2">
<h2 class="anchored" data-anchor-id="hx7.11-visually-driven-hierarchical-clustering-analysis">HX7.11 Visually-driven hierarchical clustering analysis</h2>
<p>Another type of clustering analysis is <strong>visually-driven hierarchical clustering analysis</strong>, which can be done using the <code>heatmaply</code> package. With this package, we can build both highly interactive cluster heatmaps or static cluster heatmaps.</p>
<section id="hx7.11.1-transforming-data-frame-into-matrix" class="level3">
<h3 class="anchored" data-anchor-id="hx7.11.1-transforming-data-frame-into-matrix">HX7.11.1 Transforming data frame into matrix</h3>
<p>The data was loaded as a dataframe, but to create the heatmap we have to first convert it into a data matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>shan_ict_mat <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hx7.11.2-interactive-cluster-heatmap" class="level3">
<h3 class="anchored" data-anchor-id="hx7.11.2-interactive-cluster-heatmap">HX7.11.2 Interactive cluster heatmap</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">normalize</span>(shan_ict_mat),</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclust_method =</span> <span class="st">"ward.D"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">seriate =</span> <span class="st">"OLO"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> Blues,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_row =</span> <span class="dv">6</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">200</span>,<span class="dv">60</span>,<span class="cn">NA</span>),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">4</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">5</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Geographic Segmentation of Shan State by ICT indicators"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"ICT Indicators"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Townships of Shan State"</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f547fdd7f7cb17180a7c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f547fdd7f7cb17180a7c">{"x":{"data":[{"x":[1,2,3,4,5],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],"z":[[0.11697828280235656,0.12946800291670138,0.22051676674466952,0.3846139992017637,0],[0.1190714713575737,0.34509307535574651,0.14668071862261853,0.6891560112923748,0.030692309450180387],[0.44811294912657407,0.55225992411450087,0.1052156876000811,0.57412901426752883,0.484807392774743],[0.39472652438726058,0.64647733866993595,0.19477119473094034,0.39801608135750721,0.30703392330347096],[0.40973860994388689,0.66778546258182536,0.20593962805229063,0.48078425480385872,0.31045720041004654],[0.56035905060769442,0.6821600532019152,0.21982898000630299,0.53271772917722882,0.29569694938338709],[0.50978351840105796,0.70584966248141379,0.23527761552998844,0.56572881621915971,0.18421714232785746],[0.44536782610845499,0.64847518658958281,0.40072537449675555,0.52572958435168682,0.32572766162209832],[0.3030063240466021,0.49147219082742083,0.39341363429136933,0.4349886836765729,0.25539117902522024],[0.28546056562312344,0.65316773418946472,0.3511299776298073,0.32190336940009312,0.2746837227301171],[0.18689649559375604,0.47362168694479923,0.17754710976751639,0.21901799211937109,0.21923803903390368],[0.2629488857600436,0.60093442055127599,0.10558868166123289,0.30984472139571101,0.32244406175045992],[0.34838456904687853,0.55041330721869519,0.013213311777657203,0.33060051526022327,0.28050502634682223],[0.37211615170496543,0.37496862114224927,0.12506080462855637,0.36350286192371334,0.20828663725058605],[0.38204908464317522,0.49529324375134881,0.16528121425607512,0.33285202942113168,0.12691106039033156],[0.3980907579303854,0.46773404772860855,0.1652519260833811,0.24827221676312536,0.12566331521633783],[0.46367507181173734,0.48027348971210532,0.049517603601854712,0.27845401411719362,0.10224025627189308],[0.45439139601376666,0.58594353490077888,0.14417252910969927,0.30481757278969496,0.11764114434607098],[0.57205942216261241,0.60302857970223533,0.18200927177224013,0.32084610041574091,0.099653220995087818],[0.64202483918062014,0.57786439014823909,0.20733874544122771,0.2552581189664615,0.17607405769543419],[0.46963701986480177,0.49275331606035999,0.33640390671869069,0.32646328563512589,0.19964300270472204],[0.47243757577103745,0.70830658131680169,0.18152892689938518,0.098196451325406497,0.18683697450666378],[0.48702182505931935,0.53618454590948417,0.16236928492310002,0.15547460469197441,0.074496310341376853],[0.53416314399345055,0.45576055674496135,0.10954853696695575,0.076155538926932026,0.1069257718509344],[0.4375902968230686,0.46420446143708177,0.11087478745786904,0.098440375857401646,0.098597886950666486],[0.45263667579662742,0.37779761401029394,0.11365549681498793,0.087769700588719038,0.064068575228978811],[0.31801152018301904,0.34169331569611694,0.098223180852338707,0.14121340016110578,0.06845357030346759],[0.30390562646118419,0.29573466001141141,0.12216142202890717,0.22079722888776726,0.093357637355966402],[0.12583937793228897,0.27166586954277666,0.14691293402953898,0.11190443691659302,0.040120375229698704],[0.16481813869170037,0.16307059912065375,0,0,0.050562923174397992],[0.29277803105512323,0,0.018020667308862738,0.020514689816836292,0.057341960293267422],[0.37385748377862454,0.099529007645666634,0.029599900644770458,0.026290069687093635,0.0041124401409408104],[0.48130384213362665,0.14229750653679712,0.031665051478322832,0.012573063998461675,0.030854020566575952],[1,0.1989581694259637,0.051234029774627307,0.1199784726998025,0.012754780873524385],[0.85531477807188261,0.53558029529267859,0.09544043782343907,0.18021510896887391,0.10775997132544597],[0.78980219430668397,0.70746355636330893,0.16078708461582927,0.40650165146089307,0.2074510389282212],[0.65302227298916715,0.60351827743629838,0.090757204809061548,0.45032057879694443,0.13928686759144926],[0.70831666585604425,0.59451431070864047,0.19959920412341628,0.41000871240744069,0.14010534490572477],[0.82848163458094803,0.53309615033103497,0.22225304485480443,0.49414581896158,0.24532142669874674],[0.92441487443451953,0.81570663014131484,0.3915514072900575,0.50956182689641516,0.14779989677341523],[0.55458208226657446,0.85789929032177492,0.66700796483691616,0.41150185475720735,0.13518667681882071],[0.21763398035874212,0.6520984304010603,1,0.28778828469233325,0.196437751553831],[0,0.23543567048956018,0.93210135445804221,0.40101556902451285,0.084421792656946576],[0.10937492963625835,0.6239421797955409,0.62205063209383749,0.6188729942182486,0.10736975492138892],[0.2136137052884651,0.54598018129684645,0.46285806565679205,0.5558831363146618,0.089979971244948997],[0.22989746208303394,0.60680342034724111,0.44188018109426458,0.64558140267074615,0.23838778070406408],[0.24582481175676543,0.73986922857984394,0.49811595358599009,0.8012306000003262,0.30165891030396319],[0.069496745754494604,0.91187904567993305,0.73626364575085557,0.97326830696953925,0.36217260806198814],[0.13189010662422906,0.76691504545610356,0.47117405530992845,0.74203095277732456,0.66556801662669463],[0.1648296584979817,0.51521670119868102,0.33457025472725271,0.57855734181793805,0.52903303494584919],[0.53176358126123546,0.71817785309851512,0.33811911213704343,0.64506885812542736,0.4966599235186423],[0.46321400984145472,0.77736794201940884,0.35759948327266128,0.61146312565581429,0.63887304429100655],[0.74278145022617081,0.87988241582281568,0.44075599890374501,0.78717895265256588,0.87397863437784384],[0.73856184642802991,0.88560203867754661,0.31880165558342555,1,1],[0.33405948053815493,1,0.76534529857384681,0.96780866955997524,0.98756611073781375]],"text":[["row: Narphan<br>column: RADIO_PR<br>value: 0.116978","row: Narphan<br>column: TV_PR<br>value: 0.129468","row: Narphan<br>column: LLPHONE_PR<br>value: 0.220517","row: Narphan<br>column: MPHONE_PR<br>value: 0.384614","row: Narphan<br>column: COMPUTER_PR<br>value: 0.000000"],["row: Pangwaun<br>column: RADIO_PR<br>value: 0.119071","row: Pangwaun<br>column: TV_PR<br>value: 0.345093","row: Pangwaun<br>column: LLPHONE_PR<br>value: 0.146681","row: Pangwaun<br>column: MPHONE_PR<br>value: 0.689156","row: Pangwaun<br>column: COMPUTER_PR<br>value: 0.030692"],["row: Mongpan<br>column: RADIO_PR<br>value: 0.448113","row: Mongpan<br>column: TV_PR<br>value: 0.552260","row: Mongpan<br>column: LLPHONE_PR<br>value: 0.105216","row: Mongpan<br>column: MPHONE_PR<br>value: 0.574129","row: Mongpan<br>column: COMPUTER_PR<br>value: 0.484807"],["row: Nansang<br>column: RADIO_PR<br>value: 0.394727","row: Nansang<br>column: TV_PR<br>value: 0.646477","row: Nansang<br>column: LLPHONE_PR<br>value: 0.194771","row: Nansang<br>column: MPHONE_PR<br>value: 0.398016","row: Nansang<br>column: COMPUTER_PR<br>value: 0.307034"],["row: Kyaukme<br>column: RADIO_PR<br>value: 0.409739","row: Kyaukme<br>column: TV_PR<br>value: 0.667785","row: Kyaukme<br>column: LLPHONE_PR<br>value: 0.205940","row: Kyaukme<br>column: MPHONE_PR<br>value: 0.480784","row: Kyaukme<br>column: COMPUTER_PR<br>value: 0.310457"],["row: Kalaw<br>column: RADIO_PR<br>value: 0.560359","row: Kalaw<br>column: TV_PR<br>value: 0.682160","row: Kalaw<br>column: LLPHONE_PR<br>value: 0.219829","row: Kalaw<br>column: MPHONE_PR<br>value: 0.532718","row: Kalaw<br>column: COMPUTER_PR<br>value: 0.295697"],["row: Hseni<br>column: RADIO_PR<br>value: 0.509784","row: Hseni<br>column: TV_PR<br>value: 0.705850","row: Hseni<br>column: LLPHONE_PR<br>value: 0.235278","row: Hseni<br>column: MPHONE_PR<br>value: 0.565729","row: Hseni<br>column: COMPUTER_PR<br>value: 0.184217"],["row: Langkho<br>column: RADIO_PR<br>value: 0.445368","row: Langkho<br>column: TV_PR<br>value: 0.648475","row: Langkho<br>column: LLPHONE_PR<br>value: 0.400725","row: Langkho<br>column: MPHONE_PR<br>value: 0.525730","row: Langkho<br>column: COMPUTER_PR<br>value: 0.325728"],["row: Kunhing<br>column: RADIO_PR<br>value: 0.303006","row: Kunhing<br>column: TV_PR<br>value: 0.491472","row: Kunhing<br>column: LLPHONE_PR<br>value: 0.393414","row: Kunhing<br>column: MPHONE_PR<br>value: 0.434989","row: Kunhing<br>column: COMPUTER_PR<br>value: 0.255391"],["row: Laihka<br>column: RADIO_PR<br>value: 0.285461","row: Laihka<br>column: TV_PR<br>value: 0.653168","row: Laihka<br>column: LLPHONE_PR<br>value: 0.351130","row: Laihka<br>column: MPHONE_PR<br>value: 0.321903","row: Laihka<br>column: COMPUTER_PR<br>value: 0.274684"],["row: Monghsat<br>column: RADIO_PR<br>value: 0.186896","row: Monghsat<br>column: TV_PR<br>value: 0.473622","row: Monghsat<br>column: LLPHONE_PR<br>value: 0.177547","row: Monghsat<br>column: MPHONE_PR<br>value: 0.219018","row: Monghsat<br>column: COMPUTER_PR<br>value: 0.219238"],["row: Loilen<br>column: RADIO_PR<br>value: 0.262949","row: Loilen<br>column: TV_PR<br>value: 0.600934","row: Loilen<br>column: LLPHONE_PR<br>value: 0.105589","row: Loilen<br>column: MPHONE_PR<br>value: 0.309845","row: Loilen<br>column: COMPUTER_PR<br>value: 0.322444"],["row: Mongnai<br>column: RADIO_PR<br>value: 0.348385","row: Mongnai<br>column: TV_PR<br>value: 0.550413","row: Mongnai<br>column: LLPHONE_PR<br>value: 0.013213","row: Mongnai<br>column: MPHONE_PR<br>value: 0.330601","row: Mongnai<br>column: COMPUTER_PR<br>value: 0.280505"],["row: Mongton<br>column: RADIO_PR<br>value: 0.372116","row: Mongton<br>column: TV_PR<br>value: 0.374969","row: Mongton<br>column: LLPHONE_PR<br>value: 0.125061","row: Mongton<br>column: MPHONE_PR<br>value: 0.363503","row: Mongton<br>column: COMPUTER_PR<br>value: 0.208287"],["row: Hsipaw<br>column: RADIO_PR<br>value: 0.382049","row: Hsipaw<br>column: TV_PR<br>value: 0.495293","row: Hsipaw<br>column: LLPHONE_PR<br>value: 0.165281","row: Hsipaw<br>column: MPHONE_PR<br>value: 0.332852","row: Hsipaw<br>column: COMPUTER_PR<br>value: 0.126911"],["row: Hopong<br>column: RADIO_PR<br>value: 0.398091","row: Hopong<br>column: TV_PR<br>value: 0.467734","row: Hopong<br>column: LLPHONE_PR<br>value: 0.165252","row: Hopong<br>column: MPHONE_PR<br>value: 0.248272","row: Hopong<br>column: COMPUTER_PR<br>value: 0.125663"],["row: Monghsu<br>column: RADIO_PR<br>value: 0.463675","row: Monghsu<br>column: TV_PR<br>value: 0.480273","row: Monghsu<br>column: LLPHONE_PR<br>value: 0.049518","row: Monghsu<br>column: MPHONE_PR<br>value: 0.278454","row: Monghsu<br>column: COMPUTER_PR<br>value: 0.102240"],["row: Pinlaung<br>column: RADIO_PR<br>value: 0.454391","row: Pinlaung<br>column: TV_PR<br>value: 0.585944","row: Pinlaung<br>column: LLPHONE_PR<br>value: 0.144173","row: Pinlaung<br>column: MPHONE_PR<br>value: 0.304818","row: Pinlaung<br>column: COMPUTER_PR<br>value: 0.117641"],["row: Mongmit<br>column: RADIO_PR<br>value: 0.572059","row: Mongmit<br>column: TV_PR<br>value: 0.603029","row: Mongmit<br>column: LLPHONE_PR<br>value: 0.182009","row: Mongmit<br>column: MPHONE_PR<br>value: 0.320846","row: Mongmit<br>column: COMPUTER_PR<br>value: 0.099653"],["row: Pekon<br>column: RADIO_PR<br>value: 0.642025","row: Pekon<br>column: TV_PR<br>value: 0.577864","row: Pekon<br>column: LLPHONE_PR<br>value: 0.207339","row: Pekon<br>column: MPHONE_PR<br>value: 0.255258","row: Pekon<br>column: COMPUTER_PR<br>value: 0.176074"],["row: Kutkai<br>column: RADIO_PR<br>value: 0.469637","row: Kutkai<br>column: TV_PR<br>value: 0.492753","row: Kutkai<br>column: LLPHONE_PR<br>value: 0.336404","row: Kutkai<br>column: MPHONE_PR<br>value: 0.326463","row: Kutkai<br>column: COMPUTER_PR<br>value: 0.199643"],["row: Namtu<br>column: RADIO_PR<br>value: 0.472438","row: Namtu<br>column: TV_PR<br>value: 0.708307","row: Namtu<br>column: LLPHONE_PR<br>value: 0.181529","row: Namtu<br>column: MPHONE_PR<br>value: 0.098196","row: Namtu<br>column: COMPUTER_PR<br>value: 0.186837"],["row: Hsihseng<br>column: RADIO_PR<br>value: 0.487022","row: Hsihseng<br>column: TV_PR<br>value: 0.536185","row: Hsihseng<br>column: LLPHONE_PR<br>value: 0.162369","row: Hsihseng<br>column: MPHONE_PR<br>value: 0.155475","row: Hsihseng<br>column: COMPUTER_PR<br>value: 0.074496"],["row: Kyethi<br>column: RADIO_PR<br>value: 0.534163","row: Kyethi<br>column: TV_PR<br>value: 0.455761","row: Kyethi<br>column: LLPHONE_PR<br>value: 0.109549","row: Kyethi<br>column: MPHONE_PR<br>value: 0.076156","row: Kyethi<br>column: COMPUTER_PR<br>value: 0.106926"],["row: Tangyan<br>column: RADIO_PR<br>value: 0.437590","row: Tangyan<br>column: TV_PR<br>value: 0.464204","row: Tangyan<br>column: LLPHONE_PR<br>value: 0.110875","row: Tangyan<br>column: MPHONE_PR<br>value: 0.098440","row: Tangyan<br>column: COMPUTER_PR<br>value: 0.098598"],["row: Namhsan<br>column: RADIO_PR<br>value: 0.452637","row: Namhsan<br>column: TV_PR<br>value: 0.377798","row: Namhsan<br>column: LLPHONE_PR<br>value: 0.113655","row: Namhsan<br>column: MPHONE_PR<br>value: 0.087770","row: Namhsan<br>column: COMPUTER_PR<br>value: 0.064069"],["row: Mongyai<br>column: RADIO_PR<br>value: 0.318012","row: Mongyai<br>column: TV_PR<br>value: 0.341693","row: Mongyai<br>column: LLPHONE_PR<br>value: 0.098223","row: Mongyai<br>column: MPHONE_PR<br>value: 0.141213","row: Mongyai<br>column: COMPUTER_PR<br>value: 0.068454"],["row: Mongping<br>column: RADIO_PR<br>value: 0.303906","row: Mongping<br>column: TV_PR<br>value: 0.295735","row: Mongping<br>column: LLPHONE_PR<br>value: 0.122161","row: Mongping<br>column: MPHONE_PR<br>value: 0.220797","row: Mongping<br>column: COMPUTER_PR<br>value: 0.093358"],["row: Mongkhet<br>column: RADIO_PR<br>value: 0.125839","row: Mongkhet<br>column: TV_PR<br>value: 0.271666","row: Mongkhet<br>column: LLPHONE_PR<br>value: 0.146913","row: Mongkhet<br>column: MPHONE_PR<br>value: 0.111904","row: Mongkhet<br>column: COMPUTER_PR<br>value: 0.040120"],["row: Mawkmai<br>column: RADIO_PR<br>value: 0.164818","row: Mawkmai<br>column: TV_PR<br>value: 0.163071","row: Mawkmai<br>column: LLPHONE_PR<br>value: 0.000000","row: Mawkmai<br>column: MPHONE_PR<br>value: 0.000000","row: Mawkmai<br>column: COMPUTER_PR<br>value: 0.050563"],["row: Mongkaing<br>column: RADIO_PR<br>value: 0.292778","row: Mongkaing<br>column: TV_PR<br>value: 0.000000","row: Mongkaing<br>column: LLPHONE_PR<br>value: 0.018021","row: Mongkaing<br>column: MPHONE_PR<br>value: 0.020515","row: Mongkaing<br>column: COMPUTER_PR<br>value: 0.057342"],["row: Manton<br>column: RADIO_PR<br>value: 0.373857","row: Manton<br>column: TV_PR<br>value: 0.099529","row: Manton<br>column: LLPHONE_PR<br>value: 0.029600","row: Manton<br>column: MPHONE_PR<br>value: 0.026290","row: Manton<br>column: COMPUTER_PR<br>value: 0.004112"],["row: Matman<br>column: RADIO_PR<br>value: 0.481304","row: Matman<br>column: TV_PR<br>value: 0.142298","row: Matman<br>column: LLPHONE_PR<br>value: 0.031665","row: Matman<br>column: MPHONE_PR<br>value: 0.012573","row: Matman<br>column: COMPUTER_PR<br>value: 0.030854"],["row: Ywangan<br>column: RADIO_PR<br>value: 1.000000","row: Ywangan<br>column: TV_PR<br>value: 0.198958","row: Ywangan<br>column: LLPHONE_PR<br>value: 0.051234","row: Ywangan<br>column: MPHONE_PR<br>value: 0.119978","row: Ywangan<br>column: COMPUTER_PR<br>value: 0.012755"],["row: Pindaya<br>column: RADIO_PR<br>value: 0.855315","row: Pindaya<br>column: TV_PR<br>value: 0.535580","row: Pindaya<br>column: LLPHONE_PR<br>value: 0.095440","row: Pindaya<br>column: MPHONE_PR<br>value: 0.180215","row: Pindaya<br>column: COMPUTER_PR<br>value: 0.107760"],["row: Lawksawk<br>column: RADIO_PR<br>value: 0.789802","row: Lawksawk<br>column: TV_PR<br>value: 0.707464","row: Lawksawk<br>column: LLPHONE_PR<br>value: 0.160787","row: Lawksawk<br>column: MPHONE_PR<br>value: 0.406502","row: Lawksawk<br>column: COMPUTER_PR<br>value: 0.207451"],["row: Nyaungshwe<br>column: RADIO_PR<br>value: 0.653022","row: Nyaungshwe<br>column: TV_PR<br>value: 0.603518","row: Nyaungshwe<br>column: LLPHONE_PR<br>value: 0.090757","row: Nyaungshwe<br>column: MPHONE_PR<br>value: 0.450321","row: Nyaungshwe<br>column: COMPUTER_PR<br>value: 0.139287"],["row: Nawnghkio<br>column: RADIO_PR<br>value: 0.708317","row: Nawnghkio<br>column: TV_PR<br>value: 0.594514","row: Nawnghkio<br>column: LLPHONE_PR<br>value: 0.199599","row: Nawnghkio<br>column: MPHONE_PR<br>value: 0.410009","row: Nawnghkio<br>column: COMPUTER_PR<br>value: 0.140105"],["row: Monghpyak<br>column: RADIO_PR<br>value: 0.828482","row: Monghpyak<br>column: TV_PR<br>value: 0.533096","row: Monghpyak<br>column: LLPHONE_PR<br>value: 0.222253","row: Monghpyak<br>column: MPHONE_PR<br>value: 0.494146","row: Monghpyak<br>column: COMPUTER_PR<br>value: 0.245321"],["row: Mabein<br>column: RADIO_PR<br>value: 0.924415","row: Mabein<br>column: TV_PR<br>value: 0.815707","row: Mabein<br>column: LLPHONE_PR<br>value: 0.391551","row: Mabein<br>column: MPHONE_PR<br>value: 0.509562","row: Mabein<br>column: COMPUTER_PR<br>value: 0.147800"],["row: Mongyawng<br>column: RADIO_PR<br>value: 0.554582","row: Mongyawng<br>column: TV_PR<br>value: 0.857899","row: Mongyawng<br>column: LLPHONE_PR<br>value: 0.667008","row: Mongyawng<br>column: MPHONE_PR<br>value: 0.411502","row: Mongyawng<br>column: COMPUTER_PR<br>value: 0.135187"],["row: Kunlong<br>column: RADIO_PR<br>value: 0.217634","row: Kunlong<br>column: TV_PR<br>value: 0.652098","row: Kunlong<br>column: LLPHONE_PR<br>value: 1.000000","row: Kunlong<br>column: MPHONE_PR<br>value: 0.287788","row: Kunlong<br>column: COMPUTER_PR<br>value: 0.196438"],["row: Konkyan<br>column: RADIO_PR<br>value: 0.000000","row: Konkyan<br>column: TV_PR<br>value: 0.235436","row: Konkyan<br>column: LLPHONE_PR<br>value: 0.932101","row: Konkyan<br>column: MPHONE_PR<br>value: 0.401016","row: Konkyan<br>column: COMPUTER_PR<br>value: 0.084422"],["row: Mongyang<br>column: RADIO_PR<br>value: 0.109375","row: Mongyang<br>column: TV_PR<br>value: 0.623942","row: Mongyang<br>column: LLPHONE_PR<br>value: 0.622051","row: Mongyang<br>column: MPHONE_PR<br>value: 0.618873","row: Mongyang<br>column: COMPUTER_PR<br>value: 0.107370"],["row: Mongmao<br>column: RADIO_PR<br>value: 0.213614","row: Mongmao<br>column: TV_PR<br>value: 0.545980","row: Mongmao<br>column: LLPHONE_PR<br>value: 0.462858","row: Mongmao<br>column: MPHONE_PR<br>value: 0.555883","row: Mongmao<br>column: COMPUTER_PR<br>value: 0.089980"],["row: Hopang<br>column: RADIO_PR<br>value: 0.229897","row: Hopang<br>column: TV_PR<br>value: 0.606803","row: Hopang<br>column: LLPHONE_PR<br>value: 0.441880","row: Hopang<br>column: MPHONE_PR<br>value: 0.645581","row: Hopang<br>column: COMPUTER_PR<br>value: 0.238388"],["row: Namhkan<br>column: RADIO_PR<br>value: 0.245825","row: Namhkan<br>column: TV_PR<br>value: 0.739869","row: Namhkan<br>column: LLPHONE_PR<br>value: 0.498116","row: Namhkan<br>column: MPHONE_PR<br>value: 0.801231","row: Namhkan<br>column: COMPUTER_PR<br>value: 0.301659"],["row: Laukkaing<br>column: RADIO_PR<br>value: 0.069497","row: Laukkaing<br>column: TV_PR<br>value: 0.911879","row: Laukkaing<br>column: LLPHONE_PR<br>value: 0.736264","row: Laukkaing<br>column: MPHONE_PR<br>value: 0.973268","row: Laukkaing<br>column: COMPUTER_PR<br>value: 0.362173"],["row: Mongla<br>column: RADIO_PR<br>value: 0.131890","row: Mongla<br>column: TV_PR<br>value: 0.766915","row: Mongla<br>column: LLPHONE_PR<br>value: 0.471174","row: Mongla<br>column: MPHONE_PR<br>value: 0.742031","row: Mongla<br>column: COMPUTER_PR<br>value: 0.665568"],["row: Pangsang<br>column: RADIO_PR<br>value: 0.164830","row: Pangsang<br>column: TV_PR<br>value: 0.515217","row: Pangsang<br>column: LLPHONE_PR<br>value: 0.334570","row: Pangsang<br>column: MPHONE_PR<br>value: 0.578557","row: Pangsang<br>column: COMPUTER_PR<br>value: 0.529033"],["row: Kengtung<br>column: RADIO_PR<br>value: 0.531764","row: Kengtung<br>column: TV_PR<br>value: 0.718178","row: Kengtung<br>column: LLPHONE_PR<br>value: 0.338119","row: Kengtung<br>column: MPHONE_PR<br>value: 0.645069","row: Kengtung<br>column: COMPUTER_PR<br>value: 0.496660"],["row: Lashio<br>column: RADIO_PR<br>value: 0.463214","row: Lashio<br>column: TV_PR<br>value: 0.777368","row: Lashio<br>column: LLPHONE_PR<br>value: 0.357599","row: Lashio<br>column: MPHONE_PR<br>value: 0.611463","row: Lashio<br>column: COMPUTER_PR<br>value: 0.638873"],["row: Taunggyi<br>column: RADIO_PR<br>value: 0.742781","row: Taunggyi<br>column: TV_PR<br>value: 0.879882","row: Taunggyi<br>column: LLPHONE_PR<br>value: 0.440756","row: Taunggyi<br>column: MPHONE_PR<br>value: 0.787179","row: Taunggyi<br>column: COMPUTER_PR<br>value: 0.873979"],["row: Tachileik<br>column: RADIO_PR<br>value: 0.738562","row: Tachileik<br>column: TV_PR<br>value: 0.885602","row: Tachileik<br>column: LLPHONE_PR<br>value: 0.318802","row: Tachileik<br>column: MPHONE_PR<br>value: 1.000000","row: Tachileik<br>column: COMPUTER_PR<br>value: 1.000000"],["row: Muse<br>column: RADIO_PR<br>value: 0.334059","row: Muse<br>column: TV_PR<br>value: 1.000000","row: Muse<br>column: LLPHONE_PR<br>value: 0.765345","row: Muse<br>column: MPHONE_PR<br>value: 0.967809","row: Muse<br>column: COMPUTER_PR<br>value: 0.987566"]],"colorscale":[[0,"#F7FBFF"],[0.0041124401409408104,"#F6FAFE"],[0.012573063998461675,"#F4F9FE"],[0.012754780873524385,"#F4F9FE"],[0.013213311777657203,"#F4F9FE"],[0.018020667308862738,"#F3F8FD"],[0.020514689816836292,"#F3F8FD"],[0.026290069687093635,"#F1F7FD"],[0.029599900644770458,"#F0F6FC"],[0.030692309450180387,"#F0F6FC"],[0.030854020566575952,"#F0F6FC"],[0.031665051478322832,"#F0F6FC"],[0.040120375229698704,"#EFF5FC"],[0.049517603601854712,"#ECF4FB"],[0.050562923174397992,"#ECF4FB"],[0.051234029774627307,"#ECF4FB"],[0.057341960293267422,"#EBF3FB"],[0.064068575228978811,"#EAF2FA"],[0.06845357030346759,"#E9F2FA"],[0.069496745754494604,"#E8F1FA"],[0.074496310341376853,"#E8F1FA"],[0.076155538926932026,"#E8F1FA"],[0.084421792656946576,"#E5EFF9"],[0.087769700588719038,"#E5EFF9"],[0.089979971244948997,"#E4EFF9"],[0.090757204809061548,"#E4EFF9"],[0.093357637355966402,"#E4EEF8"],[0.09544043782343907,"#E4EEF8"],[0.098196451325406497,"#E3EEF8"],[0.098223180852338707,"#E3EEF8"],[0.098440375857401646,"#E3EEF8"],[0.098597886950666486,"#E3EEF8"],[0.099529007645666634,"#E3EEF8"],[0.099653220995087818,"#E3EEF8"],[0.10224025627189308,"#E2EDF8"],[0.1052156876000811,"#E1EDF8"],[0.10558868166123289,"#E1EDF8"],[0.1069257718509344,"#E1EDF8"],[0.10736975492138892,"#E1EDF8"],[0.10775997132544597,"#E1EDF8"],[0.10937492963625835,"#E1ECF7"],[0.10954853696695575,"#E1ECF7"],[0.11087478745786904,"#E1ECF7"],[0.11190443691659302,"#E0ECF7"],[0.11365549681498793,"#E0ECF7"],[0.11697828280235656,"#DFEBF7"],[0.11764114434607098,"#DFEBF7"],[0.1190714713575737,"#DFEBF7"],[0.1199784726998025,"#DEEBF7"],[0.12216142202890717,"#DEEBF7"],[0.12506080462855637,"#DDEAF6"],[0.12566331521633783,"#DDEAF6"],[0.12583937793228897,"#DDEAF6"],[0.12691106039033156,"#DDEAF6"],[0.12946800291670138,"#DDEAF6"],[0.13189010662422906,"#DCE9F6"],[0.13518667681882071,"#DCE9F6"],[0.13928686759144926,"#DAE8F5"],[0.14010534490572477,"#DAE8F5"],[0.14121340016110578,"#DAE8F5"],[0.14229750653679712,"#DAE8F5"],[0.14417252910969927,"#DAE8F5"],[0.14668071862261853,"#DAE8F5"],[0.14691293402953898,"#DAE8F5"],[0.14779989677341523,"#D9E7F5"],[0.15547460469197441,"#D7E6F4"],[0.16078708461582927,"#D7E6F4"],[0.16236928492310002,"#D7E6F4"],[0.16307059912065375,"#D6E5F4"],[0.16481813869170037,"#D6E5F4"],[0.1648296584979817,"#D6E5F4"],[0.1652519260833811,"#D6E5F4"],[0.16528121425607512,"#D6E5F4"],[0.17607405769543419,"#D4E4F3"],[0.17754710976751639,"#D4E4F3"],[0.18021510896887391,"#D3E3F3"],[0.18152892689938518,"#D3E3F3"],[0.18200927177224013,"#D3E3F3"],[0.18421714232785746,"#D2E3F3"],[0.18683697450666378,"#D1E2F2"],[0.18689649559375604,"#D1E2F2"],[0.19477119473094034,"#D0E1F2"],[0.196437751553831,"#D0E1F2"],[0.1989581694259637,"#CFE1F2"],[0.19959920412341628,"#CFE1F2"],[0.19964300270472204,"#CFE1F2"],[0.20593962805229063,"#CEE0F1"],[0.20733874544122771,"#CEE0F1"],[0.2074510389282212,"#CEE0F1"],[0.20828663725058605,"#CEE0F1"],[0.2136137052884651,"#CDDFF1"],[0.21763398035874212,"#CCDFF1"],[0.21901799211937109,"#CBDEF0"],[0.21923803903390368,"#CBDEF0"],[0.21982898000630299,"#CBDEF0"],[0.22051676674466952,"#CBDEF0"],[0.22079722888776726,"#CBDEF0"],[0.22225304485480443,"#CBDEF0"],[0.22989746208303394,"#C9DDF0"],[0.23527761552998844,"#C8DCEF"],[0.23543567048956018,"#C8DCEF"],[0.23838778070406408,"#C8DCEF"],[0.24532142669874674,"#C6DBEF"],[0.24582481175676543,"#C6DBEF"],[0.24827221676312536,"#C6DBEF"],[0.2552581189664615,"#C4DAEE"],[0.25539117902522024,"#C4DAEE"],[0.2629488857600436,"#C1D9ED"],[0.27166586954277666,"#BFD8EC"],[0.2746837227301171,"#BED7EC"],[0.27845401411719362,"#BCD7EB"],[0.28050502634682223,"#BBD6EB"],[0.28546056562312344,"#BAD6EA"],[0.28778828469233325,"#BAD6EA"],[0.29277803105512323,"#B8D4EA"],[0.29569694938338709,"#B7D4EA"],[0.29573466001141141,"#B7D4EA"],[0.30165891030396319,"#B5D3E9"],[0.3030063240466021,"#B5D3E9"],[0.30390562646118419,"#B5D3E9"],[0.30481757278969496,"#B4D3E8"],[0.30703392330347096,"#B3D3E8"],[0.30984472139571101,"#B2D2E8"],[0.31045720041004654,"#B2D2E8"],[0.31801152018301904,"#B0D1E7"],[0.31880165558342555,"#B0D1E7"],[0.32084610041574091,"#AFD1E6"],[0.32190336940009312,"#AFD1E6"],[0.32244406175045992,"#AFD1E6"],[0.32572766162209832,"#ADD0E6"],[0.32646328563512589,"#ADD0E6"],[0.33060051526022327,"#ACD0E6"],[0.33285202942113168,"#ABCFE5"],[0.33405948053815493,"#ABCFE5"],[0.33457025472725271,"#ABCFE5"],[0.33640390671869069,"#AACFE5"],[0.33811911213704343,"#AACFE5"],[0.34169331569611694,"#A8CEE4"],[0.34509307535574651,"#A7CEE4"],[0.34838456904687853,"#A6CDE3"],[0.3511299776298073,"#A5CDE3"],[0.35759948327266128,"#A3CCE3"],[0.36217260806198814,"#A2CBE2"],[0.36350286192371334,"#A1CBE2"],[0.37211615170496543,"#9ECAE1"],[0.37385748377862454,"#9ECAE1"],[0.37496862114224927,"#9DC9E0"],[0.37779761401029394,"#9CC9E0"],[0.38204908464317522,"#9BC8E0"],[0.3846139992017637,"#9AC7E0"],[0.3915514072900575,"#97C6DF"],[0.39341363429136933,"#96C6DF"],[0.39472652438726058,"#96C5DF"],[0.39801608135750721,"#94C5DF"],[0.3980907579303854,"#94C4DE"],[0.40072537449675555,"#93C4DE"],[0.40101556902451285,"#93C4DE"],[0.40650165146089307,"#91C2DE"],[0.40973860994388689,"#90C2DE"],[0.41000871240744069,"#8FC1DD"],[0.41150185475720735,"#8FC1DD"],[0.4349886836765729,"#85BCDB"],[0.4375902968230686,"#84BBDB"],[0.44075599890374501,"#83BBDB"],[0.44188018109426458,"#82BADB"],[0.44536782610845499,"#81B9DA"],[0.44811294912657407,"#80B9DA"],[0.45032057879694443,"#7FB8DA"],[0.45263667579662742,"#7EB8DA"],[0.45439139601376666,"#7DB8D9"],[0.45576055674496135,"#7DB8D9"],[0.46285806565679205,"#7AB6D9"],[0.46321400984145472,"#7AB6D9"],[0.46367507181173734,"#7AB6D9"],[0.46420446143708177,"#79B6D9"],[0.46773404772860855,"#78B5D8"],[0.46963701986480177,"#77B4D8"],[0.47117405530992845,"#77B4D8"],[0.47243757577103745,"#76B4D8"],[0.47362168694479923,"#75B3D8"],[0.48027348971210532,"#73B2D7"],[0.48078425480385872,"#72B1D7"],[0.48130384213362665,"#72B1D7"],[0.484807392774743,"#71B1D7"],[0.48702182505931935,"#70B1D7"],[0.49147219082742083,"#6EB0D6"],[0.49275331606035999,"#6EAFD6"],[0.49414581896158,"#6DAFD6"],[0.49529324375134881,"#6CAFD6"],[0.4966599235186423,"#6CAED6"],[0.49811595358599009,"#6BAED6"],[0.50956182689641516,"#67ABD4"],[0.50978351840105796,"#67ABD4"],[0.51521670119868102,"#66AAD4"],[0.52572958435168682,"#62A8D2"],[0.52903303494584919,"#61A7D2"],[0.53176358126123546,"#60A6D1"],[0.53271772917722882,"#60A6D1"],[0.53309615033103497,"#60A6D1"],[0.53416314399345055,"#60A6D1"],[0.53558029529267859,"#5FA5D1"],[0.53618454590948417,"#5FA5D1"],[0.54598018129684645,"#5CA3D0"],[0.55041330721869519,"#5AA3CF"],[0.55225992411450087,"#59A2CF"],[0.55458208226657446,"#59A2CF"],[0.5558831363146618,"#58A1CE"],[0.56035905060769442,"#57A0CE"],[0.56572881621915971,"#559FCD"],[0.57205942216261241,"#539DCC"],[0.57412901426752883,"#529DCC"],[0.57786439014823909,"#519CCC"],[0.57855734181793805,"#509BCB"],[0.58594353490077888,"#4F9BCB"],[0.59451431070864047,"#4B98C9"],[0.60093442055127599,"#4A97C9"],[0.60302857970223533,"#4896C8"],[0.60351827743629838,"#4896C8"],[0.60680342034724111,"#4795C8"],[0.61146312565581429,"#4694C7"],[0.6188729942182486,"#4393C6"],[0.62205063209383749,"#4292C6"],[0.6239421797955409,"#4292C6"],[0.63887304429100655,"#3E8EC4"],[0.64202483918062014,"#3D8DC3"],[0.64506885812542736,"#3D8DC3"],[0.64558140267074615,"#3C8CC3"],[0.64647733866993595,"#3C8CC3"],[0.64847518658958281,"#3C8CC3"],[0.6520984304010603,"#3B8BC2"],[0.65302227298916715,"#3A8AC1"],[0.65316773418946472,"#3A8AC1"],[0.66556801662669463,"#3787C0"],[0.66700796483691616,"#3787C0"],[0.66778546258182536,"#3686C0"],[0.6821600532019152,"#3282BE"],[0.6891560112923748,"#3080BD"],[0.70584966248141379,"#2C7CBB"],[0.70746355636330893,"#2C7CBB"],[0.70830658131680169,"#2B7BBA"],[0.70831666585604425,"#2B7BBA"],[0.71817785309851512,"#2979B9"],[0.73626364575085557,"#2474B6"],[0.73856184642802991,"#2474B6"],[0.73986922857984394,"#2373B6"],[0.74203095277732456,"#2373B6"],[0.74278145022617081,"#2373B6"],[0.76534529857384681,"#1E6DB2"],[0.76691504545610356,"#1D6CB1"],[0.77736794201940884,"#1B6AAF"],[0.78717895265256588,"#1967AD"],[0.78980219430668397,"#1967AD"],[0.8012306000003262,"#1664AB"],[0.81570663014131484,"#1360A7"],[0.82848163458094803,"#115DA5"],[0.85531477807188261,"#0C56A0"],[0.85789929032177492,"#0B559F"],[0.87397863437784384,"#08519C"],[0.87988241582281568,"#08509A"],[0.88560203867754661,"#084E97"],[0.91187904567993305,"#08468D"],[0.92441487443451953,"#084388"],[0.93210135445804221,"#084185"],[0.96780866955997524,"#083877"],[0.97326830696953925,"#083775"],[0.98756611073781375,"#08336F"],[1,"#08306B"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"f6800aefb6971c64525ddbccc2f60b48","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#F7FBFF"],[0.0033444816053511705,"#F6FAFE"],[0.006688963210702341,"#F5F9FE"],[0.010033444816053512,"#F4F9FE"],[0.013377926421404682,"#F4F9FE"],[0.016722408026755852,"#F3F8FD"],[0.020066889632107024,"#F3F8FD"],[0.023411371237458192,"#F2F7FD"],[0.026755852842809364,"#F1F7FD"],[0.030100334448160536,"#F0F6FC"],[0.033444816053511704,"#EFF6FC"],[0.036789297658862873,"#EFF6FC"],[0.040133779264214048,"#EFF5FC"],[0.043478260869565216,"#EEF5FC"],[0.046822742474916385,"#EDF4FB"],[0.05016722408026756,"#ECF4FB"],[0.053511705685618728,"#ECF3FB"],[0.056856187290969896,"#ECF3FB"],[0.060200668896321072,"#EBF3FB"],[0.06354515050167224,"#EAF2FA"],[0.066889632107023408,"#E9F2FA"],[0.070234113712374577,"#E8F1FA"],[0.073578595317725745,"#E8F1FA"],[0.076923076923076927,"#E7F0F9"],[0.080267558528428096,"#E7F0F9"],[0.083612040133779264,"#E6F0F9"],[0.086956521739130432,"#E5EFF9"],[0.090301003344481601,"#E4EFF9"],[0.093645484949832769,"#E4EEF8"],[0.096989966555183951,"#E3EEF8"],[0.10033444816053512,"#E2EDF8"],[0.10367892976588629,"#E2EDF8"],[0.10702341137123746,"#E1EDF8"],[0.11036789297658862,"#E1ECF7"],[0.11371237458193979,"#E0ECF7"],[0.11705685618729096,"#DFEBF7"],[0.12040133779264214,"#DEEBF7"],[0.12374581939799331,"#DDEAF6"],[0.12709030100334448,"#DDEAF6"],[0.13043478260869565,"#DDEAF6"],[0.13377926421404682,"#DCE9F6"],[0.13712374581939799,"#DBE9F6"],[0.14046822742474915,"#DAE8F5"],[0.14381270903010032,"#DAE8F5"],[0.14715719063545149,"#D9E7F5"],[0.15050167224080269,"#D9E7F5"],[0.15384615384615385,"#D8E7F5"],[0.15719063545150502,"#D7E6F4"],[0.16053511705685619,"#D7E6F4"],[0.16387959866220736,"#D6E5F4"],[0.16722408026755853,"#D5E5F4"],[0.1705685618729097,"#D5E5F4"],[0.17391304347826086,"#D4E4F3"],[0.17725752508361203,"#D4E4F3"],[0.1806020066889632,"#D3E3F3"],[0.18394648829431437,"#D2E3F3"],[0.18729096989966554,"#D1E2F2"],[0.19063545150501671,"#D1E2F2"],[0.1939799331103679,"#D1E2F2"],[0.19732441471571907,"#D0E1F2"],[0.20066889632107024,"#CFE1F2"],[0.20401337792642141,"#CEE0F1"],[0.20735785953177258,"#CEE0F1"],[0.21070234113712374,"#CDDFF1"],[0.21404682274247491,"#CCDFF1"],[0.21739130434782608,"#CCDFF1"],[0.22073578595317725,"#CBDEF0"],[0.22408026755852842,"#CBDEF0"],[0.22742474916387959,"#CADDF0"],[0.23076923076923075,"#C9DDF0"],[0.23411371237458192,"#C8DCEF"],[0.23745819397993312,"#C8DCEF"],[0.24080267558528429,"#C8DCEF"],[0.24414715719063546,"#C7DBEF"],[0.24749163879598662,"#C6DBEF"],[0.25083612040133779,"#C5DAEE"],[0.25418060200668896,"#C4DAEE"],[0.25752508361204013,"#C3D9EE"],[0.2608695652173913,"#C2D9ED"],[0.26421404682274247,"#C1D9ED"],[0.26755852842809363,"#C0D8ED"],[0.2709030100334448,"#BFD8EC"],[0.27424749163879597,"#BED7EC"],[0.27759197324414714,"#BCD7EB"],[0.28093645484949831,"#BBD6EB"],[0.28428093645484948,"#BBD6EB"],[0.28762541806020064,"#BAD6EA"],[0.29096989966555181,"#B9D5EA"],[0.29431438127090298,"#B7D4EA"],[0.29765886287625415,"#B6D4E9"],[0.30100334448160537,"#B5D3E9"],[0.30434782608695654,"#B4D3E8"],[0.30769230769230771,"#B3D3E8"],[0.31103678929765888,"#B2D2E8"],[0.31438127090301005,"#B1D2E7"],[0.31772575250836121,"#B0D1E7"],[0.32107023411371238,"#AFD1E6"],[0.32441471571906355,"#AED0E6"],[0.32775919732441472,"#ACD0E6"],[0.33110367892976589,"#ACD0E6"],[0.33444816053511706,"#ABCFE5"],[0.33779264214046822,"#AACFE5"],[0.34113712374581939,"#A8CEE4"],[0.34448160535117056,"#A7CEE4"],[0.34782608695652173,"#A6CDE3"],[0.3511705685618729,"#A5CDE3"],[0.35451505016722407,"#A4CDE3"],[0.35785953177257523,"#A3CCE3"],[0.3612040133779264,"#A2CBE2"],[0.36454849498327757,"#A1CBE2"],[0.36789297658862874,"#A0CAE1"],[0.37123745819397991,"#9FCAE1"],[0.37458193979933108,"#9DC9E0"],[0.37792642140468224,"#9CC9E0"],[0.38127090301003341,"#9BC8E0"],[0.38461538461538458,"#9AC7E0"],[0.38795986622073581,"#98C7DF"],[0.39130434782608697,"#97C6DF"],[0.39464882943143814,"#96C5DF"],[0.39799331103678931,"#94C5DF"],[0.40133779264214048,"#93C4DE"],[0.40468227424749165,"#92C3DE"],[0.40802675585284282,"#90C2DE"],[0.41137123745819398,"#8FC1DD"],[0.41471571906354515,"#8DC0DD"],[0.41806020066889632,"#8CC0DD"],[0.42140468227424749,"#8BC0DD"],[0.42474916387959866,"#89BFDC"],[0.42809364548494983,"#88BEDC"],[0.43143812709030099,"#87BDDC"],[0.43478260869565216,"#85BCDB"],[0.43812709030100333,"#84BBDB"],[0.4414715719063545,"#82BADB"],[0.44481605351170567,"#81BADB"],[0.44816053511705684,"#80B9DA"],[0.451505016722408,"#7FB8DA"],[0.45484949832775917,"#7DB8D9"],[0.45819397993311034,"#7BB7D9"],[0.46153846153846151,"#7AB6D9"],[0.46488294314381268,"#79B5D8"],[0.46822742474916385,"#78B5D8"],[0.47157190635451507,"#77B4D8"],[0.47491638795986624,"#75B3D8"],[0.47826086956521741,"#73B2D7"],[0.48160535117056857,"#72B1D7"],[0.48494983277591974,"#71B1D7"],[0.48829431438127091,"#6FB0D6"],[0.49163879598662208,"#6EB0D6"],[0.49498327759197325,"#6DAFD6"],[0.49832775919732442,"#6BAED6"],[0.50167224080267558,"#6AADD5"],[0.50501672240802675,"#69ACD5"],[0.50836120401337792,"#68ABD4"],[0.51170568561872909,"#67ABD4"],[0.51505016722408026,"#66AAD4"],[0.51839464882943143,"#65AAD3"],[0.52173913043478259,"#63A9D3"],[0.52508361204013376,"#62A8D2"],[0.52842809364548493,"#61A7D2"],[0.5317725752508361,"#60A6D1"],[0.53511705685618727,"#5FA6D1"],[0.53846153846153844,"#5EA5D1"],[0.5418060200668896,"#5DA4D0"],[0.54515050167224077,"#5CA3D0"],[0.54849498327759194,"#5AA3CF"],[0.55183946488294311,"#59A2CF"],[0.55518394648829428,"#58A1CE"],[0.55852842809364545,"#58A1CE"],[0.56187290969899661,"#56A0CE"],[0.56521739130434778,"#559FCD"],[0.56856187290969895,"#549ECD"],[0.57190635451505012,"#539DCC"],[0.57525083612040129,"#529CCC"],[0.57859531772575246,"#509BCB"],[0.58193979933110362,"#509BCB"],[0.58528428093645479,"#4F9BCB"],[0.58862876254180596,"#4E9ACA"],[0.59197324414715713,"#4C99CA"],[0.5953177257525083,"#4B98C9"],[0.59866220735785947,"#4A97C9"],[0.60200668896321075,"#4996C8"],[0.60535117056856191,"#4896C8"],[0.60869565217391308,"#4795C8"],[0.61204013377926425,"#4694C7"],[0.61538461538461542,"#4594C7"],[0.61872909698996659,"#4393C6"],[0.62207357859531776,"#4292C6"],[0.62541806020066892,"#4292C6"],[0.62876254180602009,"#4191C5"],[0.63210702341137126,"#4090C5"],[0.63545150501672243,"#3F8FC4"],[0.6387959866220736,"#3E8EC4"],[0.64214046822742477,"#3D8DC3"],[0.64548494983277593,"#3C8CC3"],[0.6488294314381271,"#3C8CC3"],[0.65217391304347827,"#3B8BC2"],[0.65551839464882944,"#3A8AC1"],[0.65886287625418061,"#3989C1"],[0.66220735785953178,"#3888C0"],[0.66555183946488294,"#3787C0"],[0.66889632107023411,"#3686BF"],[0.67224080267558528,"#3585BF"],[0.67558528428093645,"#3484BF"],[0.67892976588628762,"#3383BE"],[0.68227424749163879,"#3282BE"],[0.68561872909698995,"#3181BD"],[0.68896321070234112,"#3080BD"],[0.69230769230769229,"#2F7FBC"],[0.69565217391304346,"#2F7FBC"],[0.69899665551839463,"#2E7EBC"],[0.7023411371237458,"#2D7DBB"],[0.70568561872909696,"#2C7CBB"],[0.70903010033444813,"#2B7BBA"],[0.7123745819397993,"#2A7AB9"],[0.71571906354515047,"#2979B9"],[0.71906354515050164,"#2979B9"],[0.72240802675585281,"#2878B8"],[0.72575250836120397,"#2777B8"],[0.72909698996655514,"#2676B7"],[0.73244147157190631,"#2575B7"],[0.73578595317725748,"#2474B6"],[0.73913043478260865,"#2474B6"],[0.74247491638795982,"#2373B6"],[0.74581939799331098,"#2272B5"],[0.74916387959866215,"#2171B5"],[0.75250836120401332,"#2070B4"],[0.75585284280936449,"#1F6FB3"],[0.75919732441471566,"#1E6EB2"],[0.76254180602006683,"#1E6EB2"],[0.76588628762541799,"#1E6DB2"],[0.76923076923076916,"#1D6CB1"],[0.77257525083612044,"#1C6BB0"],[0.77591973244147161,"#1B6AAF"],[0.77926421404682278,"#1A69AE"],[0.78260869565217395,"#1A68AE"],[0.78595317725752512,"#1A68AE"],[0.78929765886287628,"#1967AD"],[0.79264214046822745,"#1866AC"],[0.79598662207357862,"#1765AB"],[0.79933110367892979,"#1664AB"],[0.80267558528428096,"#1663AA"],[0.80602006688963213,"#1562A9"],[0.80936454849498329,"#1562A9"],[0.81270903010033446,"#1461A8"],[0.81605351170568563,"#1360A7"],[0.8193979933110368,"#135FA7"],[0.82274247491638797,"#125EA6"],[0.82608695652173914,"#115DA5"],[0.8294314381270903,"#105CA4"],[0.83277591973244147,"#105CA4"],[0.83612040133779264,"#0F5BA3"],[0.83946488294314381,"#0F5AA3"],[0.84280936454849498,"#0E59A2"],[0.84615384615384615,"#0D58A1"],[0.84949832775919731,"#0C57A0"],[0.85284280936454848,"#0C57A0"],[0.85618729096989965,"#0C56A0"],[0.85953177257525082,"#0B559F"],[0.86287625418060199,"#0A549E"],[0.86622073578595316,"#09539D"],[0.86956521739130432,"#08529C"],[0.87290969899665549,"#08519C"],[0.87625418060200666,"#08519B"],[0.87959866220735783,"#08509A"],[0.882943143812709,"#084F99"],[0.88628762541806017,"#084E97"],[0.88963210702341133,"#084C96"],[0.8929765886287625,"#084B95"],[0.89632107023411367,"#084A93"],[0.89966555183946484,"#084A92"],[0.90301003344481601,"#084990"],[0.90635451505016718,"#08488F"],[0.90969899665551834,"#08478E"],[0.91304347826086951,"#08468C"],[0.91638795986622068,"#08458B"],[0.91973244147157185,"#08448A"],[0.92307692307692302,"#084489"],[0.92642140468227419,"#084388"],[0.92976588628762535,"#084286"],[0.93311036789297652,"#084185"],[0.93645484949832769,"#084083"],[0.93979933110367886,"#083F82"],[0.94314381270903014,"#083E81"],[0.94648829431438131,"#083E7F"],[0.94983277591973247,"#083D7E"],[0.95317725752508364,"#083C7D"],[0.95652173913043481,"#083B7B"],[0.95986622073578598,"#083A7A"],[0.96321070234113715,"#083979"],[0.96655518394648832,"#083978"],[0.96989966555183948,"#083876"],[0.97324414715719065,"#083775"],[0.97658862876254182,"#083674"],[0.97993311036789299,"#083572"],[0.98327759197324416,"#083471"],[0.98662207357859533,"#083370"],[0.98996655518394649,"#08336F"],[0.99331103678929766,"#08326D"],[0.99665551839464883,"#08316C"],[1,"#08306B"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0.0016666666666666668,0.2508333333333333,0.49999999999999994,0.74916666666666665,0.99833333333333329],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.0908778897590075,1.0908778897590075,null,1.0908778897590075,0.50094972196331133,null,0.50094972196331133,0.50094972196331133,null,0.50094972196331133,0,null,0.50094972196331133,0.50094972196331133,null,0.50094972196331133,0],"y":[45.609375,42.5,null,42.5,42.5,null,42.5,42,null,42,42,null,42.5,43,null,43,43],"text":["y: 1.09087789","y: 1.09087789",null,"y: 1.09087789","y: 1.09087789",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972"],"type":"scatter","mode":"lines","line":{"width":13.228346456692915,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.0908778897590075,1.0908778897590075,null,1.0908778897590075,0.73180022212606366,null,0.73180022212606366,0.73180022212606366,null,0.73180022212606366,0.69115953326908086,null,0.69115953326908086,0.69115953326908086,null,0.69115953326908086,0.3806270981887479,null,0.3806270981887479,0.3806270981887479,null,0.3806270981887479,0.25526431689183554,null,0.25526431689183554,0.25526431689183554,null,0.25526431689183554,0,null,0.25526431689183554,0.25526431689183554,null,0.25526431689183554,0.185675404080306,null,0.185675404080306,0.185675404080306,null,0.185675404080306,0,null,0.185675404080306,0.185675404080306,null,0.185675404080306,0,null,0.3806270981887479,0.3806270981887479,null,0.3806270981887479,0,null,0.69115953326908086,0.69115953326908086,null,0.69115953326908086,0,null,0.73180022212606366,0.73180022212606366,null,0.73180022212606366,0.46680758268969319,null,0.46680758268969319,0.46680758268969319,null,0.46680758268969319,0.35841748229668252,null,0.35841748229668252,0.35841748229668252,null,0.35841748229668252,0,null,0.35841748229668252,0.35841748229668252,null,0.35841748229668252,0,null,0.46680758268969319,0.46680758268969319,null,0.46680758268969319,0.17301997631058272,null,0.17301997631058272,0.17301997631058272,null,0.17301997631058272,0,null,0.17301997631058272,0.17301997631058272,null,0.17301997631058272,0],"y":[45.609375,48.71875,null,48.71875,48.71875,null,48.71875,46.9375,null,46.9375,46.9375,null,46.9375,45.875,null,45.875,45.875,null,45.875,44.75,null,44.75,44.75,null,44.75,44,null,44,44,null,44.75,45.5,null,45.5,45.5,null,45.5,45,null,45,45,null,45.5,46,null,46,46,null,45.875,47,null,47,47,null,46.9375,48,null,48,48,null,48.71875,50.5,null,50.5,50.5,null,50.5,49.5,null,49.5,49.5,null,49.5,49,null,49,49,null,49.5,50,null,50,50,null,50.5,51.5,null,51.5,51.5,null,51.5,51,null,51,51,null,51.5,52,null,52,52],"text":["y: 1.09087789","y: 1.09087789",null,"y: 1.09087789","y: 1.09087789",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998"],"type":"scatter","mode":"lines","line":{"width":13.228346456692915,"color":"rgba(125,176,221,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.0543972272243758,1.0543972272243758,null,1.0543972272243758,0.47350573521867007,null,0.47350573521867007,0.47350573521867007,null,0.47350573521867007,0,null,0.47350573521867007,0.47350573521867007,null,0.47350573521867007,0],"y":[37.859375,40.5,null,40.5,40.5,null,40.5,40,null,40,40,null,40.5,41,null,41,41],"text":["y: 1.05439723","y: 1.05439723",null,"y: 1.05439723","y: 1.05439723",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574"],"type":"scatter","mode":"lines","line":{"width":13.228346456692915,"color":"rgba(134,184,117,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.0543972272243758,1.0543972272243758,null,1.0543972272243758,0.65936703189914236,null,0.65936703189914236,0.65936703189914236,null,0.65936703189914236,0,null,0.65936703189914236,0.65936703189914236,null,0.65936703189914236,0.36644681817261315,null,0.36644681817261315,0.36644681817261315,null,0.36644681817261315,0,null,0.36644681817261315,0.36644681817261315,null,0.36644681817261315,0.25729438180055103,null,0.25729438180055103,0.25729438180055103,null,0.25729438180055103,0.20244506563386869,null,0.20244506563386869,0.20244506563386869,null,0.20244506563386869,0,null,0.20244506563386869,0.20244506563386869,null,0.20244506563386869,0.12888304229422309,null,0.12888304229422309,0.12888304229422309,null,0.12888304229422309,0,null,0.12888304229422309,0.12888304229422309,null,0.12888304229422309,0,null,0.25729438180055103,0.25729438180055103,null,0.25729438180055103,0],"y":[37.859375,35.21875,null,35.21875,35.21875,null,35.21875,34,null,34,34,null,35.21875,36.4375,null,36.4375,36.4375,null,36.4375,35,null,35,35,null,36.4375,37.875,null,37.875,37.875,null,37.875,36.75,null,36.75,36.75,null,36.75,36,null,36,36,null,36.75,37.5,null,37.5,37.5,null,37.5,37,null,37,37,null,37.5,38,null,38,38,null,37.875,39,null,39,39],"text":["y: 1.05439723","y: 1.05439723",null,"y: 1.05439723","y: 1.05439723",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.25729438","y: 0.25729438"],"type":"scatter","mode":"lines","line":{"width":13.228346456692915,"color":"rgba(199,167,108,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5941744666987301,1.5941744666987301,null,1.5941744666987301,0.61424845626023339,null,0.61424845626023339,0.61424845626023339,null,0.61424845626023339,0.27585786880898638,null,0.27585786880898638,0.27585786880898638,null,0.27585786880898638,0,null,0.27585786880898638,0.27585786880898638,null,0.27585786880898638,0,null,0.61424845626023339,0.61424845626023339,null,0.61424845626023339,0],"y":[49.9296875,54.25,null,54.25,54.25,null,54.25,53.5,null,53.5,53.5,null,53.5,53,null,53,53,null,53.5,54,null,54,54,null,54.25,55,null,55,55],"text":["y: 1.59417447","y: 1.59417447",null,"y: 1.59417447","y: 1.59417447",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.61424846","y: 0.61424846"],"type":"scatter","mode":"lines","line":{"width":13.228346456692915,"color":"rgba(205,153,216,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.2046648341508379,1.2046648341508379,null,1.2046648341508379,0.95788286362070985,null,0.95788286362070985,0.95788286362070985,null,0.95788286362070985,0.79474550028479152,null,0.79474550028479152,0.79474550028479152,null,0.79474550028479152,0.38162569396273166,null,0.38162569396273166,0.38162569396273166,null,0.38162569396273166,0,null,0.38162569396273166,0.38162569396273166,null,0.38162569396273166,0,null,0.79474550028479152,0.79474550028479152,null,0.79474550028479152,0.66640477693470701,null,0.66640477693470701,0.66640477693470701,null,0.66640477693470701,0.3670616214398793,null,0.3670616214398793,0.3670616214398793,null,0.3670616214398793,0,null,0.3670616214398793,0.3670616214398793,null,0.3670616214398793,0.24828582661663642,null,0.24828582661663642,0.24828582661663642,null,0.24828582661663642,0.087558107117793965,null,0.087558107117793965,0.087558107117793965,null,0.087558107117793965,0,null,0.087558107117793965,0.087558107117793965,null,0.087558107117793965,0,null,0.24828582661663642,0.24828582661663642,null,0.24828582661663642,0.23756964971442932,null,0.23756964971442932,0.23756964971442932,null,0.23756964971442932,0.12990466363518885,null,0.12990466363518885,0.12990466363518885,null,0.12990466363518885,0,null,0.12990466363518885,0.12990466363518885,null,0.12990466363518885,0,null,0.23756964971442932,0.23756964971442932,null,0.23756964971442932,0,null,0.66640477693470701,0.66640477693470701,null,0.66640477693470701,0.53487511869044835,null,0.53487511869044835,0.53487511869044835,null,0.53487511869044835,0.43836359937083058,null,0.43836359937083058,0.43836359937083058,null,0.43836359937083058,0.20347407832470971,null,0.20347407832470971,0.20347407832470971,null,0.20347407832470971,0,null,0.20347407832470971,0.20347407832470971,null,0.20347407832470971,0,null,0.43836359937083058,0.43836359937083058,null,0.43836359937083058,0.3320591860865823,null,0.3320591860865823,0.3320591860865823,null,0.3320591860865823,0.27419929098840373,null,0.27419929098840373,0.27419929098840373,null,0.27419929098840373,0,null,0.27419929098840373,0.27419929098840373,null,0.27419929098840373,0.14343825675778746,null,0.14343825675778746,0.14343825675778746,null,0.14343825675778746,0,null,0.14343825675778746,0.14343825675778746,null,0.14343825675778746,0,null,0.3320591860865823,0.3320591860865823,null,0.3320591860865823,0.20894513119211036,null,0.20894513119211036,0.20894513119211036,null,0.20894513119211036,0,null,0.20894513119211036,0.20894513119211036,null,0.20894513119211036,0.15445841184345191,null,0.15445841184345191,0.15445841184345191,null,0.15445841184345191,0.090399928110331734,null,0.090399928110331734,0.090399928110331734,null,0.090399928110331734,0,null,0.090399928110331734,0.090399928110331734,null,0.090399928110331734,0,null,0.15445841184345191,0.15445841184345191,null,0.15445841184345191,0,null,0.53487511869044835,0.53487511869044835,null,0.53487511869044835,0.3721232755076867,null,0.3721232755076867,0.3721232755076867,null,0.3721232755076867,0.35032421362805982,null,0.35032421362805982,0.35032421362805982,null,0.35032421362805982,0.24340283886100492,null,0.24340283886100492,0.24340283886100492,null,0.24340283886100492,0.2124431624834609,null,0.2124431624834609,0.2124431624834609,null,0.2124431624834609,0.12708171116759612,null,0.12708171116759612,0.12708171116759612,null,0.12708171116759612,0,null,0.12708171116759612,0.12708171116759612,null,0.12708171116759612,0,null,0.2124431624834609,0.2124431624834609,null,0.2124431624834609,0,null,0.24340283886100492,0.24340283886100492,null,0.24340283886100492,0,null,0.35032421362805982,0.35032421362805982,null,0.35032421362805982,0,null,0.3721232755076867,0.3721232755076867,null,0.3721232755076867,0.18257733577118412,null,0.18257733577118412,0.18257733577118412,null,0.18257733577118412,0,null,0.18257733577118412,0.18257733577118412,null,0.18257733577118412,0.12129831255664308,null,0.12129831255664308,0.12129831255664308,null,0.12129831255664308,0,null,0.12129831255664308,0.12129831255664308,null,0.12129831255664308,0.094902085465199681,null,0.094902085465199681,0.094902085465199681,null,0.094902085465199681,0,null,0.094902085465199681,0.094902085465199681,null,0.094902085465199681,0,null,0.95788286362070985,0.95788286362070985,null,0.95788286362070985,0.40783062668695391,null,0.40783062668695391,0.40783062668695391,null,0.40783062668695391,0.21815448450140348,null,0.21815448450140348,0.21815448450140348,null,0.21815448450140348,0.099186753204319175,null,0.099186753204319175,0.099186753204319175,null,0.099186753204319175,0,null,0.099186753204319175,0.099186753204319175,null,0.099186753204319175,0,null,0.21815448450140348,0.21815448450140348,null,0.21815448450140348,0,null,0.40783062668695391,0.40783062668695391,null,0.40783062668695391,0.31959962472454068,null,0.31959962472454068,0.31959962472454068,null,0.31959962472454068,0.20918247212427826,null,0.20918247212427826,0.20918247212427826,null,0.20918247212427826,0,null,0.20918247212427826,0.20918247212427826,null,0.20918247212427826,0,null,0.31959962472454068,0.31959962472454068,null,0.31959962472454068,0.11950480173549578,null,0.11950480173549578,0.11950480173549578,null,0.11950480173549578,0,null,0.11950480173549578,0.11950480173549578,null,0.11950480173549578,0],"y":[27.923828125,17.98828125,null,17.98828125,17.98828125,null,17.98828125,6.1015625,null,6.1015625,6.1015625,null,6.1015625,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,6.1015625,10.703125,null,10.703125,10.703125,null,10.703125,4.4375,null,4.4375,4.4375,null,4.4375,3,null,3,3,null,4.4375,5.875,null,5.875,5.875,null,5.875,4.5,null,4.5,4.5,null,4.5,4,null,4,4,null,4.5,5,null,5,5,null,5.875,7.25,null,7.25,7.25,null,7.25,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,7.25,8,null,8,8,null,10.703125,16.96875,null,16.96875,16.96875,null,16.96875,11.46875,null,11.46875,11.46875,null,11.46875,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,11.46875,13.4375,null,13.4375,13.4375,null,13.4375,11.75,null,11.75,11.75,null,11.75,11,null,11,11,null,11.75,12.5,null,12.5,12.5,null,12.5,12,null,12,12,null,12.5,13,null,13,13,null,13.4375,15.125,null,15.125,15.125,null,15.125,14,null,14,14,null,15.125,16.25,null,16.25,16.25,null,16.25,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,16.25,17,null,17,17,null,16.96875,22.46875,null,22.46875,22.46875,null,22.46875,21.0625,null,21.0625,21.0625,null,21.0625,20.125,null,20.125,20.125,null,20.125,19.25,null,19.25,19.25,null,19.25,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,19.25,20,null,20,20,null,20.125,21,null,21,21,null,21.0625,22,null,22,22,null,22.46875,23.875,null,23.875,23.875,null,23.875,23,null,23,23,null,23.875,24.75,null,24.75,24.75,null,24.75,24,null,24,24,null,24.75,25.5,null,25.5,25.5,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,17.98828125,29.875,null,29.875,29.875,null,29.875,28.25,null,28.25,28.25,null,28.25,27.5,null,27.5,27.5,null,27.5,27,null,27,27,null,27.5,28,null,28,28,null,28.25,29,null,29,29,null,29.875,31.5,null,31.5,31.5,null,31.5,30.5,null,30.5,30.5,null,30.5,30,null,30,30,null,30.5,31,null,31,31,null,31.5,32.5,null,32.5,32.5,null,32.5,32,null,32,32,null,32.5,33,null,33,33],"text":["y: 1.20466483","y: 1.20466483",null,"y: 1.20466483","y: 1.20466483",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480"],"type":"scatter","mode":"lines","line":{"width":13.228346456692915,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.8228771534841939,1.8228771534841939,null,1.8228771534841939,1.2046648341508379,null,1.2046648341508379,1.2046648341508379,null,1.2046648341508379,1.0543972272243758,null,1.8228771534841939,1.8228771534841939,null,1.8228771534841939,1.5941744666987301,null,1.5941744666987301,1.5941744666987301,null,1.5941744666987301,1.0908778897590075],"y":[38.9267578125,27.923828125,null,27.923828125,27.923828125,null,27.923828125,37.859375,null,37.859375,37.859375,null,38.9267578125,49.9296875,null,49.9296875,49.9296875,null,49.9296875,45.609375,null,45.609375,45.609375],"text":["y: 1.82287715","y: 1.82287715",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.20466483","y: 1.20466483",null,"y: 1.20466483","y: 1.20466483",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.59417447","y: 1.59417447",null,"y: 1.59417447","y: 1.59417447"],"type":"scatter","mode":"lines","line":{"width":13.228346456692915,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.8228771534841939,1.2046648341508379,0.95788286362070985,0.79474550028479152,0.38162569396273166,0,0,0.66640477693470701,0.3670616214398793,0,0.24828582661663642,0.087558107117793965,0,0,0.23756964971442932,0.12990466363518885,0,0,0,0.53487511869044835,0.43836359937083058,0.20347407832470971,0,0,0.3320591860865823,0.27419929098840373,0,0.14343825675778746,0,0,0.20894513119211036,0,0.15445841184345191,0.090399928110331734,0,0,0,0.3721232755076867,0.35032421362805982,0.24340283886100492,0.2124431624834609,0.12708171116759612,0,0,0,0,0,0.18257733577118412,0,0.12129831255664308,0,0.094902085465199681,0,0,0.40783062668695391,0.21815448450140348,0.099186753204319175,0,0,0,0.31959962472454068,0.20918247212427826,0,0,0.11950480173549578,0,0,1.0543972272243758,0.65936703189914236,0,0.36644681817261315,0,0.25729438180055103,0.20244506563386869,0,0.12888304229422309,0,0,0,0.47350573521867007,0,0,1.5941744666987301,1.0908778897590075,0.50094972196331133,0,0,0.73180022212606366,0.69115953326908086,0.3806270981887479,0.25526431689183554,0,0.185675404080306,0,0,0,0,0.46680758268969319,0.35841748229668252,0,0,0.17301997631058272,0,0,0.61424845626023339,0.27585786880898638,0,0,0],"y":[38.9267578125,27.923828125,17.98828125,6.1015625,1.5,1,2,10.703125,4.4375,3,5.875,4.5,4,5,7.25,6.5,6,7,8,16.96875,11.46875,9.5,9,10,13.4375,11.75,11,12.5,12,13,15.125,14,16.25,15.5,15,16,17,22.46875,21.0625,20.125,19.25,18.5,18,19,20,21,22,23.875,23,24.75,24,25.5,25,26,29.875,28.25,27.5,27,28,29,31.5,30.5,30,31,32.5,32,33,37.859375,35.21875,34,36.4375,35,37.875,36.75,36,37.5,37,38,39,40.5,40,41,49.9296875,45.609375,42.5,42,43,48.71875,46.9375,45.875,44.75,44,45.5,45,46,47,48,50.5,49.5,49,50,51.5,51,52,54.25,53.5,53,54,55],"text":["y: 1.82287715","y: 1.20466483","y: 0.95788286","y: 0.79474550","y: 0.38162569","y: 0.00000000","y: 0.00000000","y: 0.66640478","y: 0.36706162","y: 0.00000000","y: 0.24828583","y: 0.08755811","y: 0.00000000","y: 0.00000000","y: 0.23756965","y: 0.12990466","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.53487512","y: 0.43836360","y: 0.20347408","y: 0.00000000","y: 0.00000000","y: 0.33205919","y: 0.27419929","y: 0.00000000","y: 0.14343826","y: 0.00000000","y: 0.00000000","y: 0.20894513","y: 0.00000000","y: 0.15445841","y: 0.09039993","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.37212328","y: 0.35032421","y: 0.24340284","y: 0.21244316","y: 0.12708171","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.18257734","y: 0.00000000","y: 0.12129831","y: 0.00000000","y: 0.09490209","y: 0.00000000","y: 0.00000000","y: 0.40783063","y: 0.21815448","y: 0.09918675","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.31959962","y: 0.20918247","y: 0.00000000","y: 0.00000000","y: 0.11950480","y: 0.00000000","y: 0.00000000","y: 1.05439723","y: 0.65936703","y: 0.00000000","y: 0.36644682","y: 0.00000000","y: 0.25729438","y: 0.20244507","y: 0.00000000","y: 0.12888304","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.47350574","y: 0.00000000","y: 0.00000000","y: 1.59417447","y: 1.09087789","y: 0.50094972","y: 0.00000000","y: 0.00000000","y: 0.73180022","y: 0.69115953","y: 0.38062710","y: 0.25526432","y: 0.00000000","y: 0.18567540","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.46680758","y: 0.35841748","y: 0.00000000","y: 0.00000000","y: 0.17301998","y: 0.00000000","y: 0.00000000","y: 0.61424846","y: 0.27585787","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.8897637795275593,"color":"transparent"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.80000000000000004],"automargin":true,"type":"linear","autorange":false,"range":[0.5,5.5],"tickmode":"array","ticktext":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":6.6417600664176026},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"ICT Indicators","hoverformat":".2f"},"xaxis2":{"domain":[0.80000000000000004,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1.8228771534841939],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5"],"tickvals":[0,0.49999999999999994,0.99999999999999989,1.5],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":null,"family":null,"size":0}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,55.5],"tickmode":"array","ticktext":["Narphan","Pangwaun","Mongpan","Nansang","Kyaukme","Kalaw","Hseni","Langkho","Kunhing","Laihka","Monghsat","Loilen","Mongnai","Mongton","Hsipaw","Hopong","Monghsu","Pinlaung","Mongmit","Pekon","Kutkai","Namtu","Hsihseng","Kyethi","Tangyan","Namhsan","Mongyai","Mongping","Mongkhet","Mawkmai","Mongkaing","Manton","Matman","Ywangan","Pindaya","Lawksawk","Nyaungshwe","Nawnghkio","Monghpyak","Mabein","Mongyawng","Kunlong","Konkyan","Mongyang","Mongmao","Hopang","Namhkan","Laukkaing","Mongla","Pangsang","Kengtung","Lashio","Taunggyi","Tachileik","Muse"],"tickvals":[1,2,3,3.9999999999999996,5,6,7,7.9999999999999991,9,10,11,12,13,14,14.999999999999998,15.999999999999998,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],"categoryorder":"array","categoryarray":["Narphan","Pangwaun","Mongpan","Nansang","Kyaukme","Kalaw","Hseni","Langkho","Kunhing","Laihka","Monghsat","Loilen","Mongnai","Mongton","Hsipaw","Hopong","Monghsu","Pinlaung","Mongmit","Pekon","Kutkai","Namtu","Hsihseng","Kyethi","Tangyan","Namhsan","Mongyai","Mongping","Mongkhet","Mawkmai","Mongkaing","Manton","Matman","Ywangan","Pindaya","Lawksawk","Nyaungshwe","Nawnghkio","Monghpyak","Mabein","Mongyawng","Kunlong","Konkyan","Mongyang","Mongmao","Hopang","Namhkan","Laukkaing","Mongla","Pangsang","Kengtung","Lashio","Taunggyi","Tachileik","Muse"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":5.3134080531340802},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Townships of Shan State","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.80000000000000004,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.80000000000000004,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":60,"r":null,"b":35.06849315068493,"l":200},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Geographic Segmentation of Shan State by ICT indicators"},"attrs":{"63796fbe08da":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"},"637916f9d51e":{"x":{},"y":{},"xend":{},"yend":{},"colour":{},"linetype":{},"linewidth":{},"type":"scatter"},"63796c16b05a":{"x":{},"y":{},"colour":{},"shape":{},"size":{}}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>When we plot our interactive cluster heatmap with the code chunk above, the right part of the output is effectively the same dendrogram we get from earlier.</p>
</section>
</section>
<section id="hx7.12-mapping-the-clusters-formed" class="level2">
<h2 class="anchored" data-anchor-id="hx7.12-mapping-the-clusters-formed">HX7.12 Mapping the clusters formed</h2>
<p>If we recall from earlier, we determined that the optimal number of clusters <span class="math inline">\(k\)</span> to retain is <code>6</code>. We will do just that in the code chunk below, using <code>cutree()</code> of base R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output is called groups. It is a list object.</p>
<p>In order to visualise the clusters, the groups object needs to be appended onto the <code>shan_sf</code> simple feature object. This is done in three steps:</p>
<ul>
<li>Convert <code>groups</code> into a matrix;</li>
<li>Use cbind() to append <code>groups</code> matrix to <code>shan_sf</code> to produce an output simple feature object called <code>shan_sf_cluster</code>; and</li>
<li>Use <code>rename</code>from the dplyr package to rename the <code>as.matrix.groups</code> field as <code>CLUSTER</code>.</li>
<li>Plot the choropleth map showing the clusters formed.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>shan_sf_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>hierarchical_map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_cluster, <span class="st">"CLUSTER"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>hierarchical_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hands-on-7_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The choropleth map above reveals extensive fragmentation in the clusters. The is a major limitation when non-spatial clustering algorithms such as hierarchical cluster analysis method are used.</p>
</section>
<section id="hx7.13-saving-modified-sf-to-disk-as-rds" class="level2">
<h2 class="anchored" data-anchor-id="hx7.13-saving-modified-sf-to-disk-as-rds">HX7.13 Saving modified <code>sf</code> to disk as RDS</h2>
<p>The process will continue in <a href="../HandsOn/hands-on-8.html">Hands-on exercise 8</a>. Before we conclude, we need to save some objects from earlier to the disk so that we can refer to it again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(shan_sf, <span class="st">'data/rds/shan_sf.rds'</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(shan_ict, <span class="st">'data/rds/shan_ict.rds'</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(shan_sf_cluster, <span class="st">'data/rds/shan_sf_cluster.rds'</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(hierarchical_map, <span class="st">'data/rds/hmap.rds'</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(proxmat, <span class="st">'data/rds/proxmat.rds'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>Kam, T. S. (2024). 12 Geographical Segmentation with Spatially Constrained Clustering Techniques. R for Geospatial Data Science and Analytics. <a href="https://r4gdsa.netlify.app/chap12#correlation-analysis" class="uri">https://r4gdsa.netlify.app/chap12#correlation-analysis</a></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>