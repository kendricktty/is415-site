[
  {
    "objectID": "HandsOn/Hands-on_Ex02/hands-on-2.html",
    "href": "HandsOn/Hands-on_Ex02/hands-on-2.html",
    "title": "H2: Thematic Mapping and GeoVisualisation with R",
    "section": "",
    "text": "While thematic mapping uses map symbols to visualise geographic properties such as population and temperature, geovisualisation is a subset of thematic mapping, where a pseudocolour is used to correspond with these geographic properties."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.1-overview",
    "href": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.1-overview",
    "title": "H2: Thematic Mapping and GeoVisualisation with R",
    "section": "",
    "text": "While thematic mapping uses map symbols to visualise geographic properties such as population and temperature, geovisualisation is a subset of thematic mapping, where a pseudocolour is used to correspond with these geographic properties."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.2-getting-started",
    "href": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.2-getting-started",
    "title": "H2: Thematic Mapping and GeoVisualisation with R",
    "section": "H2.2 Getting Started",
    "text": "H2.2 Getting Started\ntmap contains the packages needed to perform geovisualisation, so we need to import that along with the usual packages we use.\n\npacman::p_load(sf, tmap, tidyverse)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.3-importing-data-into-r",
    "href": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.3-importing-data-into-r",
    "title": "H2: Thematic Mapping and GeoVisualisation with R",
    "section": "H2.3 Importing Data into R",
    "text": "H2.3 Importing Data into R\nThe datasets to be used are:\n\nMaster Plan 2014 Subzone Boundary (Web)(MP14_SUBZONE_WEB_PL) in ESRI shapefile format\n\n\nmp_subzone &lt;- st_read(dsn = \"../data/geospatial/MasterPlan2014SubzoneBoundaryWebSHP\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial/MasterPlan2014SubzoneBoundaryWebSHP' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\nmp_subzone\n\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 10 features:\n   OBJECTID SUBZONE_NO       SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1         1          1    MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2         2          1    PEARL'S HILL    OTSZ01      Y          OUTRAM\n3         3          3       BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4         4          8  HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5         5          3         REDHILL    BMSZ03      N     BUKIT MERAH\n6         6          7  ALEXANDRA HILL    BMSZ07      N     BUKIT MERAH\n7         7          9   BUKIT HO SWEE    BMSZ09      N     BUKIT MERAH\n8         8          2     CLARKE QUAY    SRSZ02      Y SINGAPORE RIVER\n9         9         13 PASIR PANJANG 1    QTSZ13      N      QUEENSTOWN\n10       10          7       QUEENSWAY    QTSZ07      N      QUEENSTOWN\n   PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1          MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2          OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3          SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4          BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5          BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n6          BM CENTRAL REGION       CR 9D286521EF5E3B59 2014-12-05 25358.82\n7          BM CENTRAL REGION       CR 7839A8577144EFE2 2014-12-05 27680.06\n8          SR CENTRAL REGION       CR 48661DC0FBA09F7A 2014-12-05 29253.21\n9          QT CENTRAL REGION       CR 1F721290C421BFAB 2014-12-05 22077.34\n10         QT CENTRAL REGION       CR 3580D2AFFBEE914C 2014-12-05 24168.31\n     Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1  29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2  29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3  29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4  29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5  30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n6  29991.38   4428.913  1030378.8 MULTIPOLYGON (((25899.7 297...\n7  30230.86   3275.312   551732.0 MULTIPOLYGON (((27746.95 30...\n8  30222.86   2208.619   290184.7 MULTIPOLYGON (((29351.26 29...\n9  29893.78   6571.323  1084792.3 MULTIPOLYGON (((20996.49 30...\n10 30104.18   3454.239   631644.3 MULTIPOLYGON (((24472.11 29...\n\n\n\nunique(mp_subzone$REGION_N)\n\n[1] \"CENTRAL REGION\"    \"WEST REGION\"       \"EAST REGION\"      \n[4] \"NORTH-EAST REGION\" \"NORTH REGION\"     \n\n\n\nSingapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2011-2020 (aspatial)\n\n\npopulation_data &lt;- read_csv(\"../data/aspatial/respopagesextod2011to2020/respopagesextod2011to2020.csv\")\n\nRows: 984656 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): PA, SZ, AG, Sex, TOD\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(population_data)\n\n# A tibble: 6 × 7\n  PA         SZ                     AG     Sex   TOD                   Pop  Time\n  &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;\n1 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 1- and 2-Room …     0  2011\n2 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 3-Room Flats       10  2011\n3 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 4-Room Flats       30  2011\n4 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 5-Room and Exe…    50  2011\n5 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HUDC Flats (exclud…     0  2011\n6 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males Landed Properties       0  2011\n\n\nThe data appears to be arranged in order of planning area, so by calling head(), the first few rows feature entries located in the good town of Ang Mo Kio."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.3.4-data-preparation",
    "href": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.3.4-data-preparation",
    "title": "H2: Thematic Mapping and GeoVisualisation with R",
    "section": "H2.3.4 Data Preparation",
    "text": "H2.3.4 Data Preparation\nTo prepare our thematic map visualising the distribution of Singapore residents of various attributes, we need to filter the population dataset to only include values from the year 2020.\n\nH2.3.4.0 %&gt;% Operator\nThe %&gt;% operator is used extensively here, so as an R beginner, it might be worth summarising what it does. Basically, %&gt;% is a pipe that directs the output of the function called to its left to the one called on its right.\n\nquadratic_function &lt;- function(x) {\n    return(x * x)\n}\n\nadd_3 &lt;- function(x) {\n    return(x + 3)\n}\n\nmultiply_2 &lt;- function(x) {\n    return(x * 2)\n}\n\nthree_plus_three_times_2 &lt;- 3 %&gt;%\n    multiply_2() %&gt;%\n    add_3() %&gt;%\n    multiply_2()\nprint(\"Expected: 18\")\n\n[1] \"Expected: 18\"\n\nprint(paste(\"Actual:\", three_plus_three_times_2, sep = \" \"))\n\n[1] \"Actual: 18\"\n\n\nThe alternative would be to create a large composite list of functions within functions, which would make our code difficult to read:\n\nthree_plus_three_times_2 &lt;- multiply_2(add_3(multiply_2(3)))\nprint(\"Expected: 18\")\n\n[1] \"Expected: 18\"\n\nprint(paste(\"Actual:\", three_plus_three_times_2, sep = \" \"))\n\n[1] \"Actual: 18\"\n\n\nIn the context of data preprocessing, the %&gt;% would be akin, in Python, to chaining multiple pandas methods together in the same line, such that the operations are also performed from left to right. For example:\ndf = pd.read_csv()\ndf.fillna().head()\n\nH2.3.4.1 Data wrangling\nGreat! Now that we’ve explained %&gt;%, let’s now move on to the more complicated job of feature-engineering the population data.\n\npopulation_2020 &lt;- population_data %&gt;%\n    filter(Time == 2020) %&gt;%\n    group_by(PA, SZ, AG) %&gt;%\n    summarise(`POP` = sum(`Pop`)) %&gt;%\n    ungroup() %&gt;%\n    pivot_wider(names_from = AG, values_from = POP)\n\n`summarise()` has grouped output by 'PA', 'SZ'. You can override using the\n`.groups` argument.\n\ncolnames(population_2020)\n\n [1] \"PA\"          \"SZ\"          \"0_to_4\"      \"10_to_14\"    \"15_to_19\"   \n [6] \"20_to_24\"    \"25_to_29\"    \"30_to_34\"    \"35_to_39\"    \"40_to_44\"   \n[11] \"45_to_49\"    \"50_to_54\"    \"55_to_59\"    \"5_to_9\"      \"60_to_64\"   \n[16] \"65_to_69\"    \"70_to_74\"    \"75_to_79\"    \"80_to_84\"    \"85_to_89\"   \n[21] \"90_and_over\"\n\n\n\npopulation_2020 &lt;- population_2020 %&gt;%\n    # As young boys in Singapore serve 2 years of national service, the earliest age to be considered economically active should be 25.\n    mutate(`YOUNG` = rowSums(.[3:6]) + rowSums(.[14])) %&gt;%\n    # By 2026, the retirement age in Singapore will be raised to 64.\n    mutate(`ECONOMY ACTIVE` = rowSums(.[7:13]) + rowSums(.[15])) %&gt;%\n    mutate(`AGED` = rowSums(.[16:21])) %&gt;%\n    mutate(`TOTAL` = rowSums(.[3:21])) %&gt;%\n    mutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n    / `ECONOMY ACTIVE`) %&gt;%\n    select(\n        `PA`, `SZ`, `YOUNG`,\n        `ECONOMY ACTIVE`, `AGED`,\n        `TOTAL`, `DEPENDENCY`\n    )\n\n\n\nH2.3.4.2 Joining attribute and geospatial data\nA georelational join will now need to be performed to combine them into the same table.\nBefore we can do so, though, we need to convert the PA and SZ fields to uppercase, to unify its presentation with teh SUBZONE_N and PLN_AREA_N fields.\n\npopulation_2020 &lt;- population_2020 %&gt;%\n    mutate_at(.vars = vars(PA, SZ), .funs = list(toupper)) %&gt;%\n    filter(`ECONOMY ACTIVE` &gt; 0)\n\nWe can now perform a left join (from the dplyr function) between the subzone geospatial data and the population data on the SUBZONE_N and SZ identifiers:\n\ncombined &lt;- left_join(mp_subzone, population_2020, by = c(\"SUBZONE_N\" = \"SZ\"))"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.4-choropleth-mapping-using-tmap",
    "href": "HandsOn/Hands-on_Ex02/hands-on-2.html#h2.4-choropleth-mapping-using-tmap",
    "title": "H2: Thematic Mapping and GeoVisualisation with R",
    "section": "H2.4 Choropleth mapping using tmap",
    "text": "H2.4 Choropleth mapping using tmap\nWe can now create our choropleth map.\nAs adapted from the course website:\n\nChoropleth mapping involves the symbolisation of enumeration units, such as countries, provinces, states, counties or census units, using area patterns or graduated colors. For example, a social scientist may need to use a choropleth map to portray the spatial distribution of aged population of Singapore by Master Plan 2014 Subzone Boundary.\n\n\nTwo approaches can be used to prepare thematic map using tmap, they are:\n\n\n\nPlotting a thematic map quickly by using qtm().\nPlotting highly customisable thematic map by using tmap elements.\n\n\n\nH2.4.1 Plotting a choropleth map quickly using qtm()\nThe easiest and quickest way to draw a chloropleth map is using qtm():\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nqtm(combined,\n    fill = \"DEPENDENCY\"\n)\n\n\n\n\n\n\n\n\nThis map indicates that the dependency ratio in most of the island is a supposedly healthy 5 and below. Missing datapoints correspond with major commercial nodes and key installations in the country (such as Changi Airport in the east, the central catchment nature reserve, the downtown core and industrial estates in Jurong and Tuas), while Changi Village (the patch of red) seems to have the highest percentage of dependents.\n\nLearning points:\n\n\n\ntmap_mode() with “plot” option is used to produce a static map. For interactive mode, “view” option should be used.\n\n\n\n\nfill argument is used to map the attribute (in this case, \"DEPENDENCY\")\n\n\n\n\nH2.4.2 Creating a choropleth map using tmap elements\nA major disadvantage of qtm() is that it makes aesthetics of individual layers harder to control. Using the tmap elements allows us to draw better quality cartographic choropleth maps like the one below.\n\ntm_shape(combined) +\n    tm_fill(\"DEPENDENCY\",\n        style = \"quantile\",\n        palette = \"Blues\",\n        title = \"Dependency ratio\"\n    ) +\n    tm_layout(\n        main.title = \"Distribution of Dependency Ratio by planning subzone\",\n        main.title.position = \"center\",\n        main.title.size = 1.2,\n        legend.height = 0.45,\n        legend.width = 0.35,\n        frame = TRUE\n    ) +\n    tm_borders(alpha = 0.5) +\n    tm_compass(type = \"8star\", size = 2) +\n    tm_scale_bar() +\n    tm_grid(alpha = 0.2) +\n    tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\",\n        position = c(\"left\", \"bottom\")\n    )\n\n\n\n\n\n\n\n\nOnce again the missing datapoints correspond to areas of the country not dedicated to residential use, but this time we have a much more varied visualisation of the dependency ratio within the country. The areas with the highest dependency ratio appear to correlate with the oldest HDB estates, from Toa Payoh to Queenstown, while the newer estates such as Sengkang, Punggol and even Yishun have a smaller proportion of dependents.\n\nH2.4.2.1 Drawing a base map\nIn the code chunk below, tm_shape() is used to define the input data (i.e comined) and tm_polygons() is used to draw the planning subzone polygons.\n\ntm_shape(combined) + tm_polygons()\n\n\n\n\n\n\n\n\n\n\n2.4.2.2 Drawing a choropleth map using tm_polygons()\nTo draw a choropleth map showing the geographical distribution of a selected variable by planning subzone, we just need to assign that target variable to tm_polgyons(). The maps below show higher than usual populations of young dependents in Woodlands, Sengkang, Punggol, Tampines and Pasir Ris, and higher than usual populations of elderly dependents in Ang Mo Kio, Hougang and Bedok.\n\ntm_shape(combined) + tm_polygons(\"YOUNG\")\n\n\n\n\n\n\n\ntm_shape(combined) + tm_polygons(\"AGED\")\n\n\n\n\n\n\n\n\n\nThings to learn from tm_polygons():\n\n\nThe default interval binning used to draw the choropleth map is called “pretty”. A detailed discussion of the data classification methods supported by tmap will be provided in sub-section 4.3.\nThe default colour scheme used is YlOrRd of ColorBrewer. You will learn more about the color scheme in sub-section 4.4.\nBy default, missing values are shaded in grey.\n\n\n\nH2.4.2.3 Drawing a choropleth map with tm_fill() and tm_border()\ntm_polygons() is a wrapper of tm_fill() and tm_border(), which shades the polygons and adds borders from the shapefile onto the map respectively. Let’s see what happens when we try to use each of these two functions individually:\n\ntm_shape(combined) + tm_fill(\"DEPENDENCY\")\n\n\n\n\n\n\n\ntm_shape(combined) + tm_borders(lwd = 0.1, alpha = 1)\n\n\n\n\n\n\n\ntm_shape(combined) + tm_fill(\"DEPENDENCY\") + tm_borders(lwd = 0.1, alpha = 1)\n\n\n\n\n\n\n\n\nThe alpha argument is used to define a transparency number between 0 (totally transparent) and 1 (not transparent). By default, the alpha value of the col is used (normally 1).\nThe three other arguments for tm_borders() are:\n\ncol: border colour\nlwd: border line width (default 1)\nlty: border line type (default solid)\n\n\n\n\nH2.4.3 Data classification methods of tmap\nData classification serves to take a large number of observations and group them into data ranges or classes. tmap provides a total ten data classification methods, namely fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks. A data classification method is defined using the style argument of the tm_fill() or tm_polygons() method.\n\nH2.4.3.1 Plotting choropleth maps with built-in classification methods\nA quantile data classification with 4 classes:\n\ntm_shape(combined) +\n    tm_fill(\"AGED\",\n        n = 4,\n        style = \"quantile\"\n    ) +\n    tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\nAn equal data classification:\n\ntm_shape(combined) +\n    tm_fill(\"AGED\",\n        n = 5,\n        style = \"equal\"\n    ) +\n    tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\nUsing standard deviation:\n\ntm_shape(combined) +\n    tm_fill(\"AGED\",\n        n = 4,\n        style = \"sd\"\n    ) +\n    tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\nUsing K-means classification with 5, 10 and 15 class sizes:\n\n# for (i in 1:3) {\n#     tm_shape(combined) +\n#         tm_fill(\"AGED\", n = (5 * i), style = \"kmeans\") +\n#         tm_borders(alpha = 0.5)\n# }\ntm_shape(combined) +\n    tm_fill(\"AGED\",\n        n = 5,\n        style = \"kmeans\"\n    ) +\n    tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(combined) +\n    tm_fill(\"AGED\",\n        n = 10,\n        style = \"kmeans\"\n    ) +\n    tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(combined) +\n    tm_fill(\"AGED\",\n        n = 15,\n        style = \"kmeans\"\n    ) +\n    tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\nThe quantile and kmeans with higher n classifications are able to highlight the distribution of elderly dependents in Singapore the most clearly. The largest distributions of elderly dependents are clustered in the central, northeast and east of Singapore, with small pockets in the north and west.\n\n\nH2.4.3.2 Plotting choropleth maps with custom breaks\nCategory breaks in the built-in styles are calculated automatically. We can override the default breaks by using the breaks argument in tm_fill() to set our own breakpoints.\n\nIt is important to note that, in tmap the breaks include a minimum and maximum. As a result, in order to end up with n categories, n+1 elements must be specified in the breaks option (the values must be in increasing order).\n\nBefore we move on though, it is a good practice to retrieve our variable’s descriptive statistics - mean, median, quartiles, min and max. I’m supposed to work on the DEPENDENCY feature, but because I’m interested to map the concentration of our elderly population, I will work instead on the AGED feature.\n\nsummary(combined$AGED)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n      0     515    2080    2667    3745   20240      92 \n\n\nWe are most interested in which regions of the country contain the range between the first and third quartiles - within which also lies the mean and median. This is a universally-understood indicator of central tendency.\nAs such, our breakpoints will be the following vector:\n\naged_breaks &lt;- c(0, 514, 2079, 2666, 3744, 20240)\n\nwhere aged_breaks[1] and aged_breaks[6] are the min and max respectively. In R, indexes start at 1, and not 0 as is the case of 0-indexed languages like Python, C or Java.\n\n\n\nH2.4.4 Colour Scheme\nWith our statistically-derived breakpoints now set, we can now move on to plotting our more statistically informed choropleth map.\nSimCity 4, which I play a lot of, plots age-related data for in-game cities using a colour ramp of green (lowest) and blue (highest). Therefore, to showcase the use of tm_fill()’s palette argument for colouring, we can define a colour vector to use to colour our map in that manner.\n\ntm_shape(combined) +\n  tm_fill(\"AGED\", breaks=aged_breaks, palette=c(\"green\", \"blue\")) +\n  tm_borders(alpha=0.5)\n\n\n\n\n\n\n\n\nOr we could use one of the built-in single-colour palettes as such:\n\ntm_shape(combined) +\n  tm_fill(\"AGED\", breaks=aged_breaks, palette=\"Purples\") +\n  tm_borders(alpha=0.5)\n\n\n\n\n\n\n\n\nTo reverse the colour shading, we can add a “-” prefix:\n\ntm_shape(combined) +\n  tm_fill(\"AGED\", breaks=aged_breaks, palette=\"-Oranges\") +\n  tm_borders(alpha=0.5)\n\n\n\n\n\n\n\n\n\n\nH2.4.5 Map Layouts\n\nH2.4.5.1 Map Legend\nFrom this section onward, we will revert to working on the DEPENDENCY feature.\nIn tmap, several legend options are provided to change the placement, format and appearance of the legend.\n\ntm_shape(combined)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"jenks\", \n          palette = \"Oranges\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone \\n(Jenks classification)\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            legend.outside = FALSE,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\nH2.4.5.2 Map style\nWe can also change the map style by calling tmap_style().\n\ntm_shape(combined)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Greens\") +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"classic\")\n\ntmap style set to \"classic\"\n\n\nother available styles are: \"white\", \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"watercolor\" \n\n\n\n\n\n\n\n\n\n\n\nH2.4.5.3 Cartographic furniture\nBesides map style, tmap also allows us to draw other map furniture like compasses, scale bars and grid lines. In the code chunk below, tm_compass(), tm_scale_bar() and tm_grid() are used to add a compass, scale bar and grid lines respectively to the map.\n\ntm_shape(combined)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Greens\",\n          title = \"No. of persons\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio \\nby planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n\n\n\n\nFinally, the following code chunk resets the default style.\n\ntmap_style(\"white\")\n\ntmap style set to \"white\"\n\n\nother available styles are: \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\" \n\n\n\n\n\nH2.4.6 Drawing small multiple choropleth maps\nFrom the course outline:\n\nSmall multiple maps, also referred to as facet maps, are composed of many maps arrange side-by-side, and sometimes stacked vertically. Small multiple maps enable the visualisation of how spatial relationships change with respect to another variable, such as time.\nIn tmap, small multiple maps can be plotted in three ways:\n\n\n\nby assigning multiple values to at least one of the asthetic arguments,\n\n\n\n\nby defining a group-by variable in tm_facets(), and\n\n\n\n\nby creating multiple stand-alone maps with tmap_arrange().\n\n\n\nH2.4.6.1 By assigning multiple values to at least one of the aesthetic arguments\n\ntm_shape(combined)+\n  tm_fill(c(\"YOUNG\", \"AGED\"),\n          style = \"equal\", \n          palette = \"Blues\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\")) +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"white\")\n\ntmap style set to \"white\"\n\n\nother available styles are: \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\" \n\n\n\n\n\n\n\n\n\n\ntm_shape(combined)+ \n  tm_polygons(c(\"DEPENDENCY\", \"AGED\"),\n          style = c(\"equal\", \"quantile\"), \n          palette = list(\"Blues\", \"Greens\")) +\n  tm_layout(legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\nH2.4.6.2 By defining a group-by variable in tm_facets()\nHelpful for separating our choropleth map by regions:\n\ntm_shape(combined) +\n  tm_fill(\"DEPENDENCY\",\n          style = \"quantile\",\n          palette = \"Blues\",\n          thres.poly = 0) + \n  tm_facets(by=\"REGION_N\", \n            free.coords=TRUE, \n            drop.shapes=TRUE) +\n  tm_layout(legend.show = FALSE,\n            title.position = c(\"center\", \"center\"), \n            title.size = 20) +\n  tm_borders(alpha = 0.5)\n\nWarning: The argument drop.shapes has been renamed to drop.units, and is\ntherefore deprecated\n\n\n\n\n\n\n\n\n\n\n\nH2.4.6.3 By creating multiple standalone maps with tmap_arrange()\n\nyoungmap &lt;- tm_shape(combined)+ \n  tm_polygons(\"YOUNG\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\nagedmap &lt;- tm_shape(combined)+ \n  tm_polygons(\"AGED\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\ntmap_arrange(youngmap, agedmap, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\n\n\nH2.4.7 Mapping Spatial Objects meeting a selection criterion\nSometimes we may not have the screen real estate to create multiple small choropleth maps. In such a situation, we can use a selection function to map spatial objects meeting a selection criterion.\nIn the following code chunk, our selection function will map out the distribution of dependents in only the northeast region of the country.\n\ntm_shape(combined[combined$REGION_N==\"NORTH-EAST REGION\", ])+\n  tm_fill(\"DEPENDENCY\",\n          n = 10,\n          style = \"kmeans\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(legend.outside = TRUE,\n            legend.height = 0.45, \n            legend.width = 5.0,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\nWarning in pre_process_gt(x, interactive = interactive, orig_crs =\ngm$shape.orig_crs): legend.width controls the width of the legend within a map.\nPlease use legend.outside.size to control the width of the outside legend"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About me",
    "section": "",
    "text": "Hi there! My name is Kendrick Teo, and I’m a final-year student of Singapore Management University (SMU).\nThe purpose of this website is to document my learning journey in the course: IS415: Geospatial Analytics and Applications under professor Kam Tin Seong. Follow along with my coursework below as I explore the vast world of data analytics, geospatial analytics and urban planning.\nIf you’re liking this site so far, I would most appreciate it if you could connect with me on LinkedIn!"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "IS415: Geospatial Analytics and Applications",
    "section": "",
    "text": "Welcome, and thanks for stopping by! My name is Kendrick, and you’ve reached my portfolio website for IS415: Geospatial Analytics and Applications.\nhello_world &lt;- \"hello world!\"\nprint(hello_world)\n\n[1] \"hello world!\""
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "",
    "text": "Changelog: Since the same dataset may be required across multiple hands-on exercises, the data folder for this hands-on exercise has been moded to the root of the HandsOn directory. Correspondingly, all code chunks have been modified to reference the newly located data folder."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.4.1-importing-polygon-feature-data-in-shapefile-format",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.4.1-importing-polygon-feature-data-in-shapefile-format",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.4.1 Importing polygon feature data in shapefile format",
    "text": "H1.4.1 Importing polygon feature data in shapefile format\nThe code chunk below uses st_read() function of sf package to import the MP14_SUBZONE_WEB_PL shapefile into R as a polygon feature data frame.\n\nmp_subzone = st_read(dsn=\"../data/geospatial/MasterPlan2014SubzoneBoundaryWebSHP\", layer=\"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial/MasterPlan2014SubzoneBoundaryWebSHP' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\nThere are a total of 323 multipolygon features and 15 fields in mpsz simple feature data frame. mpsz is in svy21 projected coordinates systems. The bounding box provides the x extend and y extend of the data."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.4.2-importing-polyline-feature-data-in-shapefile-form",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.4.2-importing-polyline-feature-data-in-shapefile-form",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.4.2 Importing polyline feature data in shapefile form",
    "text": "H1.4.2 Importing polyline feature data in shapefile form\nUsing the same method as above, we now import the CyclingPath shapefile into R as a line feature data frame.\n\ncycling_paths = st_read(dsn=\"../data/geospatial/CyclingPath_Jul2024\", layer=\"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial/CyclingPath_Jul2024' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3138 features and 2 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11854.32 ymin: 28347.98 xmax: 42644.17 ymax: 48948.15\nProjected CRS: SVY21"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.4.3-importing-gis-data-in-kml-format",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.4.3-importing-gis-data-in-kml-format",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.4.3 Importing GIS data in kml format",
    "text": "H1.4.3 Importing GIS data in kml format\n\npreschool_data = st_read(\"../data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial/PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.5.1-working-with-st_geometry",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.5.1-working-with-st_geometry",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.5.1 Working with st_geometry()",
    "text": "H1.5.1 Working with st_geometry()\n\nst_geometry(mp_subzone)\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303..."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.5.2-working-with-glimpse",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.5.2-working-with-glimpse",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.5.2 Working with glimpse()",
    "text": "H1.5.2 Working with glimpse()\n\nglimpse(mp_subzone)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.5.3-working-with-head",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.5.3-working-with-head",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.5.3 Working with head()",
    "text": "H1.5.3 Working with head()\n\nhead(mp_subzone, n=10)\n\nSimple feature collection with 10 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 20660.53 ymin: 28369.47 xmax: 32362.39 ymax: 30684.55\nProjected CRS: SVY21\n   OBJECTID SUBZONE_NO       SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1         1          1    MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2         2          1    PEARL'S HILL    OTSZ01      Y          OUTRAM\n3         3          3       BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4         4          8  HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5         5          3         REDHILL    BMSZ03      N     BUKIT MERAH\n6         6          7  ALEXANDRA HILL    BMSZ07      N     BUKIT MERAH\n7         7          9   BUKIT HO SWEE    BMSZ09      N     BUKIT MERAH\n8         8          2     CLARKE QUAY    SRSZ02      Y SINGAPORE RIVER\n9         9         13 PASIR PANJANG 1    QTSZ13      N      QUEENSTOWN\n10       10          7       QUEENSWAY    QTSZ07      N      QUEENSTOWN\n   PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1          MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2          OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3          SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4          BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5          BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n6          BM CENTRAL REGION       CR 9D286521EF5E3B59 2014-12-05 25358.82\n7          BM CENTRAL REGION       CR 7839A8577144EFE2 2014-12-05 27680.06\n8          SR CENTRAL REGION       CR 48661DC0FBA09F7A 2014-12-05 29253.21\n9          QT CENTRAL REGION       CR 1F721290C421BFAB 2014-12-05 22077.34\n10         QT CENTRAL REGION       CR 3580D2AFFBEE914C 2014-12-05 24168.31\n     Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1  29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2  29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3  29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4  29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5  30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n6  29991.38   4428.913  1030378.8 MULTIPOLYGON (((25899.7 297...\n7  30230.86   3275.312   551732.0 MULTIPOLYGON (((27746.95 30...\n8  30222.86   2208.619   290184.7 MULTIPOLYGON (((29351.26 29...\n9  29893.78   6571.323  1084792.3 MULTIPOLYGON (((20996.49 30...\n10 30104.18   3454.239   631644.3 MULTIPOLYGON (((24472.11 29..."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.7.1-assigning-epsg-code-to-a-simple-feature-data-frame",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.7.1-assigning-epsg-code-to-a-simple-feature-data-frame",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.7.1 Assigning EPSG code to a simple feature data frame",
    "text": "H1.7.1 Assigning EPSG code to a simple feature data frame\nA common issue that can happen when impmorting geospatial data into R is a missing or wrongly assigned coordinate system. For example:\n\nst_crs(mp_subzone)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\nAt the end of the output, the EPSG code is displayed, and it reads 9001 (world). The correct EPSG code for the Singapore Plane Coordinate System (SVY21) should be 3414 (Singapore). As such, we need to assign the correct EPSG code using the following code chunk:\n\nmpsz_3414 &lt;- st_set_crs(mp_subzone, 3414)\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\nst_crs(mpsz_3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.7.2-transforming-the-projection-of-preschool-from-wgs84-to-svy21",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.7.2-transforming-the-projection-of-preschool-from-wgs84-to-svy21",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.7.2 Transforming the projection of preschool from wgs84 to svy21",
    "text": "H1.7.2 Transforming the projection of preschool from wgs84 to svy21\nAs noted in the above warning message upon applying st_set_crs(), simply replacing the EPSG code does not reproject the data.\nAs adapted from the course website:\n\nIn geospatial analytics, it is very common for us to transform the original data from geographic coordinate system to projected coordinate system. This is because geographic coordinate system is not appropriate if the analysis need to use distance or/and area measurements.\n\n\nst_geometry(preschool_data)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\nPOINT Z (103.8072 1.299333 0)\n\n\nPOINT Z (103.826 1.312839 0)\n\n\nPOINT Z (103.8409 1.348843 0)\n\n\nPOINT Z (103.8048 1.435024 0)\n\n\nPOINT Z (103.839 1.33315 0)\n\n\nRunning the above code reveals the preschool featureset uses the wrong wgs84 coordinate system. To fix this, instead of running st_set_crs(), we have to run st_transform() to reproject preschool from one coordinate system to another.\n\npreschool_3414 &lt;- st_transform(preschool_data, crs=3414)\nst_geometry(preschool_3414)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 11810.03 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nPOINT Z (25089.46 31299.16 0)\n\n\nPOINT Z (27189.07 32792.54 0)\n\n\nPOINT Z (28844.56 36773.76 0)\n\n\nPOINT Z (24821.92 46303.16 0)\n\n\nPOINT Z (28637.82 35038.49 0)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.8.1-importing-aspatial-airbnb-data",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.8.1-importing-aspatial-airbnb-data",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.8.1 Importing aspatial Airbnb data",
    "text": "H1.8.1 Importing aspatial Airbnb data\nJust like importing and reading data in Python’s pandas, importing aspatial data into the R/quarto environment is as easy as calling read_csv().\n\nlistings &lt;- read_csv(\"../data/aspatial/listings.csv\")\n\nRows: 3540 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (6): name, host_name, neighbourhood_group, neighbourhood, room_type, l...\ndbl  (11): id, host_id, latitude, longitude, price, minimum_nights, number_o...\ndate  (1): last_review\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nlist(listings)\n\n[[1]]\n# A tibble: 3,540 × 18\n       id name      host_id host_name neighbourhood_group neighbourhood latitude\n    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;            &lt;dbl&gt;\n 1  71609 Ensuite …  367042 Belinda   East Region         Tampines          1.35\n 2  71896 B&B  Roo…  367042 Belinda   East Region         Tampines          1.35\n 3  71903 Room 2-n…  367042 Belinda   East Region         Tampines          1.35\n 4 275343 10min wa… 1439258 Kay       Central Region      Bukit Merah       1.29\n 5 275344 15 mins … 1439258 Kay       Central Region      Bukit Merah       1.29\n 6 289234 Booking …  367042 Belinda   East Region         Tampines          1.34\n 7 294281 5 mins w… 1521514 Elizabeth Central Region      Newton            1.31\n 8 324945 Comforta… 1439258 Kay       Central Region      Bukit Merah       1.29\n 9 330095 Relaxing… 1439258 Kay       Central Region      Bukit Merah       1.29\n10 344803 Budget s…  367042 Belinda   East Region         Tampines          1.35\n# ℹ 3,530 more rows\n# ℹ 11 more variables: longitude &lt;dbl&gt;, room_type &lt;chr&gt;, price &lt;dbl&gt;,\n#   minimum_nights &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;, last_review &lt;date&gt;,\n#   reviews_per_month &lt;dbl&gt;, calculated_host_listings_count &lt;dbl&gt;,\n#   availability_365 &lt;dbl&gt;, number_of_reviews_ltm &lt;dbl&gt;, license &lt;chr&gt;"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.8.2-creating-a-simple-feature-data-frame-from-an-aspatial-data-frame",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.8.2-creating-a-simple-feature-data-frame-from-an-aspatial-data-frame",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.8.2 Creating a simple feature data frame from an aspatial data frame",
    "text": "H1.8.2 Creating a simple feature data frame from an aspatial data frame\n\nlistings_sf &lt;- st_as_sf(listings, coords = c(\"longitude\", \"latitude\"), crs=4326) %&gt;%\n    st_transform(crs=3414)\n\nThings to learn from the arguments above:\n\ncoords argument requires you to provide the column name of the x-coordinates first then followed by the column name of the y-coordinates.\ncrs argument requires you to provide the coordinates system in epsg format. EPSG: 4326 is wgs84 Geographic Coordinate System and EPSG: 3414 is Singapore’s SVY21 Projected Coordinate System. You can search for other country’s epsg code by referring to epsg.io.\n%&gt;% is used to nest st_transform() to transform the newly created simple feature data frame into the svy21 projected coordinates system.\n\n\nglimpse(listings_sf)\n\nRows: 3,540\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 28…\n$ name                           &lt;chr&gt; \"Ensuite Room (Room 1 & 2) near EXPO\", …\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; NA, 80, 80, 50, 50, NA, 85, 65, 45, 54,…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 180, 180, 92, 92, 180, 180,…\n$ number_of_reviews              &lt;dbl&gt; 19, 24, 46, 20, 16, 12, 131, 17, 5, 60,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.12, 0.15, 0.29, 0.15, 0.11, 0.08, 0.8…\n$ calculated_host_listings_count &lt;dbl&gt; 6, 6, 6, 49, 49, 6, 7, 49, 49, 6, 7, 7,…\n$ availability_365               &lt;dbl&gt; 89, 148, 90, 62, 0, 88, 365, 0, 0, 365,…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 2, 0, 0, 1, 1, 1, 0, 0, 0, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, NA, \"…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.9.1-buffering",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.9.1-buffering",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.9.1 Buffering",
    "text": "H1.9.1 Buffering\nThe scenario:\nThe authority is planning to upgrade the exiting cycling path. To do so, they need to acquire 5 metres of reserved land on the both sides of the current cycling path. You are tasked to determine the extend of the land need to be acquired and their total area.\nThe solution:\nFirstly, st_buffer() of sf package is used to compute the 5-meter buffers around cycling paths.\n\nbuffer_cycling &lt;- st_buffer(cycling_paths, dist=5, nQuadSegs=30)\n\nThen, we calculate the area of the buffers:\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\n\n…and take the sum of Base R to derive the total land needed.\n\nsum(buffer_cycling$AREA)\n\n2218855 [m^2]"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.9.2-point-in-polygon-count",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.9.2-point-in-polygon-count",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.9.2 Point-in-polygon count",
    "text": "H1.9.2 Point-in-polygon count\nThe scenario:\nA pre-school service group want to find out the numbers of pre-schools in each Planning Subzone.\nThe solution:\nThe code chunk below performs two operations at one go. Firstly, identify pre-schools located inside each Planning Subzone by using st_intersects(). Next, length() of Base R is used to calculate numbers of pre-schools that fall inside each planning subzone.\n\nmpsz_3414$`PreSch Count` &lt;- lengths(st_intersects(mpsz_3414, preschool_3414))\n\nsummary(mpsz_3414$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    4.00    7.09   10.00   72.00 \n\n\n\nWarning: Not to be confused by st_intersection().\n\ntop_n() from the dplyr package, for n = 1, is used to find the planning subzone with the greatest number of preschools:\n\ntop_n(mpsz_3414, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C\n1      189          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM\n     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\n1 EAST REGION       ER 21658EAAF84F4D8D 2014-12-05 41122.55 37392.39   10180.62\n  SHAPE_Area                       geometry PreSch Count\n1    4339824 MULTIPOLYGON (((42196.76 38...           72\n\n\n\nDIY: Calculate the density of pre-school by planning subzone.\n\nThe solution:\nFirst, use st_area() of the sf package to derive the area of each planning subzone:\n\nmpsz_3414$Area &lt;- mpsz_3414 %&gt;%\n  st_area()\n\nNext, mutate() of the dplyr package is used to compute the density by using the code chunk below.\n\nmpsz_3414 &lt;- mpsz_3414 %&gt;%\n  mutate(`PreSch Density` = `PreSch Count`/Area * 1000000)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.10.1-plotting-the-distribution-of-presch-density",
    "href": "HandsOn/Hands-on_Ex01/hands-on-1.html#h1.10.1-plotting-the-distribution-of-presch-density",
    "title": "H1: Geospatial Data Wrangling with R",
    "section": "H1.10.1 Plotting the distribution of PreSch Density",
    "text": "H1.10.1 Plotting the distribution of PreSch Density\n\nhist(mpsz_3414$`PreSch Density`)\n\n\n\n\n\n\n\n\n\nggplot(data=mpsz_3414, \n       aes(x= as.numeric(`PreSch Density`)))+\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"orange\") +\n  labs(title = \"Are preschools evenly distributed in Singapore?\",\n       subtitle= \"There are many planning sub-zones with a single preschool. On the other hand, \\nthere are two planning sub-zones with at least 20 preschools!\",\n      x = \"Pre-school density (per km^2)\",\n      y = \"Frequency\")"
  },
  {
    "objectID": "InClass/ICE1/in-class-1.html",
    "href": "InClass/ICE1/in-class-1.html",
    "title": "CE1: Geospatial Data Science",
    "section": "",
    "text": "CE1 Overview\nThe aim of this exercise is to practise loading simple featuresets (point, line, polygon, etc) with R.\n\n\nCE1.1"
  },
  {
    "objectID": "InClass/ICE1/data/MPSZ-2019.html",
    "href": "InClass/ICE1/data/MPSZ-2019.html",
    "title": "IS415 - Kendrick",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "InClass/ICE2/in-class-2.html",
    "href": "InClass/ICE2/in-class-2.html",
    "title": "CE2: Working with Master Plan Planning Subzone Data",
    "section": "",
    "text": "Create a subfolder called data in In-class_Ex02 folder\nDownload and load both the ESRI shapefile and kml file from Master Plan 2014 Subzone Boundary (Web) from the portal.\nWrite a code chunk to import Master Plan 2014 Subzone Boundary (Web) as SF simple features DataFrame.\n\n\npacman::p_load(sf, tmap, tidyverse, ggstatsplot)\n\nmp_subzone_14_shp &lt;- st_read(dsn=\"data/MasterPlan2014SubzoneBoundaryWebSHP\", layer=\"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/InClass/ICE2/data/MasterPlan2014SubzoneBoundaryWebSHP' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\nclass(mp_subzone_14_shp)\n\n[1] \"sf\"         \"data.frame\"\n\n#! eval:false\n# Doesn't work!\ntryCatch({mp_subzone_kml &lt;- st_read(\"data/MasterPlan2014SubzoneBoundaryWebKML.kml\")}, error=function(e) {\n  print(e)\n  print(\"Cannot load!\")\n  })\n\n&lt;Rcpp::exception: Cannot open \"/Users/kendricktty/Gits/smu_cs/is415-site/InClass/ICE2/data/MasterPlan2014SubzoneBoundaryWebKML.kml\"; The source could be corrupt or not supported. See `st_drivers()` for a list of supported formats.&gt;\n[1] \"Cannot load!\"\n\n# So we need to write our own KML file.\nst_write(mp_subzone_14_shp, \"data/WORKINGMasterPlan2014SubzoneBoundaryWebKML.kml\", delete_dsn=TRUE)\n\nDeleting source `data/WORKINGMasterPlan2014SubzoneBoundaryWebKML.kml' using driver `KML'\nWriting layer `WORKINGMasterPlan2014SubzoneBoundaryWebKML' to data source \n  `data/WORKINGMasterPlan2014SubzoneBoundaryWebKML.kml' using driver `KML'\nWriting 323 features with 15 fields and geometry type Multi Polygon.\n\n# delete_dsn replaces the file with our new one if its already exists"
  },
  {
    "objectID": "InClass/ICE2/in-class-2.html#ce2.1-working-with-masterplan-2014-subzone-data",
    "href": "InClass/ICE2/in-class-2.html#ce2.1-working-with-masterplan-2014-subzone-data",
    "title": "CE2: Working with Master Plan Planning Subzone Data",
    "section": "",
    "text": "Create a subfolder called data in In-class_Ex02 folder\nDownload and load both the ESRI shapefile and kml file from Master Plan 2014 Subzone Boundary (Web) from the portal.\nWrite a code chunk to import Master Plan 2014 Subzone Boundary (Web) as SF simple features DataFrame.\n\n\npacman::p_load(sf, tmap, tidyverse, ggstatsplot)\n\nmp_subzone_14_shp &lt;- st_read(dsn=\"data/MasterPlan2014SubzoneBoundaryWebSHP\", layer=\"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/InClass/ICE2/data/MasterPlan2014SubzoneBoundaryWebSHP' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\nclass(mp_subzone_14_shp)\n\n[1] \"sf\"         \"data.frame\"\n\n#! eval:false\n# Doesn't work!\ntryCatch({mp_subzone_kml &lt;- st_read(\"data/MasterPlan2014SubzoneBoundaryWebKML.kml\")}, error=function(e) {\n  print(e)\n  print(\"Cannot load!\")\n  })\n\n&lt;Rcpp::exception: Cannot open \"/Users/kendricktty/Gits/smu_cs/is415-site/InClass/ICE2/data/MasterPlan2014SubzoneBoundaryWebKML.kml\"; The source could be corrupt or not supported. See `st_drivers()` for a list of supported formats.&gt;\n[1] \"Cannot load!\"\n\n# So we need to write our own KML file.\nst_write(mp_subzone_14_shp, \"data/WORKINGMasterPlan2014SubzoneBoundaryWebKML.kml\", delete_dsn=TRUE)\n\nDeleting source `data/WORKINGMasterPlan2014SubzoneBoundaryWebKML.kml' using driver `KML'\nWriting layer `WORKINGMasterPlan2014SubzoneBoundaryWebKML' to data source \n  `data/WORKINGMasterPlan2014SubzoneBoundaryWebKML.kml' using driver `KML'\nWriting 323 features with 15 fields and geometry type Multi Polygon.\n\n# delete_dsn replaces the file with our new one if its already exists"
  },
  {
    "objectID": "InClass/ICE2/in-class-2.html#ce2.2-working-with-masterplan-2019-subzone-data",
    "href": "InClass/ICE2/in-class-2.html#ce2.2-working-with-masterplan-2019-subzone-data",
    "title": "CE2: Working with Master Plan Planning Subzone Data",
    "section": "CE2.2 Working with Masterplan 2019 Subzone Data",
    "text": "CE2.2 Working with Masterplan 2019 Subzone Data\n\nmp_subzone_19_shp &lt;- st_read(dsn=\"data/MPSZ-2019\", layer=\"MPSZ-2019\")\n\nReading layer `MPSZ-2019' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/InClass/ICE2/data/MPSZ-2019' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\nmp_subzone_19_kml &lt;- st_read(\"data/MasterPlan2019SubzoneBoundaryNoSeaKML.kml\")\n\nReading layer `URA_MP19_SUBZONE_NO_SEA_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/InClass/ICE2/data/MasterPlan2019SubzoneBoundaryNoSeaKML.kml' \n  using driver `KML'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY, XYZ\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "InClass/ICE2/in-class-2.html#ce2.3-transforming-coordinate-data-from-wgs84-to-svy21",
    "href": "InClass/ICE2/in-class-2.html#ce2.3-transforming-coordinate-data-from-wgs84-to-svy21",
    "title": "CE2: Working with Master Plan Planning Subzone Data",
    "section": "CE2.3 Transforming coordinate data from WGS84 to SVY21",
    "text": "CE2.3 Transforming coordinate data from WGS84 to SVY21\n\nmp_subzone_19_shp &lt;- mp_subzone_19_shp %&gt;% st_transform(crs = 3414)\nst_crs(mp_subzone_19_shp)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]"
  },
  {
    "objectID": "InClass/ICE2/in-class-2.html#ce2.4-working-with-population-data",
    "href": "InClass/ICE2/in-class-2.html#ce2.4-working-with-population-data",
    "title": "CE2: Working with Master Plan Planning Subzone Data",
    "section": "CE2.4 Working with Population Data",
    "text": "CE2.4 Working with Population Data\n\npopulation_2023 &lt;- read_csv(\"data/respopagesextod2023/respopagesextod2023.csv\")\n\nRows: 100928 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): PA, SZ, AG, Sex, TOD\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nprint(\"Columns of population_2023\")\n\n[1] \"Columns of population_2023\"\n\ncolnames(population_2023)\n\n[1] \"PA\"   \"SZ\"   \"AG\"   \"Sex\"  \"TOD\"  \"Pop\"  \"Time\"\n\nprint(\"Head of population_2023\")\n\n[1] \"Head of population_2023\"\n\nhead(population_2023)\n\n# A tibble: 6 × 7\n  PA         SZ                     AG     Sex   TOD                   Pop  Time\n  &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;\n1 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 1- and 2-Room …     0  2023\n2 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 3-Room Flats        0  2023\n3 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 4-Room Flats       10  2023\n4 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 5-Room and Exe…    30  2023\n5 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HUDC Flats (exclud…     0  2023\n6 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males Condominiums and O…    40  2023"
  },
  {
    "objectID": "InClass/ICE2/data/MPSZ-2019/MPSZ-2019.html",
    "href": "InClass/ICE2/data/MPSZ-2019/MPSZ-2019.html",
    "title": "IS415 - Kendrick",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "InClass/ICE2/in-class-2.html#ce2.5-group-data-by-planning-area-and-subzone",
    "href": "InClass/ICE2/in-class-2.html#ce2.5-group-data-by-planning-area-and-subzone",
    "title": "CE2: Working with Master Plan Planning Subzone Data",
    "section": "CE2.5 Group data by planning area and subzone",
    "text": "CE2.5 Group data by planning area and subzone\n\npopulation_2023_pivot &lt;- population_2023 %&gt;%\n  group_by(PA, SZ, AG) %&gt;%\n  summarise(`POP`=sum(`Pop`)) %&gt;%\n  ungroup() %&gt;%\n  pivot_wider(names_from=AG, values_from=POP)\n\n`summarise()` has grouped output by 'PA', 'SZ'. You can override using the\n`.groups` argument.\n\ncolnames(population_2023)\n\n[1] \"PA\"   \"SZ\"   \"AG\"   \"Sex\"  \"TOD\"  \"Pop\"  \"Time\"\n\n# Read the data structure carefully before proceeding!"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "",
    "text": "Notes for grading: For week 3, the requirement is to complete both chapters 4 and 5 in the R for Geospatial Data Science and Analytics course website. Both have been combined into a single webpage for brevity."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.1-overview",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.1-overview",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.1 Overview",
    "text": "H3.1 Overview\nSpatial Point Pattern Analysis serves to evaluate the pattern or distribution of a set of points on a map surface. These points serve many purposes, ranging from mapping events like crimes and disease onset (like John Snow’s map of the 1854 Broad Street cholera outbreak), or the locations of business services or facilities.\nUsing appropriate functions, this hands-on exercise aims to discover the spatial point patterns of a quintessential facility in 2020s Singapore - childcare centres. Specifically, we want to find out:\n\nif these are randomly distributed throughout the country, and;\nthe planning areas with the highest concentration of childcare centres."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.2-the-data",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.2-the-data",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.2 The data",
    "text": "H3.2 The data\nThe datasets to be used are:\n\nMP14_SUBZONE_WEB_PL, containing polygon features.\nCoastalOutline, a new dataset containing polygon features showing the boundaries of Singapore. It is provided by SLA in ESRI shapefile format.\n\nIn addition, our childcare centre data will, as always, be sourced from the Singapore government’s data lake at data.gov.sg. These will take the form of point feature data."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.3-installing-and-loading-r-packages",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.3-installing-and-loading-r-packages",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.3 Installing and Loading R packages",
    "text": "H3.3 Installing and Loading R packages\nAlong with the usual sf and tmap, three new packages will be used. They are:\n\nspatstat, which includes a wide range of useful functions for first and second order spatial point patterns analysis, and to derive the kernel density estimation (KDE) layer.\nraster reads, writes, manipulates, analyses and models (i.e. rasters) gridded spatial data.\nmaptools, which is for manipulating geographic data.\n\n\npacman::p_load(sf, raster, spatstat, tmap, tidyverse)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.4-spatial-data-wrangling",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.4-spatial-data-wrangling",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.4 Spatial Data Wrangling",
    "text": "H3.4 Spatial Data Wrangling\n\nH3.4.1 Importing spatial data\nHere, we import the data we need and plot basic maps to get a basic sense of the spatial patterns we are dealing with.\n\nmpsz_sf &lt;- st_read(dsn=\"../data/geospatial/MasterPlan2014SubzoneBoundaryWebSHP\", layer=\"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial/MasterPlan2014SubzoneBoundaryWebSHP' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\nsg_sf &lt;- st_read(dsn=\"../data/geospatial/CoastalOutline\", layer=\"CostalOutline\")\n\nReading layer `CostalOutline' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial/CoastalOutline' \n  using driver `ESRI Shapefile'\nSimple feature collection with 60 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 2663.926 ymin: 16357.98 xmax: 56047.79 ymax: 50244.03\nProjected CRS: SVY21\n\nchildcare_sf &lt;- st_read(\"../data/geospatial/child-care-services-geojson.geojson\") %&gt;% st_transform(crs=3414)\n\nReading layer `child-care-services-geojson' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial/child-care-services-geojson.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 1545 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6824 ymin: 1.248403 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\ntm_shape(mpsz_sf) + tm_polygons() + tm_shape(childcare_sf) + tm_dots() + tm_layout(title = 'Childcare Centres')\n\n\n\n\n\n\n\n\nAlternatively, we can prepare a pin map as below.\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(childcare_sf) + tm_dots() + tm_layout(title = 'Childcare Centres')\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting"
  },
  {
    "objectID": "InClass/ICE2/in-class-2.html#ce2.6-data-wrangling",
    "href": "InClass/ICE2/in-class-2.html#ce2.6-data-wrangling",
    "title": "CE2: Working with Master Plan Planning Subzone Data",
    "section": "CE2.6 Data Wrangling",
    "text": "CE2.6 Data Wrangling\n\npopulation_2023_pivot &lt;- population_2023_pivot %&gt;%\n    # As young boys in Singapore serve 2 years of national service, the earliest age to be considered economically active should be 25.\n    mutate(`YOUNG` = rowSums(.[3:6]) + rowSums(.[14])) %&gt;%\n    # By 2026, the retirement age in Singapore will be raised to 64.\n    mutate(`ECONOMY ACTIVE` = rowSums(.[7:13]) + rowSums(.[15])) %&gt;%\n    mutate(`AGED` = rowSums(.[16:21])) %&gt;%\n    mutate(`TOTAL` = rowSums(.[3:21])) %&gt;%\n    mutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n    / `ECONOMY ACTIVE`) %&gt;%\n    # mutate(): Perform calculation or conversion\n    select(\n        `PA`, `SZ`, `YOUNG`,\n        `ECONOMY ACTIVE`, `AGED`,\n        `TOTAL`, `DEPENDENCY`\n    ) %&gt;% \n    mutate_at(.vars = vars(PA, SZ), .funs = list(toupper)) %&gt;%\n    filter(`ECONOMY ACTIVE` &gt; 0)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.5-geospatial-data-wrangling",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.5-geospatial-data-wrangling",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.5 Geospatial Data Wrangling",
    "text": "H3.5 Geospatial Data Wrangling\nSome geospatial analysis packages require that any input geospatial data be represented with sp’s Spatial* classes. This section introduces a way to convert simple feature data into the Spatial* class.\n\nH3.5.1 Converting sf data frames to Spatial* class\n\nchildcare &lt;- as_Spatial(childcare_sf)\nmpsz &lt;- as_Spatial(mpsz_sf)\nsg &lt;- as_Spatial(sg_sf)\n\nchildcare\n\nclass       : SpatialPointsDataFrame \nfeatures    : 1545 \nextent      : 11203.01, 45404.24, 25667.6, 49300.88  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 2\nnames       :    Name,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Description \nmin values  :   kml_1, &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;018989&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;1, MARINA BOULEVARD, #B1 - 01, ONE MARINA BOULEVARD, SINGAPORE 018989&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;0&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;0&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;THE LITTLE SKOOL-HOUSE INTERNATIONAL PTE. LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;08F73931F4A691F4&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20200826094036&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt; \nmax values  : kml_999,                  &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;829646&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;200, PONGGOL SEVENTEENTH AVENUE, SINGAPORE 829646&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Child Care Services&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;0&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;0&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;RAFFLES KIDZ @ PUNGGOL PTE LTD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;379D017BF244B0FA&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20200826094036&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt; \n\nmpsz\n\nclass       : SpatialPolygonsDataFrame \nfeatures    : 323 \nextent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs \nvariables   : 15\nnames       : OBJECTID, SUBZONE_NO, SUBZONE_N, SUBZONE_C, CA_IND, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C,          INC_CRC, FMEL_UPD_D,     X_ADDR,     Y_ADDR,    SHAPE_Leng,    SHAPE_Area \nmin values  :        1,          1, ADMIRALTY,    AMSZ01,      N, ANG MO KIO,         AM, CENTRAL REGION,       CR, 00F5E30B5C9B7AD8,      16409,  5092.8949,  19579.069, 871.554887798, 39437.9352703 \nmax values  :      323,         17,    YUNNAN,    YSSZ09,      Y,     YISHUN,         YS,    WEST REGION,       WR, FFCCF172717C2EAF,      16409, 50424.7923, 49552.7904, 68083.9364708,  69748298.792 \n\nsg\n\nclass       : SpatialPolygonsDataFrame \nfeatures    : 60 \nextent      : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs \nvariables   : 4\nnames       : GDO_GID, MSLINK, MAPID,              COSTAL_NAM \nmin values  :       1,      1,     0,             ISLAND LINK \nmax values  :      60,     67,     0, SINGAPORE - MAIN ISLAND \n\n\n\n\nH3.5.2 Converting Spatial* into generic sp format\nspatstat requires the analytical data to be in ppp object form. There is no direct way to convert a Spatial* class into a ppp object. We need to convert it into a Spatial object first.\n\nchildcare_sp &lt;- as(childcare, \"SpatialPoints\")\nchildcare_sp\n\nclass       : SpatialPoints \nfeatures    : 1545 \nextent      : 11203.01, 45404.24, 25667.6, 49300.88  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \n\nsg_sp &lt;- as(sg, \"SpatialPolygons\")\nsg_sp\n\nclass       : SpatialPolygons \nfeatures    : 60 \nextent      : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs \n\n\nOne major difference that can observed between a Spatial class object and generic sp object is the variables, names, min values and max values attributes, which are absent in the latter.\n\n\nH3.5.3 Converting generic sp format into ppp format\n\nchildcare_ppp &lt;- as.ppp(childcare_sf)\n\nWarning in as.ppp.sf(childcare_sf): only first attribute column is used for\nmarks\n\nchildcare_ppp\n\nMarked planar point pattern: 1545 points\nmarks are of storage type  'character'\nwindow: rectangle = [11203.01, 45404.24] x [25667.6, 49300.88] units\n\nplot(childcare_ppp)\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 1545 symbols are shown in the symbol map\n\n\n\n\n\n\n\n\nsummary(childcare_ppp)\n\nMarked planar point pattern:  1545 points\nAverage intensity 1.91145e-06 points per square unit\n\nCoordinates are given to 11 decimal places\n\nmarks are of type 'character'\nSummary:\n   Length     Class      Mode \n     1545 character character \n\nWindow: rectangle = [11203.01, 45404.24] x [25667.6, 49300.88] units\n                    (34200 x 23630 units)\nWindow area = 808287000 square units"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.5.4-handling-duplicates",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.5.4-handling-duplicates",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.5.4 Handling duplicates",
    "text": "H3.5.4 Handling duplicates\nIn spatial point patterns analysis, as is data analytics in general, an issue of significance is the presence of duplicates. These need to be handled, since it is assumed that the points cannot be coincident.\nIn this section, we will:\n\nCheck for duplicated points in our childcare_ppp object;\nCount the number of coincidence points with the multiplicity() function;\nFind the number of locations with more than one point event;\nView the locations of duplicated point events on a map plot;\nPerform jittering, which will add a small perturbation to the duplicate points so that they do not occupy the exact same space.\n\n\n# Check for duplication\nany(duplicated(childcare_ppp))\n\n[1] FALSE\n\n# Find multiplicity\nmultiplicity &lt;- multiplicity(childcare_ppp)\nmultiplicity\n\n   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [223] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [260] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [297] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [334] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [371] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [408] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [445] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [482] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [519] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [556] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [593] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [630] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [667] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [704] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [741] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [778] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [815] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [852] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [889] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [926] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [963] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1000] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1037] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1074] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1111] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1148] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1185] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1222] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1259] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1296] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1333] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1370] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1407] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1444] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1481] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1518] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n\n# Print the number of locations with more than 1 point event\nsum(multiplicity &gt; 1)\n\n[1] 0\n\n\nWe can conclude from the above that there are no duplicates in the data.\n\n# Find the locations of duplicate point events\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(childcare) +\n  tm_dots(alpha=0.4, \n          size=0.05)\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n# Perform jittering\nchildcare_ppp_jit &lt;- rjitter(childcare_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\nany(duplicated(childcare_ppp_jit))\n\n[1] FALSE\n\n\nJittering is one of three ways to deal with missing geospatial data, the others being to make each point “unique” and then attach the duplicate attributes as marks (which would be more complex), or simply remove the data (which might lead to the loss of other important attributes).\n\nH3.5.5 Creating an owin object\nWhen analysing spatial point patterns, it is a good practice to confine the analysis within a geographical area, such as the national boundary of Singapore. In spatstat, owin is specifically designed to represent this polygonal region and can be defined and output as such:\n\nsg_owin &lt;- as.owin(sg_sf)\nplot(sg_owin)\n\n\n\n\n\n\n\nsummary(sg_owin)\n\nWindow: polygonal boundary\n50 separate polygons (1 hole)\n                 vertices         area relative.area\npolygon 1 (hole)       30     -7081.18     -9.76e-06\npolygon 2              55     82537.90      1.14e-04\npolygon 3              90    415092.00      5.72e-04\npolygon 4              49     16698.60      2.30e-05\npolygon 5              38     24249.20      3.34e-05\npolygon 6             976  23344700.00      3.22e-02\npolygon 7             721   1927950.00      2.66e-03\npolygon 8            1992   9992170.00      1.38e-02\npolygon 9             330   1118960.00      1.54e-03\npolygon 10            175    925904.00      1.28e-03\npolygon 11            115    928394.00      1.28e-03\npolygon 12             24      6352.39      8.76e-06\npolygon 13            190    202489.00      2.79e-04\npolygon 14             37     10170.50      1.40e-05\npolygon 15             25     16622.70      2.29e-05\npolygon 16             10      2145.07      2.96e-06\npolygon 17             66     16184.10      2.23e-05\npolygon 18           5195 636837000.00      8.78e-01\npolygon 19             76    312332.00      4.31e-04\npolygon 20            627  31891300.00      4.40e-02\npolygon 21             20     32842.00      4.53e-05\npolygon 22             42     55831.70      7.70e-05\npolygon 23             67   1313540.00      1.81e-03\npolygon 24            734   4690930.00      6.47e-03\npolygon 25             16      3194.60      4.40e-06\npolygon 26             15      4872.96      6.72e-06\npolygon 27             15      4464.20      6.15e-06\npolygon 28             14      5466.74      7.54e-06\npolygon 29             37      5261.94      7.25e-06\npolygon 30            111    662927.00      9.14e-04\npolygon 31             69     56313.40      7.76e-05\npolygon 32            143    145139.00      2.00e-04\npolygon 33            397   2488210.00      3.43e-03\npolygon 34             90    115991.00      1.60e-04\npolygon 35             98     62682.90      8.64e-05\npolygon 36            165    338736.00      4.67e-04\npolygon 37            130     94046.50      1.30e-04\npolygon 38             93    430642.00      5.94e-04\npolygon 39             16      2010.46      2.77e-06\npolygon 40            415   3253840.00      4.49e-03\npolygon 41             30     10838.20      1.49e-05\npolygon 42             53     34400.30      4.74e-05\npolygon 43             26      8347.58      1.15e-05\npolygon 44             74     58223.40      8.03e-05\npolygon 45            327   2169210.00      2.99e-03\npolygon 46            177    467446.00      6.44e-04\npolygon 47             46    699702.00      9.65e-04\npolygon 48              6     16841.00      2.32e-05\npolygon 49             13     70087.30      9.66e-05\npolygon 50              4      9459.63      1.30e-05\nenclosing rectangle: [2663.93, 56047.79] x [16357.98, 50244.03] units\n                     (53380 x 33890 units)\nWindow area = 725376000 square units\nFraction of frame area: 0.401\n\n\n\n\nH3.5.6 Combining point events and owin objects\nFinally, we can extract our childcare centre “events” and combine them with the owin object as such:\n\nchildcare_SG_ppp = childcare_ppp[sg_owin]\nplot(childcare_SG_ppp)\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 1545 symbols are shown in the symbol map\n\n\n\n\n\n\n\n\nsummary(childcare_SG_ppp)\n\nMarked planar point pattern:  1545 points\nAverage intensity 2.129929e-06 points per square unit\n\nCoordinates are given to 11 decimal places\n\nmarks are of type 'character'\nSummary:\n   Length     Class      Mode \n     1545 character character \n\nWindow: polygonal boundary\n50 separate polygons (1 hole)\n                 vertices         area relative.area\npolygon 1 (hole)       30     -7081.18     -9.76e-06\npolygon 2              55     82537.90      1.14e-04\npolygon 3              90    415092.00      5.72e-04\npolygon 4              49     16698.60      2.30e-05\npolygon 5              38     24249.20      3.34e-05\npolygon 6             976  23344700.00      3.22e-02\npolygon 7             721   1927950.00      2.66e-03\npolygon 8            1992   9992170.00      1.38e-02\npolygon 9             330   1118960.00      1.54e-03\npolygon 10            175    925904.00      1.28e-03\npolygon 11            115    928394.00      1.28e-03\npolygon 12             24      6352.39      8.76e-06\npolygon 13            190    202489.00      2.79e-04\npolygon 14             37     10170.50      1.40e-05\npolygon 15             25     16622.70      2.29e-05\npolygon 16             10      2145.07      2.96e-06\npolygon 17             66     16184.10      2.23e-05\npolygon 18           5195 636837000.00      8.78e-01\npolygon 19             76    312332.00      4.31e-04\npolygon 20            627  31891300.00      4.40e-02\npolygon 21             20     32842.00      4.53e-05\npolygon 22             42     55831.70      7.70e-05\npolygon 23             67   1313540.00      1.81e-03\npolygon 24            734   4690930.00      6.47e-03\npolygon 25             16      3194.60      4.40e-06\npolygon 26             15      4872.96      6.72e-06\npolygon 27             15      4464.20      6.15e-06\npolygon 28             14      5466.74      7.54e-06\npolygon 29             37      5261.94      7.25e-06\npolygon 30            111    662927.00      9.14e-04\npolygon 31             69     56313.40      7.76e-05\npolygon 32            143    145139.00      2.00e-04\npolygon 33            397   2488210.00      3.43e-03\npolygon 34             90    115991.00      1.60e-04\npolygon 35             98     62682.90      8.64e-05\npolygon 36            165    338736.00      4.67e-04\npolygon 37            130     94046.50      1.30e-04\npolygon 38             93    430642.00      5.94e-04\npolygon 39             16      2010.46      2.77e-06\npolygon 40            415   3253840.00      4.49e-03\npolygon 41             30     10838.20      1.49e-05\npolygon 42             53     34400.30      4.74e-05\npolygon 43             26      8347.58      1.15e-05\npolygon 44             74     58223.40      8.03e-05\npolygon 45            327   2169210.00      2.99e-03\npolygon 46            177    467446.00      6.44e-04\npolygon 47             46    699702.00      9.65e-04\npolygon 48              6     16841.00      2.32e-05\npolygon 49             13     70087.30      9.66e-05\npolygon 50              4      9459.63      1.30e-05\nenclosing rectangle: [2663.93, 56047.79] x [16357.98, 50244.03] units\n                     (53380 x 33890 units)\nWindow area = 725376000 square units\nFraction of frame area: 0.401"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.6-first-order-spatial-point-patterns-analysis",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.6-first-order-spatial-point-patterns-analysis",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.6 First Order Spatial Point Patterns Analysis",
    "text": "H3.6 First Order Spatial Point Patterns Analysis\nSpatial point patterns analysis (SPPA) is the study of the spatial arrangements of points in (typically) 2D space. In this section, we will perform first order SPPA using spatstat. In particular, we will:\n\nderive the kernel density estimation (KDE) layer for visualising and exploring the intensity of point processes, and;\nperforming confirmatory spatial point patterns analysis using nearest neighbour statistics.\n\n\nH3.6.1 Kernel Density Estimation\nKernel density estimation (KDE) serves to compute the intensity of a point distribution. It has two general steps: first to compute the point intensity, followed by spatial interpolation using a kernel function (to create distributions like a uniform, triangular, quartic or gaussian distribution). In this exercise, we will mostly use the gaussian kernel.\n\nH3.6.1.1 Computing KDE using automatic bandwidth selection\n\nkde_childcareSG_bw &lt;- density(childcare_SG_ppp,\n                              sigma=bw.diggle,\n                              edge=TRUE,\n                            kernel=\"gaussian\")\nplot(kde_childcareSG_bw)\n\n\n\n\n\n\n\n\nAs we can see, the range of our density values is between 0 and 35*10-4, which is way too small for us. This is because svy21 uses metres by default, which means the density values to be computed will be the number of points per square metre.\nWe will therefore need to rescale our KDE values. Before we move on though, it is good to know that the following code chunk will retrieve us the bandwidth used to compute the KDE layer.\n\nbw &lt;- bw.diggle(childcare_SG_ppp)\nbw\n\n   sigma \n298.4095 \n\n\n\n\nH3.6.1.2 Rescaling KDE values\nTo rescale our KDE values, we can convert the unit of measurement into kilometres, and then re-run density() and plot the output map to see the result.\n\nchildcareSG_ppp.km &lt;- rescale.ppp(childcare_SG_ppp, 1000, \"km\")\nkde_childcareSG.bw &lt;- density(childcareSG_ppp.km, sigma=bw.diggle, edge=TRUE, kernel=\"gaussian\")\nplot(kde_childcareSG.bw)\n\n\n\n\n\n\n\n\nWe now have a much more readable density map.\n\n\n\nH3.6.2 Working with different automatic bandwidth methods\nOther than bw.diggle(), bw.CvL(), bw.scott() and bw.ppl may be used to determine the bandwidth.\n\nbw.diggle(childcareSG_ppp.km)\n\n    sigma \n0.2984095 \n\nbw.scott(childcareSG_ppp.km)\n\n sigma.x  sigma.y \n2.224898 1.450966 \n\nbw.CvL(childcareSG_ppp.km)\n\n   sigma \n4.543278 \n\nbw.ppl(childcareSG_ppp.km)\n\n    sigma \n0.3897114 \n\n\nWe can also plot different maps to compare the output of different bandwidth methods.\n\nkde_childcareSG.ppl &lt;- density(childcareSG_ppp.km, \n                               sigma=bw.ppl, \n                               edge=TRUE,\n                               kernel=\"gaussian\")\npar(mfrow=c(1,2))\nplot(kde_childcareSG.bw, main = \"bw.diggle\")\nplot(kde_childcareSG.ppl, main = \"bw.ppl\")\n\n\n\n\n\n\n\n\n\n\nH3.6.3 Working with different kernel methods\nAs mentioned, there are different kernel methods to give us different distributions. The code chunk below compares the results of three other kernel methods than gaussian, and computes additional kernel density estimations.\n\npar(mfrow=c(2,2))\nplot(density(childcareSG_ppp.km, \n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"Gaussian\")\nplot(density(childcareSG_ppp.km, \n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"epanechnikov\"), \n     main=\"Epanechnikov\")\n\nWarning in density.ppp(childcareSG_ppp.km, sigma = bw.ppl, edge = TRUE, :\nBandwidth selection will be based on Gaussian kernel\n\nplot(density(childcareSG_ppp.km, \n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"quartic\"), \n     main=\"Quartic\")\n\nWarning in density.ppp(childcareSG_ppp.km, sigma = bw.ppl, edge = TRUE, :\nBandwidth selection will be based on Gaussian kernel\n\nplot(density(childcareSG_ppp.km, \n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"disc\"), \n     main=\"Disc\")\n\nWarning in density.ppp(childcareSG_ppp.km, sigma = bw.ppl, edge = TRUE, :\nBandwidth selection will be based on Gaussian kernel"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.7-fixed-and-adaptive-kde",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.7-fixed-and-adaptive-kde",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.7 Fixed and adaptive KDE",
    "text": "H3.7 Fixed and adaptive KDE\n\nH3.7.1 Computing KDE using fixed bandwidth\nAnother way to compute a KDE layer is by defining a fixed bandwidth. The code chunk below defines a bandwidth (sigma) of 600m (0.6km).\n\nkde_childcareSG_600 &lt;- density(childcareSG_ppp.km, sigma=0.6, edge=TRUE, kernel=\"gaussian\")\nplot(kde_childcareSG_600)\n\n\n\n\n\n\n\n\n\n\nH3.7.2 Computing KDE using adaptive bandwidth\nThe fixed bandwidth method is sensitive to skewed distributions of spatial point patterns (for instance, if a large number of points is clustered in one area, say an urban area, instead of another, like a rural area.) Adaptive bandwidth, using density.adaptive(), is one way to overcome this problem.\n\nkde_childcareSG_adaptive &lt;- adaptive.density(childcareSG_ppp.km, method=\"kernel\")\nplot(kde_childcareSG_adaptive)\n\n\n\n\n\n\n\n\nTwo KDE outputs may be compared as follows.\n\npar(mfrow=c(1,2))\nplot(kde_childcareSG.bw, main = \"Fixed bandwidth\")\nplot(kde_childcareSG_adaptive, main = \"Adaptive bandwidth\")\n\n\n\n\n\n\n\n\n\n\nH3.7.3 Converting KDE outputs into grid objects\nFor mapping purposes.\n\ngridded_kde_childcareSG_bw &lt;- as(kde_childcareSG.bw, \"SpatialGridDataFrame\")\nspplot(gridded_kde_childcareSG_bw)\n\n\n\n\n\n\n\n\n\n\nH3.7.3.1 Converting gridded output into RasterLayer\n\nkde_childcareSG_bw_raster &lt;- raster(kde_childcareSG.bw)\nkde_childcareSG_bw_raster\n\nclass      : RasterLayer \ndimensions : 128, 128, 16384  (nrow, ncol, ncell)\nresolution : 0.4170614, 0.2647348  (x, y)\nextent     : 2.663926, 56.04779, 16.35798, 50.24403  (xmin, xmax, ymin, ymax)\ncrs        : NA \nsource     : memory\nnames      : layer \nvalues     : -8.476185e-15, 28.51831  (min, max)\n\n\n\n\nH3.7.3.2 Assigning projection system\nNotice that the crs attribute is NA, indicating that no coordinate system has been assigned to the raster. We will fix this by adding the WSY21 (Singapore) CRS to our RasterLayer.\n\nprojection(kde_childcareSG_bw_raster) &lt;- CRS(\"+init=EPSG:3414\")\nkde_childcareSG_bw_raster\n\nclass      : RasterLayer \ndimensions : 128, 128, 16384  (nrow, ncol, ncell)\nresolution : 0.4170614, 0.2647348  (x, y)\nextent     : 2.663926, 56.04779, 16.35798, 50.24403  (xmin, xmax, ymin, ymax)\ncrs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs \nsource     : memory\nnames      : layer \nvalues     : -8.476185e-15, 28.51831  (min, max)\n\n\n\n\nH3.7.4 Visualising output in tmap\nFinally, we can display the raster in cartographic quality using tmap.\n\ntm_shape(kde_childcareSG_bw_raster) + \n  tm_raster(\"layer\", palette = \"viridis\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\"), frame = FALSE)\n\n\n\n\n\n\n\n\nWith all the work we have done so far, a quick glance at the maps indicates a higher than usual density of childcare centres in the areas of Woodlands South and Punggol (the yellow patches in the above tmap display).\n\n\nH3.7.5 Comparing Spatial Point Patterns using KDE\nAnd now for the fun part - comparing KDEs between regions. In this section, we will compare the density estimations of childcare centres located in the planning areas of Choa Chu Kang, Jurong West, Punggol and Tampines.\n\nH3.7.5.1 Extracting and plotting study areas\n\n# First, extract the target planning areas\n\npunggol &lt;- mpsz_sf %&gt;%\n  filter(PLN_AREA_N == \"PUNGGOL\")\ntampines &lt;- mpsz_sf %&gt;%\n  filter(PLN_AREA_N == \"TAMPINES\")\nchoa_chu_kang &lt;- mpsz_sf %&gt;%\n  filter(PLN_AREA_N == \"CHOA CHU KANG\")\njurong_west &lt;- mpsz_sf %&gt;%\n  filter(PLN_AREA_N == \"JURONG WEST\")\n\n# Then, visualise the areas with a plot\npar(mfrow=c(2,2))\nplot(punggol, main = \"Punggol\")\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\nplot(tampines, main = \"Tampines\")\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\nplot(choa_chu_kang, main = \"Choa Chu Kang\")\n\nWarning: plotting the first 10 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\nplot(jurong_west, main = \"Jurong West\")\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\n\n\nH3.7.5.2 Creating owin object\n\npg_owin &lt;- as.owin(punggol)\ntm_owin &lt;- as.owin(tampines)\nck_owin &lt;- as.owin(choa_chu_kang)\njw_owin &lt;- as.owin(jurong_west)\n\n\n\nH3.7.5.3 Combining childcare points and the study area\nThe code chunk below completes the following 3 tasks. First, we extract the childcare region for each of our four study areas. Next, we transform the unit of measurement from metres to kilometres. Finally, we can plot the locations of childcare centres within the four study areas.\n\nchildcare_pg_ppp &lt;- childcare_ppp_jit[pg_owin]\nchildcare_tm_ppp &lt;- childcare_ppp_jit[tm_owin]\nchildcare_ck_ppp &lt;- childcare_ppp_jit[ck_owin]\nchildcare_jw_ppp &lt;- childcare_ppp_jit[jw_owin]\n\nchildcare_pg_ppp.km &lt;- rescale.ppp(childcare_pg_ppp, 1000, \"km\")\nchildcare_tm_ppp.km &lt;- rescale.ppp(childcare_tm_ppp, 1000, \"km\")\nchildcare_ck_ppp.km &lt;- rescale.ppp(childcare_ck_ppp, 1000, \"km\")\nchildcare_jw_ppp.km &lt;- rescale.ppp(childcare_jw_ppp, 1000, \"km\")\n\npar(mfrow=c(2,2))\nplot(childcare_pg_ppp.km, main=\"Childcare centres in Punggol\")\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 61 symbols are shown in the symbol map\n\nplot(childcare_tm_ppp.km, main=\"Childcare centres in Tampines\")\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 89 symbols are shown in the symbol map\n\nplot(childcare_ck_ppp.km, main=\"Childcare centres in Choa Chu Kang\")\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 61 symbols are shown in the symbol map\n\nplot(childcare_jw_ppp.km, main=\"Childcare centres in Jurong West\")\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 88 symbols are shown in the symbol map\n\n\n\n\n\n\n\n\n\n\n\nH3.7.5.4 Computing KDE\nFinally, we can compute the KDE for each of the four planning areas with the bw.diggle method.\n\npar(mfrow=c(2,2))\nplot(density(childcare_pg_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Punggol\")\nplot(density(childcare_tm_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Tempines\")\nplot(density(childcare_ck_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Choa Chu Kang\")\nplot(density(childcare_jw_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Jurong West\")\n\n\n\n\n\n\n\n\nThe KDE displays indicate Punggol as the planning area with the highest density of childcare centres."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.7.4-visualising-output-in-tmap",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.7.4-visualising-output-in-tmap",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.7.4 Visualising output in tmap",
    "text": "H3.7.4 Visualising output in tmap\nFinally, we can display the raster in cartographic quality using tmap.\n\ntm_shape(kde_childcareSG_bw_raster) + \n  tm_raster(\"layer\", palette = \"viridis\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\"), frame = FALSE)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.7.5-comparing-spatial-point-patterns-using-kde",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.7.5-comparing-spatial-point-patterns-using-kde",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.7.5 Comparing Spatial Point Patterns using KDE",
    "text": "H3.7.5 Comparing Spatial Point Patterns using KDE\nAnd now for the fun part - comparing KDEs between regions. In this section, we will compare the density estimations of childcare centres located in the planning areas of Choa Chu Kang, Jurong West, Punggol and Tampines.\n\nH3.7.5.1 Extracting and plotting study areas"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.8-nearest-neighbour-analysis",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.8-nearest-neighbour-analysis",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.8 Nearest Neighbour Analysis",
    "text": "H3.8 Nearest Neighbour Analysis\nNearest neighbours are the direct distance from points to their nearest neighbours. The nearest neighbour index is expressed as the ratio of the observed mean distance to the expected mean distance. An index of less than 1 indicates the spatial point pattern exhibits clustering, while an index of greater than 1 indicates dispersion or competition. Finally, an index of exactly 1 indicates complete random distribution.\nIn this section, we will perform the Clark-Evans test on the hypothesis that the distribution of childcare services is random.\n\nH3.8.1 Testing spatial point patterns using the Clark-Evans Test\n\nclarkevans.test(childcare_SG_ppp,\n                correction=\"none\",\n                clipregion=\"sg_owin\",\n                alternative=c(\"clustered\"),\n                nsim=99)\n\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  childcare_SG_ppp\nR = 0.55631, p-value &lt; 2.2e-16\nalternative hypothesis: clustered (R &lt; 1)\n\n\nWith a p-value of 2.2 * 10-16, we can conclude that the spatial point patterns are not randomly distributed for the entire country, and are instead clustered. We can corroborate this test result with the map visualisations, that indicates that childcare centres are typically located in either the city centre or suburban towns.\nWe can run the test again on each of the sets pertaining to our four planning areas. For now, we will focus on Punggol and Jurong West - the former is a non-mature estate inhabited by more young families, while the latter is a mature estate where residents might have lived in for longer.\n\n\nH3.8.2 Clark-Evans Test: Punggol\n\nclarkevans.test(childcare_pg_ppp,\n                correction=\"none\",\n                clipregion=NULL,\n                alternative=c(\"two.sided\"),\n                nsim=999)\n\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  childcare_pg_ppp\nR = 0.91633, p-value = 0.2112\nalternative hypothesis: two-sided\n\n\n\n\nH3.8.3 Clark-Evans Test: Jurong West\n\nclarkevans.test(childcare_jw_ppp,\n                correction=\"none\",\n                clipregion=NULL,\n                alternative=c(\"two.sided\"),\n                nsim=999)\n\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  childcare_jw_ppp\nR = 0.9087, p-value = 0.1013\nalternative hypothesis: two-sided"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.9-second-order-spatial-points-patterns-analysis",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.9-second-order-spatial-points-patterns-analysis",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.9 Second Order Spatial Points Patterns Analysis",
    "text": "H3.9 Second Order Spatial Points Patterns Analysis\nWhile first order SPPA measures how observations vary due to changes in the underlying property, second order SPPA deals with variations in observations due to the way they interact with one another. The methods used for second order SPPA include the F-, G-, K- and L-functions.\nIn this section, we will explore the F-, G- K- and L-functions by applying them on the childcare centre data for the planning areas of Choa Chu Kang in Western Singapore, and Tampines in the East."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.10-f-function",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.10-f-function",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.10 F-Function",
    "text": "H3.10 F-Function\nThe F-function estimates the empty space function \\(F(r)\\) from a point pattern in a window of arbitrary shape. It can be computed using Fest() of the spatstat package.\nFollowing that, a Monte Carlo simulation test can be performed using envelope(). We will perform both operations on the segments of the data representing\n\nH3.10.1 Computing F-function estimations\n\nH3.10.1.1 Choa Chu Kang\n\nF_function_Choa_Chu_Kang &lt;- Fest(childcare_ck_ppp)\nplot(F_function_Choa_Chu_Kang)\n\n\n\n\n\n\n\n\n\n\nH3.10.1.2 Tampines\n\nF_function_Tampines &lt;- Fest(childcare_tm_ppp, correction=\"best\")\nplot(F_function_Tampines)\n\n\n\n\n\n\n\n\n\n\n\nH3.10.2 Performing Complete Spatial Randomness Test\nTo confirm the observed spatial patterns above, we can conduct a Monte Carlo (hypothesis) test with envelope(). The hypothesis and test are as follows:\nH0 = The distribution of childcare services at Choa Chu Kang/Tampines are randomly distributed.\nH1= The distribution of childcare services at Choa Chu Kang/Tampines are not randomly distributed.\nThe null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.\n\nH3.10.2.1 Choa Chu Kang\n\nF_CCK.csr &lt;- envelope(childcare_ck_ppp, Fest, nsim = 999)\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\nplot(F_CCK.csr)\n\n\n\n\n\n\n\n\n\n\nH3.10.2.2 Tampines\n\nF_TM.csr &lt;- envelope(childcare_tm_ppp, Fest, correction=\"all\", nsim = 999)\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\nplot(F_TM.csr)\n\n\n\n\n\n\n\n\nThe F-function for the Choa Chu Kang set is within the envelope, and that for the Tampines set is below the envelope. This indicates that indicating that the childcare centres in Choa Chu Kang exhibit complete spatial randomness (CSR), while the centres in Tampines are clustered."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.10.1-computing-f-function-estimation-for-choa-chu-kang-planning-area",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.10.1-computing-f-function-estimation-for-choa-chu-kang-planning-area",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.10.1 Computing F-function estimation for Choa Chu Kang planning area",
    "text": "H3.10.1 Computing F-function estimation for Choa Chu Kang planning area\n\nF_CCK = Fest(childcare_ck_ppp)\nplot(F_CCK)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.10.2-performing-complete-spatial-randomness-test",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.10.2-performing-complete-spatial-randomness-test",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.10.2 Performing Complete Spatial Randomness Test",
    "text": "H3.10.2 Performing Complete Spatial Randomness Test"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.11-g-function",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.11-g-function",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.11 G-Function",
    "text": "H3.11 G-Function\nThe G-function measures the distribution of distances from an arbitrary event to its nearest event.\nOnce again, a function from the spatstat package will be used, this time the Gest() function. Following that, we will perform another Monte Carlo simulation test with envelope().\n\nH3.11.1 Computing G-function estimations\n\nH3.11.1.1 Choa Chu Kang\n\nG_CK &lt;- Gest(childcare_ck_ppp, correction = \"border\")\nplot(G_CK, xlim=c(0,500))\n\n\n\n\n\n\n\n\n\n\nH3.11.1.2 Tampines\n\nG_tm &lt;- Gest(childcare_tm_ppp, correction = \"best\")\nplot(G_tm)\n\n\n\n\n\n\n\n\n\n\n\nH3.11.2 Performing Complete Spatial Randomness Test\nAs a reminder:\nH0 = The distribution of childcare services at Choa Chu Kang/Tampines are randomly distributed.\nH1= The distribution of childcare services at Choa Chu Kang/Tampines are not randomly distributed.\nThe null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.\n\nH3.11.2.1 Choa Chu Kang\n\nG_CK.csr &lt;- envelope(childcare_ck_ppp, Gest, nsim = 999)\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\nplot(G_CK.csr)\n\n\n\n\n\n\n\n\n\n\nH3.11.2.2 Tampines\n\nG_tm.csr &lt;- envelope(childcare_tm_ppp, Gest, correction = \"all\", nsim = 999)\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\nplot(G_tm.csr)\n\n\n\n\n\n\n\n\nUnlike the function for Choa Chu Kang, which lies entirely within the envelopes, a small portion of the Tampines function falls above the envelopes. Once again, this indicates that the childcare centres of Choa Chu Kang exhibit CSR, while those in Tampines are clustered."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.12-k-function",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.12-k-function",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.12 K-Function",
    "text": "H3.12 K-Function\nThe K-function measures the number of events found up to a given distance of any particular event. For this exercise, the spatstat function to be used is the the Kest() function, and another Monte Carlo simulation test will be performed with envelope().\n\nH3.12.1 Computing K-function estimations\n\nH3.12.1.1 Choa Chu Kang\n\nK_ck = Kest(childcare_ck_ppp, correction = \"Ripley\")\nplot(K_ck, . -r ~ r, ylab= \"K(d)-r\", xlab = \"d(m)\")\n\n\n\n\n\n\n\n\n\n\nH3.12.1.2 Tampines\n\nK_tm = Kest(childcare_tm_ppp, correction = \"Ripley\")\nplot(K_tm, . -r ~ r, \n     ylab= \"K(d)-r\", xlab = \"d(m)\", \n     xlim=c(0,1000))\n\n\n\n\n\n\n\n\n\n\n\nH3.12.2 Performing Complete Spatial Randomness Test\nAs a reminder:\nH0 = The distribution of childcare services at Choa Chu Kang/Tampines are randomly distributed.\nH1= The distribution of childcare services at Choa Chu Kang/Tampines are not randomly distributed.\nThe null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.\n\nH3.12.2.1 Choa Chu Kang\n\nK_ck.csr &lt;- envelope(childcare_ck_ppp, Kest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(K_ck.csr, . - r ~ r, xlab=\"d\", ylab=\"K(d)-r\")\n\n\n\n\n\n\n\n\n\n\nH3.12.2.2 Tampines\n\nK_tm.csr &lt;- envelope(childcare_tm_ppp, Kest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(K_tm.csr, . - r ~ r, \n     xlab=\"d\", ylab=\"K(d)-r\", xlim=c(0,500))\n\n\n\n\n\n\n\n\nThe Choa Chu Kang K-function lies entirely inside the envelope, while much of that for Tampines lies above it. Once again, this shows that the Choa Chu Kang childcare centres are randomly distributed (CSR). The K-function indicates that the childcare centres in Tampines exhibit a significant regular pattern."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.13-l-function",
    "href": "HandsOn/Hands-on_Ex03/hands-on-3.html#h3.13-l-function",
    "title": "H3: Spatial Point Patterns Analysis",
    "section": "H3.13 L-Function",
    "text": "H3.13 L-Function\nThe L-function is a normalisation of the K-function so as to obtain a benchmark of zero.\nFor this exercise, the spatstat function to be used is the the Lest() function, and another Monte Carlo simulation test will be performed with envelope().\n\nH3.13.1 Computing L-function estimations\n\nH3.13.1.1 Choa Chu Kang\n\nL_ck = Lest(childcare_ck_ppp, correction = \"Ripley\")\nplot(L_ck, . -r ~ r, \n     ylab= \"L(d)-r\", xlab = \"d(m)\")\n\n\n\n\n\n\n\n\n\n\nH3.13.1.2 Tampines\n\nL_tm = Lest(childcare_tm_ppp, correction = \"Ripley\")\nplot(L_tm, . -r ~ r, \n     ylab= \"L(d)-r\", xlab = \"d(m)\", \n     xlim=c(0,1000))\n\n\n\n\n\n\n\n\n\n\n\nH3.13.2 Performing Complete Spatial Randomness Test\n\nH3.13.2.1 Choa Chu Kang\n\nL_ck.csr &lt;- envelope(childcare_ck_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(L_ck.csr, . - r ~ r, xlab=\"d\", ylab=\"L(d)-r\")\n\n\n\n\n\n\n\n\n\n\nH3.13.2.2 Tampines\n\nL_tm.csr &lt;- envelope(childcare_tm_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(L_tm.csr, . - r ~ r, \n     xlab=\"d\", ylab=\"L(d)-r\", xlim=c(0,500))"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex04/hands-on-4.html",
    "href": "HandsOn/Hands-on_Ex04/hands-on-4.html",
    "title": "H4: Network Constrained Spatial Point Patterns Analysis (Incomplete)",
    "section": "",
    "text": "Network Constrained Spatial Point Patterns Analysis (NetSPPA) is a collection of spatial point patterns analysis (SPPA) methods special developed for analysing spatial point event occurs on or alongside a network. Examples of networks are road, train and river networks, while examples of spatial point events include locations of events like crime, or facilities like schools and parks.\nThis exercise will be on the spNetwork package, which serves to derive network kernel density estimation (NKDE), as well as to perform network G- and K-function analysis. Continuing on our theme of childcare centres, we will analyise the spatial distribution of childcare centres in the relatively young, northeastern planning area of Punggol. Two geospatial datasets in ESRI shapefile format will be used, namely:\n\nPunggol_St, a line featureset storing information on Punggol’s road network, and;\nPunggol_CC, a point featureset storing the locations of Punggol’s childcare centres."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.1-overview",
    "href": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.1-overview",
    "title": "H4: Network Constrained Spatial Point Patterns Analysis",
    "section": "",
    "text": "Network constrained Spatial Point Patterns Analysis (NetSPAA) is a collection of spatial point patterns analysis methods special developed for analysing spatial point event occurs on or alongside network. The spatial point event can be locations of traffic accident or childcare centre for example. The network, on the other hand can be a road network or river network."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.1-overview-and-data",
    "href": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.1-overview-and-data",
    "title": "H4: Network Constrained Spatial Point Patterns Analysis (Incomplete)",
    "section": "",
    "text": "Network Constrained Spatial Point Patterns Analysis (NetSPPA) is a collection of spatial point patterns analysis (SPPA) methods special developed for analysing spatial point event occurs on or alongside a network. Examples of networks are road, train and river networks, while examples of spatial point events include locations of events like crime, or facilities like schools and parks.\nThis exercise will be on the spNetwork package, which serves to derive network kernel density estimation (NKDE), as well as to perform network G- and K-function analysis. Continuing on our theme of childcare centres, we will analyise the spatial distribution of childcare centres in the relatively young, northeastern planning area of Punggol. Two geospatial datasets in ESRI shapefile format will be used, namely:\n\nPunggol_St, a line featureset storing information on Punggol’s road network, and;\nPunggol_CC, a point featureset storing the locations of Punggol’s childcare centres."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.2-installing-and-launching-r-packages",
    "href": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.2-installing-and-launching-r-packages",
    "title": "H4: Network Constrained Spatial Point Patterns Analysis (Incomplete)",
    "section": "H4.2 Installing and launching R packages",
    "text": "H4.2 Installing and launching R packages\nThe R packages to be used today are:\n\nspNetwork, for performing SPPA procedures like KDE and K-functions on the network. It can also be used to build spatial matrices to conduct any kind of traditional spatial analysis with spatial weights based on reticular distances.\nsf\ntmap, particularly the leaflet API, which helps us plot cartographic-quality static point pattern maps or interactive maps.\n\n\n# pacman::p_load(sf, spNetwork, tmap, tidyverse)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.3-data-import-preparation-and-visualisation",
    "href": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.3-data-import-preparation-and-visualisation",
    "title": "H4: Network Constrained Spatial Point Patterns Analysis (Incomplete)",
    "section": "H4.3 Data Import, Preparation and Visualisation",
    "text": "H4.3 Data Import, Preparation and Visualisation\nAs always, the first step is to import our geospatial datasets into RStudio as sf dataframes.\n\n# network &lt;- st_read(dsn=\".../data/geospatial\", \n#                    layer=\"Punggol_St\")\n# network\n# childcare &lt;- st_read(dsn=\".../data/geospatial\",\n#                      layer=\"Punggol_CC\")\n# childcare\n# plot(st_geometry(network))\n# plot(childcare, add=T, col='blue', pch=19)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.4-network-kde-analysis",
    "href": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.4-network-kde-analysis",
    "title": "H4: Network Constrained Spatial Point Patterns Analysis (Incomplete)",
    "section": "H4.4 Network KDE Analysis",
    "text": "H4.4 Network KDE Analysis\nNetwork KDE (NKDE) analysis can be performed by using appropriate functions from the spNetwork package.\n\nH4.4.1 Preparing lixel objects\nBefore finding the NKDE, we need to first cut our SpatialLines objects into lixels with a specified minimal distance. We can do this by calling lixelize_lines() as shown. In the code chunk below:\n\nThe length of a lixel, taken in with the lx_length parameter, is set to 700 metres, and;\nThe minimum length of a lixel, as defined in the mindist parameter, is 375 metres.\n\n\n# lixels &lt;- lixelize_lines(network, \n#                          700, \n#                          mindist = 375)\n\nAfter cutting, the length of the final lixel, if shorter than the minimum distance, is added to the previous lixel. If mindist is not defined (NULL), then it is maxdist / 10. Segments that are already shorter than the minimum distance are also not modified.\n\n\nH4.4.2 Generating line centre points\nNext, the code chunk below will generate a SpatialPointsDataFrame (i.e. samples) with line centre points. These points are located at the centre of the line based on its length.\n\n# samples &lt;- lines_center(lixels)\n\n\n\nH4.4.3 Performing NKDE\nWe are now ready to compute the NKDE by using the following code chunk.\n\n# densities &lt;- nkde(network, \n#                   events = childcare,\n#                   w = rep(1, nrow(childcare)),\n#                   samples = samples,\n#                   kernel_name = \"quartic\",\n#                   bw = 300, \n#                   div= \"bw\", \n#                   method = \"simple\", \n#                   digits = 1, \n#                   tol = 1,\n#                   grid_shape = c(1,1), \n#                   max_depth = 8,\n#                   agg = 5, \n#                   sparse = TRUE,\n#                   verbose = FALSE)\n\nSome interesting elements to note from the above code chunk include:\n\nThe quartic kernel is to be used for this NKDE exercise, and is passed into the kernel_name argument.\nThe simple keyword is passed into the method argument, which indicates it is to be used to find the NKDE.\n\nThree popular methods are currently supported by spNetwork - simple, discontinuous and continuous. simple uses network distances between events and sampling points, and the density is calculated over a linear unit (like metres) instead of an areal unit (like square metres). discontinuous “divides” the mass density of an event at intersections of lixels, while continuous divides the mass of the density at intersection but adjusts the density before the intersection to make the function continuous.\n\nH4.4.3.1 Visualising NKDE\nWe are now ready to visualise our computed NKDE values, but not before doing some preparatory work beforehand.\nFirst, we need to insert the computed density values (densities) into the density fields of our samples and lixels objects.\n\n# samples$density &lt;- densities\n# lixels$density &lt;- densities\n\nNext, we have to rescale our density values by kilometres, up from the current metres. As we’ve seen in a previous hands-on exercise, leaving the projection system in metres (the SVY21 default) leads to extremely small computed density values.\n\n# samples$density &lt;- samples$density * 1000\n# lixels$density &lt;- lixels$density * 1000\n\nFinally, we can draw our interactive and high-quality map visualisation.\n\n# tmap_mode('view')\n# tm_shape(lixels)+\n#   tm_lines(col=\"density\")+\n# tm_shape(childcare)+\n#   tm_dots()\n# tmap_mode('plot')\n\nThe interactive map above effectively distinguishes road segments with a relatively higher density of childcare centres (darker color) than those with a relatively lower density of childcare centres (lighter color)."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex05/hands-on-5.html",
    "href": "HandsOn/Hands-on_Ex05/hands-on-5.html",
    "title": "H5: Spatial Weights and Appliations",
    "section": "",
    "text": "This exercise is on computing spatial weights with R. For this exercise, the following datasets, set in Hunan Province, China, will be used:\n\nThe Hunan country boundary layer, in ESRI shapefile format, and;\nHunan_2012.csv, an aspatial dataset containing selected local development indicators for the area in 2012.\n\nIn addition to the usual sf, readr and dplyr packages, spatial weights and spatially lagged variables will be computed using appropriate spdep functions.\n\n\nAfter loading our packages, our data will be imported into the R environment.\n\npacman::p_load(sf, spdep, tmap, tidyverse, knitr)\nhunan &lt;- st_read(dsn = \"../data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\ndev_2012 &lt;- read_csv(\"../data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nWe can now perform a left join of the Hunan 2012 development dataset on the map of Hunan province:\n\nhunan &lt;- left_join(hunan,dev_2012)%&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex05/hands-on-5.html#h5.1-overview-study-area-and-data",
    "href": "HandsOn/Hands-on_Ex05/hands-on-5.html#h5.1-overview-study-area-and-data",
    "title": "H5: Spatial Weights and Appliations",
    "section": "",
    "text": "This exercise is on computing spatial weights with R. For this exercise, the following datasets, set in Hunan Province, China, will be used:\n\nThe Hunan country boundary layer, in ESRI shapefile format, and;\nHunan_2012.csv, an aspatial dataset containing selected local development indicators for the area in 2012.\n\nIn addition to the usual sf, readr and dplyr packages, spatial weights and spatially lagged variables will be computed using appropriate spdep functions.\n\n\nAfter loading our packages, our data will be imported into the R environment.\n\npacman::p_load(sf, spdep, tmap, tidyverse, knitr)\nhunan &lt;- st_read(dsn = \"../data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\ndev_2012 &lt;- read_csv(\"../data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nWe can now perform a left join of the Hunan 2012 development dataset on the map of Hunan province:\n\nhunan &lt;- left_join(hunan,dev_2012)%&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.5-network-constrained-g--and-k-function-analysis",
    "href": "HandsOn/Hands-on_Ex04/hands-on-4.html#h4.5-network-constrained-g--and-k-function-analysis",
    "title": "H4: Network Constrained Spatial Point Patterns Analysis (Incomplete)",
    "section": "H4.5 Network-Constrained G- and K-Function Analysis",
    "text": "H4.5 Network-Constrained G- and K-Function Analysis\nThe last step is to perform a complete spatial randomness (CSR) test by running our data through a K-function. The function to be used is kfunctions(), once again from the spNetwork package.\nToday’s null hypothesis is defined as:\nH0: The observed spatial point events (i.e distribution of childcare centres) are uniformly distributed over a street network in Punggol.\nIn other words, our childcare centres are randomly and independently distributed over the street network. If this null hypothesis is rejected, we may infer that the childcare centres in Punggol are spatially dependent on each other; as a result, they may form non-random patterns.\n\n# kfun_childcare &lt;- kfunctions(network, \n#                              childcare,\n#                              start = 0, \n#                              end = 1000, \n#                              step = 50, \n#                              width = 50, \n#                              nsim = 50, \n#                              resolution = 50,\n#                              verbose = FALSE, \n#                              conf_int = 0.05)\n\nThe ten arguments required by kfunctions() are:\n\nlines: A SpatialLinesDataFrame with the sampling points.\npoints: A SpatialPointsDataFrame representing the points on the network. These points will be snapped on the network.\nstart: A double, the start value for evaluating the K- and G- functions.\nend: A double, the last value for evaluating the K- and G- functions.\nstep: A double, the jump between two evaluations of the K- and G- function.\nwidth: The width of each donut for the g-function.\nnsim: An integer indicating the number of Monte Carlo simulations required. In the above example, 50 simulations were performed, but it is usually preferred to have more simulations.\nresolution: When simulating random points on the network, selecting a resolution will reduce greatly the calculation time. When the resolution is NULL, the random points can occur everywhere on the graph. If a value is specified, the edges are split according to this value and the random points are selected vertices on the new network.\nconf_int: A double indicating the width confidence interval (default = 0.05).\n\nkfunctions() outputs:\n\nplotkA, a ggplot2 object representing the values of the K-function;\nplotgA, a ggplot2 object representing the values of the G-function;\nvaluesA, a DataFrame with the values used to build the plots.\n\nFinally, we can visualise the ggplot2 object of our K-function as follows.\n\n# kfun_childcare$plotk\n\nSince the observed values for the distance interval of 250-400m are below the envelop, we can infer that the childcare centres in Punggol resemble a regular pattern for that distance."
  },
  {
    "objectID": "HandsOn/Hands-on_Ex05/hands-on-5.html#h5.2-visualising-our-data",
    "href": "HandsOn/Hands-on_Ex05/hands-on-5.html#h5.2-visualising-our-data",
    "title": "H5: Spatial Weights and Appliations",
    "section": "H5.2 Visualising our Data",
    "text": "H5.2 Visualising our Data\nUsing qtm() and other tmap packages, we can now prepare a basemap and choropleth map showing the distribution of GDP per capita by region.\n\nbasemap &lt;- tm_shape(hunan) +\n  tm_polygons() +\n  tm_text(\"NAME_3\", size=0.5)\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex05/hands-on-5.html#h5.3-computing-contiguity-spatial-weights",
    "href": "HandsOn/Hands-on_Ex05/hands-on-5.html#h5.3-computing-contiguity-spatial-weights",
    "title": "H5: Spatial Weights and Appliations",
    "section": "H5.3 Computing Contiguity Spatial Weights",
    "text": "H5.3 Computing Contiguity Spatial Weights\nThe poly2nb() function of the spdep package may be used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with continuous boundaries.\n\nH5.3.1 Creating QUEEN contiguity-based neighbours\n\nwm_q &lt;- poly2nb(hunan, queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nFor each polygon in our polygon object, wm_q lists all neighbouring polygons. The following code chunk reveals the neighbours for the first polygon in the object. It is good to be reminded here that R is not a zero-index index, so all list indices start from 1.\n\nwm_q[[1]]\n\n[1]  2  3  4 57 85\n\n\nWe can also retrieve the county name with Polygon ID=1 as follows:\n\nhunan$County[1]\n\n[1] \"Anxiang\"\n\n\nOr the county names of the five counties bordering county ID 1:\n\nhunan$NAME_3[c(2,3,4,57,85)]\n\n[1] \"Hanshou\" \"Jinshi\"  \"Li\"      \"Nan\"     \"Taoyuan\"\n\n\nFinally, we can retrieve the GDP per capita of each of the five counties bordering county ID 1:\n\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n[1] 20981 34592 24473 21311 22879\n\n\nThe complete weight matrix may be displayed using str(). It’s a long one.\n\nstr(wm_q)\n\nList of 88\n $ : int [1:5] 2 3 4 57 85\n $ : int [1:5] 1 57 58 78 85\n $ : int [1:4] 1 4 5 85\n $ : int [1:4] 1 3 5 6\n $ : int [1:4] 3 4 6 85\n $ : int [1:5] 4 5 69 75 85\n $ : int [1:4] 67 71 74 84\n $ : int [1:7] 9 46 47 56 78 80 86\n $ : int [1:6] 8 66 68 78 84 86\n $ : int [1:8] 16 17 19 20 22 70 72 73\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:3] 11 15 17\n $ : int [1:4] 13 14 17 83\n $ : int [1:5] 10 17 22 72 83\n $ : int [1:7] 10 11 14 15 16 72 83\n $ : int [1:5] 20 22 23 77 83\n $ : int [1:6] 10 20 21 73 74 86\n $ : int [1:7] 10 18 19 21 22 23 82\n $ : int [1:5] 19 20 35 82 86\n $ : int [1:5] 10 16 18 20 83\n $ : int [1:7] 18 20 38 41 77 79 82\n $ : int [1:5] 25 28 31 32 54\n $ : int [1:5] 24 28 31 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:3] 26 29 42\n $ : int [1:5] 24 25 33 49 54\n $ : int [1:3] 27 37 42\n $ : int 33\n $ : int [1:8] 24 25 32 36 39 40 56 81\n $ : int [1:8] 24 31 50 54 55 56 75 85\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 47 80 82 86\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:4] 29 42 43 44\n $ : int [1:4] 23 44 77 79\n $ : int [1:5] 31 40 42 43 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:7] 26 27 29 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:4] 37 38 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:3] 8 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:5] 32 48 52 54 55\n $ : int [1:3] 48 49 52\n $ : int [1:5] 48 49 50 51 54\n $ : int [1:3] 48 55 75\n $ : int [1:6] 24 28 32 49 50 52\n $ : int [1:5] 32 48 50 53 75\n $ : int [1:7] 8 31 32 36 78 80 85\n $ : int [1:6] 1 2 58 64 76 85\n $ : int [1:5] 2 57 68 76 78\n $ : int [1:4] 60 61 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:7] 12 59 60 62 63 77 87\n $ : int [1:3] 61 77 87\n $ : int [1:4] 12 61 77 83\n $ : int [1:2] 57 76\n $ : int 76\n $ : int [1:5] 9 67 68 76 84\n $ : int [1:4] 7 66 76 84\n $ : int [1:5] 9 58 66 76 78\n $ : int [1:3] 6 75 85\n $ : int [1:3] 10 72 73\n $ : int [1:3] 7 73 74\n $ : int [1:5] 10 11 16 17 70\n $ : int [1:5] 10 19 70 71 74\n $ : int [1:6] 7 19 71 73 84 86\n $ : int [1:6] 6 32 53 55 69 85\n $ : int [1:7] 57 58 64 65 66 67 68\n $ : int [1:7] 18 23 38 61 62 63 83\n $ : int [1:7] 2 8 9 56 58 68 85\n $ : int [1:7] 23 38 40 41 43 44 45\n $ : int [1:8] 8 34 35 36 41 45 47 56\n $ : int [1:6] 25 26 31 33 39 42\n $ : int [1:5] 20 21 23 35 41\n $ : int [1:9] 12 13 15 16 17 18 22 63 77\n $ : int [1:6] 7 9 66 67 74 86\n $ : int [1:11] 1 2 3 5 6 32 56 57 69 75 ...\n $ : int [1:9] 8 9 19 21 35 46 47 74 84\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language poly2nb(pl = hunan, queen = TRUE)\n - attr(*, \"type\")= chr \"queen\"\n - attr(*, \"sym\")= logi TRUE\n\n\n\n\nH5.3.2 Creating ROOK contiguity-based neighbours\nAside from the QUEEN contiguity weight matrix, we can also create ROOK contiguity based neighbours by setting the queen parameter to FALSE. The summary report below shows there are 88 area units in Hunan Province, with the most connected area unit having 10 neighbours.\n\nwm_r &lt;- poly2nb(hunan, queen=FALSE)\nsummary(wm_r)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 440 \nPercentage nonzero weights: 5.681818 \nAverage number of links: 5 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 10 \n 2  2 12 20 21 14 11  3  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 10 links\n\n\n\n\nH5.3.3 Visualising contiguity weights\nA connectivity graph takes a point and displays a line to each neighboring point. We are working with polygons at the moment, so we will need to get points in order to make our connectivity graphs. The most typically method for this will be polygon centroids, which we can calculate these in the sf package.\n\nH5.3.3.1 Getting Latitude and Longitude of Polygon Centroids\nWe will need points to associate with each polygon before we can make our connectivity graph. It will be a little more complicated than just running st_centroid on the sf object: us.bound. We need the coordinates in a separate data frame for this to work. To do this we will use a mapping function. The mapping function applies a given function to each element of a vector and returns a vector of the same length. Our input vector will be the geometry column of us.bound. Our function will be st_centroid. We will be using map_dbl variation of map from the purrr package. For more documentation, check out map documentation\nTo get our longitude values we map the st_centroid function over the geometry column of us.bound and access the longitude value through double bracket notation [[]] and 1. This allows us to get only the longitude, which is the first value in each centroid.\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\nWe do the same for latitude with one key difference. We access the second value per each centroid with [[2]].\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\nNow that we have latitude and longitude, we use cbind to put longitude and latitude into the same object.\n\ncoords &lt;- cbind(longitude, latitude)\n\nWe can check the first few observations to see if things are formatted correctly.\n\nhead(coords)\n\n     longitude latitude\n[1,]  112.1531 29.44362\n[2,]  112.0372 28.86489\n[3,]  111.8917 29.47107\n[4,]  111.7031 29.74499\n[5,]  111.6138 29.49258\n[6,]  111.0341 29.79863\n\n\n\n\nH5.3.3.2 Plotting Queen contiguity based neighbours map\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"red\")\n\n\n\n\n\n\n\n\n\n\nH5.3.3.3 Plotting Rook contiguity based neighbours map\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\n\n\n\n\n\n\n\n\n\nH5.3.3.4 Plotting both together\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\", main=\"Queen Contiguity\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"red\")\nplot(hunan$geometry, border=\"lightgrey\", main=\"Rook Contiguity\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\n\n\n\n\n\n\n\n\n\n\nH5.4 Computing distance-based neighbours\nDistance-based weight matrices may be derived using dnearneigh(). This function identifies neighbours of region points by Euclidean distance with a lower bound of d1 and upper bound of d2, controlled by the bounds parameter. If unprojected coordinates are used and either specified in the coordinates object x or with x as a two column matrix, and longlat=TRUE, great circle distances in km will be calculated assuming the WGS84 reference ellipsoid.\n\n\nH5.4.1 Determining the cutoff distance\nTo determine the upper limit for the distance band, we can follow the steps below:\n\nReturn a matrix with the indices of points belonging to the set of the k nearest neighbours of each other using knearneigh();\nConvert the knn object returned by knearneigh() into a neighbours list of class nb with a list of integer vectors containing neighbour region number IDs using knn2nb()\nReturn the length of neighbour relationship edges using nbdists(), which returns in the units of the coordinates if one is projected, and in kilometres otherwise.\nRemove the list structure of the returned object using unlist().\n\n\n# coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n\n\nH5.4.2 Computing fixed distance weight matrix using dnearneigh()\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat=TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\nNext, we use str() to display the content of our matrix.\n\nstr(wm_d62)\n\nList of 88\n $ : int [1:5] 3 4 5 57 64\n $ : int [1:4] 57 58 78 85\n $ : int [1:4] 1 4 5 57\n $ : int [1:3] 1 3 5\n $ : int [1:4] 1 3 4 85\n $ : int 69\n $ : int [1:2] 67 84\n $ : int [1:4] 9 46 47 78\n $ : int [1:4] 8 46 68 84\n $ : int [1:4] 16 22 70 72\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:2] 11 17\n $ : int 13\n $ : int [1:4] 10 17 22 83\n $ : int [1:3] 11 14 16\n $ : int [1:3] 20 22 63\n $ : int [1:5] 20 21 73 74 82\n $ : int [1:5] 18 19 21 22 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:4] 10 16 18 20\n $ : int [1:3] 41 77 82\n $ : int [1:4] 25 28 31 54\n $ : int [1:4] 24 28 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:2] 26 29\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:2] 27 37\n $ : int 33\n $ : int [1:2] 24 36\n $ : int 50\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:5] 31 34 45 56 80\n $ : int [1:2] 29 42\n $ : int [1:3] 44 77 79\n $ : int [1:4] 40 42 43 81\n $ : int [1:3] 39 45 79\n $ : int [1:5] 23 35 45 79 82\n $ : int [1:5] 26 37 39 43 81\n $ : int [1:3] 39 42 44\n $ : int [1:2] 38 43\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:5] 8 9 35 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:4] 48 49 50 52\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:2] 48 55\n $ : int [1:5] 24 28 49 50 52\n $ : int [1:4] 48 50 53 75\n $ : int 36\n $ : int [1:5] 1 2 3 58 64\n $ : int [1:5] 2 57 64 66 68\n $ : int [1:3] 60 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:5] 12 60 62 63 87\n $ : int [1:4] 61 63 77 87\n $ : int [1:5] 12 18 61 62 83\n $ : int [1:4] 1 57 58 76\n $ : int 76\n $ : int [1:5] 58 67 68 76 84\n $ : int [1:2] 7 66\n $ : int [1:4] 9 58 66 84\n $ : int [1:2] 6 75\n $ : int [1:3] 10 72 73\n $ : int [1:2] 73 74\n $ : int [1:3] 10 11 70\n $ : int [1:4] 19 70 71 74\n $ : int [1:5] 19 21 71 73 86\n $ : int [1:2] 55 69\n $ : int [1:3] 64 65 66\n $ : int [1:3] 23 38 62\n $ : int [1:2] 2 8\n $ : int [1:4] 38 40 41 45\n $ : int [1:5] 34 35 36 45 47\n $ : int [1:5] 25 26 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:4] 12 13 16 63\n $ : int [1:4] 7 9 66 68\n $ : int [1:2] 2 5\n $ : int [1:4] 21 46 47 74\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language dnearneigh(x = coords, d1 = 0, d2 = 62, longlat = TRUE)\n - attr(*, \"dnn\")= num [1:2] 0 62\n - attr(*, \"bounds\")= chr [1:2] \"GE\" \"LE\"\n - attr(*, \"nbtype\")= chr \"distance\"\n - attr(*, \"sym\")= logi TRUE\n\n\nWe can also display the weight matrix in a table form by combining table() and card(), from spdep.\n\ntable(hunan$County, card(wm_d62))\n\n               \n                1 2 3 4 5 6\n  Anhua         1 0 0 0 0 0\n  Anren         0 0 0 1 0 0\n  Anxiang       0 0 0 0 1 0\n  Baojing       0 0 0 0 1 0\n  Chaling       0 0 1 0 0 0\n  Changning     0 0 1 0 0 0\n  Changsha      0 0 0 1 0 0\n  Chengbu       0 1 0 0 0 0\n  Chenxi        0 0 0 1 0 0\n  Cili          0 1 0 0 0 0\n  Dao           0 0 0 1 0 0\n  Dongan        0 0 1 0 0 0\n  Dongkou       0 0 0 1 0 0\n  Fenghuang     0 0 0 1 0 0\n  Guidong       0 0 1 0 0 0\n  Guiyang       0 0 0 1 0 0\n  Guzhang       0 0 0 0 0 1\n  Hanshou       0 0 0 1 0 0\n  Hengdong      0 0 0 0 1 0\n  Hengnan       0 0 0 0 1 0\n  Hengshan      0 0 0 0 0 1\n  Hengyang      0 0 0 0 0 1\n  Hongjiang     0 0 0 0 1 0\n  Huarong       0 0 0 1 0 0\n  Huayuan       0 0 0 1 0 0\n  Huitong       0 0 0 1 0 0\n  Jiahe         0 0 0 0 1 0\n  Jianghua      0 0 1 0 0 0\n  Jiangyong     0 1 0 0 0 0\n  Jingzhou      0 1 0 0 0 0\n  Jinshi        0 0 0 1 0 0\n  Jishou        0 0 0 0 0 1\n  Lanshan       0 0 0 1 0 0\n  Leiyang       0 0 0 1 0 0\n  Lengshuijiang 0 0 1 0 0 0\n  Li            0 0 1 0 0 0\n  Lianyuan      0 0 0 0 1 0\n  Liling        0 1 0 0 0 0\n  Linli         0 0 0 1 0 0\n  Linwu         0 0 0 1 0 0\n  Linxiang      1 0 0 0 0 0\n  Liuyang       0 1 0 0 0 0\n  Longhui       0 0 1 0 0 0\n  Longshan      0 1 0 0 0 0\n  Luxi          0 0 0 0 1 0\n  Mayang        0 0 0 0 0 1\n  Miluo         0 0 0 0 1 0\n  Nan           0 0 0 0 1 0\n  Ningxiang     0 0 0 1 0 0\n  Ningyuan      0 0 0 0 1 0\n  Pingjiang     0 1 0 0 0 0\n  Qidong        0 0 1 0 0 0\n  Qiyang        0 0 1 0 0 0\n  Rucheng       0 1 0 0 0 0\n  Sangzhi       0 1 0 0 0 0\n  Shaodong      0 0 0 0 1 0\n  Shaoshan      0 0 0 0 1 0\n  Shaoyang      0 0 0 1 0 0\n  Shimen        1 0 0 0 0 0\n  Shuangfeng    0 0 0 0 0 1\n  Shuangpai     0 0 0 1 0 0\n  Suining       0 0 0 0 1 0\n  Taojiang      0 1 0 0 0 0\n  Taoyuan       0 1 0 0 0 0\n  Tongdao       0 1 0 0 0 0\n  Wangcheng     0 0 0 1 0 0\n  Wugang        0 0 1 0 0 0\n  Xiangtan      0 0 0 1 0 0\n  Xiangxiang    0 0 0 0 1 0\n  Xiangyin      0 0 0 1 0 0\n  Xinhua        0 0 0 0 1 0\n  Xinhuang      1 0 0 0 0 0\n  Xinning       0 1 0 0 0 0\n  Xinshao       0 0 0 0 0 1\n  Xintian       0 0 0 0 1 0\n  Xupu          0 1 0 0 0 0\n  Yanling       0 0 1 0 0 0\n  Yizhang       1 0 0 0 0 0\n  Yongshun      0 0 0 1 0 0\n  Yongxing      0 0 0 1 0 0\n  You           0 0 0 1 0 0\n  Yuanjiang     0 0 0 0 1 0\n  Yuanling      1 0 0 0 0 0\n  Yueyang       0 0 1 0 0 0\n  Zhijiang      0 0 0 0 1 0\n  Zhongfang     0 0 0 1 0 0\n  Zhuzhou       0 0 0 0 1 0\n  Zixing        0 0 1 0 0 0\n\nn_comp &lt;- n.comp.nb(wm_d62)\nn_comp$nc\n\n[1] 1\n\ntable(n_comp$comp.id)\n\n\n 1 \n88 \n\n\n\nH5.4.2.1 Plotting fixed distance weight matrix\nA weight matrix can now be plotted as below:\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_d62, coords, add=TRUE)\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\n\n\n\n\n\n\n\n\nThe red lines show links of first nearest neighbours, while the black lines show the links of neighbours within the cutoff distance of 62km.\nAlternatively, we can plot both of these next to each other as below:\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\", main=\"1st nearest neighbours\")\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\nplot(hunan$geometry, border=\"lightgrey\", main=\"Distance link\")\nplot(wm_d62, coords, add=TRUE, pch = 19, cex = 0.6)\n\n\n\n\n\n\n\n\n\n\n\nH5.4.3 Computing distance matrix\nA key characteristic involving fixed distance weight matrices is that more densly-populated areas (usually urban areas) tend to have more neighbours than their less densly-populated counterparts. Yet, having many neighbours smoothes the neighbour relationship across more neighbours. It is possible to control the number of neighbours directly using K-nearest neighbours, by either accepting asymmetric neighbours or imposing symmetry as shown below.\n\nknn6 &lt;- knn2nb(knearneigh(coords, k=6))\nknn6\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 528 \nPercentage nonzero weights: 6.818182 \nAverage number of links: 6 \nNon-symmetric neighbours list\n\nstr(knn6)\n\nList of 88\n $ : int [1:6] 2 3 4 5 57 64\n $ : int [1:6] 1 3 57 58 78 85\n $ : int [1:6] 1 2 4 5 57 85\n $ : int [1:6] 1 3 5 6 69 85\n $ : int [1:6] 1 3 4 6 69 85\n $ : int [1:6] 3 4 5 69 75 85\n $ : int [1:6] 9 66 67 71 74 84\n $ : int [1:6] 9 46 47 78 80 86\n $ : int [1:6] 8 46 66 68 84 86\n $ : int [1:6] 16 19 22 70 72 73\n $ : int [1:6] 10 14 16 17 70 72\n $ : int [1:6] 13 15 60 61 63 83\n $ : int [1:6] 12 15 60 61 63 83\n $ : int [1:6] 11 15 16 17 72 83\n $ : int [1:6] 12 13 14 17 60 83\n $ : int [1:6] 10 11 17 22 72 83\n $ : int [1:6] 10 11 14 16 72 83\n $ : int [1:6] 20 22 23 63 77 83\n $ : int [1:6] 10 20 21 73 74 82\n $ : int [1:6] 18 19 21 22 23 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:6] 10 16 18 19 20 83\n $ : int [1:6] 18 20 41 77 79 82\n $ : int [1:6] 25 28 31 52 54 81\n $ : int [1:6] 24 28 31 33 54 81\n $ : int [1:6] 25 27 29 33 42 81\n $ : int [1:6] 26 29 30 37 42 81\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:6] 26 27 37 42 43 81\n $ : int [1:6] 26 27 28 33 49 81\n $ : int [1:6] 24 25 36 39 40 54\n $ : int [1:6] 24 31 50 54 55 56\n $ : int [1:6] 25 26 28 30 49 81\n $ : int [1:6] 36 40 41 45 56 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:6] 26 27 29 42 43 44\n $ : int [1:6] 23 43 44 62 77 79\n $ : int [1:6] 25 40 42 43 44 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:6] 26 27 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:6] 37 38 39 42 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:6] 8 9 35 47 78 86\n $ : int [1:6] 8 21 35 46 80 86\n $ : int [1:6] 49 50 51 52 53 55\n $ : int [1:6] 28 33 48 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:6] 28 48 49 50 52 54\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:6] 48 50 51 52 55 75\n $ : int [1:6] 24 28 49 50 51 52\n $ : int [1:6] 32 48 50 52 53 75\n $ : int [1:6] 32 34 36 78 80 85\n $ : int [1:6] 1 2 3 58 64 68\n $ : int [1:6] 2 57 64 66 68 78\n $ : int [1:6] 12 13 60 61 87 88\n $ : int [1:6] 12 13 59 61 63 87\n $ : int [1:6] 12 13 60 62 63 87\n $ : int [1:6] 12 38 61 63 77 87\n $ : int [1:6] 12 18 60 61 62 83\n $ : int [1:6] 1 3 57 58 68 76\n $ : int [1:6] 58 64 66 67 68 76\n $ : int [1:6] 9 58 67 68 76 84\n $ : int [1:6] 7 65 66 68 76 84\n $ : int [1:6] 9 57 58 66 78 84\n $ : int [1:6] 4 5 6 32 75 85\n $ : int [1:6] 10 16 19 22 72 73\n $ : int [1:6] 7 19 73 74 84 86\n $ : int [1:6] 10 11 14 16 17 70\n $ : int [1:6] 10 19 21 70 71 74\n $ : int [1:6] 19 21 71 73 84 86\n $ : int [1:6] 6 32 50 53 55 69\n $ : int [1:6] 58 64 65 66 67 68\n $ : int [1:6] 18 23 38 61 62 63\n $ : int [1:6] 2 8 9 46 58 68\n $ : int [1:6] 38 40 41 43 44 45\n $ : int [1:6] 34 35 36 41 45 47\n $ : int [1:6] 25 26 28 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:6] 12 13 15 16 22 63\n $ : int [1:6] 7 9 66 68 71 74\n $ : int [1:6] 2 3 4 5 56 69\n $ : int [1:6] 8 9 21 46 47 74\n $ : int [1:6] 59 60 61 62 63 88\n $ : int [1:6] 59 60 61 62 63 87\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language knearneigh(x = coords, k = 6)\n - attr(*, \"sym\")= logi FALSE\n - attr(*, \"type\")= chr \"knn\"\n - attr(*, \"knn-k\")= num 6\n - attr(*, \"class\")= chr \"nb\"\n\n\n\n\nH5.4.3.1 Plotting distance-based neighbours\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(knn6, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\n\n\n\n\n\n\n\n\n\nH5.5 Weights based on IDW\nThis section serves to derive a spatial weight matrix based on the inversed distance method.\nFirst, we compute the distance between areas using nbdists().\n\ndist &lt;- nbdists(wm_q, coords, longlat = TRUE)\nids &lt;- lapply(dist, function(x) 1/(x))\nids\n\n[[1]]\n[1] 0.01535405 0.03916350 0.01820896 0.02807922 0.01145113\n\n[[2]]\n[1] 0.01535405 0.01764308 0.01925924 0.02323898 0.01719350\n\n[[3]]\n[1] 0.03916350 0.02822040 0.03695795 0.01395765\n\n[[4]]\n[1] 0.01820896 0.02822040 0.03414741 0.01539065\n\n[[5]]\n[1] 0.03695795 0.03414741 0.01524598 0.01618354\n\n[[6]]\n[1] 0.015390649 0.015245977 0.021748129 0.011883901 0.009810297\n\n[[7]]\n[1] 0.01708612 0.01473997 0.01150924 0.01872915\n\n[[8]]\n[1] 0.02022144 0.03453056 0.02529256 0.01036340 0.02284457 0.01500600 0.01515314\n\n[[9]]\n[1] 0.02022144 0.01574888 0.02109502 0.01508028 0.02902705 0.01502980\n\n[[10]]\n[1] 0.02281552 0.01387777 0.01538326 0.01346650 0.02100510 0.02631658 0.01874863\n[8] 0.01500046\n\n[[11]]\n[1] 0.01882869 0.02243492 0.02247473\n\n[[12]]\n[1] 0.02779227 0.02419652 0.02333385 0.02986130 0.02335429\n\n[[13]]\n[1] 0.02779227 0.02650020 0.02670323 0.01714243\n\n[[14]]\n[1] 0.01882869 0.01233868 0.02098555\n\n[[15]]\n[1] 0.02650020 0.01233868 0.01096284 0.01562226\n\n[[16]]\n[1] 0.02281552 0.02466962 0.02765018 0.01476814 0.01671430\n\n[[17]]\n[1] 0.01387777 0.02243492 0.02098555 0.01096284 0.02466962 0.01593341 0.01437996\n\n[[18]]\n[1] 0.02039779 0.02032767 0.01481665 0.01473691 0.01459380\n\n[[19]]\n[1] 0.01538326 0.01926323 0.02668415 0.02140253 0.01613589 0.01412874\n\n[[20]]\n[1] 0.01346650 0.02039779 0.01926323 0.01723025 0.02153130 0.01469240 0.02327034\n\n[[21]]\n[1] 0.02668415 0.01723025 0.01766299 0.02644986 0.02163800\n\n[[22]]\n[1] 0.02100510 0.02765018 0.02032767 0.02153130 0.01489296\n\n[[23]]\n[1] 0.01481665 0.01469240 0.01401432 0.02246233 0.01880425 0.01530458 0.01849605\n\n[[24]]\n[1] 0.02354598 0.01837201 0.02607264 0.01220154 0.02514180\n\n[[25]]\n[1] 0.02354598 0.02188032 0.01577283 0.01949232 0.02947957\n\n[[26]]\n[1] 0.02155798 0.01745522 0.02212108 0.02220532\n\n[[27]]\n[1] 0.02155798 0.02490625 0.01562326\n\n[[28]]\n[1] 0.01837201 0.02188032 0.02229549 0.03076171 0.02039506\n\n[[29]]\n[1] 0.02490625 0.01686587 0.01395022\n\n[[30]]\n[1] 0.02090587\n\n[[31]]\n[1] 0.02607264 0.01577283 0.01219005 0.01724850 0.01229012 0.01609781 0.01139438\n[8] 0.01150130\n\n[[32]]\n[1] 0.01220154 0.01219005 0.01712515 0.01340413 0.01280928 0.01198216 0.01053374\n[8] 0.01065655\n\n[[33]]\n[1] 0.01949232 0.01745522 0.02229549 0.02090587 0.01979045\n\n[[34]]\n[1] 0.03113041 0.03589551 0.02882915\n\n[[35]]\n[1] 0.01766299 0.02185795 0.02616766 0.02111721 0.02108253 0.01509020\n\n[[36]]\n[1] 0.01724850 0.03113041 0.01571707 0.01860991 0.02073549 0.01680129\n\n[[37]]\n[1] 0.01686587 0.02234793 0.01510990 0.01550676\n\n[[38]]\n[1] 0.01401432 0.02407426 0.02276151 0.01719415\n\n[[39]]\n[1] 0.01229012 0.02172543 0.01711924 0.02629732 0.01896385\n\n[[40]]\n[1] 0.01609781 0.01571707 0.02172543 0.01506473 0.01987922 0.01894207\n\n[[41]]\n[1] 0.02246233 0.02185795 0.02205991 0.01912542 0.01601083 0.01742892\n\n[[42]]\n[1] 0.02212108 0.01562326 0.01395022 0.02234793 0.01711924 0.01836831 0.01683518\n\n[[43]]\n[1] 0.01510990 0.02629732 0.01506473 0.01836831 0.03112027 0.01530782\n\n[[44]]\n[1] 0.01550676 0.02407426 0.03112027 0.01486508\n\n[[45]]\n[1] 0.03589551 0.01860991 0.01987922 0.02205991 0.02107101 0.01982700\n\n[[46]]\n[1] 0.03453056 0.04033752 0.02689769\n\n[[47]]\n[1] 0.02529256 0.02616766 0.04033752 0.01949145 0.02181458\n\n[[48]]\n[1] 0.02313819 0.03370576 0.02289485 0.01630057 0.01818085\n\n[[49]]\n[1] 0.03076171 0.02138091 0.02394529 0.01990000\n\n[[50]]\n[1] 0.01712515 0.02313819 0.02551427 0.02051530 0.02187179\n\n[[51]]\n[1] 0.03370576 0.02138091 0.02873854\n\n[[52]]\n[1] 0.02289485 0.02394529 0.02551427 0.02873854 0.03516672\n\n[[53]]\n[1] 0.01630057 0.01979945 0.01253977\n\n[[54]]\n[1] 0.02514180 0.02039506 0.01340413 0.01990000 0.02051530 0.03516672\n\n[[55]]\n[1] 0.01280928 0.01818085 0.02187179 0.01979945 0.01882298\n\n[[56]]\n[1] 0.01036340 0.01139438 0.01198216 0.02073549 0.01214479 0.01362855 0.01341697\n\n[[57]]\n[1] 0.028079221 0.017643082 0.031423501 0.029114131 0.013520292 0.009903702\n\n[[58]]\n[1] 0.01925924 0.03142350 0.02722997 0.01434859 0.01567192\n\n[[59]]\n[1] 0.01696711 0.01265572 0.01667105 0.01785036\n\n[[60]]\n[1] 0.02419652 0.02670323 0.01696711 0.02343040\n\n[[61]]\n[1] 0.02333385 0.01265572 0.02343040 0.02514093 0.02790764 0.01219751 0.02362452\n\n[[62]]\n[1] 0.02514093 0.02002219 0.02110260\n\n[[63]]\n[1] 0.02986130 0.02790764 0.01407043 0.01805987\n\n[[64]]\n[1] 0.02911413 0.01689892\n\n[[65]]\n[1] 0.02471705\n\n[[66]]\n[1] 0.01574888 0.01726461 0.03068853 0.01954805 0.01810569\n\n[[67]]\n[1] 0.01708612 0.01726461 0.01349843 0.01361172\n\n[[68]]\n[1] 0.02109502 0.02722997 0.03068853 0.01406357 0.01546511\n\n[[69]]\n[1] 0.02174813 0.01645838 0.01419926\n\n[[70]]\n[1] 0.02631658 0.01963168 0.02278487\n\n[[71]]\n[1] 0.01473997 0.01838483 0.03197403\n\n[[72]]\n[1] 0.01874863 0.02247473 0.01476814 0.01593341 0.01963168\n\n[[73]]\n[1] 0.01500046 0.02140253 0.02278487 0.01838483 0.01652709\n\n[[74]]\n[1] 0.01150924 0.01613589 0.03197403 0.01652709 0.01342099 0.02864567\n\n[[75]]\n[1] 0.011883901 0.010533736 0.012539774 0.018822977 0.016458383 0.008217581\n\n[[76]]\n[1] 0.01352029 0.01434859 0.01689892 0.02471705 0.01954805 0.01349843 0.01406357\n\n[[77]]\n[1] 0.014736909 0.018804247 0.022761507 0.012197506 0.020022195 0.014070428\n[7] 0.008440896\n\n[[78]]\n[1] 0.02323898 0.02284457 0.01508028 0.01214479 0.01567192 0.01546511 0.01140779\n\n[[79]]\n[1] 0.01530458 0.01719415 0.01894207 0.01912542 0.01530782 0.01486508 0.02107101\n\n[[80]]\n[1] 0.01500600 0.02882915 0.02111721 0.01680129 0.01601083 0.01982700 0.01949145\n[8] 0.01362855\n\n[[81]]\n[1] 0.02947957 0.02220532 0.01150130 0.01979045 0.01896385 0.01683518\n\n[[82]]\n[1] 0.02327034 0.02644986 0.01849605 0.02108253 0.01742892\n\n[[83]]\n[1] 0.023354289 0.017142433 0.015622258 0.016714303 0.014379961 0.014593799\n[7] 0.014892965 0.018059871 0.008440896\n\n[[84]]\n[1] 0.01872915 0.02902705 0.01810569 0.01361172 0.01342099 0.01297994\n\n[[85]]\n [1] 0.011451133 0.017193502 0.013957649 0.016183544 0.009810297 0.010656545\n [7] 0.013416965 0.009903702 0.014199260 0.008217581 0.011407794\n\n[[86]]\n[1] 0.01515314 0.01502980 0.01412874 0.02163800 0.01509020 0.02689769 0.02181458\n[8] 0.02864567 0.01297994\n\n[[87]]\n[1] 0.01667105 0.02362452 0.02110260 0.02058034\n\n[[88]]\n[1] 0.01785036 0.02058034\n\n\n\n\nH5.6 Row-standardised Weights Matrix\nNext, we need to assign weights to each neighbouring polygon. In our case, each neighbouring polygon will be assigned equal weight (style=\"W\").\n\nrswm_q &lt;- nb2listw(wm_q, style=\"W\", zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\nrswm_ids &lt;- nb2listw(wm_q, glist=ids, style=\"B\", zero.policy=TRUE)\nrswm_ids\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn       S0        S1     S2\nB 88 7744 8.786867 0.3776535 3.8137\n\nrswm_q$weights[10]\n\n[[1]]\n[1] 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125\n\nsummary(unlist(rswm_ids$weights))\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n0.008218 0.015088 0.018739 0.019614 0.022823 0.040338"
  },
  {
    "objectID": "HandsOn/Hands-on_Ex05/hands-on-5.html#h5.7-applications-of-spatial-weight-matrices",
    "href": "HandsOn/Hands-on_Ex05/hands-on-5.html#h5.7-applications-of-spatial-weight-matrices",
    "title": "H5: Spatial Weights and Appliations",
    "section": "H5.7 Applications of Spatial Weight Matrices",
    "text": "H5.7 Applications of Spatial Weight Matrices\nSpatial weight matrices are used to create spatial lagged variables. In this section, four of them will be created: first with row-standardised weights, second as a sum of neighbouring values, third a spatial window average, and fourth a spatial window sum.\n\nH5.7.1 Row-standardised weights\nFirst, the average neighbour GDP per capita value for each polygon is calculated.\n\nGDPPC.lag &lt;- lag.listw(rswm_q, hunan$GDPPC)\nGDPPC.lag\n\n [1] 24847.20 22724.80 24143.25 27737.50 27270.25 21248.80 43747.00 33582.71\n [9] 45651.17 32027.62 32671.00 20810.00 25711.50 30672.33 33457.75 31689.20\n[17] 20269.00 23901.60 25126.17 21903.43 22718.60 25918.80 20307.00 20023.80\n[25] 16576.80 18667.00 14394.67 19848.80 15516.33 20518.00 17572.00 15200.12\n[33] 18413.80 14419.33 24094.50 22019.83 12923.50 14756.00 13869.80 12296.67\n[41] 15775.17 14382.86 11566.33 13199.50 23412.00 39541.00 36186.60 16559.60\n[49] 20772.50 19471.20 19827.33 15466.80 12925.67 18577.17 14943.00 24913.00\n[57] 25093.00 24428.80 17003.00 21143.75 20435.00 17131.33 24569.75 23835.50\n[65] 26360.00 47383.40 55157.75 37058.00 21546.67 23348.67 42323.67 28938.60\n[73] 25880.80 47345.67 18711.33 29087.29 20748.29 35933.71 15439.71 29787.50\n[81] 18145.00 21617.00 29203.89 41363.67 22259.09 44939.56 16902.00 16930.00\n\n\nIn the previous section, we retrieved the GDP per capita of the five neighbours with this code chunk:\n\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n[1] 20981 34592 24473 21311 22879\n\n\nWe can then append the spatially lagged GDP per capita values onto the hunan dataset by using the code chunk below, and print out the average neighbouring income values for each county. Following that, we can plot both GDP per capita and spatial lag GDP per capita for comparison.\n\nlag.list &lt;- list(hunan$NAME_3, lag.listw(rswm_q, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag.list)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag GDPPC\")\nhunan &lt;- left_join(hunan,lag.res)\n\nJoining with `by = join_by(NAME_3)`\n\nhead(hunan)\n\nSimple feature collection with 6 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 28.61762 xmax: 112.3013 ymax: 30.12812\nGeodetic CRS:  WGS 84\n   NAME_2  ID_3  NAME_3   ENGTYPE_3  County GDPPC lag GDPPC\n1 Changde 21098 Anxiang      County Anxiang 23667  24847.20\n2 Changde 21100 Hanshou      County Hanshou 20981  22724.80\n3 Changde 21101  Jinshi County City  Jinshi 34592  24143.25\n4 Changde 21102      Li      County      Li 24473  27737.50\n5 Changde 21103   Linli      County   Linli 25554  27270.25\n6 Changde 21104  Shimen      County  Shimen 27137  21248.80\n                        geometry\n1 POLYGON ((112.0625 29.75523...\n2 POLYGON ((112.2288 29.11684...\n3 POLYGON ((111.8927 29.6013,...\n4 POLYGON ((111.3731 29.94649...\n5 POLYGON ((111.6324 29.76288...\n6 POLYGON ((110.8825 30.11675...\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_gdppc &lt;- qtm(hunan, \"lag GDPPC\")\ntmap_arrange(gdppc, lag_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\n\nH5.7.2 Spatial lag as a sum of neighbouring values\nWe can also calculate spatial lag as a sum of neighbouring values by assigning binary weights. This requires us to go back to the neighbours list, apply a function to assign binary weights, then explicitly assign the weights with the glist= parameter in the nb2listw() function.\nWe start by applying a function that will assign a value of 1 per neighbour. This is done with lapply(), which was used before to manipulate neighbour structure. The lapply() a function across each value in the neighbours structure.\n\nb_weights &lt;- lapply(wm_q, function(x) 0*x + 1)\nb_weights2 &lt;- nb2listw(wm_q,\n                       glist = b_weights,\n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1    S2\nB 88 7744 448 896 10224\n\n\nWith the proper weights assigned, we can use lag.listw() to compute a lag variable from our weight and GDP per capita. We can then examine the result with the code chunk below.\n\nlag_sum &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag_sum)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag_sum GDPPC\")\nlag_sum\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 124236 113624  96573 110950 109081 106244 174988 235079 273907 256221\n[11]  98013 104050 102846  92017 133831 158446 141883 119508 150757 153324\n[21] 113593 129594 142149 100119  82884  74668  43184  99244  46549  20518\n[31] 140576 121601  92069  43258 144567 132119  51694  59024  69349  73780\n[41]  94651 100680  69398  52798 140472 118623 180933  82798  83090  97356\n[51]  59482  77334  38777 111463  74715 174391 150558 122144  68012  84575\n[61] 143045  51394  98279  47671  26360 236917 220631 185290  64640  70046\n[71] 126971 144693 129404 284074 112268 203611 145238 251536 108078 238300\n[81] 108870 108085 262835 248182 244850 404456  67608  33860\n\n\nNext, let’s left join the GDPPC field of lag_sum into the hunan dataframe. After that, we can plot both the original dataset and the spatial lag sum dataset for comparison.\n\nhunan &lt;- left_join(hunan, lag.res)\n\nJoining with `by = join_by(NAME_3)`\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum GDPPC\")\ntmap_arrange(gdppc, lag_sum_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\n\nH5.7.3 Spatial window average\nThe spatial window average uses row-standardised weights and includes the diagonal element. To do this in R, we need to go back to the neighbours structure and add the diagonal element before assigning weights with include.self(wm_q) before assigning weights.\n\nwm_qs &lt;- include.self(wm_q)\nwm_qs[[1]]\n\n[1]  1  2  3  4 57 85\n\n\nNotice that [1] now has 6 neighbours instead of 5. We can now proceed to obtain and assign weight values.\n\nwm_qs &lt;- nb2listw(wm_qs)\nwm_qs\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 30.90265 357.5308\n\nlag_w_avg_gpdpc &lt;- lag.listw(wm_qs, \n                             hunan$GDPPC)\nlag_w_avg_gpdpc\n\n [1] 24650.50 22434.17 26233.00 27084.60 26927.00 22230.17 47621.20 37160.12\n [9] 49224.71 29886.89 26627.50 22690.17 25366.40 25825.75 30329.00 32682.83\n[17] 25948.62 23987.67 25463.14 21904.38 23127.50 25949.83 20018.75 19524.17\n[25] 18955.00 17800.40 15883.00 18831.33 14832.50 17965.00 17159.89 16199.44\n[33] 18764.50 26878.75 23188.86 20788.14 12365.20 15985.00 13764.83 11907.43\n[41] 17128.14 14593.62 11644.29 12706.00 21712.29 43548.25 35049.00 16226.83\n[49] 19294.40 18156.00 19954.75 18145.17 12132.75 18419.29 14050.83 23619.75\n[57] 24552.71 24733.67 16762.60 20932.60 19467.75 18334.00 22541.00 26028.00\n[65] 29128.50 46569.00 47576.60 36545.50 20838.50 22531.00 42115.50 27619.00\n[73] 27611.33 44523.29 18127.43 28746.38 20734.50 33880.62 14716.38 28516.22\n[81] 18086.14 21244.50 29568.80 48119.71 22310.75 43151.60 17133.40 17009.33\n\n\nThe final steps are to:\n\nConvert the lag variable listw object into a dataframe;\nLeft joining our lag window back to the hunan dataframe;\nCompare the spatial lag weights and spatial window average by plotting the lag_gdppc and w_ave_dgppc maps side by side.\n\n\nlag.list.wm_qs &lt;- list(hunan$NAME_3, lag.listw(wm_qs, hunan$GDPPC))\nlag_wm_qs.res &lt;- as.data.frame(lag.list.wm_qs)\ncolnames(lag_wm_qs.res) &lt;- c(\"NAME_3\", \"lag_window_avg GDPPC\")\nhunan &lt;- left_join(hunan, lag_wm_qs.res)\n\nJoining with `by = join_by(NAME_3)`\n\n# w_avg_gdppc &lt;- qtm(hunan, \"lag_window_avg GDPPC\")\n# tmap_arrange(lag_gdppc, w_avg_gdppc, asp=1, ncol=2)\n\nTo compare the values of lag GDPPC and Spatial window average, we can use kable() from the Knitr package to prepare a table.\n\nhunan %&gt;%\n  select(\"County\", \n         \"lag GDPPC\", \n         \"lag_window_avg GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag GDPPC\nlag_window_avg GDPPC\ngeometry\n\n\n\n\nAnxiang\n24847.20\n24650.50\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n22724.80\n22434.17\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n24143.25\n26233.00\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n27737.50\n27084.60\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n27270.25\n26927.00\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n21248.80\n22230.17\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n43747.00\n47621.20\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n33582.71\n37160.12\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n45651.17\n49224.71\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n32027.62\n29886.89\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n32671.00\n26627.50\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n20810.00\n22690.17\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n25711.50\n25366.40\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n30672.33\n25825.75\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n33457.75\n30329.00\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n31689.20\n32682.83\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n20269.00\n25948.62\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n23901.60\n23987.67\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n25126.17\n25463.14\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n21903.43\n21904.38\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n22718.60\n23127.50\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n25918.80\n25949.83\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n20307.00\n20018.75\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n20023.80\n19524.17\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n16576.80\n18955.00\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n18667.00\n17800.40\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n14394.67\n15883.00\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n19848.80\n18831.33\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n15516.33\n14832.50\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518.00\n17965.00\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n17572.00\n17159.89\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n15200.12\n16199.44\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n18413.80\n18764.50\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n14419.33\n26878.75\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n24094.50\n23188.86\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n22019.83\n20788.14\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n12923.50\n12365.20\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n14756.00\n15985.00\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n13869.80\n13764.83\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n12296.67\n11907.43\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n15775.17\n17128.14\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n14382.86\n14593.62\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n11566.33\n11644.29\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n13199.50\n12706.00\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n23412.00\n21712.29\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n39541.00\n43548.25\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n36186.60\n35049.00\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n16559.60\n16226.83\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n20772.50\n19294.40\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n19471.20\n18156.00\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n19827.33\n19954.75\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n15466.80\n18145.17\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n12925.67\n12132.75\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n18577.17\n18419.29\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n14943.00\n14050.83\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n24913.00\n23619.75\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n25093.00\n24552.71\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n24428.80\n24733.67\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n17003.00\n16762.60\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n21143.75\n20932.60\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n20435.00\n19467.75\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n17131.33\n18334.00\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n24569.75\n22541.00\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n23835.50\n26028.00\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360.00\n29128.50\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n47383.40\n46569.00\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n55157.75\n47576.60\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n37058.00\n36545.50\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n21546.67\n20838.50\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n23348.67\n22531.00\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n42323.67\n42115.50\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n28938.60\n27619.00\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n25880.80\n27611.33\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n47345.67\n44523.29\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n18711.33\n18127.43\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n29087.29\n28746.38\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n20748.29\n20734.50\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n35933.71\n33880.62\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n15439.71\n14716.38\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n29787.50\n28516.22\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n18145.00\n18086.14\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n21617.00\n21244.50\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n29203.89\n29568.80\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n41363.67\n48119.71\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n22259.09\n22310.75\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n44939.56\n43151.60\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n16902.00\n17133.40\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n16930.00\n17009.33\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\n\n\nH5.7.4 Spatial Window Sum\nUnlike the spatial window average, the spatial window sum does not use row-standardised weights. The first two steps to creating our spatial window sum are the same as before - add the diagonal element from the neighbour list and assign binary weights. The lag variable is then computed with lag.listw(), then converted into a data frame and left joined back to the hunan data frame.\n\nw_sum_gdppc &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nw_sum_gdppc\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 124236 113624  96573 110950 109081 106244 174988 235079 273907 256221\n[11]  98013 104050 102846  92017 133831 158446 141883 119508 150757 153324\n[21] 113593 129594 142149 100119  82884  74668  43184  99244  46549  20518\n[31] 140576 121601  92069  43258 144567 132119  51694  59024  69349  73780\n[41]  94651 100680  69398  52798 140472 118623 180933  82798  83090  97356\n[51]  59482  77334  38777 111463  74715 174391 150558 122144  68012  84575\n[61] 143045  51394  98279  47671  26360 236917 220631 185290  64640  70046\n[71] 126971 144693 129404 284074 112268 203611 145238 251536 108078 238300\n[81] 108870 108085 262835 248182 244850 404456  67608  33860\n\nw_sum_gdppc.res &lt;- as.data.frame(w_sum_gdppc)\ncolnames(w_sum_gdppc.res) &lt;- c(\"NAME_3\", \"w_sum GDPPC\")\nhunan &lt;- left_join(hunan, w_sum_gdppc.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\nFinally, we can compare the spatial lag weights and spatial window average by plotting the lag_sum_gdppc and w_sum_gdppc maps side by side. We can also construct a kable() table to compare the results in tabular form.\n\nw_sum_gdppc &lt;- qtm(hunan, \"w_sum GDPPC\")\ntmap_arrange(lag_sum_gdppc, w_sum_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\nhunan %&gt;%\n  select(\"County\", \"lag_sum GDPPC\", \"w_sum GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag_sum GDPPC\nw_sum GDPPC\ngeometry\n\n\n\n\nAnxiang\n124236\n124236\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n113624\n113624\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n96573\n96573\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n110950\n110950\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n109081\n109081\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n106244\n106244\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n174988\n174988\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n235079\n235079\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n273907\n273907\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n256221\n256221\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n98013\n98013\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n104050\n104050\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n102846\n102846\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n92017\n92017\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n133831\n133831\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n158446\n158446\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n141883\n141883\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n119508\n119508\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n150757\n150757\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n153324\n153324\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n113593\n113593\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n129594\n129594\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n142149\n142149\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n100119\n100119\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n82884\n82884\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n74668\n74668\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n43184\n43184\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n99244\n99244\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n46549\n46549\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518\n20518\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n140576\n140576\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n121601\n121601\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n92069\n92069\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n43258\n43258\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n144567\n144567\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n132119\n132119\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n51694\n51694\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n59024\n59024\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n69349\n69349\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n73780\n73780\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n94651\n94651\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n100680\n100680\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n69398\n69398\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n52798\n52798\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n140472\n140472\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n118623\n118623\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n180933\n180933\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n82798\n82798\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n83090\n83090\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n97356\n97356\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n59482\n59482\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n77334\n77334\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n38777\n38777\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n111463\n111463\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n74715\n74715\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n174391\n174391\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n150558\n150558\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n122144\n122144\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n68012\n68012\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n84575\n84575\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n143045\n143045\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n51394\n51394\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n98279\n98279\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n47671\n47671\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360\n26360\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n236917\n236917\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n220631\n220631\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n185290\n185290\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n64640\n64640\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n70046\n70046\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n126971\n126971\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n144693\n144693\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n129404\n129404\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n284074\n284074\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n112268\n112268\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n203611\n203611\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n145238\n145238\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n251536\n251536\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n108078\n108078\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n238300\n238300\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n108870\n108870\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n108085\n108085\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n262835\n262835\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n248182\n248182\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n244850\n244850\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n404456\n404456\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n67608\n67608\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n33860\n33860\nPOLYGON ((111.3659 25.39472…"
  },
  {
    "objectID": "index.html#featured-exercises",
    "href": "index.html#featured-exercises",
    "title": "IS415: Geospatial Analytics and Applications",
    "section": "Featured Exercises",
    "text": "Featured Exercises"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html",
    "href": "TakeHome/TakeHome1/take-home-1.html",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "",
    "text": "Millions of people have their lives shattered by armed conflict every year. One of these is the Myanmar Civil War, a significant escalation of the long-running Myanmar Conflict in response to the 2021 coup d’etat.\nGeospatial analtyics holds the potential to address complex problems facing society, such as this one. This study serves to discover the sptial and spatio-temporal distribution (spread) of the latest armed conflict in Myanmar by applying spatial point pattern analysis (SPPA) methods.\n\n\nThe R packages we will use today are:\n\nsf\ntmap\nspatstat\nsparr\nraster\nmaptools\n\n\npacman::p_load(sf, raster, spatstat, sparr, tmap, tidyverse)"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.1-setting-the-scene",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.1-setting-the-scene",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "",
    "text": "Millions of people have their lives shattered by armed conflict every year. One of these is the Myanmar Civil War, a significant escalation of the long-running Myanmar Conflict in response to the 2021 coup d’etat.\nGeospatial analtyics holds the potential to address complex problems facing society, such as this one. This study serves to discover the sptial and spatio-temporal distribution (spread) of the latest armed conflict in Myanmar by applying spatial point pattern analysis (SPPA) methods.\n\n\nThe R packages we will use today are:\n\nsf\ntmap\nspatstat\nsparr\nraster\nmaptools\n\n\npacman::p_load(sf, raster, spatstat, sparr, tmap, tidyverse)"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.2-the-data",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.2-the-data",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.2 The Data",
    "text": "TH1.2 The Data\nArmed conflict data in Myanmar between January 2021 and September 2024 was downloaded from the Armed Conflict Location & Event Database (ACLED), an independent, impartial, international non-profit organization collecting data on violent conflicts and protests in all countries and territories in the world (Raleigh et al., 2023). We will be superimposing these locations with the geogrpahical boundary and subdivisions of the country, from the Myanmar Information Management Unit (MIMU).\n\nTH1.2.1 Loading armed conflict data into tibble object\nFirst, we load our aspatial armed conflict data into a tibble object.\n\nacled_mya &lt;- read_csv(\"data/2021-01-01-2024-09-16-Southeast_Asia-Myanmar.csv\")\n\nRows: 53653 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(acled_mya)\n\n# A tibble: 6 × 31\n  event_id_cnty event_date         year time_precision disorder_type  event_type\n  &lt;chr&gt;         &lt;chr&gt;             &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;     \n1 MMR66329      06 September 2024  2024              1 Political vio… Battles   \n2 MMR66334      06 September 2024  2024              1 Political vio… Explosion…\n3 MMR66353      06 September 2024  2024              1 Political vio… Explosion…\n4 MMR66365      06 September 2024  2024              1 Political vio… Explosion…\n5 MMR66368      06 September 2024  2024              1 Political vio… Battles   \n6 MMR66422      06 September 2024  2024              1 Political vio… Explosion…\n# ℹ 25 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,\n#   inter1 &lt;dbl&gt;, actor2 &lt;chr&gt;, assoc_actor_2 &lt;chr&gt;, inter2 &lt;dbl&gt;,\n#   interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;, region &lt;chr&gt;,\n#   country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;, location &lt;chr&gt;,\n#   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, geo_precision &lt;dbl&gt;, source &lt;chr&gt;,\n#   source_scale &lt;chr&gt;, notes &lt;chr&gt;, fatalities &lt;dbl&gt;, tags &lt;chr&gt;,\n#   timestamp &lt;dbl&gt;\n\n\n\n\nTH1.2.2 Loading administrative boundaries into sf object\nThree representations of Myanmar’s geography exist on the MIMU repository - Admin1 subdivides the country into its states and regions only, while Admin2 subdivides the country by its smaller districts, and Admin3 its townships. Further, the ACLED labels each incident with all 3 representations. For simplicity and ease of initial understanding, we shall use the Admin1 representation.\n\nmmr_admin1 &lt;- st_read(dsn = \"data/mmr_polbnda_adm1_250k_mimu_1\", layer = \"mmr_polbnda_adm1_250k_mimu_1\")\n\nReading layer `mmr_polbnda_adm1_250k_mimu_1' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/TakeHome/TakeHome1/data/mmr_polbnda_adm1_250k_mimu_1' \n  using driver `ESRI Shapefile'\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n\nmmr_admin1\n\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\nFirst 10 features:\n   OBJECTID          ST ST_PCODE           ST_RG          ST_MMR PCode_V\n1         1  Ayeyarwady   MMR017          Region  ဧရာဝတီတိုင်းဒေသကြီး     9.4\n2         2        Bago   MMR111          Region    ပဲခူးတိုင်းဒေသကြီး     9.4\n3         4        Chin   MMR004           State       ချင်းပြည်နယ်     9.4\n4         5      Kachin   MMR001           State       ကချင်ပြည်နယ်     9.4\n5         6       Kayah   MMR002           State       ကယားပြည်နယ်     9.4\n6         7       Kayin   MMR003           State        ကရင်ပြည်နယ်     9.4\n7         8      Magway   MMR009          Region   မကွေးတိုင်းဒေသကြီး     9.4\n8         9    Mandalay   MMR010          Region မန္တလေးတိုင်းဒေသကြီး     9.4\n9        10         Mon   MMR011           State         မွန်ပြည်နယ်     9.4\n10       11 Nay Pyi Taw   MMR018 Union Territory        နေပြည်တော်     9.4\n                         geometry\n1  MULTIPOLYGON (((95.20798 15...\n2  MULTIPOLYGON (((96.17964 19...\n3  MULTIPOLYGON (((93.36931 24...\n4  MULTIPOLYGON (((97.59674 28...\n5  MULTIPOLYGON (((97.1759 19....\n6  MULTIPOLYGON (((97.81508 16...\n7  MULTIPOLYGON (((94.11699 22...\n8  MULTIPOLYGON (((96.14023 23...\n9  MULTIPOLYGON (((97.73689 15...\n10 MULTIPOLYGON (((96.32013 20...\n\nqtm(mmr_admin1) # Plots the national boundaries of Myanmar\n\n\n\n\n\n\n\n\n\n\nTH1.2.3 Creating sf data frame from aspatial data\nThe ACLED tibble contains coordinates, making it useful for plotting on our map as points. We can therefore use it to create an sf data frame using which we can plot our points on a map. The EPSG format of the import coordinates should be 4326, corresponding to the WGS84 Geographic Coordinate System.\n\nacled_mya_sf &lt;- st_as_sf(acled_mya, coords = c(\"longitude\", \"latitude\"), crs = 4326)"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.3-using-appropriate-function-of-sf-and-tidyverse-packages-import-and-transform-the-downloaded-armed-conflict-data-and-administrative-boundary-data-into-sf-tibble-data.frames",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.3-using-appropriate-function-of-sf-and-tidyverse-packages-import-and-transform-the-downloaded-armed-conflict-data-and-administrative-boundary-data-into-sf-tibble-data.frames",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.3 Using appropriate function of sf and tidyverse packages, import and transform the downloaded armed conflict data and administrative boundary data into sf tibble data.frames",
    "text": "TH1.3 Using appropriate function of sf and tidyverse packages, import and transform the downloaded armed conflict data and administrative boundary data into sf tibble data.frames\n\nTH1.3.1 Loading R packages and importing data\nThe R packages we will use today are:\n\nsf\ntmap\nspatstat\nraster\nmaptools\n\n\npacman::p_load(sf, raster, spatstat, tmap, tidyverse)\nmmr_polbnda &lt;- st_read(dsn=\"data/mmr_polbnda_adm1_250k_mimu_1\", layer=\"mmr_polbnda_adm1_250k_mimu_1\")\n\nReading layer `mmr_polbnda_adm1_250k_mimu_1' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/TakeHome/TakeHome1/data/mmr_polbnda_adm1_250k_mimu_1' \n  using driver `ESRI Shapefile'\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n\nmmr_polbnda\n\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\nFirst 10 features:\n   OBJECTID          ST ST_PCODE           ST_RG          ST_MMR PCode_V\n1         1  Ayeyarwady   MMR017          Region  ဧရာဝတီတိုင်းဒေသကြီး     9.4\n2         2        Bago   MMR111          Region    ပဲခူးတိုင်းဒေသကြီး     9.4\n3         4        Chin   MMR004           State       ချင်းပြည်နယ်     9.4\n4         5      Kachin   MMR001           State       ကချင်ပြည်နယ်     9.4\n5         6       Kayah   MMR002           State       ကယားပြည်နယ်     9.4\n6         7       Kayin   MMR003           State        ကရင်ပြည်နယ်     9.4\n7         8      Magway   MMR009          Region   မကွေးတိုင်းဒေသကြီး     9.4\n8         9    Mandalay   MMR010          Region မန္တလေးတိုင်းဒေသကြီး     9.4\n9        10         Mon   MMR011           State         မွန်ပြည်နယ်     9.4\n10       11 Nay Pyi Taw   MMR018 Union Territory        နေပြည်တော်     9.4\n                         geometry\n1  MULTIPOLYGON (((95.20798 15...\n2  MULTIPOLYGON (((96.17964 19...\n3  MULTIPOLYGON (((93.36931 24...\n4  MULTIPOLYGON (((97.59674 28...\n5  MULTIPOLYGON (((97.1759 19....\n6  MULTIPOLYGON (((97.81508 16...\n7  MULTIPOLYGON (((94.11699 22...\n8  MULTIPOLYGON (((96.14023 23...\n9  MULTIPOLYGON (((97.73689 15...\n10 MULTIPOLYGON (((96.32013 20...\n\nacled_mya &lt;- read_csv(\"data/ACLED_Myanmar.csv\")\n\nRows: 55574 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nacled_mya\n\n# A tibble: 55,574 × 31\n   event_id_cnty event_date        year time_precision disorder_type  event_type\n   &lt;chr&gt;         &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;     \n 1 MMR56099      31 December 2023  2023              1 Political vio… Explosion…\n 2 MMR56222      31 December 2023  2023              1 Political vio… Explosion…\n 3 MMR56370      31 December 2023  2023              1 Political vio… Battles   \n 4 MMR56376      31 December 2023  2023              1 Demonstrations Protests  \n 5 MMR56380      31 December 2023  2023              1 Strategic dev… Strategic…\n 6 MMR56869      31 December 2023  2023              1 Strategic dev… Strategic…\n 7 MMR56871      31 December 2023  2023              1 Political vio… Battles   \n 8 MMR56873      31 December 2023  2023              1 Political vio… Explosion…\n 9 MMR56874      31 December 2023  2023              1 Political vio… Battles   \n10 MMR56876      31 December 2023  2023              1 Political vio… Violence …\n# ℹ 55,564 more rows\n# ℹ 25 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,\n#   inter1 &lt;dbl&gt;, actor2 &lt;chr&gt;, assoc_actor_2 &lt;chr&gt;, inter2 &lt;dbl&gt;,\n#   interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;, region &lt;chr&gt;,\n#   country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;, location &lt;chr&gt;,\n#   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, geo_precision &lt;dbl&gt;, source &lt;chr&gt;,\n#   source_scale &lt;chr&gt;, notes &lt;chr&gt;, fatalities &lt;dbl&gt;, tags &lt;chr&gt;, …"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.3-importing-and-transforming-armed-conflict-data-and-administrative-boundary-data-into-sf-tibble-data.frames",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.3-importing-and-transforming-armed-conflict-data-and-administrative-boundary-data-into-sf-tibble-data.frames",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.3 Importing and transforming armed conflict data and administrative boundary data into sf tibble data.frames",
    "text": "TH1.3 Importing and transforming armed conflict data and administrative boundary data into sf tibble data.frames\n\nTH1.3.1 Loading R packages and aspatial data\nThe R packages we will use today are:\n\nsf\ntmap\nspatstat\nraster\nmaptools\n\n\npacman::p_load(sf, raster, spatstat, tmap, tidyverse)\nacled_mya &lt;- read_csv(\"data/ACLED_Myanmar.csv\")\n\nRows: 55574 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(acled_mya)\n\n# A tibble: 6 × 31\n  event_id_cnty event_date        year time_precision disorder_type   event_type\n  &lt;chr&gt;         &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;     \n1 MMR56099      31 December 2023  2023              1 Political viol… Explosion…\n2 MMR56222      31 December 2023  2023              1 Political viol… Explosion…\n3 MMR56370      31 December 2023  2023              1 Political viol… Battles   \n4 MMR56376      31 December 2023  2023              1 Demonstrations  Protests  \n5 MMR56380      31 December 2023  2023              1 Strategic deve… Strategic…\n6 MMR56869      31 December 2023  2023              1 Strategic deve… Strategic…\n# ℹ 25 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,\n#   inter1 &lt;dbl&gt;, actor2 &lt;chr&gt;, assoc_actor_2 &lt;chr&gt;, inter2 &lt;dbl&gt;,\n#   interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;, region &lt;chr&gt;,\n#   country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;, location &lt;chr&gt;,\n#   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, geo_precision &lt;dbl&gt;, source &lt;chr&gt;,\n#   source_scale &lt;chr&gt;, notes &lt;chr&gt;, fatalities &lt;dbl&gt;, tags &lt;chr&gt;,\n#   timestamp &lt;dbl&gt;\n\n\n\n\nTH1.3.2 Loading and plotting geospatial data\nThree representations of Myanmar’s geography exist on - Admin1 subdivides the country into its states and regions only, while Admin2 subdivides the country by its smaller districts, and Admin3 its townships. Further, the ACLED labels each incident with all 3 representations. For simplicity and ease of understanding, we shall use the Admin1 representation.\n\nmmr_admin1 &lt;- st_read(dsn=\"data/mmr_polbnda_adm1_250k_mimu_1\", layer=\"mmr_polbnda_adm1_250k_mimu_1\")\n\nReading layer `mmr_polbnda_adm1_250k_mimu_1' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/TakeHome/TakeHome1/data/mmr_polbnda_adm1_250k_mimu_1' \n  using driver `ESRI Shapefile'\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n\nmmr_admin1\n\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\nFirst 10 features:\n   OBJECTID          ST ST_PCODE           ST_RG          ST_MMR PCode_V\n1         1  Ayeyarwady   MMR017          Region  ဧရာဝတီတိုင်းဒေသကြီး     9.4\n2         2        Bago   MMR111          Region    ပဲခူးတိုင်းဒေသကြီး     9.4\n3         4        Chin   MMR004           State       ချင်းပြည်နယ်     9.4\n4         5      Kachin   MMR001           State       ကချင်ပြည်နယ်     9.4\n5         6       Kayah   MMR002           State       ကယားပြည်နယ်     9.4\n6         7       Kayin   MMR003           State        ကရင်ပြည်နယ်     9.4\n7         8      Magway   MMR009          Region   မကွေးတိုင်းဒေသကြီး     9.4\n8         9    Mandalay   MMR010          Region မန္တလေးတိုင်းဒေသကြီး     9.4\n9        10         Mon   MMR011           State         မွန်ပြည်နယ်     9.4\n10       11 Nay Pyi Taw   MMR018 Union Territory        နေပြည်တော်     9.4\n                         geometry\n1  MULTIPOLYGON (((95.20798 15...\n2  MULTIPOLYGON (((96.17964 19...\n3  MULTIPOLYGON (((93.36931 24...\n4  MULTIPOLYGON (((97.59674 28...\n5  MULTIPOLYGON (((97.1759 19....\n6  MULTIPOLYGON (((97.81508 16...\n7  MULTIPOLYGON (((94.11699 22...\n8  MULTIPOLYGON (((96.14023 23...\n9  MULTIPOLYGON (((97.73689 15...\n10 MULTIPOLYGON (((96.32013 20...\n\nqtm(mmr_admin1)\n\n\n\n\n\n\n\n\n\n\nTH1.3.3 Creating sf data frame from aspatial data\nThe ACLED data contains coordinates, making it useful for plotting on our map as points. We can therefore use it to create an sf data frame which we can use to plot our points on a map. The EPSG format of the import coordinates should be 4326, corresponding to the WGS84 Geographic Coordinate System.\n\nacled_mya_sf &lt;- st_as_sf(acled_mya, coords = c(\"longitude\", \"latitude\"), crs=4326) \n\nThe EPSG area code for Myanmar is 4239. Before we work with our datasets, we will need to transform the coordinate system to use it.\n\nacled_mya_sf &lt;- acled_mya_sf %&gt;% st_transform(crs=4239)\nmmr_admin1 &lt;- mmr_admin1 %&gt;% st_transform(crs=4239)\ntm_shape(mmr_admin1) + tm_polygons() + tm_shape(acled_mya_sf) + tm_dots(size=0.05)\n\n\n\n\n\n\n\n\nAdditionally, since the data is timestamped, we are able to plot and compare the frequency of conflict events over time. Before we do, though, we need to preprocess the timestamps.\n\nacled_mya_sf &lt;- acled_mya_sf %&gt;% mutate(event_date=dmy(timestamp))\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `event_date = dmy(timestamp)`.\nCaused by warning:\n! All formats failed to parse. No formats found."
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#references",
    "href": "TakeHome/TakeHome1/take-home-1.html#references",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "References",
    "text": "References\n\nAlbert, E., & Maizland, L. (2020, January 23). What forces are fueling Myanmar’s Rohingya crisis? Council on Foreign Relations. https://www.cfr.org/backgrounder/rohingya-crisis\nDiggle, P.J. (1985). A kernel method for smoothing point process data. Applied Statistics (Journal of the Royal Statistical Society, Series C), 34, 138–147.\nMaizland, L. (2022, January 31). Myanmar’s troubled history: Coups, military rule, and ethnic conflict. Council on Foreign Relations. https://www.cfr.org/backgrounder/myanmar-history-coup-military-rule-ethnic-conflict-rohingya\nMyanmar Information Management Unit. (n.d.). Country Overview. Retrieved 16 September 2024, from https://www.themimu.info/country-overview\nRaleigh, C., Kishi, R. & Linke, A. Political instability patterns are obscured by conflict dataset scope conditions, sources, and coding choices. Humanit Soc Sci Commun 10, 74 (2023). https://doi.org/10.1057/s41599-023-01559-4\nRieffel, L. (2019, December 6). Peace and war in Myanmar. Brookings. https://www.brookings.edu/articles/peace-and-war-in-myanmar/\nScott, D.W. (1992). Multivariate Density Estimation. Theory, Practice and Visualization. New York: Wiley.\nSmith, M. (1999). Burma: Insurgency and the politics of ethnicity (2. (updated) ed). Univ. Press [u.a.].\nSullivan, D. P. (2021, October 21). Dire consequences: Addressing the humanitarian fallout from myanmar’s coup. Refugees International; Refugees International. https://www.refugeesinternational.org/reports-briefs/dire-consequences-addressing-the-humanitarian-fallout-from-myanmars-coup/\nUNDP (Ed.). (2024). Breaking the gridlock: Reimagining cooperation in a polarized world. United Nations Development Programme (UNDP)."
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html",
    "href": "InClass/ICE4/in-class-4.html",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "",
    "text": "A spatio-temporal point process (also called space-time or spatial-temporal point process) is a random collection of points, where each point represents the time and location of an event. Examples of events include incidence of disease, sightings or births of a species, or the occurrences of fires, earthquakes, lightning strikes, tsunamis, or volcanic eruptions.\nSpatio-temporal point patterns analysis (STPPA) is becoming increasingly necessary, given the rapid emergence of geographically and temporally indexed data in a wide range of fields. Several spatio-temporal point patterns analysis methods have been introduced and implemented in R in the last ten years. Today’s exercise will use data on a real-world forest fire event in Kepulauan Bangka Belitung, Indonesia from 1st January to 31st December 2023, to illustrate the methods, procedures and interpretations of STPPA.\nThis chapter shows how various R packages can be combined to run a set of spatio-temporal point pattern analyses in a guided and intuitive way. A real world forest fire event in from 1st January 2023 to 31st December 2023 is used to illustrate the methods, procedures and interpretations."
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.1-overview-and-explanation",
    "href": "InClass/ICE4/in-class-4.html#ce4.1-overview-and-explanation",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "",
    "text": "A spatio-temporal point process (also called space-time or spatial-temporal point process) is a random collection of points, where each point represents the time and location of an event. Examples of events include incidence of disease, sightings or births of a species, or the occurrences of fires, earthquakes, lightning strikes, tsunamis, or volcanic eruptions.\nSpatio-temporal point patterns analysis (STPPA) is becoming increasingly necessary, given the rapid emergence of geographically and temporally indexed data in a wide range of fields. Several spatio-temporal point patterns analysis methods have been introduced and implemented in R in the last ten years. Today’s exercise will use data on a real-world forest fire event in Kepulauan Bangka Belitung, Indonesia from 1st January to 31st December 2023, to illustrate the methods, procedures and interpretations of STPPA.\nThis chapter shows how various R packages can be combined to run a set of spatio-temporal point pattern analyses in a guided and intuitive way. A real world forest fire event in from 1st January 2023 to 31st December 2023 is used to illustrate the methods, procedures and interpretations."
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.2-research-questions",
    "href": "InClass/ICE4/in-class-4.html#ce4.2-research-questions",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.2 Research questions",
    "text": "CE4.2 Research questions\nBy the end of the exercise I hope to find out:\n\nIf the locations of forest fires in Kepulauan Bangka Belitung are spatially and spatially-temporally independent, and;\nIf not, where and when the observed forest fire locations tend to cluster."
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.3-the-data",
    "href": "InClass/ICE4/in-class-4.html#ce4.3-the-data",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.3 The data",
    "text": "CE4.3 The data\n\nforestfires, a CSV file that provides locations on forest fires from Moderate Resolution Imaging Spectroradiometer (MODIS) sensor data.\nKepulauan_Bangka_Belitung, which as the name suggests marks the boundary of the region of Kepulauan Bangka Belitung."
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.4-new-r-packages",
    "href": "InClass/ICE4/in-class-4.html#ce4.4-new-r-packages",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.4 New R Packages",
    "text": "CE4.4 New R Packages\nA new R package to be introduced today is rgdal, which is used for importing geospatial data in the GIS file format and saving it as a Spatial* DataFrame.\nIn addition, sparr gives us the ability to estimate fixed and adatptive kernel-smoothed spatial relative risk surfaces via the density-ratio method, and perform subsequent inferrence.\n\npacman::p_load(sf, raster, spatstat, tmap, tidyverse, sparr)"
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.5-importing-and-preparing-study-area",
    "href": "InClass/ICE4/in-class-4.html#ce4.5-importing-and-preparing-study-area",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.5 Importing and preparing study area",
    "text": "CE4.5 Importing and preparing study area\n\nCE4.5.1 Importing study area and creating OWIN object\n\nkbb &lt;- st_read(dsn=\"data/rawdata\", layer=\"Kepulauan_Bangka_Belitung\") %&gt;%\n  st_union() %&gt;%\n  st_zm(drop=TRUE, what=\"ZM\") %&gt;% # Drop Z-values\n  st_transform(crs=32748) # EPSG: Indonesia\n\nReading layer `Kepulauan_Bangka_Belitung' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/InClass/ICE4/data/rawdata' \n  using driver `ESRI Shapefile'\nSimple feature collection with 298 features and 27 fields\nGeometry type: POLYGON\nDimension:     XYZ\nBounding box:  xmin: 105.1085 ymin: -3.116593 xmax: 106.8488 ymax: -1.501603\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nst_as_s2(): dropping Z and/or M coordinate\n\n# This dataset keeps Z-dimension (height) data. We might want to remove it if we are to do KDE\nkbb_owin &lt;- as.owin(kbb)\nkbb_owin\n\nwindow: polygonal boundary\nenclosing rectangle: [512066.8, 705559.4] x [9655398, 9834006] units"
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.5.1-importing-study-area",
    "href": "InClass/ICE4/in-class-4.html#ce4.5.1-importing-study-area",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.5.1 Importing study area",
    "text": "CE4.5.1 Importing study area\n\nkbb &lt;- st_read(dsn=\"data/rawdata\", layer=\"Kepulauan_Bangka_Belitung\")\n\nReading layer `Kepulauan_Bangka_Belitung' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/InClass/ICE4/data/rawdata' \n  using driver `ESRI Shapefile'\nSimple feature collection with 298 features and 27 fields\nGeometry type: POLYGON\nDimension:     XYZ\nBounding box:  xmin: 105.1085 ymin: -3.116593 xmax: 106.8488 ymax: -1.501603\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "InClass/ICE4/data/rawdata/Kepulauan_Bangka_Belitung.html",
    "href": "InClass/ICE4/data/rawdata/Kepulauan_Bangka_Belitung.html",
    "title": "IS415 - Kendrick",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     \n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.5.1-importing-study-area-and-convert-to-owin",
    "href": "InClass/ICE4/in-class-4.html#ce4.5.1-importing-study-area-and-convert-to-owin",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.5.1 Importing study area and convert to OWIN",
    "text": "CE4.5.1 Importing study area and convert to OWIN\n\nkbb &lt;- st_read(dsn=\"data/rawdata\", layer=\"Kepulauan_Bangka_Belitung\") %&gt;%\n  st_union() %&gt;%\n  st_zm(drop=TRUE, what=\"ZM\") %&gt;% # Drop Z-values\n  st_transform(crs=32748) # EPSG: Indonesia\n\nReading layer `Kepulauan_Bangka_Belitung' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/InClass/ICE4/data/rawdata' \n  using driver `ESRI Shapefile'\nSimple feature collection with 298 features and 27 fields\nGeometry type: POLYGON\nDimension:     XYZ\nBounding box:  xmin: 105.1085 ymin: -3.116593 xmax: 106.8488 ymax: -1.501603\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nst_as_s2(): dropping Z and/or M coordinate\n\n# This dataset keeps Z-dimension (height) data. We might want to remove it if we are to do KDE\nkbb_owin &lt;- as.owin(kbb)\nkbb_owin\n\nwindow: polygonal boundary\nenclosing rectangle: [512066.8, 705559.4] x [9655398, 9834006] units"
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.5.1-importing-study-area-and-creating-owin-object",
    "href": "InClass/ICE4/in-class-4.html#ce4.5.1-importing-study-area-and-creating-owin-object",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.5.1 Importing study area and creating OWIN object",
    "text": "CE4.5.1 Importing study area and creating OWIN object\n\nkbb &lt;- st_read(dsn=\"data/rawdata\", layer=\"Kepulauan_Bangka_Belitung\") %&gt;%\n  st_union() %&gt;%\n  st_zm(drop=TRUE, what=\"ZM\") %&gt;% # Drop Z-values\n  st_transform(crs=32748) # EPSG: Indonesia\n\nReading layer `Kepulauan_Bangka_Belitung' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/InClass/ICE4/data/rawdata' \n  using driver `ESRI Shapefile'\nSimple feature collection with 298 features and 27 fields\nGeometry type: POLYGON\nDimension:     XYZ\nBounding box:  xmin: 105.1085 ymin: -3.116593 xmax: 106.8488 ymax: -1.501603\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nst_as_s2(): dropping Z and/or M coordinate\n\n# This dataset keeps Z-dimension (height) data. We might want to remove it if we are to do KDE\nkbb_owin &lt;- as.owin(kbb)\nkbb_owin\n\nwindow: polygonal boundary\nenclosing rectangle: [512066.8, 705559.4] x [9655398, 9834006] units\n\n\n\nfire_sf &lt;- read_csv(\"data/rawdata/forestfires.csv\") %&gt;% st_as_sf(coords=c(\"longitude\", \"latitude\"), crs=4326) %&gt;% st_transform(crs=32748)\n\nRows: 741 Columns: 15\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (3): satellite, instrument, daynight\ndbl  (11): latitude, longitude, brightness, scan, track, acq_time, confidenc...\ndate  (1): acq_date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.6-importing-and-preparing-forest-fire-data",
    "href": "InClass/ICE4/in-class-4.html#ce4.6-importing-and-preparing-forest-fire-data",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.6 Importing and preparing forest fire data",
    "text": "CE4.6 Importing and preparing forest fire data\n\n# Creating an SF dataframe from a CSV removes \"longitude\" and \"latitude\", transforming it to a \"geometry\" field\nfire_sf &lt;- read_csv(\"data/rawdata/forestfires.csv\") %&gt;% st_as_sf(coords=c(\"longitude\", \"latitude\"), crs=4326) %&gt;% st_transform(crs=32748)\n\nRows: 741 Columns: 15\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (3): satellite, instrument, daynight\ndbl  (11): latitude, longitude, brightness, scan, track, acq_time, confidenc...\ndate  (1): acq_date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWe will want to convert our SF object into ppp, which only accepts numerical or character data, later on. We will therefore need to convert our acq_date fields into numeric fields.\n\nfire_sf &lt;- fire_sf %&gt;% mutate(DayOfYear=yday(acq_date)) %&gt;%\n                      mutate(Month_num=month(acq_date)) %&gt;%\n                      mutate(Month_fac=month(acq_date, label=TRUE, abbr=FALSE))"
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.7-visualising-fire",
    "href": "InClass/ICE4/in-class-4.html#ce4.7-visualising-fire",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.7 Visualising fire",
    "text": "CE4.7 Visualising fire"
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.7-visualising-fire-locations",
    "href": "InClass/ICE4/in-class-4.html#ce4.7-visualising-fire-locations",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.7 Visualising fire locations",
    "text": "CE4.7 Visualising fire locations\n\nCE4.7.1 As points\n\n# tm_shape(kbb) + tm_polygons() + tm_shape(fire_sf) + tm_dots()\ntm_shape(kbb) + tm_polygons() + tm_shape(fire_sf) + tm_bubbles()\n\n\n\n\n\n\n\n\n\n\nCE4.7.2 Over time\n\ntm_shape(kbb) + tm_polygons() + tm_shape(fire_sf) + tm_dots(size=0.1) + tm_facets(by=\"Month_fac\", free.coords=FALSE, drop.units=TRUE)\n\n\n\n\n\n\n\n# free.coords: All points have the same coordinate pairs"
  },
  {
    "objectID": "InClass/ICE4/in-class-4.html#ce4.8-computing-stkde-by-month",
    "href": "InClass/ICE4/in-class-4.html#ce4.8-computing-stkde-by-month",
    "title": "CE4/H4: Spatial-Temporal Point Patterns Analysis",
    "section": "CE4.8 Computing STKDE by Month",
    "text": "CE4.8 Computing STKDE by Month\nUsing sparttemp.density() of the sparr package, we are able to compute spatial-temporal KDE (STKDE).\n\nCE4.8.1 Forest fires by month (ppp)\n\nfire_month &lt;- fire_sf %&gt;% select(Month_num)\nfire_month_ppp &lt;- as.ppp(fire_month)\nfire_month_ppp\n\nMarked planar point pattern: 741 points\nmarks are numeric, of storage type  'double'\nwindow: rectangle = [521564.1, 695791] x [9658137, 9828767] units\n\nsummary(fire_month_ppp)\n\nMarked planar point pattern:  741 points\nAverage intensity 2.49258e-08 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   8.000   9.000   8.579  10.000  12.000 \n\nWindow: rectangle = [521564.1, 695791] x [9658137, 9828767] units\n                    (174200 x 170600 units)\nWindow area = 29728200000 square units\n\nany(duplicated(fire_month_ppp))\n\n[1] FALSE\n\nfire_month_owin &lt;- fire_month_ppp[kbb_owin]\nsummary(fire_month_owin)\n\nMarked planar point pattern:  741 points\nAverage intensity 6.424519e-08 points per square unit\n\nCoordinates are given to 10 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   8.000   9.000   8.579  10.000  12.000 \n\nWindow: polygonal boundary\n2 separate polygons (no holes)\n           vertices        area relative.area\npolygon 1     47493 11533600000      1.00e+00\npolygon 2       256      306427      2.66e-05\nenclosing rectangle: [512066.8, 705559.4] x [9655398, 9834006] units\n                     (193500 x 178600 units)\nWindow area = 11533900000 square units\nFraction of frame area: 0.334\n\n\n\n\nCE4.8.2 Spatio-temporal KDE\n\nst_kde &lt;- spattemp.density(fire_month_owin)\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\nsummary(st_kde)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 15102.47 (spatial)\n  lambda = 0.0304 (temporal)\n\nNo. of observations\n  741 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [512066.8, 705559.4] x [9655398, 9834006]\n\nTemporal bound\n  [1, 12]\n\nEvaluation\n  128 x 128 x 12 trivariate lattice\n  Density range: [1.233458e-27, 8.202976e-10]\n\n\n\n\nCE4.8.3 Plotting the spatio-temporal KDE object\nThis code chunk plot()s the KDE for the entire year 2023. As expected, the KDEs indicate far fewer occurrences of forest fires in the area before June 2023 and in December 2023 (the rainy season usually falls between December and February.)\n\n# sparr\ntims &lt;- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)\npar(mfcol=c(1,2))\nfor (i in tims) {\n  plot(st_kde, i, override.par=FALSE, fix.range=TRUE, main=paste(\"KDE at month\", i))\n}"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.3-importing-and-transforming-armed-conflict-data-and-administrative-boundary-data-into-sf-and-tibble-dataframes",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.3-importing-and-transforming-armed-conflict-data-and-administrative-boundary-data-into-sf-and-tibble-dataframes",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.3 Importing and transforming armed conflict data and administrative boundary data into sf and tibble dataframes",
    "text": "TH1.3 Importing and transforming armed conflict data and administrative boundary data into sf and tibble dataframes\n\nTH1.3.1 Loading R packages and aspatial data\nThe R packages we will use today are:\n\nsf\ntmap\nspatstat\nraster\nmaptools\n\n\npacman::p_load(sf, raster, spatstat, tmap, tidyverse)\nacled_mya &lt;- read_csv(\"data/ACLED_Myanmar.csv\")\n\nRows: 47832 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(acled_mya)\n\n# A tibble: 6 × 31\n  event_id_cnty event_date        year time_precision disorder_type   event_type\n  &lt;chr&gt;         &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;     \n1 MMR56099      31 December 2023  2023              1 Political viol… Explosion…\n2 MMR56222      31 December 2023  2023              1 Political viol… Explosion…\n3 MMR56370      31 December 2023  2023              1 Political viol… Battles   \n4 MMR56376      31 December 2023  2023              1 Demonstrations  Protests  \n5 MMR56380      31 December 2023  2023              1 Strategic deve… Strategic…\n6 MMR56869      31 December 2023  2023              1 Strategic deve… Strategic…\n# ℹ 25 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,\n#   inter1 &lt;dbl&gt;, actor2 &lt;chr&gt;, assoc_actor_2 &lt;chr&gt;, inter2 &lt;dbl&gt;,\n#   interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;, region &lt;chr&gt;,\n#   country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;, location &lt;chr&gt;,\n#   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, geo_precision &lt;dbl&gt;, source &lt;chr&gt;,\n#   source_scale &lt;chr&gt;, notes &lt;chr&gt;, fatalities &lt;dbl&gt;, tags &lt;chr&gt;,\n#   timestamp &lt;dbl&gt;\n\n\n\n\nTH1.3.2 Loading and plotting geospatial data\nThree representations of Myanmar’s geography exist on the MIMU repository - Admin1 subdivides the country into its states and regions only, while Admin2 subdivides the country by its smaller districts, and Admin3 its townships. Further, the ACLED labels each incident with all 3 representations. For simplicity and ease of understanding, we shall use the Admin1 representation.\n\nmmr_admin1 &lt;- st_read(dsn = \"data/mmr_polbnda_adm1_250k_mimu_1\", layer = \"mmr_polbnda_adm1_250k_mimu_1\")\n\nReading layer `mmr_polbnda_adm1_250k_mimu_1' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/TakeHome/TakeHome1/data/mmr_polbnda_adm1_250k_mimu_1' \n  using driver `ESRI Shapefile'\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n\nmmr_admin1\n\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\nFirst 10 features:\n   OBJECTID          ST ST_PCODE           ST_RG          ST_MMR PCode_V\n1         1  Ayeyarwady   MMR017          Region  ဧရာဝတီတိုင်းဒေသကြီး     9.4\n2         2        Bago   MMR111          Region    ပဲခူးတိုင်းဒေသကြီး     9.4\n3         4        Chin   MMR004           State       ချင်းပြည်နယ်     9.4\n4         5      Kachin   MMR001           State       ကချင်ပြည်နယ်     9.4\n5         6       Kayah   MMR002           State       ကယားပြည်နယ်     9.4\n6         7       Kayin   MMR003           State        ကရင်ပြည်နယ်     9.4\n7         8      Magway   MMR009          Region   မကွေးတိုင်းဒေသကြီး     9.4\n8         9    Mandalay   MMR010          Region မန္တလေးတိုင်းဒေသကြီး     9.4\n9        10         Mon   MMR011           State         မွန်ပြည်နယ်     9.4\n10       11 Nay Pyi Taw   MMR018 Union Territory        နေပြည်တော်     9.4\n                         geometry\n1  MULTIPOLYGON (((95.20798 15...\n2  MULTIPOLYGON (((96.17964 19...\n3  MULTIPOLYGON (((93.36931 24...\n4  MULTIPOLYGON (((97.59674 28...\n5  MULTIPOLYGON (((97.1759 19....\n6  MULTIPOLYGON (((97.81508 16...\n7  MULTIPOLYGON (((94.11699 22...\n8  MULTIPOLYGON (((96.14023 23...\n9  MULTIPOLYGON (((97.73689 15...\n10 MULTIPOLYGON (((96.32013 20...\n\nqtm(mmr_admin1)\n\n\n\n\n\n\n\n\n\n\nTH1.3.3 Creating sf data frame from aspatial data\nThe ACLED tibble contains coordinates, making it useful for plotting on our map as points. We can therefore use it to create an sf data frame using which we can plot our points on a map. The EPSG format of the import coordinates should be 4326, corresponding to the WGS84 Geographic Coordinate System.\n\nacled_mya_sf &lt;- st_as_sf(acled_mya, coords = c(\"longitude\", \"latitude\"), crs = 4326)\n\nThe EPSG area code for Myanmar is 4239, while the WGS 84-compatible code is 32647. Since we’re creating an owin object later, we need to first convert our coordinate system.\n\nacled_mya_sf &lt;- acled_mya_sf %&gt;% st_transform(crs = 32647)\nmmr_admin1 &lt;- mmr_admin1 %&gt;% st_transform(crs = 32647)\ntm_shape(mmr_admin1) + tm_polygons() + tm_shape(acled_mya_sf) + tm_dots(size = 0.05)\n\n\n\n\n\n\n\n\nAdditionally, since the data is timestamped, we are able to plot and compare the frequency of conflict events over time. Before we do, though, we need to standardise the date stamps, then compartmentalise them into their year, month and day components, so that we can perform spatial-temporal point patterns analysis (STPPA) later.\nA visualisation of the spatial-temporial distribution of points can be found in Annex A. Notice the consistent appearance throughout the entire study period of a large cluster of points towards the west of the country - roughly the location of Rahkine state on the border with Bangladesh.\n\nacled_mya_sf &lt;- acled_mya_sf %&gt;%\n    mutate(event_date = dmy(event_date)) %&gt;%\n    mutate(DayOfYear = yday(event_date)) %&gt;%\n    mutate(Month_num = format(event_date, \"%Y-%m\")) %&gt;%  # Year-Month format\n    mutate(Month_fac = factor(format(event_date, \"%B %Y\"))) %&gt;% # Full month\n    mutate(Quarter = paste0(year(event_date), \"-\", quarter(event_date), \"Q\"))  # Quarter format\nacled_mya_sf\n\nSimple feature collection with 47832 features and 33 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -207135 ymin: 1103500 xmax: 640934.5 ymax: 3042960\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 47,832 × 34\n   event_id_cnty event_date  year time_precision disorder_type        event_type\n * &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;     \n 1 MMR56099      2023-12-31  2023              1 Political violence   Explosion…\n 2 MMR56222      2023-12-31  2023              1 Political violence   Explosion…\n 3 MMR56370      2023-12-31  2023              1 Political violence   Battles   \n 4 MMR56376      2023-12-31  2023              1 Demonstrations       Protests  \n 5 MMR56380      2023-12-31  2023              1 Strategic developme… Strategic…\n 6 MMR56869      2023-12-31  2023              1 Strategic developme… Strategic…\n 7 MMR56871      2023-12-31  2023              1 Political violence   Battles   \n 8 MMR56873      2023-12-31  2023              1 Political violence   Explosion…\n 9 MMR56874      2023-12-31  2023              1 Political violence   Battles   \n10 MMR56876      2023-12-31  2023              1 Political violence   Violence …\n# ℹ 47,822 more rows\n# ℹ 28 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,\n#   inter1 &lt;dbl&gt;, actor2 &lt;chr&gt;, assoc_actor_2 &lt;chr&gt;, inter2 &lt;dbl&gt;,\n#   interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;, region &lt;chr&gt;,\n#   country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;, location &lt;chr&gt;,\n#   geo_precision &lt;dbl&gt;, source &lt;chr&gt;, source_scale &lt;chr&gt;, notes &lt;chr&gt;,\n#   fatalities &lt;dbl&gt;, tags &lt;chr&gt;, timestamp &lt;dbl&gt;, geometry &lt;POINT [m]&gt;, …\n\nquarters &lt;- unique(acled_mya_sf$Quarter)\nprint(length(quarters))\n\n[1] 20\n\nquarters\n\n [1] \"2023-4Q\" \"2023-3Q\" \"2023-2Q\" \"2023-1Q\" \"2022-4Q\" \"2022-3Q\" \"2022-2Q\"\n [8] \"2022-1Q\" \"2021-4Q\" \"2021-3Q\" \"2021-2Q\" \"2021-1Q\" \"2020-4Q\" \"2020-3Q\"\n[15] \"2020-2Q\" \"2020-1Q\" \"2019-4Q\" \"2019-3Q\" \"2019-2Q\" \"2019-1Q\"\n\n\n\n\nTH1.3.4 Final steps to prepare for KDE\nFinally, before moving on to our KDE,\n\nTH1.3.4.1 Using owin to confine study area within Myanmar borders\n\nmmr_admin1_owin &lt;- as.owin(mmr_admin1)\nplot(mmr_admin1_owin)\n\n\n\n\n\n\n\n# summary(mmr_admin1_owin)\n\n\n\nTH1.3.4.2 Creating quarterly ppp objects for KDE and merging owin\nThe code chunk below will extract quarterly\n\n# Extract quarterly armed conflict events and save to a list\nacled_ppp_list &lt;- list()\nfor (quarter in quarters) {\n  print(quarter)\n  acled_mya_quarters_subset &lt;- subset(acled_mya_sf, acled_mya_sf$Quarter == quarter)\n  acled_mya_quarter_ppp &lt;- as.ppp(acled_mya_quarters_subset)\n  acled_mya_quarter_ppp &lt;- acled_mya_quarter_ppp[mmr_admin1_owin]\n  acled_ppp_list[[as.character(quarter)]] &lt;- acled_mya_quarter_ppp\n  plot(acled_mya_quarter_ppp)\n}\n\n[1] \"2023-4Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\n\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 3761 symbols are shown in the symbol map\n\n\n[1] \"2023-3Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\n\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 3195 symbols are shown in the symbol map\n\n\n[1] \"2023-2Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 2725 symbols are shown in the symbol map\n\n\n[1] \"2023-1Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 3021 symbols are shown in the symbol map\n\n\n[1] \"2022-4Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 3400 symbols are shown in the symbol map\n\n\n[1] \"2022-3Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 3759 symbols are shown in the symbol map\n\n\n[1] \"2022-2Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 4111 symbols are shown in the symbol map\n\n\n[1] \"2022-1Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 4265 symbols are shown in the symbol map\n\n\n[1] \"2021-4Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 4452 symbols are shown in the symbol map\n\n\n[1] \"2021-3Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 3393 symbols are shown in the symbol map\n\n\n[1] \"2021-2Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 4737 symbols are shown in the symbol map\n\n\n[1] \"2021-1Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 3692 symbols are shown in the symbol map\n\n\n[1] \"2020-4Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 281 symbols are shown in the symbol map\n\n\n[1] \"2020-3Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 276 symbols are shown in the symbol map\n\n\n[1] \"2020-2Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 328 symbols are shown in the symbol map\n\n\n[1] \"2020-1Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 614 symbols are shown in the symbol map\n\n\n[1] \"2019-4Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 600 symbols are shown in the symbol map\n\n\n[1] \"2019-3Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 504 symbols are shown in the symbol map\n\n\n[1] \"2019-2Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 334 symbols are shown in the symbol map\n\n\n[1] \"2019-1Q\"\n\n\nWarning in as.ppp.sf(acled_mya_quarters_subset): only first attribute column is\nused for marks\nWarning in as.ppp.sf(acled_mya_quarters_subset): Too many types to display\nevery type as a different character\n\n\n\n\n\n\n\n\n\nWarning: Only 10 out of 377 symbols are shown in the symbol map\n\n\n\n\n\n\n\n\n# Create all-encompassing ppp\nacled_mya_ppp &lt;- as.ppp(acled_mya_sf)\n\nWarning in as.ppp.sf(acled_mya_sf): only first attribute column is used for\nmarks\n\nacled_mya_ppp &lt;- acled_mya_ppp[mmr_admin1_owin]\nplot(acled_mya_ppp)\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 47825 symbols are shown in the symbol map\n\n\n\n\n\n\n\n\nacled_mya_ppp\n\nMarked planar point pattern: 47825 points\nmarks are of storage type  'character'\nwindow: polygonal boundary\nenclosing rectangle: [-210008.6, 724647.6] x [1072026.3, 3158467.1] units\n\n\n\n\nTH1.3.4.3 Handling duplicates\nFirst, we check if there are duplicated points in the ACLED ppp.\n\n# any(duplicated(acled_mya_ppp))\n# sum(multiplicity(acled_mya_ppp) &gt; 1)\n\n\n\nTH1.3.4.4 Combining point events object and owin\n\n# acled_mya_ppp = acled_mya_ppp[mmr_admin1_owin]\n# plot(acled_mya_ppp)"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#annex-a-spatial-temporal-distribution-of-armed-conflict-occurrences-in-myanmar-between-2019-and-2023",
    "href": "TakeHome/TakeHome1/take-home-1.html#annex-a-spatial-temporal-distribution-of-armed-conflict-occurrences-in-myanmar-between-2019-and-2023",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "Annex A: Spatial-temporal distribution of armed conflict occurrences in Myanmar between 2019 and 2023",
    "text": "Annex A: Spatial-temporal distribution of armed conflict occurrences in Myanmar between 2019 and 2023"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.4-interlude-a-brief-history-of-myanmars-ethnic-groups",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.4-interlude-a-brief-history-of-myanmars-ethnic-groups",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.4 Interlude: A brief history of Myanmar’s ethnic groups",
    "text": "TH1.4 Interlude: A brief history of Myanmar’s ethnic groups"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.5-first-order-sppa",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.5-first-order-sppa",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.5 First Order SPPA",
    "text": "TH1.5 First Order SPPA"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.5-first-order-sppa---kde",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.5-first-order-sppa---kde",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.5 First Order SPPA - KDE",
    "text": "TH1.5 First Order SPPA - KDE\nKernel density estimation (KDE) serves to compute the intensity of a point distribution. It has two general steps: first to compute the point intensity, followed by spatial interpolation using a kernel function. Using KDE, we can determine the general region of Myanmar with the highest incidence of armed conflict.\n\nTH1.5.1 Overall Fixed-Bandwidth KDE\n\n\nTH1.5.2 Overall adaptive-bandwidth KDE\n\n\nTH1.5.3 Quarterly fixed-bandwidth KDE\n\n\nTH1.5.4 Quarterly adaptive-bandwidth KDE"
  },
  {
    "objectID": "InClass/ICE5/in-class-5.html",
    "href": "InClass/ICE5/in-class-5.html",
    "title": "CE5: Geographically-weighted statistics with gwModel",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse, knitr, GWmodel)"
  },
  {
    "objectID": "InClass/ICE5/in-class-5.html#ce5.1-loading-package",
    "href": "InClass/ICE5/in-class-5.html#ce5.1-loading-package",
    "title": "CE5: Geographically-weighted statistics with gwModel",
    "section": "",
    "text": "pacman::p_load(sf, raster, spatstat, sparr, tmap, tidyverse, GWmodel)"
  },
  {
    "objectID": "InClass/ICE5/in-class-5.html#ce5.1-loading-packages",
    "href": "InClass/ICE5/in-class-5.html#ce5.1-loading-packages",
    "title": "CE5: Geographically-weighted statistics with gwModel",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse, knitr, GWmodel)"
  },
  {
    "objectID": "InClass/ICE5/in-class-5.html#ce5.2-preparing-data",
    "href": "InClass/ICE5/in-class-5.html#ce5.2-preparing-data",
    "title": "CE5: Geographically-weighted statistics with gwModel",
    "section": "CE5.2 Preparing data",
    "text": "CE5.2 Preparing data\n\nCE5.2.1 Importing Hunan data shapefile\n\nhunan &lt;- st_read(dsn = \"data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/InClass/ICE5/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\nCE5.2.2 Importing Hunan 2012 Census Data\n\ndev_2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\nCE5.2.3 Relational Join\n\nhunan &lt;- left_join(hunan, dev_2012) %&gt;%\n  select(1:3, 7, 15, 16, 31, 32)\n\nJoining with `by = join_by(County)`\n\n  # Only selects fields we are interested in, in this case GDP per capita\n\n\n\nCE5.2.4 Save/load joined data\n\n# To save the need to regenerate the table later\nwrite_rds(hunan, \"data/rds/hunan_sf.rds\")\n\n\nhunan &lt;- read_rds(\"data/rds/hunan_sf.rds\")"
  },
  {
    "objectID": "InClass/ICE5/in-class-5.html#ce5.3-converting-to-spatialpolygondataframe",
    "href": "InClass/ICE5/in-class-5.html#ce5.3-converting-to-spatialpolygondataframe",
    "title": "CE5: Geographically-weighted statistics with gwModel",
    "section": "CE5.3 Converting to SpatialPolygonDataFrame",
    "text": "CE5.3 Converting to SpatialPolygonDataFrame\nGWmodel, being a relatively older package, requires spatial data to be represented as sp objects.\n\nhunan_sp &lt;- hunan %&gt;% as_Spatial()"
  },
  {
    "objectID": "InClass/ICE5/in-class-5.html#ce5.4-geographically-weighted-summary-statistics-with-adaptive-bandwidth",
    "href": "InClass/ICE5/in-class-5.html#ce5.4-geographically-weighted-summary-statistics-with-adaptive-bandwidth",
    "title": "CE5: Geographically-weighted statistics with gwModel",
    "section": "CE5.4 Geographically weighted summary statistics with adaptive bandwidth",
    "text": "CE5.4 Geographically weighted summary statistics with adaptive bandwidth\n\nCE5.4.1 AIC\n\nbw_AIC &lt;- bw.gwr(GDPPC ~ 1, data = hunan_sp, approach=\"AIC\", adaptive=TRUE, kernel=\"bisquare\", longlat=T)\n\nAdaptive bandwidth (number of nearest neighbours): 62 AICc value: 1923.156 \nAdaptive bandwidth (number of nearest neighbours): 46 AICc value: 1920.469 \nAdaptive bandwidth (number of nearest neighbours): 36 AICc value: 1917.324 \nAdaptive bandwidth (number of nearest neighbours): 29 AICc value: 1916.661 \nAdaptive bandwidth (number of nearest neighbours): 26 AICc value: 1914.897 \nAdaptive bandwidth (number of nearest neighbours): 22 AICc value: 1914.045 \nAdaptive bandwidth (number of nearest neighbours): 22 AICc value: 1914.045 \n\nbw_AIC\n\n[1] 22\n\n# GDPPC ~ 1: Defines the independent variable\n\n\n\nCE5.4.2 Cross-validation\n\nbw_CV &lt;- bw.gwr(GDPPC ~ 1, data = hunan_sp, approach=\"CV\", adaptive=FALSE, kernel=\"bisquare\", longlat=T)\n\nFixed bandwidth: 357.4897 CV score: 16265191728 \nFixed bandwidth: 220.985 CV score: 14954930931 \nFixed bandwidth: 136.6204 CV score: 14134185837 \nFixed bandwidth: 84.48025 CV score: 13693362460 \nFixed bandwidth: 52.25585 CV score: Inf \nFixed bandwidth: 104.396 CV score: 13891052305 \nFixed bandwidth: 72.17162 CV score: 13577893677 \nFixed bandwidth: 64.56447 CV score: 14681160609 \nFixed bandwidth: 76.8731 CV score: 13444716890 \nFixed bandwidth: 79.77877 CV score: 13503296834 \nFixed bandwidth: 75.07729 CV score: 13452450771 \nFixed bandwidth: 77.98296 CV score: 13457916138 \nFixed bandwidth: 76.18716 CV score: 13442911302 \nFixed bandwidth: 75.76323 CV score: 13444600639 \nFixed bandwidth: 76.44916 CV score: 13442994078 \nFixed bandwidth: 76.02523 CV score: 13443285248 \nFixed bandwidth: 76.28724 CV score: 13442844774 \nFixed bandwidth: 76.34909 CV score: 13442864995 \nFixed bandwidth: 76.24901 CV score: 13442855596 \nFixed bandwidth: 76.31086 CV score: 13442847019 \nFixed bandwidth: 76.27264 CV score: 13442846793 \nFixed bandwidth: 76.29626 CV score: 13442844829 \nFixed bandwidth: 76.28166 CV score: 13442845238 \nFixed bandwidth: 76.29068 CV score: 13442844678 \nFixed bandwidth: 76.29281 CV score: 13442844691 \nFixed bandwidth: 76.28937 CV score: 13442844698 \nFixed bandwidth: 76.2915 CV score: 13442844676 \nFixed bandwidth: 76.292 CV score: 13442844679 \nFixed bandwidth: 76.29119 CV score: 13442844676 \nFixed bandwidth: 76.29099 CV score: 13442844676 \nFixed bandwidth: 76.29131 CV score: 13442844676 \nFixed bandwidth: 76.29138 CV score: 13442844676 \nFixed bandwidth: 76.29126 CV score: 13442844676 \nFixed bandwidth: 76.29123 CV score: 13442844676 \n\nbw_CV\n\n[1] 76.29126"
  },
  {
    "objectID": "InClass/ICE5/in-class-5.html#ce5.5-geographically-weighted-summary-statistics-with-fixed-bandwidth",
    "href": "InClass/ICE5/in-class-5.html#ce5.5-geographically-weighted-summary-statistics-with-fixed-bandwidth",
    "title": "CE5: Geographically-weighted statistics with gwModel",
    "section": "CE5.5 Geographically weighted summary statistics with fixed bandwidth",
    "text": "CE5.5 Geographically weighted summary statistics with fixed bandwidth\n\nCE5.5.1 AIC\n\nbw_AIC &lt;- bw.gwr(GDPPC ~ 1, data = hunan_sp, approach=\"AIC\", adaptive=FALSE, kernel=\"bisquare\", longlat=T)\n\nFixed bandwidth: 357.4897 AICc value: 1927.631 \nFixed bandwidth: 220.985 AICc value: 1921.547 \nFixed bandwidth: 136.6204 AICc value: 1919.993 \nFixed bandwidth: 84.48025 AICc value: 1940.603 \nFixed bandwidth: 168.8448 AICc value: 1919.457 \nFixed bandwidth: 188.7606 AICc value: 1920.007 \nFixed bandwidth: 156.5362 AICc value: 1919.41 \nFixed bandwidth: 148.929 AICc value: 1919.527 \nFixed bandwidth: 161.2377 AICc value: 1919.392 \nFixed bandwidth: 164.1433 AICc value: 1919.403 \nFixed bandwidth: 159.4419 AICc value: 1919.393 \nFixed bandwidth: 162.3475 AICc value: 1919.394 \nFixed bandwidth: 160.5517 AICc value: 1919.391 \n\nbw_AIC\n\n[1] 160.5517\n\n# GDPPC ~ 1: Defines the independent variable\n\n\n\nCE5.5.2 Cross-validation\n\nbw_CV &lt;- bw.gwr(GDPPC ~ 1, data = hunan_sp, approach=\"CV\", adaptive=FALSE, kernel=\"bisquare\", longlat=T)\n\nFixed bandwidth: 357.4897 CV score: 16265191728 \nFixed bandwidth: 220.985 CV score: 14954930931 \nFixed bandwidth: 136.6204 CV score: 14134185837 \nFixed bandwidth: 84.48025 CV score: 13693362460 \nFixed bandwidth: 52.25585 CV score: Inf \nFixed bandwidth: 104.396 CV score: 13891052305 \nFixed bandwidth: 72.17162 CV score: 13577893677 \nFixed bandwidth: 64.56447 CV score: 14681160609 \nFixed bandwidth: 76.8731 CV score: 13444716890 \nFixed bandwidth: 79.77877 CV score: 13503296834 \nFixed bandwidth: 75.07729 CV score: 13452450771 \nFixed bandwidth: 77.98296 CV score: 13457916138 \nFixed bandwidth: 76.18716 CV score: 13442911302 \nFixed bandwidth: 75.76323 CV score: 13444600639 \nFixed bandwidth: 76.44916 CV score: 13442994078 \nFixed bandwidth: 76.02523 CV score: 13443285248 \nFixed bandwidth: 76.28724 CV score: 13442844774 \nFixed bandwidth: 76.34909 CV score: 13442864995 \nFixed bandwidth: 76.24901 CV score: 13442855596 \nFixed bandwidth: 76.31086 CV score: 13442847019 \nFixed bandwidth: 76.27264 CV score: 13442846793 \nFixed bandwidth: 76.29626 CV score: 13442844829 \nFixed bandwidth: 76.28166 CV score: 13442845238 \nFixed bandwidth: 76.29068 CV score: 13442844678 \nFixed bandwidth: 76.29281 CV score: 13442844691 \nFixed bandwidth: 76.28937 CV score: 13442844698 \nFixed bandwidth: 76.2915 CV score: 13442844676 \nFixed bandwidth: 76.292 CV score: 13442844679 \nFixed bandwidth: 76.29119 CV score: 13442844676 \nFixed bandwidth: 76.29099 CV score: 13442844676 \nFixed bandwidth: 76.29131 CV score: 13442844676 \nFixed bandwidth: 76.29138 CV score: 13442844676 \nFixed bandwidth: 76.29126 CV score: 13442844676 \nFixed bandwidth: 76.29123 CV score: 13442844676 \n\nbw_CV\n\n[1] 76.29126\n\n\n\n\nCE5.5.3 Computing geographically weighted summary statistics\n\ngwstat &lt;- gwss(data=hunan_sp, vars=\"GDPPC\", bw=bw_AIC, kernel=\"bisquare\", adaptive=TRUE, longlat=T)\n\n\nCE5.5.3.1 Preparing the output data\n\ngwstat_df &lt;- as.data.frame(gwstat$SDF)\n\ncbind() is then used to append the newly derived dataframe to hunan_sf.\n\nhunan_gstat &lt;- cbind(hunan, gwstat_df)"
  },
  {
    "objectID": "InClass/ICE5/in-class-5.html#ce5.6-visualising-geographically-weighted-summary-statistics",
    "href": "InClass/ICE5/in-class-5.html#ce5.6-visualising-geographically-weighted-summary-statistics",
    "title": "CE5: Geographically-weighted statistics with gwModel",
    "section": "CE5.6 Visualising geographically-weighted summary statistics",
    "text": "CE5.6 Visualising geographically-weighted summary statistics\n\ntm_shape(hunan_gstat) + tm_fill(\"GDPPC_LM\", n=5, style=\"quantile\") + tm_borders(alpha=0.5) + tm_layout(main.title=\"Distribution of geographically weighted mean\", main.title.position = \"center\", main.title.size = 1, legend.text.size = 0.5, legend.height = 1.5, legend.width = 1.5, frame = TRUE)"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.3-a-brief-summary-of-myanmar-and-the-myanmar-conflict",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.3-a-brief-summary-of-myanmar-and-the-myanmar-conflict",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.3 A brief summary of Myanmar and the Myanmar Conflict",
    "text": "TH1.3 A brief summary of Myanmar and the Myanmar Conflict\nWe have imported our R packages and loaded our datasets, but before we move on, it is useful to present a brief introduction to the country of Myanmar and the evolution of its longstanding conflict to the state it is today.\nThe second largest country in Southeast Asia at 676,578 square kilometres and an ASEAN member state, Myanmar features fertile tropical deltas in the south and the rugged Himalayan foothills to its north. It shares borders with China to the north and northeast, Laos and Thailand to the east and Southeast, and Bangladesh and India to the west and northwest. Despite having a 2800km coastline providing access to deep-sea ports and an abundance in natural resources including arable land, forests, minerals and natural gas, conflict-ridden Myanmar is considered a least developed country, with a GNP per capita of US$1144 (2011) (Myanmar Information Management Unit, n.d.) and a HDI of 0.6 (UNDP, 2024). Consequently, agriculture accounts for 36% of GDP and 60-70% of employment.\nMyanmar is organised into seven states, seven regions including its largest city Yangon, and one union territory - its capital, Naypyitaw, located at around the country’s geographic centre. The states - Chin, Kachin, Kayah, Kyain, Mon, Rakhine and Shan - are largely populated by the national ethnic communities, while most of the inhabitants of its regions - Ayeyarwady, Bago, Mandalay, Sagaing, Tanintharyi and largest city Yangon - are of the majority Bamar (Burmese) ethnicity. The following code chunk plots the states and regions of Myanmar into an interactive map.\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(mmr_admin1) + tm_polygons()\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\nCrucially, Myanmar is one of the world’s most ethnically diverse countries, with as many as 135 different ethnic groups boasting a rich tapestry of culture and religious history (Maizland, 2022). While this may paint a rosy picture of cultural beauty on the surface, this is far from reality in the country. While the majority Bamar enjoy a privileged position in society and have held of government and military positions, many of the country’s minority groups grapple with systemic discrimination, lack of economic opportunity and development, minimum representation in government, and abuses at the hands of the military.\nThe code chunk below visualises Myanmar’s ethnic breakdown in a pie chart, based on data from the US CIA World Factbook and presented by Maizland (2022).\n\n# Plot the composition of ethnic groups in Myanmar\nx &lt;- c(2, 2, 3, 4, 5, 7, 9, 68)\ny &lt;- c(\"Indian\", \"Mon\", \"Chinese\", \"Rakhine\", \"Other\", \"Karen\", \"Shan\", \"Bamar\")\n\ny &lt;- paste(y, x)\ny &lt;- paste(y, \"%\", sep=\"\")\n\npie(x, labels = y, main = \"Composition of Ethnic Groups in Myanmar (Maizland, 2022)\", col = c(\"#999999\", \"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \"#D55E00\", \"#CC79A7\"))\n\n\n\n\n\n\n\n# legend(\"topright\", y, cex = 0.8, fill = c(\"#999999\", \"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \"#D55E00\", \"#CC79A7\"))\n\nBecause of this disparity - and partially as a result of the British using a divide-and-conquer strategy during the colonial era - lengthy armed conflicts have ensued since Myanmar’s independence between the ethnic groups (comprising ethnic armed organisations and smaller militias) and the Tatmadaw, the military, creating what is perhaps the world’s longest continuing civil war (Rieffel, 2019). The different ethnic groups of Myanmar fight over many issues, from greater autonomy to control over natural resources. This did not stop even after the country underwent a democratic reform in the early 2010s - since 2017, the Tatmadaw had been mounting a brutal campaign against the ethnic Rohingya (Albert & Maizland, 2020). While the administration of since-deposed state chancellor Aung San Suu Kyi defended their actions, restricting press freedoms in the process, rights groups and UN officials fervently claim the Tatmadaw’s actions have amounted to genocide. The Tatmadaw has since unseated Aung San Suu Kyi in 2021 and re-established the military junta, significantly escalating tensions within the country."
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.4-data-wrangling",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.4-data-wrangling",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.4 Data wrangling",
    "text": "TH1.4 Data wrangling\n\nTH1.4.1 Coordinate system conversion\nThe EPSG area code for Myanmar is 4239, while the WGS 84-compatible code is 32647. Since we’re creating an owin object later, we need to first convert our coordinate system.\n\nacled_mya_sf &lt;- acled_mya_sf %&gt;% st_transform(crs = 32647)\nmmr_admin1 &lt;- mmr_admin1 %&gt;% st_transform(crs = 32647)\ntm_shape(mmr_admin1) + tm_polygons() + tm_shape(acled_mya_sf) + tm_dots(size = 0.05)\n\n\n\n\n\n\n\n\n\n\nTH1.4.2 Feature creation\nSince the data is timestamped, we are able to plot and compare the frequency of conflict events over time. Before we do, though, we need to standardise the date stamps, then compartmentalise them into their year, month and day components, so that we can perform spatial-temporal point patterns analysis (STPPA) later.\nAdditionally, the ACLED dataset splits the conflict incidents in Shan state into North, South and East, and incidents in the Bago region into East and West. We need to combine these into their representations in the polygon set.\n\nacled_mya_sf &lt;- acled_mya_sf %&gt;%\n    mutate(event_date = dmy(event_date)) %&gt;%\n    mutate(DayOfYear = yday(event_date)) %&gt;%\n    mutate(Month_num = format(event_date, \"%Y-%m\")) %&gt;%  # Year-Month format\n    mutate(Month_fac = factor(format(event_date, \"%B %Y\"))) %&gt;% # Full month\n    mutate(Quarter_num = ((year(event_date) - 2021) * 4) + quarter(event_date)) %&gt;% # Numbers quarters for STKDE\n    mutate(Quarter = paste(year(event_date), \"-\", quarter(event_date), \"Q\"))  %&gt;% # Quarter format\n    mutate(admin1 = case_when(\n      admin1 %in% c(\"Shan-North\", \"Shan-South\", \"Shan-East\") ~ \"Shan\",\n      admin1 %in% c(\"Bago-East\", \"Bago-West\") ~ \"Bago\",\n      TRUE ~ admin1\n    ))\n\n\n\n [1] \"Kachin\"      \"Shan\"        \"Magway\"      \"Sagaing\"     \"Chin\"       \n [6] \"Rakhine\"     \"Mandalay\"    \"Tanintharyi\" \"Kayah\"       \"Yangon\"     \n[11] \"Kayin\"       \"Mon\"         \"Ayeyarwady\"  \"Bago\"        \"Nay Pyi Taw\"\n\n\n\n\n [1] 15 14 13 12 11 10  9  8  7  6  5  4  3  2  1\n\n\n\n\n[1] 15\n\n\n [1] \"2024 - 3 Q\" \"2024 - 2 Q\" \"2024 - 1 Q\" \"2023 - 4 Q\" \"2023 - 3 Q\"\n [6] \"2023 - 2 Q\" \"2023 - 1 Q\" \"2022 - 4 Q\" \"2022 - 3 Q\" \"2022 - 2 Q\"\n[11] \"2022 - 1 Q\" \"2021 - 4 Q\" \"2021 - 3 Q\" \"2021 - 2 Q\" \"2021 - 1 Q\"\n\n\n\n# Plot points by quarter\ntm_shape(mmr_admin1) + tm_polygons() + tm_shape(acled_mya_sf) + tm_dots(size = 0.05) + tm_facets(by=\"Quarter_num\", free.coords=FALSE, drop.units = TRUE)\n\n\n\n\n\n\n\n\n\n\nSimple feature collection with 6 features and 34 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 297846.6 ymin: 1920825 xmax: 389155.2 ymax: 2653913\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 6 × 35\n  event_id_cnty event_date  year time_precision disorder_type      event_type   \n  &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;              &lt;chr&gt;        \n1 MMR11022      2021-01-02  2021              1 Political violence Explosions/R…\n2 MMR10936      2021-01-02  2021              1 Political violence Battles      \n3 MMR10933      2021-01-01  2021              1 Political violence Battles      \n4 MMR10920      2021-01-01  2021              1 Political violence Violence aga…\n5 MMR10906      2021-01-01  2021              1 Political violence Battles      \n6 MMR10932      2021-01-01  2021              1 Political violence Battles      \n# ℹ 29 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,\n#   inter1 &lt;dbl&gt;, actor2 &lt;chr&gt;, assoc_actor_2 &lt;chr&gt;, inter2 &lt;dbl&gt;,\n#   interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;, region &lt;chr&gt;,\n#   country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;, location &lt;chr&gt;,\n#   geo_precision &lt;dbl&gt;, source &lt;chr&gt;, source_scale &lt;chr&gt;, notes &lt;chr&gt;,\n#   fatalities &lt;dbl&gt;, tags &lt;chr&gt;, timestamp &lt;dbl&gt;, geometry &lt;POINT [m]&gt;,\n#   DayOfYear &lt;dbl&gt;, Month_num &lt;chr&gt;, Month_fac &lt;fct&gt;, Quarter_num &lt;dbl&gt;, …\n\n\n\n\nTH1.4.3 Using owin to confine study area within Myanmar borders\nFinally, we need to create an owin object that will be combined with any ppp objects we create later for SPPA.\n\nmmr_admin1_owin &lt;- as.owin(mmr_admin1)\nplot(mmr_admin1_owin)\n\n\n\n\n\n\n\n# summary(mmr_admin1_owin)"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.5-performing-spatial-temporal-kde",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.5-performing-spatial-temporal-kde",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.5 Performing Spatial-Temporal KDE",
    "text": "TH1.5 Performing Spatial-Temporal KDE\nOur first order of business is to identify areas of consistently high conflict using spatial-temporal kernel density estimation (KDE). We can then zoom in on these areas for deeper research on why this is the case.\nAs always, we start by creating ppp objects out of our sf objects, and checking for duplicates.\n\nacled_mya_sf_quarters &lt;- acled_mya_sf %&gt;% select(Quarter_num)\nacled_mya_quarters_ppp &lt;- as.ppp(acled_mya_sf_quarters)\nany(duplicated(acled_mya_quarters_ppp))\n\n[1] TRUE\n\n\nSince there are duplicates, we need to handle them using jittering.\n\nacled_mya_quarters_ppp &lt;- rjitter(acled_mya_quarters_ppp, retry=TRUE, nsim=1, drop=TRUE)\nany(duplicated(acled_mya_quarters_ppp))\n\n[1] FALSE\n\n\nFinally, we join the owin object mapping the borders of Myanmar to the ppp object.\n\nacled_mya_quarters_ppp &lt;- acled_mya_quarters_ppp[mmr_admin1_owin]\nplot(acled_mya_quarters_ppp)\n\n\n\n\n\n\n\nsummary(acled_mya_quarters_ppp)\n\nMarked planar point pattern:  53551 points\nAverage intensity 7.996106e-08 points per square unit\n\nCoordinates are given to 15 decimal places\n\nmarks are numeric, of type 'double'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   4.000   7.000   7.397  11.000  15.000 \n\nWindow: polygonal boundary\n3555 separate polygons (2977 holes)\n                    vertices         area relative.area\npolygon 1 (hole)           4 -1.17922e-06     -1.76e-18\npolygon 2 (hole)           4 -1.51784e-07     -2.27e-19\npolygon 3 (hole)          16 -3.19682e-05     -4.77e-17\npolygon 4 (hole)           4 -1.22376e-06     -1.83e-18\npolygon 5 (hole)           4 -2.82562e-06     -4.22e-18\npolygon 6 (hole)           4 -6.46982e-07     -9.66e-19\npolygon 7 (hole)           4 -1.71724e-07     -2.56e-19\npolygon 8 (hole)           8 -2.51690e-06     -3.76e-18\npolygon 9 (hole)           4 -7.57720e-08     -1.13e-19\npolygon 10 (hole)          4 -4.91084e-08     -7.33e-20\npolygon 11 (hole)          6 -1.39001e-06     -2.08e-18\npolygon 12 (hole)          3 -1.35988e-08     -2.03e-20\npolygon 13 (hole)          4 -6.46177e-09     -9.65e-21\npolygon 14 (hole)          6 -3.67433e-07     -5.49e-19\npolygon 15 (hole)          4 -6.96521e-09     -1.04e-20\npolygon 16 (hole)          7 -9.66998e-06     -1.44e-17\npolygon 17 (hole)          3 -2.89356e-10     -4.32e-22\npolygon 18 (hole)          3 -2.57036e-06     -3.84e-18\npolygon 19 (hole)          4 -2.15272e-09     -3.21e-21\npolygon 20 (hole)          4 -2.28390e-06     -3.41e-18\npolygon 21 (hole)          4 -1.99135e-06     -2.97e-18\npolygon 22 (hole)          4 -1.93357e-06     -2.89e-18\npolygon 23 (hole)          4 -6.97742e-07     -1.04e-18\npolygon 24 (hole)          8 -5.09105e-06     -7.60e-18\npolygon 25 (hole)          6 -7.26101e-08     -1.08e-19\npolygon 26 (hole)          4 -6.91841e-07     -1.03e-18\npolygon 27 (hole)          3 -7.31150e-11     -1.09e-22\npolygon 28 (hole)          8 -2.86981e-06     -4.29e-18\npolygon 29 (hole)          6 -9.22941e-07     -1.38e-18\npolygon 30 (hole)          6 -3.02897e-06     -4.52e-18\npolygon 31 (hole)          4 -8.89049e-08     -1.33e-19\npolygon 32 (hole)         11 -2.42073e-06     -3.61e-18\npolygon 33 (hole)          3 -4.23795e-13     -6.33e-25\npolygon 34 (hole)          4 -2.48176e-07     -3.71e-19\npolygon 35 (hole)          3 -1.85370e-08     -2.77e-20\npolygon 36 (hole)          4 -2.83385e-08     -4.23e-20\npolygon 37 (hole)          3 -4.91195e-10     -7.33e-22\npolygon 38 (hole)          6 -1.52398e-06     -2.28e-18\npolygon 39 (hole)          3 -6.44721e-07     -9.63e-19\npolygon 40 (hole)          4 -2.32264e-07     -3.47e-19\npolygon 41 (hole)          3 -6.61312e-08     -9.87e-20\npolygon 42 (hole)          3 -1.11892e-07     -1.67e-19\npolygon 43 (hole)          7 -3.16269e-08     -4.72e-20\npolygon 44 (hole)          4 -2.44134e-08     -3.65e-20\npolygon 45 (hole)          3 -3.50603e-08     -5.24e-20\npolygon 46 (hole)          4 -3.78666e-08     -5.65e-20\npolygon 47 (hole)          4 -4.96624e-10     -7.42e-22\npolygon 48 (hole)          4 -3.40331e-10     -5.08e-22\npolygon 49 (hole)          4 -1.45296e-08     -2.17e-20\npolygon 50 (hole)          6 -1.23032e-05     -1.84e-17\npolygon 51 (hole)          3 -9.08825e-08     -1.36e-19\npolygon 52 (hole)          4 -1.19443e-06     -1.78e-18\npolygon 53 (hole)          8 -2.05461e-06     -3.07e-18\npolygon 54 (hole)          8 -1.34895e-06     -2.01e-18\npolygon 55 (hole)         14 -1.01296e-05     -1.51e-17\npolygon 56 (hole)          4 -4.09782e-06     -6.12e-18\npolygon 57 (hole)          8 -5.16146e-07     -7.71e-19\npolygon 58 (hole)          8 -1.24437e-06     -1.86e-18\npolygon 59 (hole)          3 -2.71738e-10     -4.06e-22\npolygon 60 (hole)          4 -9.30785e-07     -1.39e-18\npolygon 61 (hole)          4 -5.71765e-06     -8.54e-18\npolygon 62 (hole)         16 -1.04764e-05     -1.56e-17\npolygon 63 (hole)          3 -6.05397e-10     -9.04e-22\npolygon 64 (hole)          4 -6.52246e-07     -9.74e-19\npolygon 65 (hole)          4 -2.80054e-07     -4.18e-19\npolygon 66 (hole)          6 -4.90726e-07     -7.33e-19\npolygon 67 (hole)         12 -5.92509e-06     -8.85e-18\npolygon 68 (hole)          6 -2.97467e-06     -4.44e-18\npolygon 69 (hole)         10 -1.52747e-06     -2.28e-18\npolygon 70 (hole)          4 -9.29454e-07     -1.39e-18\npolygon 71 (hole)          8 -6.23639e-06     -9.31e-18\npolygon 72 (hole)          5 -8.64266e-07     -1.29e-18\npolygon 73 (hole)          4 -4.81242e-08     -7.19e-20\npolygon 74 (hole)         16 -2.30660e-05     -3.44e-17\npolygon 75 (hole)          8 -5.25959e-06     -7.85e-18\npolygon 76 (hole)          5 -4.71377e-07     -7.04e-19\npolygon 77 (hole)          4 -1.51103e-07     -2.26e-19\npolygon 78 (hole)          3 -8.44522e-07     -1.26e-18\npolygon 79 (hole)          3 -3.82006e-10     -5.70e-22\npolygon 80                 3  0.00000e+00      0.00e+00\npolygon 81 (hole)          3 -8.99303e-11     -1.34e-22\npolygon 82 (hole)          4 -3.12397e-07     -4.66e-19\npolygon 83 (hole)          6 -2.90001e-06     -4.33e-18\npolygon 84 (hole)          3 -6.29455e-09     -9.40e-21\npolygon 85 (hole)          4 -1.40965e-08     -2.10e-20\npolygon 86 (hole)          4 -6.45745e-07     -9.64e-19\npolygon 87 (hole)          8 -6.44879e-07     -9.63e-19\npolygon 88 (hole)          3 -1.40894e-10     -2.10e-22\npolygon 89 (hole)          4 -1.28048e-06     -1.91e-18\npolygon 90 (hole)          4 -2.57033e-07     -3.84e-19\npolygon 91 (hole)          5 -9.51804e-07     -1.42e-18\npolygon 92 (hole)          3 -3.18705e-07     -4.76e-19\npolygon 93 (hole)         20 -1.49748e-05     -2.24e-17\npolygon 94 (hole)          4 -2.36338e-06     -3.53e-18\npolygon 95 (hole)         22 -5.29584e-05     -7.91e-17\npolygon 96 (hole)          6 -1.43118e-06     -2.14e-18\npolygon 97 (hole)          4 -2.75205e-06     -4.11e-18\npolygon 98 (hole)          5 -4.43529e-06     -6.62e-18\npolygon 99 (hole)          3 -5.24040e-07     -7.82e-19\npolygon 100 (hole)         3 -3.63106e-07     -5.42e-19\npolygon 101 (hole)         3 -7.97991e-09     -1.19e-20\npolygon 102 (hole)         4 -1.76305e-08     -2.63e-20\npolygon 103 (hole)         4 -6.17484e-08     -9.22e-20\npolygon 104 (hole)        12 -5.02736e-06     -7.51e-18\npolygon 105 (hole)         4 -1.17411e-06     -1.75e-18\npolygon 106 (hole)        18 -1.53693e-05     -2.29e-17\npolygon 107 (hole)         4 -1.45368e-07     -2.17e-19\npolygon 108 (hole)        19 -1.51599e-05     -2.26e-17\npolygon 109 (hole)         4 -2.89740e-02     -4.33e-14\npolygon 110 (hole)         5 -7.39370e-02     -1.10e-13\npolygon 111 (hole)        12 -8.54910e-06     -1.28e-17\npolygon 112 (hole)         6 -1.08246e-01     -1.62e-13\npolygon 113 (hole)        14 -1.24274e-05     -1.86e-17\npolygon 114 (hole)         4 -1.90050e-10     -2.84e-22\npolygon 115 (hole)         6 -5.60881e-06     -8.37e-18\npolygon 116 (hole)         4 -1.43170e-06     -2.14e-18\npolygon 117 (hole)        12 -3.49643e-06     -5.22e-18\npolygon 118 (hole)         6 -6.09677e-08     -9.10e-20\npolygon 119 (hole)         4 -7.45627e-07     -1.11e-18\npolygon 120 (hole)         6 -2.41126e-06     -3.60e-18\npolygon 121 (hole)         6 -1.45222e-07     -2.17e-19\npolygon 122 (hole)         8 -1.57620e-07     -2.35e-19\npolygon 123 (hole)         4 -2.06799e-07     -3.09e-19\npolygon 124 (hole)         4 -1.12630e-08     -1.68e-20\npolygon 125 (hole)         3 -8.75915e-12     -1.31e-23\npolygon 126 (hole)         3 -4.41734e-10     -6.60e-22\npolygon 127 (hole)         6 -1.52193e-07     -2.27e-19\npolygon 128 (hole)         3 -9.03696e-12     -1.35e-23\npolygon 129 (hole)         7 -1.07566e-07     -1.61e-19\npolygon 130 (hole)         4 -1.00064e-07     -1.49e-19\npolygon 131 (hole)         4 -6.10944e-10     -9.12e-22\npolygon 132 (hole)         4 -6.00905e-08     -8.97e-20\npolygon 133 (hole)         4 -4.63690e-08     -6.92e-20\npolygon 134 (hole)         8 -1.97860e-07     -2.95e-19\npolygon 135 (hole)         4 -1.59524e-08     -2.38e-20\npolygon 136 (hole)         4 -2.28390e-07     -3.41e-19\npolygon 137 (hole)         7 -1.93186e-06     -2.88e-18\npolygon 138 (hole)         4 -9.68302e-08     -1.45e-19\npolygon 139 (hole)         5 -4.64988e-08     -6.94e-20\npolygon 140 (hole)         5 -7.33204e-08     -1.09e-19\npolygon 141 (hole)         4 -1.16384e-07     -1.74e-19\npolygon 142 (hole)         4 -3.34594e-09     -5.00e-21\npolygon 143 (hole)        14 -8.43976e-07     -1.26e-18\npolygon 144                3  0.00000e+00      0.00e+00\npolygon 145 (hole)        10 -2.58404e-07     -3.86e-19\npolygon 146 (hole)         8 -4.37214e-07     -6.53e-19\npolygon 147 (hole)         4 -2.69646e-08     -4.03e-20\npolygon 148 (hole)        14 -7.91488e-07     -1.18e-18\npolygon 149 (hole)         4 -2.84188e-08     -4.24e-20\npolygon 150 (hole)         5 -2.68219e-09     -4.00e-21\npolygon 151 (hole)         3 -2.58426e-08     -3.86e-20\npolygon 152 (hole)         4 -9.45189e-08     -1.41e-19\npolygon 153 (hole)         6 -1.07212e-06     -1.60e-18\npolygon 154 (hole)         5 -8.02087e-08     -1.20e-19\npolygon 155 (hole)         4 -1.52812e-07     -2.28e-19\npolygon 156 (hole)         6 -1.67399e-07     -2.50e-19\npolygon 157 (hole)         4 -2.08047e-08     -3.11e-20\npolygon 158 (hole)         7 -3.57396e-07     -5.34e-19\npolygon 159 (hole)         3 -1.29130e-08     -1.93e-20\npolygon 160 (hole)         3 -8.06425e-08     -1.20e-19\npolygon 161 (hole)         4 -3.77433e-07     -5.64e-19\npolygon 162 (hole)         4 -1.00296e-07     -1.50e-19\npolygon 163 (hole)         3 -8.98589e-09     -1.34e-20\npolygon 164 (hole)         5 -1.34056e-07     -2.00e-19\npolygon 165 (hole)         4 -9.83445e-08     -1.47e-19\npolygon 166 (hole)         4 -2.00568e-07     -2.99e-19\npolygon 167 (hole)         4 -2.27760e-08     -3.40e-20\npolygon 168 (hole)         6 -1.74530e-07     -2.61e-19\npolygon 169 (hole)         7 -8.58409e-07     -1.28e-18\npolygon 170 (hole)         5 -2.57097e-06     -3.84e-18\npolygon 171                3  2.73718e-09      4.09e-21\npolygon 172 (hole)         5 -1.12534e-06     -1.68e-18\npolygon 173 (hole)         4 -5.29009e-07     -7.90e-19\npolygon 174 (hole)        14 -1.61457e-06     -2.41e-18\npolygon 175 (hole)         3 -3.71031e-08     -5.54e-20\npolygon 176 (hole)         4 -3.79353e-07     -5.66e-19\npolygon 177 (hole)         5 -1.19678e-07     -1.79e-19\npolygon 178 (hole)         4 -2.94190e-08     -4.39e-20\npolygon 179 (hole)         4 -2.78185e-07     -4.15e-19\npolygon 180 (hole)         4 -3.56031e-08     -5.32e-20\npolygon 181 (hole)         4 -9.29434e-09     -1.39e-20\npolygon 182 (hole)         5 -1.47329e-07     -2.20e-19\npolygon 183 (hole)         3 -2.03195e-08     -3.03e-20\npolygon 184 (hole)         5 -1.54881e-07     -2.31e-19\npolygon 185 (hole)         4 -4.82971e-10     -7.21e-22\npolygon 186 (hole)         5 -7.50213e-09     -1.12e-20\npolygon 187 (hole)         4 -1.59433e-08     -2.38e-20\npolygon 188 (hole)         4 -1.07874e-07     -1.61e-19\npolygon 189 (hole)        22 -1.16814e-05     -1.74e-17\npolygon 190 (hole)         3 -1.31628e-07     -1.97e-19\npolygon 191 (hole)         3 -1.19861e-09     -1.79e-21\npolygon 192                3  1.40809e-10      2.10e-22\npolygon 193 (hole)        18 -2.87101e-06     -4.29e-18\npolygon 194 (hole)         4 -5.47162e-08     -8.17e-20\npolygon 195 (hole)         3 -1.08984e-08     -1.63e-20\npolygon 196 (hole)         4 -2.26800e-07     -3.39e-19\npolygon 197 (hole)         4 -2.60332e-08     -3.89e-20\npolygon 198 (hole)         9 -3.03175e-06     -4.53e-18\npolygon 199 (hole)         3 -5.45915e-09     -8.15e-21\npolygon 200 (hole)         6 -5.72029e-07     -8.54e-19\npolygon 201 (hole)        13 -4.99957e-06     -7.47e-18\npolygon 202 (hole)        12 -1.67863e-05     -2.51e-17\npolygon 203 (hole)        13 -3.27066e-01     -4.88e-13\npolygon 204 (hole)         4 -2.29016e-09     -3.42e-21\npolygon 205 (hole)         5 -1.75108e-06     -2.61e-18\npolygon 206 (hole)        27 -2.16655e-05     -3.24e-17\npolygon 207 (hole)         4 -3.21153e-06     -4.80e-18\npolygon 208 (hole)         3 -1.82700e-08     -2.73e-20\npolygon 209 (hole)        10 -9.57521e-06     -1.43e-17\npolygon 210 (hole)         4 -1.73639e-07     -2.59e-19\npolygon 211 (hole)         4 -9.49080e-07     -1.42e-18\npolygon 212 (hole)         4 -4.13898e-07     -6.18e-19\npolygon 213 (hole)        10 -4.01841e-06     -6.00e-18\npolygon 214 (hole)         9 -3.25083e-06     -4.85e-18\npolygon 215 (hole)         4 -2.05272e-06     -3.07e-18\npolygon 216 (hole)        10 -6.71359e-06     -1.00e-17\npolygon 217 (hole)         8 -1.25283e-06     -1.87e-18\npolygon 218 (hole)         3 -6.37871e-08     -9.52e-20\npolygon 219 (hole)         7 -2.20958e-06     -3.30e-18\npolygon 220 (hole)         8 -1.11127e-06     -1.66e-18\npolygon 221 (hole)         4 -1.74725e-06     -2.61e-18\npolygon 222 (hole)         3 -4.43156e-07     -6.62e-19\npolygon 223 (hole)         5 -2.85377e-06     -4.26e-18\npolygon 224 (hole)         6 -1.17152e-06     -1.75e-18\npolygon 225 (hole)         4 -6.79930e-07     -1.02e-18\npolygon 226 (hole)         6 -1.03775e-06     -1.55e-18\npolygon 227 (hole)        11 -2.65253e-06     -3.96e-18\npolygon 228 (hole)         4 -2.80678e-06     -4.19e-18\npolygon 229 (hole)         6 -1.58031e-06     -2.36e-18\npolygon 230 (hole)        12 -5.22495e-06     -7.80e-18\npolygon 231 (hole)         6 -7.58316e-07     -1.13e-18\npolygon 232 (hole)         3 -8.68395e-11     -1.30e-22\npolygon 233 (hole)         6 -3.02978e-06     -4.52e-18\npolygon 234 (hole)         3 -4.73088e-08     -7.06e-20\npolygon 235 (hole)         6 -2.95733e-06     -4.42e-18\npolygon 236 (hole)         4 -1.54307e-07     -2.30e-19\npolygon 237 (hole)         3 -1.00078e-08     -1.49e-20\npolygon 238 (hole)         6 -7.31756e-07     -1.09e-18\npolygon 239 (hole)         3 -8.31105e-08     -1.24e-19\npolygon 240 (hole)         6 -1.21660e-06     -1.82e-18\npolygon 241 (hole)         4 -4.50645e-07     -6.73e-19\npolygon 242 (hole)         4 -8.05911e-07     -1.20e-18\npolygon 243 (hole)         4 -1.17474e-07     -1.75e-19\npolygon 244 (hole)         6 -8.07035e-07     -1.21e-18\npolygon 245 (hole)         4 -2.57062e-11     -3.84e-23\npolygon 246 (hole)        11 -3.55746e-06     -5.31e-18\npolygon 247 (hole)         4 -2.30195e-07     -3.44e-19\npolygon 248 (hole)         4 -4.05292e-09     -6.05e-21\npolygon 249 (hole)         6 -1.30161e-06     -1.94e-18\npolygon 250 (hole)         3 -9.27009e-09     -1.38e-20\npolygon 251 (hole)         4 -1.43838e-08     -2.15e-20\npolygon 252 (hole)         3 -4.13961e-07     -6.18e-19\npolygon 253 (hole)         4 -8.91297e-10     -1.33e-21\npolygon 254 (hole)         4 -6.87468e-08     -1.03e-19\npolygon 255 (hole)         4 -2.10653e-06     -3.15e-18\npolygon 256 (hole)         6 -1.63109e-06     -2.44e-18\npolygon 257 (hole)         4 -6.58467e-07     -9.83e-19\npolygon 258 (hole)         3 -1.54768e-07     -2.31e-19\npolygon 259 (hole)        18 -8.38859e-06     -1.25e-17\npolygon 260 (hole)         4 -8.28389e-11     -1.24e-22\npolygon 261 (hole)         4 -2.99172e-07     -4.47e-19\npolygon 262 (hole)         4 -5.85808e-08     -8.75e-20\npolygon 263 (hole)         4 -7.55475e-11     -1.13e-22\npolygon 264 (hole)         3 -3.52174e-07     -5.26e-19\npolygon 265 (hole)         6 -4.38405e-07     -6.55e-19\npolygon 266 (hole)         4 -5.23317e-07     -7.81e-19\npolygon 267 (hole)         4 -1.80397e-10     -2.69e-22\npolygon 268 (hole)         4 -5.04558e-08     -7.53e-20\npolygon 269 (hole)         6 -1.30117e-06     -1.94e-18\npolygon 270 (hole)         6 -1.43008e-06     -2.14e-18\npolygon 271 (hole)        10 -3.67094e-06     -5.48e-18\npolygon 272 (hole)         4 -4.48594e-08     -6.70e-20\npolygon 273 (hole)        10 -5.52927e-06     -8.26e-18\npolygon 274 (hole)         8 -3.88253e-06     -5.80e-18\npolygon 275 (hole)         4 -1.25417e-06     -1.87e-18\npolygon 276 (hole)         7 -2.01027e-06     -3.00e-18\npolygon 277 (hole)         4 -3.80010e-08     -5.67e-20\npolygon 278 (hole)         3 -5.61249e-08     -8.38e-20\npolygon 279 (hole)         4 -3.52769e-08     -5.27e-20\npolygon 280 (hole)         4 -6.43696e-07     -9.61e-19\npolygon 281 (hole)         4 -2.07381e-08     -3.10e-20\npolygon 282 (hole)         4 -1.69860e-06     -2.54e-18\npolygon 283 (hole)         6 -4.08828e-06     -6.10e-18\npolygon 284 (hole)         4 -1.84660e-07     -2.76e-19\npolygon 285 (hole)        10 -1.49409e-06     -2.23e-18\npolygon 286 (hole)         3 -8.69358e-07     -1.30e-18\npolygon 287 (hole)         3 -6.79461e-11     -1.01e-22\npolygon 288 (hole)         3 -3.55641e-07     -5.31e-19\npolygon 289 (hole)         3 -1.44619e-10     -2.16e-22\npolygon 290 (hole)        12 -3.78169e-06     -5.65e-18\npolygon 291 (hole)         4 -1.07268e-06     -1.60e-18\npolygon 292 (hole)         6 -2.11280e-07     -3.15e-19\npolygon 293 (hole)        10 -4.84998e-06     -7.24e-18\npolygon 294 (hole)         8 -3.13934e-06     -4.69e-18\npolygon 295 (hole)         3 -1.61476e-09     -2.41e-21\npolygon 296 (hole)        21 -1.58612e-05     -2.37e-17\npolygon 297 (hole)        10 -1.77996e-06     -2.66e-18\npolygon 298 (hole)         6 -2.57245e-07     -3.84e-19\npolygon 299 (hole)         5 -1.38412e-07     -2.07e-19\npolygon 300 (hole)        10 -5.95296e-06     -8.89e-18\npolygon 301 (hole)         9 -9.48127e-07     -1.42e-18\npolygon 302 (hole)         8 -8.49674e-06     -1.27e-17\npolygon 303 (hole)         4 -7.87867e-08     -1.18e-19\npolygon 304 (hole)         4 -5.26005e-07     -7.85e-19\npolygon 305 (hole)         3 -4.72282e-08     -7.05e-20\npolygon 306 (hole)         7 -1.83520e-06     -2.74e-18\npolygon 307 (hole)         7 -2.26806e-05     -3.39e-17\npolygon 308 (hole)         3 -1.30326e-08     -1.95e-20\npolygon 309 (hole)         3 -2.58013e-07     -3.85e-19\npolygon 310 (hole)         3 -3.21497e-06     -4.80e-18\npolygon 311 (hole)         4 -2.84071e-07     -4.24e-19\npolygon 312 (hole)         3 -1.31497e-12     -1.96e-24\npolygon 313 (hole)         4 -6.53285e-07     -9.75e-19\npolygon 314 (hole)         5 -1.08946e-09     -1.63e-21\npolygon 315 (hole)         4 -4.33947e-09     -6.48e-21\npolygon 316 (hole)         3 -2.44141e-07     -3.65e-19\npolygon 317 (hole)         6 -1.86637e-06     -2.79e-18\npolygon 318 (hole)         6 -5.04834e-07     -7.54e-19\npolygon 319 (hole)         6 -1.45755e-06     -2.18e-18\npolygon 320 (hole)        22 -1.23229e-05     -1.84e-17\npolygon 321 (hole)         8 -3.96507e-06     -5.92e-18\npolygon 322 (hole)         8 -3.48176e-07     -5.20e-19\npolygon 323 (hole)         3 -8.14734e-08     -1.22e-19\npolygon 324 (hole)         8 -1.85179e-06     -2.77e-18\npolygon 325 (hole)         8 -1.55650e-06     -2.32e-18\npolygon 326 (hole)        13 -6.24455e-06     -9.32e-18\npolygon 327 (hole)        16 -5.31554e-06     -7.94e-18\npolygon 328 (hole)         4 -6.92069e-08     -1.03e-19\npolygon 329 (hole)         4 -3.82693e-07     -5.71e-19\npolygon 330 (hole)         4 -5.54737e-07     -8.28e-19\npolygon 331 (hole)        16 -5.48170e-06     -8.19e-18\npolygon 332 (hole)         4 -1.31400e-08     -1.96e-20\npolygon 333 (hole)         8 -1.80531e-06     -2.70e-18\npolygon 334 (hole)         6 -1.63550e-07     -2.44e-19\npolygon 335 (hole)         4 -5.26585e-07     -7.86e-19\npolygon 336 (hole)         4 -1.54884e-07     -2.31e-19\npolygon 337 (hole)         6 -9.73839e-07     -1.45e-18\npolygon 338 (hole)        13 -4.09827e-06     -6.12e-18\npolygon 339 (hole)         4 -1.02765e-06     -1.53e-18\npolygon 340 (hole)        18 -6.88726e-06     -1.03e-17\npolygon 341 (hole)        10 -2.63104e-06     -3.93e-18\npolygon 342 (hole)         8 -2.72116e-06     -4.06e-18\npolygon 343 (hole)         4 -1.68671e-07     -2.52e-19\npolygon 344 (hole)        12 -3.23259e-06     -4.83e-18\npolygon 345 (hole)         6 -1.17038e-06     -1.75e-18\npolygon 346 (hole)         8 -3.37698e-06     -5.04e-18\npolygon 347 (hole)         4 -1.05355e-11     -1.57e-23\npolygon 348 (hole)         4 -1.52254e-09     -2.27e-21\npolygon 349 (hole)         4 -1.35663e-08     -2.03e-20\npolygon 350 (hole)         4 -3.67328e-08     -5.48e-20\npolygon 351 (hole)         4 -1.54101e-09     -2.30e-21\npolygon 352 (hole)         8 -1.13605e-06     -1.70e-18\npolygon 353 (hole)         4 -2.38757e-07     -3.57e-19\npolygon 354 (hole)        16 -2.41684e-06     -3.61e-18\npolygon 355 (hole)        39 -1.25544e-05     -1.87e-17\npolygon 356 (hole)         4 -1.99814e-08     -2.98e-20\npolygon 357 (hole)         8 -1.34242e-06     -2.00e-18\npolygon 358 (hole)         6 -7.63185e-07     -1.14e-18\npolygon 359 (hole)         4 -7.53921e-07     -1.13e-18\npolygon 360 (hole)         3 -4.37276e-09     -6.53e-21\npolygon 361 (hole)         8 -3.48924e-06     -5.21e-18\npolygon 362 (hole)         6 -1.13581e-06     -1.70e-18\npolygon 363 (hole)        40 -1.09783e-05     -1.64e-17\npolygon 364 (hole)         8 -1.87798e-06     -2.80e-18\npolygon 365 (hole)         6 -3.47210e-06     -5.18e-18\npolygon 366 (hole)        26 -1.15213e-05     -1.72e-17\npolygon 367 (hole)         3 -3.93519e-07     -5.88e-19\npolygon 368 (hole)         7 -2.38727e-06     -3.56e-18\npolygon 369 (hole)         8 -2.06048e-06     -3.08e-18\npolygon 370 (hole)         4 -1.56540e-06     -2.34e-18\npolygon 371 (hole)         5 -1.03251e-06     -1.54e-18\npolygon 372 (hole)         8 -1.11960e-06     -1.67e-18\npolygon 373 (hole)         6 -3.39517e-07     -5.07e-19\npolygon 374 (hole)        15 -5.58246e-06     -8.34e-18\npolygon 375 (hole)         3 -7.54222e-07     -1.13e-18\npolygon 376 (hole)         6 -6.10625e-07     -9.12e-19\npolygon 377 (hole)         6 -4.16709e-07     -6.22e-19\npolygon 378 (hole)         4 -7.78401e-07     -1.16e-18\npolygon 379 (hole)        12 -5.50958e-06     -8.23e-18\npolygon 380 (hole)         4 -7.27636e-08     -1.09e-19\npolygon 381 (hole)         6 -1.42155e-06     -2.12e-18\npolygon 382 (hole)        10 -1.60609e-06     -2.40e-18\npolygon 383 (hole)         4 -1.67043e-07     -2.49e-19\npolygon 384 (hole)        11 -6.26263e-06     -9.35e-18\npolygon 385 (hole)        12 -7.67542e-06     -1.15e-17\npolygon 386 (hole)         3 -2.45564e-07     -3.67e-19\npolygon 387 (hole)         4 -3.67944e-07     -5.49e-19\npolygon 388 (hole)         4 -2.89692e-07     -4.33e-19\npolygon 389 (hole)         4 -3.76234e-07     -5.62e-19\npolygon 390 (hole)         7 -5.78373e-06     -8.64e-18\npolygon 391 (hole)         4 -3.44773e-07     -5.15e-19\npolygon 392 (hole)        19 -2.15288e-06     -3.21e-18\npolygon 393 (hole)         4 -1.18289e-07     -1.77e-19\npolygon 394 (hole)         3 -5.13605e-07     -7.67e-19\npolygon 395 (hole)         4 -1.71917e-07     -2.57e-19\npolygon 396 (hole)        10 -9.61983e-06     -1.44e-17\npolygon 397 (hole)        10 -3.82411e-06     -5.71e-18\npolygon 398 (hole)         3 -8.05741e-08     -1.20e-19\npolygon 399 (hole)         4 -1.01022e-06     -1.51e-18\npolygon 400 (hole)         3 -1.91474e-11     -2.86e-23\npolygon 401 (hole)         4 -7.93468e-07     -1.18e-18\npolygon 402 (hole)         6 -5.42813e-07     -8.11e-19\npolygon 403 (hole)        22 -2.59674e-05     -3.88e-17\npolygon 404 (hole)         9 -1.41691e-05     -2.12e-17\npolygon 405 (hole)         7 -1.54774e-06     -2.31e-18\npolygon 406 (hole)        12 -1.03263e-05     -1.54e-17\npolygon 407 (hole)         4 -5.41035e-08     -8.08e-20\npolygon 408 (hole)         6 -2.04282e-06     -3.05e-18\npolygon 409 (hole)         9 -1.17809e-06     -1.76e-18\npolygon 410 (hole)        12 -7.72004e-06     -1.15e-17\npolygon 411 (hole)         3 -3.02414e-12     -4.52e-24\npolygon 412 (hole)        10 -1.83006e-06     -2.73e-18\npolygon 413 (hole)         4 -7.51067e-08     -1.12e-19\npolygon 414 (hole)        12 -4.62852e-06     -6.91e-18\npolygon 415 (hole)         3 -7.28660e-08     -1.09e-19\npolygon 416 (hole)        12 -4.05803e-06     -6.06e-18\npolygon 417 (hole)         7 -4.85696e-06     -7.25e-18\npolygon 418 (hole)         3 -7.59230e-07     -1.13e-18\npolygon 419 (hole)         5 -2.71519e-06     -4.05e-18\npolygon 420 (hole)         3 -1.71925e-06     -2.57e-18\npolygon 421 (hole)         6 -5.19131e-06     -7.75e-18\npolygon 422 (hole)         5 -2.28045e-06     -3.41e-18\npolygon 423 (hole)        10 -5.47958e-07     -8.18e-19\npolygon 424 (hole)         7 -7.38497e-06     -1.10e-17\npolygon 425 (hole)         4 -1.49686e-06     -2.24e-18\npolygon 426 (hole)         4 -5.57534e-07     -8.32e-19\npolygon 427 (hole)         3 -7.21303e-09     -1.08e-20\npolygon 428 (hole)        36 -9.98946e-06     -1.49e-17\npolygon 429 (hole)         4 -9.88173e-09     -1.48e-20\npolygon 430 (hole)        21 -3.12749e-05     -4.67e-17\npolygon 431 (hole)         6 -3.98805e-06     -5.95e-18\npolygon 432 (hole)         9 -1.90464e-06     -2.84e-18\npolygon 433 (hole)         8 -8.32697e-06     -1.24e-17\npolygon 434 (hole)        10 -5.56359e-06     -8.31e-18\npolygon 435 (hole)         3 -1.35521e-06     -2.02e-18\npolygon 436 (hole)         3 -3.11126e-07     -4.65e-19\npolygon 437 (hole)         4 -1.93201e-07     -2.88e-19\npolygon 438 (hole)         4 -2.54318e-06     -3.80e-18\npolygon 439 (hole)        16 -1.44270e-05     -2.15e-17\npolygon 440 (hole)         4 -1.41609e-07     -2.11e-19\npolygon 441 (hole)        12 -4.09743e-06     -6.12e-18\npolygon 442 (hole)         8 -1.57135e-06     -2.35e-18\npolygon 443 (hole)         4 -1.68776e-07     -2.52e-19\npolygon 444 (hole)         6 -1.99765e-06     -2.98e-18\npolygon 445 (hole)         6 -1.91744e-06     -2.86e-18\npolygon 446 (hole)         6 -1.90754e-06     -2.85e-18\npolygon 447 (hole)         6 -2.48305e-06     -3.71e-18\npolygon 448 (hole)        26 -3.01895e-05     -4.51e-17\npolygon 449 (hole)         4 -1.33556e-06     -1.99e-18\npolygon 450 (hole)        12 -1.07964e-05     -1.61e-17\npolygon 451 (hole)        19 -1.00111e-05     -1.49e-17\npolygon 452 (hole)        10 -1.34543e-06     -2.01e-18\npolygon 453 (hole)         4 -3.18526e-08     -4.76e-20\npolygon 454 (hole)        20 -3.76696e-06     -5.62e-18\npolygon 455 (hole)         8 -6.55378e-06     -9.79e-18\npolygon 456 (hole)        12 -5.89263e-06     -8.80e-18\npolygon 457 (hole)        23 -1.97073e-05     -2.94e-17\npolygon 458 (hole)         4 -9.55118e-07     -1.43e-18\npolygon 459 (hole)        12 -2.02628e-06     -3.03e-18\npolygon 460 (hole)         6 -2.44077e-06     -3.64e-18\npolygon 461 (hole)         4 -8.99374e-07     -1.34e-18\npolygon 462 (hole)         6 -4.02676e-06     -6.01e-18\npolygon 463 (hole)        10 -9.26810e-06     -1.38e-17\npolygon 464 (hole)         3 -1.31165e-11     -1.96e-23\npolygon 465 (hole)         6 -8.92634e-07     -1.33e-18\npolygon 466 (hole)        11 -7.19420e-06     -1.07e-17\npolygon 467 (hole)         4 -9.91452e-07     -1.48e-18\npolygon 468 (hole)        19 -1.62364e-05     -2.42e-17\npolygon 469 (hole)         6 -3.92848e-06     -5.87e-18\npolygon 470 (hole)        32 -2.81336e-05     -4.20e-17\npolygon 471 (hole)        16 -1.96856e-05     -2.94e-17\npolygon 472 (hole)         4 -5.09630e-07     -7.61e-19\npolygon 473 (hole)        17 -9.43900e-06     -1.41e-17\npolygon 474 (hole)         4 -8.64641e-07     -1.29e-18\npolygon 475 (hole)         3 -4.49792e-12     -6.72e-24\npolygon 476 (hole)         4 -1.27844e-06     -1.91e-18\npolygon 477 (hole)         6 -1.80469e-07     -2.69e-19\npolygon 478 (hole)         4 -1.04434e-07     -1.56e-19\npolygon 479 (hole)         4 -2.44529e-08     -3.65e-20\npolygon 480 (hole)         3 -4.09291e-12     -6.11e-24\npolygon 481                3  4.48081e-10      6.69e-22\npolygon 482 (hole)         3 -2.15225e-10     -3.21e-22\npolygon 483 (hole)         4 -8.72824e-07     -1.30e-18\npolygon 484 (hole)         4 -3.47505e-07     -5.19e-19\npolygon 485 (hole)         4 -1.84038e-06     -2.75e-18\npolygon 486 (hole)         3 -1.05492e-11     -1.58e-23\npolygon 487 (hole)         3 -1.38710e-07     -2.07e-19\npolygon 488 (hole)         7 -5.62382e-06     -8.40e-18\npolygon 489 (hole)         3 -1.50348e-07     -2.24e-19\npolygon 490 (hole)        40 -3.21663e-05     -4.80e-17\npolygon 491 (hole)        10 -5.80641e-06     -8.67e-18\npolygon 492 (hole)         7 -2.82331e-06     -4.22e-18\npolygon 493 (hole)         7 -6.20795e-06     -9.27e-18\npolygon 494 (hole)        10 -7.04963e-06     -1.05e-17\npolygon 495 (hole)         4 -1.95555e-06     -2.92e-18\npolygon 496 (hole)        16 -7.50984e-06     -1.12e-17\npolygon 497 (hole)         7 -4.40178e-07     -6.57e-19\npolygon 498 (hole)        10 -4.52628e-06     -6.76e-18\npolygon 499 (hole)        19 -7.71381e-06     -1.15e-17\npolygon 500 (hole)        16 -8.97205e-06     -1.34e-17\npolygon 501 (hole)         3 -6.37225e-10     -9.51e-22\npolygon 502 (hole)         6 -2.24910e-06     -3.36e-18\npolygon 503 (hole)         9 -2.18650e-06     -3.26e-18\npolygon 504 (hole)        12 -2.08237e-06     -3.11e-18\npolygon 505 (hole)         6 -1.76688e-06     -2.64e-18\npolygon 506 (hole)        20 -9.25321e-06     -1.38e-17\npolygon 507 (hole)        12 -2.00803e-06     -3.00e-18\npolygon 508 (hole)         8 -1.92434e-06     -2.87e-18\npolygon 509 (hole)        10 -2.57683e-06     -3.85e-18\npolygon 510 (hole)         6 -1.06924e-06     -1.60e-18\npolygon 511 (hole)        26 -1.66652e-05     -2.49e-17\npolygon 512 (hole)         4 -3.88535e-07     -5.80e-19\npolygon 513 (hole)        15 -3.79127e-06     -5.66e-18\npolygon 514 (hole)        10 -4.05429e-06     -6.05e-18\npolygon 515 (hole)         4 -2.04133e-07     -3.05e-19\npolygon 516 (hole)         6 -1.39013e-06     -2.08e-18\npolygon 517 (hole)         4 -1.21592e-07     -1.82e-19\npolygon 518 (hole)         6 -2.12920e-06     -3.18e-18\npolygon 519 (hole)         4 -9.76810e-09     -1.46e-20\npolygon 520 (hole)        18 -6.55930e-06     -9.79e-18\npolygon 521 (hole)        11 -2.22514e-06     -3.32e-18\npolygon 522 (hole)         4 -4.84253e-07     -7.23e-19\npolygon 523 (hole)         3 -5.57299e-08     -8.32e-20\npolygon 524 (hole)         3 -1.20399e-08     -1.80e-20\npolygon 525 (hole)         4 -3.24893e-07     -4.85e-19\npolygon 526 (hole)         4 -1.03541e-08     -1.55e-20\npolygon 527 (hole)        10 -1.75315e-06     -2.62e-18\npolygon 528 (hole)         9 -1.33734e-06     -2.00e-18\npolygon 529 (hole)         9 -8.38337e-07     -1.25e-18\npolygon 530 (hole)         7 -6.23885e-07     -9.32e-19\npolygon 531 (hole)         6 -2.62141e-06     -3.91e-18\npolygon 532 (hole)         4 -2.80306e-08     -4.19e-20\npolygon 533 (hole)         3 -3.90799e-08     -5.84e-20\npolygon 534 (hole)         3 -5.18751e-09     -7.75e-21\npolygon 535 (hole)         5 -3.36718e-06     -5.03e-18\npolygon 536 (hole)         4 -2.27211e-07     -3.39e-19\npolygon 537 (hole)         9 -8.96919e-07     -1.34e-18\npolygon 538 (hole)         4 -9.22478e-08     -1.38e-19\npolygon 539 (hole)         5 -2.81450e-08     -4.20e-20\npolygon 540 (hole)         4 -3.64948e-08     -5.45e-20\npolygon 541 (hole)        10 -4.17715e-06     -6.24e-18\npolygon 542 (hole)         4 -3.65585e-07     -5.46e-19\npolygon 543 (hole)         4 -6.45414e-07     -9.64e-19\npolygon 544 (hole)         3 -7.76383e-07     -1.16e-18\npolygon 545 (hole)         4 -3.38505e-08     -5.05e-20\npolygon 546 (hole)         4 -2.65357e-07     -3.96e-19\npolygon 547 (hole)         4 -1.60263e-07     -2.39e-19\npolygon 548 (hole)         6 -6.27574e-07     -9.37e-19\npolygon 549 (hole)         5 -2.76735e-06     -4.13e-18\npolygon 550 (hole)         5 -4.56093e-07     -6.81e-19\npolygon 551 (hole)         4 -4.76599e-06     -7.12e-18\npolygon 552 (hole)         4 -2.98815e-07     -4.46e-19\npolygon 553 (hole)         6 -8.97432e-07     -1.34e-18\npolygon 554 (hole)         5 -5.57552e-06     -8.33e-18\npolygon 555 (hole)         3 -1.54772e-07     -2.31e-19\npolygon 556 (hole)         3 -6.05573e-07     -9.04e-19\npolygon 557 (hole)         5 -3.37601e-06     -5.04e-18\npolygon 558 (hole)         6 -2.45701e-06     -3.67e-18\npolygon 559 (hole)         4 -3.52240e-09     -5.26e-21\npolygon 560 (hole)         5 -1.28069e-06     -1.91e-18\npolygon 561 (hole)         3 -2.06009e-08     -3.08e-20\npolygon 562 (hole)         4 -3.18981e-06     -4.76e-18\npolygon 563 (hole)         3 -9.49022e-08     -1.42e-19\npolygon 564 (hole)         3 -7.58867e-08     -1.13e-19\npolygon 565 (hole)         4 -4.33598e-07     -6.47e-19\npolygon 566 (hole)         4 -2.58341e-08     -3.86e-20\npolygon 567 (hole)         3 -2.81250e-09     -4.20e-21\npolygon 568 (hole)         4 -8.21822e-07     -1.23e-18\npolygon 569 (hole)         6 -9.66697e-07     -1.44e-18\npolygon 570 (hole)         6 -1.55890e-06     -2.33e-18\npolygon 571 (hole)         7 -4.08907e-06     -6.11e-18\npolygon 572 (hole)         3 -5.51929e-07     -8.24e-19\npolygon 573 (hole)         3 -3.00332e-07     -4.48e-19\npolygon 574 (hole)         4 -1.90988e-06     -2.85e-18\npolygon 575 (hole)         4 -5.75747e-07     -8.60e-19\npolygon 576 (hole)         4 -8.89384e-07     -1.33e-18\npolygon 577 (hole)         4 -8.97940e-07     -1.34e-18\npolygon 578 (hole)         3 -1.66733e-09     -2.49e-21\npolygon 579 (hole)         4 -1.52669e-06     -2.28e-18\npolygon 580 (hole)         3 -9.82376e-08     -1.47e-19\npolygon 581 (hole)         7 -4.20478e-07     -6.28e-19\npolygon 582 (hole)         4 -5.78404e-07     -8.64e-19\npolygon 583 (hole)         4 -1.12886e-07     -1.69e-19\npolygon 584 (hole)         4 -2.79586e-06     -4.17e-18\npolygon 585 (hole)         3 -6.11099e-07     -9.12e-19\npolygon 586 (hole)         4 -7.65090e-07     -1.14e-18\npolygon 587 (hole)         4 -4.65736e-07     -6.95e-19\npolygon 588 (hole)         3 -7.51030e-09     -1.12e-20\npolygon 589 (hole)         4 -3.92071e-08     -5.85e-20\npolygon 590 (hole)         4 -6.18955e-07     -9.24e-19\npolygon 591 (hole)         3 -3.08035e-07     -4.60e-19\npolygon 592 (hole)         6 -2.18374e-06     -3.26e-18\npolygon 593 (hole)         7 -1.32636e-06     -1.98e-18\npolygon 594 (hole)         8 -5.35877e-07     -8.00e-19\npolygon 595 (hole)         4 -2.71934e-07     -4.06e-19\npolygon 596 (hole)         4 -2.52827e-07     -3.78e-19\npolygon 597 (hole)         7 -4.76008e-07     -7.11e-19\npolygon 598 (hole)         4 -4.90880e-06     -7.33e-18\npolygon 599 (hole)         6 -9.66325e-07     -1.44e-18\npolygon 600 (hole)         8 -1.76023e-06     -2.63e-18\npolygon 601 (hole)         8 -4.32675e-07     -6.46e-19\npolygon 602 (hole)         4 -3.17498e-07     -4.74e-19\npolygon 603 (hole)         3 -5.95218e-09     -8.89e-21\npolygon 604 (hole)         6 -9.18734e-06     -1.37e-17\npolygon 605 (hole)         3 -1.59625e-09     -2.38e-21\npolygon 606 (hole)         3 -1.05422e-07     -1.57e-19\npolygon 607 (hole)         3 -3.32399e-06     -4.96e-18\npolygon 608 (hole)        16 -2.07485e-05     -3.10e-17\npolygon 609 (hole)        10 -6.15237e-06     -9.19e-18\npolygon 610 (hole)         7 -1.61478e-06     -2.41e-18\npolygon 611 (hole)         3 -6.16826e-07     -9.21e-19\npolygon 612 (hole)         9 -7.81839e-06     -1.17e-17\npolygon 613 (hole)         4 -1.72055e-06     -2.57e-18\npolygon 614 (hole)         4 -3.53368e-06     -5.28e-18\npolygon 615 (hole)        22 -3.22862e-05     -4.82e-17\npolygon 616 (hole)         7 -3.72870e-06     -5.57e-18\npolygon 617 (hole)         4 -3.67219e-07     -5.48e-19\npolygon 618 (hole)         7 -4.34664e-06     -6.49e-18\npolygon 619 (hole)        34 -2.22103e-05     -3.32e-17\npolygon 620 (hole)        36 -4.45744e-05     -6.66e-17\npolygon 621 (hole)         4 -3.62444e-10     -5.41e-22\npolygon 622 (hole)         4 -3.38637e-07     -5.06e-19\npolygon 623 (hole)        10 -1.20407e-05     -1.80e-17\npolygon 624 (hole)        18 -6.75442e-06     -1.01e-17\npolygon 625 (hole)         4 -2.58807e-06     -3.86e-18\npolygon 626 (hole)         4 -2.27048e-06     -3.39e-18\npolygon 627 (hole)         4 -9.15837e-07     -1.37e-18\npolygon 628 (hole)        20 -1.06801e-05     -1.59e-17\npolygon 629 (hole)        11 -2.28909e-05     -3.42e-17\npolygon 630 (hole)         5 -9.99451e-06     -1.49e-17\npolygon 631 (hole)         4 -1.47029e-07     -2.20e-19\npolygon 632 (hole)         7 -8.56059e-07     -1.28e-18\npolygon 633 (hole)         4 -1.56852e-07     -2.34e-19\npolygon 634 (hole)         6 -3.00288e-07     -4.48e-19\npolygon 635 (hole)         3 -3.93582e-08     -5.88e-20\npolygon 636 (hole)         4 -1.67592e-05     -2.50e-17\npolygon 637 (hole)         6 -1.89713e-05     -2.83e-17\npolygon 638 (hole)         7 -6.90502e-06     -1.03e-17\npolygon 639 (hole)        15 -1.51956e-05     -2.27e-17\npolygon 640 (hole)         3 -2.57281e-06     -3.84e-18\npolygon 641 (hole)         4 -2.47789e-06     -3.70e-18\npolygon 642 (hole)         4 -1.65301e-06     -2.47e-18\npolygon 643 (hole)        43 -1.42035e-04     -2.12e-16\npolygon 644 (hole)         5 -1.02734e-05     -1.53e-17\npolygon 645 (hole)         8 -1.11191e-05     -1.66e-17\npolygon 646 (hole)         6 -2.14781e-06     -3.21e-18\npolygon 647 (hole)         6 -3.78093e-06     -5.65e-18\npolygon 648 (hole)         4 -7.46113e-08     -1.11e-19\npolygon 649 (hole)        11 -2.69065e-06     -4.02e-18\npolygon 650 (hole)         5 -2.93049e-07     -4.38e-19\npolygon 651 (hole)        17 -7.83435e-06     -1.17e-17\npolygon 652 (hole)         3 -5.33410e-08     -7.96e-20\npolygon 653 (hole)        26 -8.78286e-06     -1.31e-17\npolygon 654 (hole)         4 -4.41637e-07     -6.59e-19\npolygon 655 (hole)        16 -9.74263e-06     -1.45e-17\npolygon 656 (hole)         4 -4.73661e-07     -7.07e-19\npolygon 657 (hole)        13 -6.55106e-06     -9.78e-18\npolygon 658 (hole)         9 -3.00258e-05     -4.48e-17\npolygon 659 (hole)         9 -1.12701e-05     -1.68e-17\npolygon 660 (hole)         3 -1.10177e-06     -1.65e-18\npolygon 661 (hole)        38 -3.54618e-05     -5.30e-17\npolygon 662 (hole)         8 -1.74404e-06     -2.60e-18\npolygon 663 (hole)         8 -2.56810e-06     -3.83e-18\npolygon 664 (hole)         5 -2.38830e-07     -3.57e-19\npolygon 665 (hole)         5 -7.21593e-07     -1.08e-18\npolygon 666 (hole)        19 -2.24084e-06     -3.35e-18\npolygon 667 (hole)         8 -1.64175e-06     -2.45e-18\npolygon 668 (hole)         5 -1.09412e-06     -1.63e-18\npolygon 669 (hole)         4 -1.77013e-07     -2.64e-19\npolygon 670 (hole)         4 -2.94344e-07     -4.40e-19\npolygon 671 (hole)         6 -1.55669e-06     -2.32e-18\npolygon 672 (hole)         6 -1.75930e-06     -2.63e-18\npolygon 673 (hole)         6 -2.68574e-06     -4.01e-18\npolygon 674 (hole)        10 -7.18257e-06     -1.07e-17\npolygon 675 (hole)         8 -2.46398e-06     -3.68e-18\npolygon 676 (hole)         4 -6.90305e-07     -1.03e-18\npolygon 677 (hole)         6 -6.59631e-07     -9.85e-19\npolygon 678 (hole)         7 -1.29369e-06     -1.93e-18\npolygon 679 (hole)         8 -1.85201e-06     -2.77e-18\npolygon 680 (hole)         6 -4.89105e-06     -7.30e-18\npolygon 681 (hole)         4 -1.65358e-07     -2.47e-19\npolygon 682 (hole)         6 -3.99927e-07     -5.97e-19\npolygon 683 (hole)         9 -1.87181e-06     -2.79e-18\npolygon 684 (hole)        24 -6.69228e-06     -9.99e-18\npolygon 685 (hole)         4 -5.46189e-07     -8.16e-19\npolygon 686 (hole)        20 -6.12444e-06     -9.14e-18\npolygon 687 (hole)        18 -6.77458e-06     -1.01e-17\npolygon 688 (hole)         4 -6.40146e-07     -9.56e-19\npolygon 689 (hole)        11 -8.53899e-06     -1.28e-17\npolygon 690 (hole)         7 -4.33857e-06     -6.48e-18\npolygon 691 (hole)         9 -4.29041e-06     -6.41e-18\npolygon 692 (hole)        16 -8.88575e-07     -1.33e-18\npolygon 693 (hole)        12 -3.03675e-06     -4.53e-18\npolygon 694 (hole)        16 -1.34003e-06     -2.00e-18\npolygon 695 (hole)        20 -7.64167e-06     -1.14e-17\npolygon 696 (hole)         8 -1.44680e-06     -2.16e-18\npolygon 697 (hole)         6 -6.17098e-08     -9.21e-20\npolygon 698 (hole)         8 -6.47538e-07     -9.67e-19\npolygon 699 (hole)        12 -3.43607e-06     -5.13e-18\npolygon 700 (hole)         8 -2.75374e-06     -4.11e-18\npolygon 701 (hole)        10 -2.17307e-06     -3.24e-18\npolygon 702 (hole)        11 -9.98722e-07     -1.49e-18\npolygon 703 (hole)        43 -2.73905e-05     -4.09e-17\npolygon 704 (hole)         4 -1.67997e-06     -2.51e-18\npolygon 705 (hole)        13 -1.96065e-05     -2.93e-17\npolygon 706 (hole)         4 -4.48786e-07     -6.70e-19\npolygon 707 (hole)        10 -1.55657e-05     -2.32e-17\npolygon 708 (hole)        20 -1.33138e-05     -1.99e-17\npolygon 709 (hole)         6 -3.30155e-06     -4.93e-18\npolygon 710 (hole)        12 -2.65112e-06     -3.96e-18\npolygon 711 (hole)        16 -8.46723e-06     -1.26e-17\npolygon 712 (hole)         3 -2.83566e-07     -4.23e-19\npolygon 713 (hole)         4 -5.43305e-06     -8.11e-18\npolygon 714 (hole)         8 -9.21185e-06     -1.38e-17\npolygon 715 (hole)        12 -5.26073e-06     -7.86e-18\npolygon 716 (hole)        12 -1.06597e-05     -1.59e-17\npolygon 717 (hole)         3 -1.72988e-08     -2.58e-20\npolygon 718 (hole)         4 -1.60286e-07     -2.39e-19\npolygon 719 (hole)         7 -3.56051e-07     -5.32e-19\npolygon 720 (hole)         7 -4.30376e-07     -6.43e-19\npolygon 721 (hole)         4 -3.21852e-07     -4.81e-19\npolygon 722 (hole)         4 -2.19817e-07     -3.28e-19\npolygon 723 (hole)        14 -2.74884e-06     -4.10e-18\npolygon 724 (hole)        12 -4.75410e-06     -7.10e-18\npolygon 725 (hole)        12 -5.52978e-06     -8.26e-18\npolygon 726 (hole)        16 -1.22529e-05     -1.83e-17\npolygon 727 (hole)        10 -6.51627e-06     -9.73e-18\npolygon 728 (hole)         8 -3.24725e-06     -4.85e-18\npolygon 729 (hole)         6 -5.21989e-07     -7.79e-19\npolygon 730 (hole)        14 -5.52052e-06     -8.24e-18\npolygon 731 (hole)        13 -2.17785e-06     -3.25e-18\npolygon 732 (hole)        24 -6.30517e-06     -9.41e-18\npolygon 733 (hole)        24 -2.25468e-05     -3.37e-17\npolygon 734 (hole)         9 -5.28741e-07     -7.90e-19\npolygon 735 (hole)        10 -1.21969e-05     -1.82e-17\npolygon 736 (hole)         4 -7.71142e-07     -1.15e-18\npolygon 737 (hole)         4 -6.01362e-08     -8.98e-20\npolygon 738 (hole)         4 -3.57061e-08     -5.33e-20\npolygon 739 (hole)        16 -1.29864e-05     -1.94e-17\npolygon 740 (hole)        10 -2.78467e-06     -4.16e-18\npolygon 741 (hole)        12 -4.16812e-06     -6.22e-18\npolygon 742 (hole)         4 -1.50563e-07     -2.25e-19\npolygon 743 (hole)        12 -3.34357e-06     -4.99e-18\npolygon 744 (hole)         3 -1.60812e-11     -2.40e-23\npolygon 745 (hole)        12 -8.18420e-07     -1.22e-18\npolygon 746 (hole)         3 -1.67128e-10     -2.50e-22\npolygon 747 (hole)         3 -1.51040e-09     -2.26e-21\npolygon 748 (hole)         5 -3.31089e-07     -4.94e-19\npolygon 749 (hole)         4 -8.01878e-10     -1.20e-21\npolygon 750                3  0.00000e+00      0.00e+00\npolygon 751 (hole)         3 -1.05233e-07     -1.57e-19\npolygon 752 (hole)         4 -2.40412e-09     -3.59e-21\npolygon 753 (hole)         6 -9.51520e-07     -1.42e-18\npolygon 754 (hole)        12 -5.13710e-06     -7.67e-18\npolygon 755 (hole)         3 -7.33440e-09     -1.10e-20\npolygon 756 (hole)         8 -1.30473e-06     -1.95e-18\npolygon 757 (hole)         6 -1.04629e-06     -1.56e-18\npolygon 758 (hole)        12 -1.60213e-06     -2.39e-18\npolygon 759 (hole)         3 -7.47102e-08     -1.12e-19\npolygon 760 (hole)         8 -1.70885e-06     -2.55e-18\npolygon 761 (hole)         6 -2.56715e-06     -3.83e-18\npolygon 762 (hole)         3 -4.58241e-09     -6.84e-21\npolygon 763 (hole)        18 -7.58721e-06     -1.13e-17\npolygon 764 (hole)         8 -7.88753e-07     -1.18e-18\npolygon 765 (hole)         8 -2.04205e-06     -3.05e-18\npolygon 766 (hole)         4 -6.76032e-08     -1.01e-19\npolygon 767 (hole)         3 -8.58648e-09     -1.28e-20\npolygon 768 (hole)         4 -5.45251e-09     -8.14e-21\npolygon 769 (hole)         4 -5.04991e-07     -7.54e-19\npolygon 770 (hole)         5 -2.79886e-06     -4.18e-18\npolygon 771 (hole)        14 -8.69488e-06     -1.30e-17\npolygon 772 (hole)        10 -4.59315e-07     -6.86e-19\npolygon 773 (hole)         4 -1.22972e-07     -1.84e-19\npolygon 774 (hole)         4 -2.19271e-06     -3.27e-18\npolygon 775 (hole)        12 -7.30245e-06     -1.09e-17\npolygon 776 (hole)         5 -6.55069e-07     -9.78e-19\npolygon 777 (hole)         6 -9.15106e-06     -1.37e-17\npolygon 778 (hole)        10 -1.42088e-05     -2.12e-17\npolygon 779 (hole)         7 -1.31024e-06     -1.96e-18\npolygon 780 (hole)         9 -1.43691e-05     -2.15e-17\npolygon 781 (hole)         4 -2.11024e-06     -3.15e-18\npolygon 782 (hole)         4 -6.92613e-08     -1.03e-19\npolygon 783 (hole)         7 -2.04849e-06     -3.06e-18\npolygon 784 (hole)        12 -1.02480e-05     -1.53e-17\npolygon 785 (hole)        16 -1.04982e-05     -1.57e-17\npolygon 786 (hole)         4 -5.77663e-07     -8.63e-19\npolygon 787 (hole)         5 -1.59645e-06     -2.38e-18\npolygon 788 (hole)         4 -2.15697e-06     -3.22e-18\npolygon 789 (hole)         4 -2.45081e-06     -3.66e-18\npolygon 790 (hole)         4 -2.74329e-07     -4.10e-19\npolygon 791 (hole)         4 -5.28048e-08     -7.88e-20\npolygon 792 (hole)        13 -1.99065e-06     -2.97e-18\npolygon 793 (hole)         4 -1.72089e-07     -2.57e-19\npolygon 794 (hole)         4 -5.36984e-08     -8.02e-20\npolygon 795 (hole)         4 -1.31200e-06     -1.96e-18\npolygon 796 (hole)         4 -7.67239e-07     -1.15e-18\npolygon 797 (hole)         4 -8.90784e-07     -1.33e-18\npolygon 798 (hole)         3 -1.94794e-11     -2.91e-23\npolygon 799 (hole)         4 -4.89519e-06     -7.31e-18\npolygon 800 (hole)         4 -7.54507e-07     -1.13e-18\npolygon 801 (hole)         4 -6.30508e-07     -9.41e-19\npolygon 802 (hole)         5 -2.41685e-06     -3.61e-18\npolygon 803 (hole)         9 -2.46170e-06     -3.68e-18\npolygon 804 (hole)         3 -5.88236e-09     -8.78e-21\npolygon 805 (hole)        19 -3.70522e-05     -5.53e-17\npolygon 806 (hole)         5 -6.50835e-07     -9.72e-19\npolygon 807 (hole)         8 -5.40750e-07     -8.07e-19\npolygon 808 (hole)         4 -7.57651e-08     -1.13e-19\npolygon 809 (hole)         3 -5.48740e-09     -8.19e-21\npolygon 810 (hole)         6 -7.07339e-06     -1.06e-17\npolygon 811 (hole)        11 -1.32791e-05     -1.98e-17\npolygon 812 (hole)         8 -1.00478e-06     -1.50e-18\npolygon 813 (hole)         9 -1.30672e-06     -1.95e-18\npolygon 814 (hole)        34 -2.52174e-05     -3.77e-17\npolygon 815 (hole)         6 -5.77420e-06     -8.62e-18\npolygon 816 (hole)        14 -1.00039e-05     -1.49e-17\npolygon 817 (hole)        14 -1.27903e-05     -1.91e-17\npolygon 818 (hole)         6 -2.89513e-06     -4.32e-18\npolygon 819 (hole)         4 -3.90195e-07     -5.83e-19\npolygon 820 (hole)         4 -1.66294e-06     -2.48e-18\npolygon 821 (hole)        22 -1.85115e-05     -2.76e-17\npolygon 822 (hole)         3 -3.12851e-07     -4.67e-19\npolygon 823 (hole)         3 -3.10142e-08     -4.63e-20\npolygon 824 (hole)         4 -3.08188e-07     -4.60e-19\npolygon 825 (hole)         4 -4.47973e-07     -6.69e-19\npolygon 826 (hole)         9 -1.04283e-05     -1.56e-17\npolygon 827 (hole)         8 -1.48416e-06     -2.22e-18\npolygon 828 (hole)        10 -5.58863e-06     -8.34e-18\npolygon 829 (hole)         3 -4.14133e-07     -6.18e-19\npolygon 830 (hole)        30 -3.47307e-05     -5.19e-17\npolygon 831 (hole)         4 -1.85245e-06     -2.77e-18\npolygon 832 (hole)         6 -5.63652e-07     -8.42e-19\npolygon 833 (hole)        13 -5.20425e-06     -7.77e-18\npolygon 834 (hole)         3 -1.86294e-06     -2.78e-18\npolygon 835 (hole)         4 -1.98260e-06     -2.96e-18\npolygon 836 (hole)        24 -1.30457e-05     -1.95e-17\npolygon 837 (hole)         3 -6.39260e-11     -9.55e-23\npolygon 838 (hole)         4 -1.85129e-06     -2.76e-18\npolygon 839 (hole)        24 -1.20845e-05     -1.80e-17\npolygon 840 (hole)        22 -1.76911e-05     -2.64e-17\npolygon 841 (hole)         4 -4.24110e-06     -6.33e-18\npolygon 842 (hole)         3 -1.67592e-07     -2.50e-19\npolygon 843 (hole)         4 -5.07095e-07     -7.57e-19\npolygon 844 (hole)        15 -1.93292e-05     -2.89e-17\npolygon 845 (hole)         3 -2.63499e-08     -3.93e-20\npolygon 846 (hole)         4 -9.59317e-07     -1.43e-18\npolygon 847 (hole)         9 -1.03907e-06     -1.55e-18\npolygon 848 (hole)         6 -9.10628e-07     -1.36e-18\npolygon 849 (hole)         4 -1.26556e-06     -1.89e-18\npolygon 850 (hole)         3 -6.32105e-08     -9.44e-20\npolygon 851 (hole)         8 -2.75227e-06     -4.11e-18\npolygon 852 (hole)         8 -5.04469e-06     -7.53e-18\npolygon 853 (hole)        12 -1.06652e-05     -1.59e-17\npolygon 854 (hole)         3 -2.55325e-10     -3.81e-22\npolygon 855 (hole)         3 -1.64351e-06     -2.45e-18\npolygon 856 (hole)         3 -7.21379e-07     -1.08e-18\npolygon 857 (hole)         4 -7.64394e-08     -1.14e-19\npolygon 858 (hole)         4 -9.59171e-07     -1.43e-18\npolygon 859 (hole)         3 -3.04001e-06     -4.54e-18\npolygon 860 (hole)         4 -4.17524e-07     -6.23e-19\npolygon 861 (hole)         3 -8.13487e-07     -1.21e-18\npolygon 862 (hole)         3 -1.88495e-13     -2.81e-25\npolygon 863 (hole)         5 -7.00021e-10     -1.05e-21\npolygon 864 (hole)         4 -1.17209e-06     -1.75e-18\npolygon 865 (hole)         4 -1.61030e-08     -2.40e-20\npolygon 866 (hole)         7 -1.64801e-05     -2.46e-17\npolygon 867 (hole)         4 -9.60361e-11     -1.43e-22\npolygon 868 (hole)         6 -7.04295e-06     -1.05e-17\npolygon 869 (hole)         4 -4.44230e-07     -6.63e-19\npolygon 870 (hole)         4 -3.66199e-07     -5.47e-19\npolygon 871 (hole)         3 -9.36087e-07     -1.40e-18\npolygon 872 (hole)         4 -4.67178e-06     -6.98e-18\npolygon 873 (hole)        11 -1.83842e-05     -2.75e-17\npolygon 874 (hole)        10 -4.45963e-06     -6.66e-18\npolygon 875 (hole)         6 -4.97999e-06     -7.44e-18\npolygon 876 (hole)         4 -5.18698e-07     -7.75e-19\npolygon 877 (hole)         3 -6.92946e-07     -1.03e-18\npolygon 878 (hole)         4 -1.36612e-06     -2.04e-18\npolygon 879 (hole)         4 -2.92987e-07     -4.37e-19\npolygon 880 (hole)         6 -5.28596e-06     -7.89e-18\npolygon 881 (hole)         5 -3.18954e-06     -4.76e-18\npolygon 882 (hole)        16 -2.17578e-06     -3.25e-18\npolygon 883 (hole)         4 -4.39401e-06     -6.56e-18\npolygon 884 (hole)         4 -3.53685e-07     -5.28e-19\npolygon 885 (hole)         4 -9.91210e-07     -1.48e-18\npolygon 886 (hole)         4 -4.40831e-10     -6.58e-22\npolygon 887 (hole)         3 -3.91156e-09     -5.84e-21\npolygon 888 (hole)         4 -5.85356e-08     -8.74e-20\npolygon 889 (hole)         4 -3.90887e-07     -5.84e-19\npolygon 890 (hole)         3 -2.53717e-08     -3.79e-20\npolygon 891               26  2.85778e+06      4.27e-06\npolygon 892 (hole)         7 -5.96459e-06     -8.91e-18\npolygon 893 (hole)         5 -1.11617e-06     -1.67e-18\npolygon 894 (hole)         4 -1.58962e-06     -2.37e-18\npolygon 895 (hole)         3 -6.47723e-09     -9.67e-21\npolygon 896 (hole)         5 -4.91126e-06     -7.33e-18\npolygon 897 (hole)         3 -2.82115e-12     -4.21e-24\npolygon 898 (hole)         3 -1.32283e-06     -1.98e-18\npolygon 899                3  2.61158e-10      3.90e-22\npolygon 900 (hole)         4 -3.44876e-07     -5.15e-19\npolygon 901 (hole)         3 -7.15065e-08     -1.07e-19\npolygon 902 (hole)         4 -1.00656e-08     -1.50e-20\npolygon 903 (hole)         3 -6.08303e-07     -9.08e-19\npolygon 904 (hole)         3 -2.22135e-07     -3.32e-19\npolygon 905 (hole)        11 -1.29690e-05     -1.94e-17\npolygon 906 (hole)         4 -8.08955e-07     -1.21e-18\npolygon 907 (hole)         3 -1.78443e-07     -2.66e-19\npolygon 908 (hole)         4 -4.37379e-06     -6.53e-18\npolygon 909 (hole)         8 -5.87752e-06     -8.78e-18\npolygon 910 (hole)        15 -2.27764e-05     -3.40e-17\npolygon 911 (hole)         3 -1.64688e-07     -2.46e-19\npolygon 912 (hole)         8 -8.57021e-06     -1.28e-17\npolygon 913 (hole)         8 -9.93116e-06     -1.48e-17\npolygon 914 (hole)         4 -2.22152e-06     -3.32e-18\npolygon 915 (hole)         4 -4.45747e-07     -6.66e-19\npolygon 916 (hole)         4 -4.03379e-07     -6.02e-19\npolygon 917 (hole)         4 -1.09729e-06     -1.64e-18\npolygon 918 (hole)         4 -4.90172e-07     -7.32e-19\npolygon 919 (hole)        15 -7.82538e-06     -1.17e-17\npolygon 920 (hole)         4 -3.05630e-06     -4.56e-18\npolygon 921 (hole)         3 -1.22893e-10     -1.84e-22\npolygon 922 (hole)         3 -1.78531e-07     -2.67e-19\npolygon 923 (hole)        29 -2.26091e-05     -3.38e-17\npolygon 924 (hole)         6 -1.63260e-06     -2.44e-18\npolygon 925 (hole)         3 -3.53577e-07     -5.28e-19\npolygon 926 (hole)         3 -6.61644e-07     -9.88e-19\npolygon 927 (hole)        11 -5.92633e-07     -8.85e-19\npolygon 928 (hole)         3 -1.60869e-07     -2.40e-19\npolygon 929 (hole)         6 -4.25227e-06     -6.35e-18\npolygon 930 (hole)        24 -1.72642e-05     -2.58e-17\npolygon 931 (hole)         5 -2.20502e-07     -3.29e-19\npolygon 932 (hole)         4 -1.12303e-06     -1.68e-18\npolygon 933 (hole)         6 -2.04297e-06     -3.05e-18\npolygon 934 (hole)         5 -4.03695e-06     -6.03e-18\npolygon 935 (hole)         7 -1.79877e-06     -2.69e-18\npolygon 936 (hole)         5 -1.11811e-10     -1.67e-22\npolygon 937 (hole)        11 -1.64428e-05     -2.46e-17\npolygon 938 (hole)         5 -1.04667e-06     -1.56e-18\npolygon 939 (hole)         4 -1.43538e-06     -2.14e-18\npolygon 940 (hole)         6 -1.36286e-06     -2.03e-18\npolygon 941 (hole)         4 -2.17697e-06     -3.25e-18\npolygon 942 (hole)         3 -3.90693e-07     -5.83e-19\npolygon 943 (hole)         6 -5.01011e-06     -7.48e-18\npolygon 944 (hole)         6 -4.83409e-06     -7.22e-18\npolygon 945 (hole)         3 -4.82888e-07     -7.21e-19\npolygon 946 (hole)         6 -5.29906e-06     -7.91e-18\npolygon 947 (hole)         3 -2.70309e-06     -4.04e-18\npolygon 948 (hole)        12 -2.05767e-05     -3.07e-17\npolygon 949 (hole)         5 -1.99859e-06     -2.98e-18\npolygon 950 (hole)        20 -2.45831e-05     -3.67e-17\npolygon 951 (hole)        14 -2.03544e-05     -3.04e-17\npolygon 952 (hole)         3 -2.87490e-07     -4.29e-19\npolygon 953 (hole)         5 -3.63819e-06     -5.43e-18\npolygon 954 (hole)         6 -7.40637e-07     -1.11e-18\npolygon 955 (hole)         4 -3.87159e-07     -5.78e-19\npolygon 956 (hole)         4 -1.66151e-06     -2.48e-18\npolygon 957 (hole)         6 -3.05068e-06     -4.56e-18\npolygon 958 (hole)        12 -1.48555e-05     -2.22e-17\npolygon 959 (hole)         4 -2.22976e-06     -3.33e-18\npolygon 960 (hole)         8 -6.64064e-06     -9.92e-18\npolygon 961 (hole)         4 -2.15967e-07     -3.22e-19\npolygon 962 (hole)         3 -7.42890e-07     -1.11e-18\npolygon 963 (hole)         4 -3.00191e-07     -4.48e-19\npolygon 964 (hole)         9 -3.62075e-07     -5.41e-19\npolygon 965 (hole)         8 -3.01321e-06     -4.50e-18\npolygon 966 (hole)         3 -3.48481e-07     -5.20e-19\npolygon 967 (hole)         5 -1.25831e-06     -1.88e-18\npolygon 968 (hole)        23 -7.27453e-06     -1.09e-17\npolygon 969 (hole)         4 -1.57642e-06     -2.35e-18\npolygon 970 (hole)        14 -9.19299e-06     -1.37e-17\npolygon 971 (hole)        16 -1.79450e-05     -2.68e-17\npolygon 972 (hole)         4 -8.16740e-09     -1.22e-20\npolygon 973 (hole)         3 -1.63614e-12     -2.44e-24\npolygon 974 (hole)         3 -3.94517e-09     -5.89e-21\npolygon 975 (hole)        10 -3.11867e-06     -4.66e-18\npolygon 976 (hole)         4 -1.02308e-06     -1.53e-18\npolygon 977 (hole)         4 -1.03133e-06     -1.54e-18\npolygon 978 (hole)         4 -8.70230e-07     -1.30e-18\npolygon 979 (hole)         3 -5.08006e-07     -7.59e-19\npolygon 980 (hole)        18 -1.47972e-05     -2.21e-17\npolygon 981 (hole)         4 -1.48789e-06     -2.22e-18\npolygon 982 (hole)         4 -2.04307e-06     -3.05e-18\npolygon 983 (hole)        18 -2.75250e-05     -4.11e-17\npolygon 984 (hole)         5 -5.99491e-06     -8.95e-18\npolygon 985 (hole)         3 -1.09648e-06     -1.64e-18\npolygon 986 (hole)         3 -1.59984e-07     -2.39e-19\npolygon 987 (hole)         4 -1.48988e-06     -2.22e-18\npolygon 988 (hole)         3 -1.60103e-07     -2.39e-19\npolygon 989 (hole)         3 -5.27938e-11     -7.88e-23\npolygon 990 (hole)         7 -1.57914e-06     -2.36e-18\npolygon 991 (hole)         7 -2.32130e-06     -3.47e-18\npolygon 992 (hole)         4 -1.82516e-07     -2.73e-19\npolygon 993 (hole)        10 -9.92723e-06     -1.48e-17\npolygon 994 (hole)         4 -4.64956e-08     -6.94e-20\npolygon 995 (hole)         6 -5.41605e-07     -8.09e-19\npolygon 996 (hole)        14 -6.63886e-07     -9.91e-19\npolygon 997 (hole)         8 -3.08030e-06     -4.60e-18\npolygon 998 (hole)        11 -3.57478e-06     -5.34e-18\npolygon 999 (hole)         4 -2.03798e-07     -3.04e-19\npolygon 1000 (hole)        7 -7.84638e-07     -1.17e-18\npolygon 1001 (hole)        6 -3.85565e-06     -5.76e-18\npolygon 1002 (hole)       15 -6.42409e-06     -9.59e-18\npolygon 1003 (hole)        4 -3.32368e-07     -4.96e-19\npolygon 1004 (hole)        4 -1.88769e-08     -2.82e-20\npolygon 1005 (hole)        4 -2.00520e-07     -2.99e-19\npolygon 1006 (hole)        3 -1.18046e-07     -1.76e-19\npolygon 1007 (hole)        8 -2.84542e-06     -4.25e-18\npolygon 1008 (hole)        8 -4.42521e-06     -6.61e-18\npolygon 1009 (hole)        4 -4.26203e-07     -6.36e-19\npolygon 1010 (hole)        3 -6.37843e-07     -9.52e-19\npolygon 1011 (hole)        5 -2.21462e-06     -3.31e-18\npolygon 1012 (hole)        4 -1.33402e-07     -1.99e-19\npolygon 1013 (hole)        3 -8.67980e-07     -1.30e-18\npolygon 1014 (hole)        6 -1.57252e-06     -2.35e-18\npolygon 1015 (hole)        3 -3.77207e-07     -5.63e-19\npolygon 1016 (hole)       14 -9.76015e-06     -1.46e-17\npolygon 1017 (hole)        3 -4.96964e-08     -7.42e-20\npolygon 1018 (hole)        6 -4.88962e-06     -7.30e-18\npolygon 1019 (hole)        7 -6.44682e-08     -9.63e-20\npolygon 1020 (hole)        4 -5.53087e-07     -8.26e-19\npolygon 1021 (hole)        3 -6.31546e-07     -9.43e-19\npolygon 1022 (hole)        4 -2.04558e-07     -3.05e-19\npolygon 1023 (hole)        3 -1.20001e-07     -1.79e-19\npolygon 1024 (hole)        4 -3.99068e-07     -5.96e-19\npolygon 1025 (hole)        3 -6.96598e-08     -1.04e-19\npolygon 1026 (hole)       14 -8.80954e-06     -1.32e-17\npolygon 1027 (hole)        4 -2.24556e-07     -3.35e-19\npolygon 1028 (hole)        4 -3.14953e-07     -4.70e-19\npolygon 1029 (hole)        6 -5.75421e-06     -8.59e-18\npolygon 1030 (hole)        9 -2.19271e-05     -3.27e-17\npolygon 1031 (hole)       15 -9.00510e-06     -1.34e-17\npolygon 1032 (hole)        3 -2.62200e-07     -3.92e-19\npolygon 1033 (hole)        4 -1.35217e-06     -2.02e-18\npolygon 1034 (hole)        6 -2.60366e-06     -3.89e-18\npolygon 1035 (hole)        5 -1.22881e-05     -1.83e-17\npolygon 1036 (hole)        3 -2.23247e-10     -3.33e-22\npolygon 1037 (hole)        4 -1.17525e-10     -1.75e-22\npolygon 1038 (hole)        3 -3.25202e-07     -4.86e-19\npolygon 1039 (hole)        4 -8.01372e-07     -1.20e-18\npolygon 1040 (hole)        4 -6.72027e-07     -1.00e-18\npolygon 1041 (hole)        4 -8.43417e-07     -1.26e-18\npolygon 1042 (hole)        3 -4.61945e-07     -6.90e-19\npolygon 1043 (hole)        4 -2.55155e-06     -3.81e-18\npolygon 1044 (hole)        6 -2.41174e-06     -3.60e-18\npolygon 1045 (hole)        5 -2.30613e-06     -3.44e-18\npolygon 1046 (hole)        4 -3.62129e-07     -5.41e-19\npolygon 1047 (hole)        5 -9.44626e-07     -1.41e-18\npolygon 1048 (hole)       17 -8.02571e-06     -1.20e-17\npolygon 1049 (hole)        3 -4.64224e-08     -6.93e-20\npolygon 1050 (hole)        4 -7.89939e-07     -1.18e-18\npolygon 1051 (hole)        9 -1.04802e-06     -1.56e-18\npolygon 1052               3  0.00000e+00      0.00e+00\npolygon 1053 (hole)        6 -2.90975e-06     -4.34e-18\npolygon 1054 (hole)        7 -1.58592e-05     -2.37e-17\npolygon 1055 (hole)        4 -2.94713e-07     -4.40e-19\npolygon 1056 (hole)        4 -1.26885e-06     -1.89e-18\npolygon 1057 (hole)        4 -4.36370e-07     -6.52e-19\npolygon 1058 (hole)        4 -3.25844e-06     -4.87e-18\npolygon 1059 (hole)        4 -4.71746e-07     -7.04e-19\npolygon 1060 (hole)        4 -4.38190e-07     -6.54e-19\npolygon 1061 (hole)        6 -1.02852e-06     -1.54e-18\npolygon 1062 (hole)        4 -1.13896e-06     -1.70e-18\npolygon 1063 (hole)        3 -1.02731e-07     -1.53e-19\npolygon 1064 (hole)       28 -1.62790e-05     -2.43e-17\npolygon 1065 (hole)        9 -2.86214e-06     -4.27e-18\npolygon 1066 (hole)        3 -3.86621e-07     -5.77e-19\npolygon 1067 (hole)        3 -1.94296e-07     -2.90e-19\npolygon 1068 (hole)        7 -1.73842e-06     -2.60e-18\npolygon 1069 (hole)        4 -5.33629e-07     -7.97e-19\npolygon 1070 (hole)        3 -5.77992e-08     -8.63e-20\npolygon 1071 (hole)        8 -2.90435e-06     -4.34e-18\npolygon 1072 (hole)        6 -6.68165e-06     -9.98e-18\npolygon 1073 (hole)        4 -2.62580e-07     -3.92e-19\npolygon 1074 (hole)        3 -1.40958e-07     -2.10e-19\npolygon 1075 (hole)        4 -3.40111e-07     -5.08e-19\npolygon 1076 (hole)        6 -6.50251e-06     -9.71e-18\npolygon 1077 (hole)        4 -2.72494e-07     -4.07e-19\npolygon 1078               3  3.84969e-11      5.75e-23\npolygon 1079 (hole)        3 -2.01419e-07     -3.01e-19\npolygon 1080 (hole)        3 -7.45888e-08     -1.11e-19\npolygon 1081 (hole)        3 -1.69937e-07     -2.54e-19\npolygon 1082 (hole)        7 -2.48519e-06     -3.71e-18\npolygon 1083 (hole)        3 -1.34889e-12     -2.01e-24\npolygon 1084 (hole)        4 -3.20418e-07     -4.78e-19\npolygon 1085 (hole)        7 -4.93298e-06     -7.37e-18\npolygon 1086 (hole)        6 -2.76374e-06     -4.13e-18\npolygon 1087 (hole)        3 -4.94831e-09     -7.39e-21\npolygon 1088 (hole)        3 -1.50987e-07     -2.25e-19\npolygon 1089 (hole)        6 -3.34929e-06     -5.00e-18\npolygon 1090 (hole)        4 -3.19557e-08     -4.77e-20\npolygon 1091 (hole)        6 -2.01693e-06     -3.01e-18\npolygon 1092 (hole)        3 -1.43680e-12     -2.15e-24\npolygon 1093 (hole)        4 -3.23951e-07     -4.84e-19\npolygon 1094 (hole)        6 -5.36840e-10     -8.02e-22\npolygon 1095 (hole)       15 -1.26600e-05     -1.89e-17\npolygon 1096 (hole)        3 -9.77071e-07     -1.46e-18\npolygon 1097 (hole)        3 -4.22433e-08     -6.31e-20\npolygon 1098 (hole)        4 -5.16259e-07     -7.71e-19\npolygon 1099 (hole)        4 -1.47720e-07     -2.21e-19\npolygon 1100 (hole)       10 -2.75166e-06     -4.11e-18\npolygon 1101 (hole)        4 -1.82686e-07     -2.73e-19\npolygon 1102 (hole)        7 -5.94904e-06     -8.88e-18\npolygon 1103 (hole)        3 -1.09796e-07     -1.64e-19\npolygon 1104 (hole)       10 -3.12800e-06     -4.67e-18\npolygon 1105 (hole)        4 -2.59993e-06     -3.88e-18\npolygon 1106 (hole)       12 -3.06453e-06     -4.58e-18\npolygon 1107 (hole)       12 -3.78550e-06     -5.65e-18\npolygon 1108 (hole)        6 -7.09957e-10     -1.06e-21\npolygon 1109 (hole)        3 -1.27186e-09     -1.90e-21\npolygon 1110              43  7.32477e+06      1.09e-05\npolygon 1111 (hole)        5 -5.48437e-06     -8.19e-18\npolygon 1112 (hole)       14 -4.44790e-06     -6.64e-18\npolygon 1113 (hole)        3 -1.30026e-06     -1.94e-18\npolygon 1114 (hole)        8 -1.46223e-06     -2.18e-18\npolygon 1115 (hole)        4 -4.67145e-07     -6.98e-19\npolygon 1116 (hole)        8 -6.37136e-06     -9.51e-18\npolygon 1117 (hole)       17 -3.25623e-05     -4.86e-17\npolygon 1118 (hole)        4 -3.15090e-06     -4.70e-18\npolygon 1119 (hole)        4 -1.67963e-06     -2.51e-18\npolygon 1120 (hole)       22 -2.59250e-05     -3.87e-17\npolygon 1121 (hole)        3 -7.16762e-07     -1.07e-18\npolygon 1122 (hole)       10 -1.19654e-05     -1.79e-17\npolygon 1123 (hole)        3 -3.68787e-08     -5.51e-20\npolygon 1124 (hole)        3 -1.09729e-08     -1.64e-20\npolygon 1125 (hole)        4 -2.17763e-06     -3.25e-18\npolygon 1126 (hole)        4 -4.29839e-07     -6.42e-19\npolygon 1127 (hole)        7 -1.20491e-06     -1.80e-18\npolygon 1128 (hole)        4 -7.12967e-07     -1.06e-18\npolygon 1129 (hole)        4 -2.03065e-06     -3.03e-18\npolygon 1130 (hole)        5 -3.55055e-07     -5.30e-19\npolygon 1131 (hole)       23 -1.97398e-05     -2.95e-17\npolygon 1132 (hole)        3 -4.10383e-08     -6.13e-20\npolygon 1133 (hole)        3 -6.65433e-09     -9.94e-21\npolygon 1134 (hole)        4 -1.10024e-07     -1.64e-19\npolygon 1135 (hole)        6 -8.83053e-06     -1.32e-17\npolygon 1136             103  1.86991e+07      2.79e-05\npolygon 1137 (hole)        8 -1.00086e-05     -1.49e-17\npolygon 1138 (hole)        4 -6.23238e-07     -9.31e-19\npolygon 1139 (hole)       22 -1.29332e-05     -1.93e-17\npolygon 1140 (hole)        4 -6.17006e-06     -9.21e-18\npolygon 1141 (hole)        3 -2.40251e-07     -3.59e-19\npolygon 1142 (hole)       11 -2.56068e-06     -3.82e-18\npolygon 1143 (hole)        8 -2.60548e-06     -3.89e-18\npolygon 1144 (hole)        4 -2.35185e-07     -3.51e-19\npolygon 1145 (hole)        6 -3.67142e-07     -5.48e-19\npolygon 1146 (hole)        5 -1.77476e-06     -2.65e-18\npolygon 1147 (hole)        4 -1.69793e-07     -2.54e-19\npolygon 1148 (hole)        6 -3.97525e-06     -5.94e-18\npolygon 1149 (hole)        9 -1.56450e-05     -2.34e-17\npolygon 1150 (hole)        5 -2.87263e-06     -4.29e-18\npolygon 1151 (hole)        6 -6.49094e-06     -9.69e-18\npolygon 1152 (hole)        3 -2.16654e-08     -3.24e-20\npolygon 1153 (hole)        3 -2.61093e-08     -3.90e-20\npolygon 1154 (hole)        8 -2.52718e-06     -3.77e-18\npolygon 1155 (hole)        4 -1.97862e-06     -2.95e-18\npolygon 1156 (hole)        4 -1.05456e-06     -1.57e-18\npolygon 1157 (hole)        4 -3.42565e-07     -5.12e-19\npolygon 1158 (hole)       13 -1.15432e-05     -1.72e-17\npolygon 1159 (hole)        3 -5.05599e-09     -7.55e-21\npolygon 1160              37  9.32316e+06      1.39e-05\npolygon 1161 (hole)        4 -5.78332e-07     -8.64e-19\npolygon 1162 (hole)        7 -4.90460e-06     -7.32e-18\npolygon 1163 (hole)        6 -2.77656e-07     -4.15e-19\npolygon 1164               3  0.00000e+00      0.00e+00\npolygon 1165 (hole)        4 -1.31877e-06     -1.97e-18\npolygon 1166 (hole)        5 -1.28966e-10     -1.93e-22\npolygon 1167 (hole)        3 -1.23421e-07     -1.84e-19\npolygon 1168 (hole)        8 -3.18610e-06     -4.76e-18\npolygon 1169 (hole)        6 -5.47974e-07     -8.18e-19\npolygon 1170 (hole)        3 -3.78911e-14     -5.66e-26\npolygon 1171 (hole)        9 -1.85948e-06     -2.78e-18\npolygon 1172 (hole)        4 -7.24111e-07     -1.08e-18\npolygon 1173 (hole)        4 -2.59043e-08     -3.87e-20\npolygon 1174 (hole)        3 -1.49186e-06     -2.23e-18\npolygon 1175 (hole)       10 -7.59355e-06     -1.13e-17\npolygon 1176 (hole)        3 -2.74447e-08     -4.10e-20\npolygon 1177 (hole)        5 -9.62222e-11     -1.44e-22\npolygon 1178 (hole)        3 -1.99064e-06     -2.97e-18\npolygon 1179 (hole)        5 -9.41661e-08     -1.41e-19\npolygon 1180 (hole)        9 -2.53515e-06     -3.79e-18\npolygon 1181 (hole)        4 -1.24371e-06     -1.86e-18\npolygon 1182 (hole)        3 -1.74329e-09     -2.60e-21\npolygon 1183 (hole)        4 -7.68729e-07     -1.15e-18\npolygon 1184 (hole)        4 -8.06015e-07     -1.20e-18\npolygon 1185 (hole)        8 -1.34515e-05     -2.01e-17\npolygon 1186             371  2.43869e+08      3.64e-04\npolygon 1187             297  2.84905e+08      4.25e-04\npolygon 1188 (hole)        3 -3.52869e-06     -5.27e-18\npolygon 1189 (hole)       20 -1.72659e-05     -2.58e-17\npolygon 1190 (hole)        3 -8.57454e-08     -1.28e-19\npolygon 1191 (hole)        8 -2.24071e-06     -3.35e-18\npolygon 1192 (hole)       18 -7.31578e-06     -1.09e-17\npolygon 1193 (hole)        4 -1.42541e-06     -2.13e-18\npolygon 1194 (hole)       22 -5.79419e-06     -8.65e-18\npolygon 1195 (hole)       21 -5.86078e-06     -8.75e-18\npolygon 1196 (hole)        4 -3.64930e-07     -5.45e-19\npolygon 1197 (hole)        3 -2.59333e-11     -3.87e-23\npolygon 1198 (hole)        8 -7.19306e-07     -1.07e-18\npolygon 1199 (hole)        3 -9.74499e-08     -1.46e-19\npolygon 1200 (hole)        4 -3.20603e-07     -4.79e-19\npolygon 1201 (hole)       14 -3.89488e-06     -5.82e-18\npolygon 1202              33  1.68222e+07      2.51e-05\npolygon 1203 (hole)       29 -2.31866e-05     -3.46e-17\npolygon 1204              33  4.47665e+05      6.68e-07\npolygon 1205              19  1.34593e+05      2.01e-07\npolygon 1206 (hole)       51 -2.16393e-05     -3.23e-17\npolygon 1207              39  1.36327e+06      2.04e-06\npolygon 1208             137  1.55547e+08      2.32e-04\npolygon 1209 (hole)       12 -1.18253e-06     -1.77e-18\npolygon 1210 (hole)        3 -8.80442e-09     -1.31e-20\npolygon 1211 (hole)        8 -6.00435e-07     -8.97e-19\npolygon 1212 (hole)        3 -7.71201e-08     -1.15e-19\npolygon 1213 (hole)        4 -3.84460e-06     -5.74e-18\npolygon 1214 (hole)        6 -7.26931e-06     -1.09e-17\npolygon 1215 (hole)        4 -8.47596e-07     -1.27e-18\npolygon 1216              36  8.76479e+06      1.31e-05\npolygon 1217 (hole)        4 -1.03089e-06     -1.54e-18\npolygon 1218 (hole)        4 -4.56983e-07     -6.82e-19\npolygon 1219 (hole)       10 -1.57059e-05     -2.35e-17\npolygon 1220              79  3.08116e+07      4.60e-05\npolygon 1221 (hole)       23 -5.88977e-06     -8.79e-18\npolygon 1222 (hole)        4 -5.65565e-07     -8.44e-19\npolygon 1223             388  2.25271e+08      3.36e-04\npolygon 1224 (hole)        5 -1.23644e-07     -1.85e-19\npolygon 1225 (hole)        4 -3.40694e-06     -5.09e-18\npolygon 1226 (hole)        8 -1.59581e-06     -2.38e-18\npolygon 1227 (hole)        3 -2.06111e-12     -3.08e-24\npolygon 1228 (hole)       14 -2.36318e-06     -3.53e-18\npolygon 1229 (hole)        4 -8.37521e-08     -1.25e-19\npolygon 1230 (hole)       10 -4.11917e-06     -6.15e-18\npolygon 1231 (hole)        3 -8.11432e-07     -1.21e-18\npolygon 1232 (hole)        4 -6.23658e-08     -9.31e-20\npolygon 1233 (hole)       11 -6.49645e-07     -9.70e-19\npolygon 1234 (hole)        3 -4.42215e-09     -6.60e-21\npolygon 1235 (hole)        6 -9.79736e-07     -1.46e-18\npolygon 1236 (hole)        4 -3.60342e-07     -5.38e-19\npolygon 1237 (hole)       14 -1.29743e-06     -1.94e-18\npolygon 1238             316  7.78512e+07      1.16e-04\npolygon 1239 (hole)        4 -2.20699e-07     -3.30e-19\npolygon 1240 (hole)       12 -1.62468e-06     -2.43e-18\npolygon 1241              13  1.09564e+05      1.64e-07\npolygon 1242              18  3.49727e+05      5.22e-07\npolygon 1243 (hole)        6 -5.15224e-07     -7.69e-19\npolygon 1244 (hole)        4 -2.11723e-08     -3.16e-20\npolygon 1245 (hole)       12 -2.64155e-06     -3.94e-18\npolygon 1246              31  1.23017e+06      1.84e-06\npolygon 1247              16  6.55537e+05      9.79e-07\npolygon 1248 (hole)        4 -4.06254e-06     -6.07e-18\npolygon 1249              24  8.49487e+05      1.27e-06\npolygon 1250 (hole)       10 -2.71371e-06     -4.05e-18\npolygon 1251 (hole)        5 -3.47634e-07     -5.19e-19\npolygon 1252 (hole)        4 -6.71077e-07     -1.00e-18\npolygon 1253 (hole)        3 -8.81299e-13     -1.32e-24\npolygon 1254 (hole)       16 -2.88295e-06     -4.30e-18\npolygon 1255 (hole)        4 -1.38208e-07     -2.06e-19\npolygon 1256              30  2.54436e+06      3.80e-06\npolygon 1257 (hole)        7 -1.62397e-06     -2.42e-18\npolygon 1258 (hole)        4 -6.56130e-07     -9.80e-19\npolygon 1259 (hole)        4 -3.07496e-09     -4.59e-21\npolygon 1260 (hole)       10 -2.13530e-06     -3.19e-18\npolygon 1261 (hole)       13 -4.14351e-06     -6.19e-18\npolygon 1262             336  4.15806e+07      6.21e-05\npolygon 1263 (hole)       24 -1.52579e-05     -2.28e-17\npolygon 1264 (hole)       17 -1.31766e-05     -1.97e-17\npolygon 1265 (hole)        6 -2.02351e-06     -3.02e-18\npolygon 1266 (hole)        8 -1.01065e-06     -1.51e-18\npolygon 1267 (hole)        8 -6.72294e-07     -1.00e-18\npolygon 1268 (hole)        4 -2.93181e-07     -4.38e-19\npolygon 1269 (hole)        4 -1.88875e-08     -2.82e-20\npolygon 1270 (hole)       16 -5.54898e-06     -8.29e-18\npolygon 1271 (hole)       11 -5.73284e-06     -8.56e-18\npolygon 1272 (hole)        4 -1.93265e-09     -2.89e-21\npolygon 1273 (hole)       15 -7.75368e-06     -1.16e-17\npolygon 1274 (hole)        3 -3.13390e-08     -4.68e-20\npolygon 1275 (hole)        3 -6.78219e-09     -1.01e-20\npolygon 1276 (hole)        6 -7.91939e-07     -1.18e-18\npolygon 1277 (hole)        5 -1.51254e-06     -2.26e-18\npolygon 1278 (hole)        4 -6.08172e-07     -9.08e-19\npolygon 1279 (hole)        3 -4.00018e-07     -5.97e-19\npolygon 1280 (hole)        4 -3.01903e-08     -4.51e-20\npolygon 1281 (hole)        6 -1.58500e-06     -2.37e-18\npolygon 1282             330  1.69190e+08      2.53e-04\npolygon 1283              47  1.08035e+07      1.61e-05\npolygon 1284 (hole)        6 -2.82316e-06     -4.22e-18\npolygon 1285              39  4.94369e+06      7.38e-06\npolygon 1286 (hole)        4 -8.99114e-07     -1.34e-18\npolygon 1287 (hole)        3 -1.33201e-07     -1.99e-19\npolygon 1288 (hole)        6 -3.92597e-06     -5.86e-18\npolygon 1289 (hole)        7 -3.98304e-07     -5.95e-19\npolygon 1290 (hole)        4 -2.36291e-08     -3.53e-20\npolygon 1291 (hole)        6 -8.48726e-07     -1.27e-18\npolygon 1292 (hole)        4 -4.78273e-13     -7.14e-25\npolygon 1293 (hole)        3 -1.83234e-07     -2.74e-19\npolygon 1294 (hole)       10 -1.73133e-06     -2.59e-18\npolygon 1295 (hole)        4 -1.05318e-07     -1.57e-19\npolygon 1296 (hole)        3 -1.41573e-08     -2.11e-20\npolygon 1297 (hole)        4 -1.60561e-07     -2.40e-19\npolygon 1298 (hole)        6 -2.14452e-06     -3.20e-18\npolygon 1299 (hole)        6 -2.92367e-06     -4.37e-18\npolygon 1300 (hole)        3 -1.87524e-12     -2.80e-24\npolygon 1301 (hole)        3 -1.07143e-07     -1.60e-19\npolygon 1302 (hole)       12 -3.59178e-07     -5.36e-19\npolygon 1303 (hole)        4 -1.55122e-06     -2.32e-18\npolygon 1304 (hole)        6 -5.49759e-07     -8.21e-19\npolygon 1305 (hole)        4 -1.73880e-06     -2.60e-18\npolygon 1306 (hole)        3 -1.26427e-07     -1.89e-19\npolygon 1307 (hole)        3 -9.79394e-10     -1.46e-21\npolygon 1308 (hole)       20 -1.95865e-05     -2.92e-17\npolygon 1309 (hole)        4 -6.11199e-07     -9.13e-19\npolygon 1310              23  2.72438e+06      4.07e-06\npolygon 1311 (hole)        9 -1.41894e-06     -2.12e-18\npolygon 1312 (hole)       10 -2.31262e-06     -3.45e-18\npolygon 1313 (hole)        8 -1.57906e-06     -2.36e-18\npolygon 1314 (hole)       15 -2.57958e-05     -3.85e-17\npolygon 1315 (hole)       10 -2.65498e-06     -3.96e-18\npolygon 1316 (hole)       12 -1.65474e-05     -2.47e-17\npolygon 1317 (hole)       14 -4.35752e-06     -6.51e-18\npolygon 1318 (hole)        3 -9.60485e-07     -1.43e-18\npolygon 1319 (hole)        4 -4.30008e-06     -6.42e-18\npolygon 1320 (hole)        3 -9.50720e-07     -1.42e-18\npolygon 1321              33  5.70263e+06      8.52e-06\npolygon 1322 (hole)        4 -1.11026e-07     -1.66e-19\npolygon 1323 (hole)       18 -3.35438e-06     -5.01e-18\npolygon 1324 (hole)        4 -8.99662e-08     -1.34e-19\npolygon 1325              90  4.20329e+07      6.28e-05\npolygon 1326 (hole)        7 -4.57836e-06     -6.84e-18\npolygon 1327 (hole)        6 -6.10846e-07     -9.12e-19\npolygon 1328 (hole)        4 -3.06663e-06     -4.58e-18\npolygon 1329              28  1.35341e+06      2.02e-06\npolygon 1330             225  1.08816e+08      1.62e-04\npolygon 1331 (hole)        4 -3.25111e-06     -4.85e-18\npolygon 1332 (hole)        7 -1.18871e-05     -1.77e-17\npolygon 1333 (hole)        4 -1.55924e-06     -2.33e-18\npolygon 1334 (hole)        6 -7.60023e-06     -1.13e-17\npolygon 1335 (hole)        4 -2.30025e-06     -3.43e-18\npolygon 1336 (hole)       11 -9.84822e-06     -1.47e-17\npolygon 1337 (hole)        5 -7.53674e-06     -1.13e-17\npolygon 1338              33  9.16670e+06      1.37e-05\npolygon 1339 (hole)        3 -2.41744e-08     -3.61e-20\npolygon 1340 (hole)        4 -2.51620e-06     -3.76e-18\npolygon 1341 (hole)       16 -1.27029e-05     -1.90e-17\npolygon 1342 (hole)       26 -1.72288e-05     -2.57e-17\npolygon 1343 (hole)       10 -2.36438e-06     -3.53e-18\npolygon 1344 (hole)        4 -3.34808e-06     -5.00e-18\npolygon 1345 (hole)        3 -9.14837e-09     -1.37e-20\npolygon 1346 (hole)        4 -1.19873e-06     -1.79e-18\npolygon 1347 (hole)        4 -4.92955e-07     -7.36e-19\npolygon 1348 (hole)        4 -2.32698e-06     -3.47e-18\npolygon 1349 (hole)        7 -2.16172e-05     -3.23e-17\npolygon 1350             192  7.02655e+07      1.05e-04\npolygon 1351 (hole)       26 -2.40792e-05     -3.60e-17\npolygon 1352 (hole)        7 -5.03281e-06     -7.51e-18\npolygon 1353 (hole)        7 -1.64468e-06     -2.46e-18\npolygon 1354 (hole)        8 -1.85171e-06     -2.76e-18\npolygon 1355              49  1.49245e+07      2.23e-05\npolygon 1356 (hole)       18 -9.02330e-06     -1.35e-17\npolygon 1357 (hole)       27 -5.41764e-06     -8.09e-18\npolygon 1358              98  1.79076e+07      2.67e-05\npolygon 1359 (hole)       13 -4.80257e-06     -7.17e-18\npolygon 1360 (hole)        4 -1.23210e-09     -1.84e-21\npolygon 1361 (hole)       10 -5.69750e-06     -8.51e-18\npolygon 1362 (hole)        4 -8.64197e-09     -1.29e-20\npolygon 1363 (hole)        4 -7.99628e-07     -1.19e-18\npolygon 1364 (hole)        4 -1.05581e-07     -1.58e-19\npolygon 1365 (hole)        4 -1.37479e-06     -2.05e-18\npolygon 1366 (hole)       15 -6.55499e-06     -9.79e-18\npolygon 1367 (hole)       16 -1.01732e-05     -1.52e-17\npolygon 1368 (hole)        4 -7.88985e-07     -1.18e-18\npolygon 1369 (hole)       16 -8.67609e-06     -1.30e-17\npolygon 1370 (hole)        5 -1.04547e-06     -1.56e-18\npolygon 1371 (hole)        6 -3.70115e-08     -5.53e-20\npolygon 1372 (hole)        4 -6.66500e-07     -9.95e-19\npolygon 1373 (hole)        5 -2.67465e-06     -3.99e-18\npolygon 1374 (hole)        6 -1.90428e-06     -2.84e-18\npolygon 1375 (hole)       13 -8.41304e-06     -1.26e-17\npolygon 1376 (hole)       13 -1.36015e-05     -2.03e-17\npolygon 1377 (hole)        4 -8.74539e-08     -1.31e-19\npolygon 1378 (hole)       30 -2.87850e-05     -4.30e-17\npolygon 1379 (hole)       11 -2.40885e-06     -3.60e-18\npolygon 1380 (hole)       13 -5.82211e-06     -8.69e-18\npolygon 1381 (hole)        4 -4.20571e-07     -6.28e-19\npolygon 1382 (hole)       10 -9.55963e-07     -1.43e-18\npolygon 1383 (hole)        5 -2.76738e-06     -4.13e-18\npolygon 1384 (hole)        8 -3.64075e-06     -5.44e-18\npolygon 1385 (hole)        4 -4.06980e-07     -6.08e-19\npolygon 1386 (hole)        4 -5.07468e-07     -7.58e-19\npolygon 1387 (hole)       16 -9.38904e-06     -1.40e-17\npolygon 1388 (hole)        4 -1.23601e-06     -1.85e-18\npolygon 1389               6  6.37552e+05      9.52e-07\npolygon 1390 (hole)        4 -9.73983e-07     -1.45e-18\npolygon 1391 (hole)        6 -1.42122e-06     -2.12e-18\npolygon 1392 (hole)        3 -3.51665e-08     -5.25e-20\npolygon 1393 (hole)        7 -3.01497e-06     -4.50e-18\npolygon 1394 (hole)        4 -2.90932e-07     -4.34e-19\npolygon 1395 (hole)       12 -8.34946e-06     -1.25e-17\npolygon 1396              49  1.01233e+07      1.51e-05\npolygon 1397 (hole)        3 -1.18683e-06     -1.77e-18\npolygon 1398 (hole)       14 -5.27823e-06     -7.88e-18\npolygon 1399 (hole)        6 -1.29239e-06     -1.93e-18\npolygon 1400 (hole)        6 -1.89882e-06     -2.84e-18\npolygon 1401 (hole)        8 -1.54910e-06     -2.31e-18\npolygon 1402 (hole)       44 -2.79284e-05     -4.17e-17\npolygon 1403 (hole)        4 -2.93319e-07     -4.38e-19\npolygon 1404 (hole)        4 -5.98880e-07     -8.94e-19\npolygon 1405 (hole)       17 -1.61884e-05     -2.42e-17\npolygon 1406 (hole)        4 -3.00830e-06     -4.49e-18\npolygon 1407 (hole)       10 -6.32218e-06     -9.44e-18\npolygon 1408 (hole)        6 -2.22110e-06     -3.32e-18\npolygon 1409 (hole)        4 -1.37311e-06     -2.05e-18\npolygon 1410 (hole)      116 -5.74188e-05     -8.57e-17\npolygon 1411 (hole)        4 -6.73023e-08     -1.00e-19\npolygon 1412 (hole)       11 -3.06108e-06     -4.57e-18\npolygon 1413 (hole)        4 -9.53593e-07     -1.42e-18\npolygon 1414 (hole)        4 -1.01867e-06     -1.52e-18\npolygon 1415 (hole)        6 -6.04033e-06     -9.02e-18\npolygon 1416 (hole)       10 -2.57535e-07     -3.85e-19\npolygon 1417 (hole)        3 -3.82545e-09     -5.71e-21\npolygon 1418 (hole)        5 -1.72474e-06     -2.58e-18\npolygon 1419 (hole)       20 -1.04546e-05     -1.56e-17\npolygon 1420             141  3.43053e+07      5.12e-05\npolygon 1421 (hole)       16 -2.77488e-06     -4.14e-18\npolygon 1422 (hole)        8 -5.86072e-06     -8.75e-18\npolygon 1423 (hole)        6 -3.30880e-06     -4.94e-18\npolygon 1424 (hole)        6 -6.07373e-06     -9.07e-18\npolygon 1425 (hole)        9 -2.99554e-06     -4.47e-18\npolygon 1426 (hole)        8 -1.67405e-06     -2.50e-18\npolygon 1427 (hole)       28 -6.15781e-06     -9.19e-18\npolygon 1428 (hole)        3 -3.88782e-08     -5.81e-20\npolygon 1429 (hole)        4 -3.27643e-07     -4.89e-19\npolygon 1430 (hole)        6 -2.82303e-06     -4.22e-18\npolygon 1431 (hole)       19 -1.25469e-05     -1.87e-17\npolygon 1432 (hole)        3 -2.77450e-08     -4.14e-20\npolygon 1433             195  3.24345e+07      4.84e-05\npolygon 1434              51  3.38313e+06      5.05e-06\npolygon 1435 (hole)        6 -1.02362e-06     -1.53e-18\npolygon 1436 (hole)       10 -2.99067e-06     -4.47e-18\npolygon 1437 (hole)       48 -3.28328e-05     -4.90e-17\npolygon 1438 (hole)       14 -1.26686e-05     -1.89e-17\npolygon 1439              34  2.01400e+06      3.01e-06\npolygon 1440 (hole)        4 -3.38471e-07     -5.05e-19\npolygon 1441 (hole)       12 -6.52316e-06     -9.74e-18\npolygon 1442 (hole)        3 -4.54695e-07     -6.79e-19\npolygon 1443              13  2.50435e+05      3.74e-07\npolygon 1444 (hole)        4 -4.28792e-07     -6.40e-19\npolygon 1445               9  9.04824e+04      1.35e-07\npolygon 1446 (hole)        6 -5.00839e-07     -7.48e-19\npolygon 1447 (hole)       16 -6.87328e-06     -1.03e-17\npolygon 1448 (hole)        3 -2.19555e-07     -3.28e-19\npolygon 1449 (hole)        4 -6.17909e-07     -9.23e-19\npolygon 1450 (hole)        7 -3.08205e-06     -4.60e-18\npolygon 1451 (hole)        6 -8.00906e-07     -1.20e-18\npolygon 1452 (hole)       44 -3.21771e-05     -4.80e-17\npolygon 1453 (hole)       12 -9.93527e-06     -1.48e-17\npolygon 1454 (hole)        4 -3.77730e-06     -5.64e-18\npolygon 1455 (hole)        4 -6.15912e-08     -9.20e-20\npolygon 1456 (hole)       21 -1.99790e-05     -2.98e-17\npolygon 1457              34  4.61794e+06      6.90e-06\npolygon 1458 (hole)        6 -3.95357e-06     -5.90e-18\npolygon 1459 (hole)        8 -3.20550e-06     -4.79e-18\npolygon 1460 (hole)        4 -1.13574e-06     -1.70e-18\npolygon 1461 (hole)        6 -4.01107e-06     -5.99e-18\npolygon 1462              17  4.58200e+05      6.84e-07\npolygon 1463              15  2.74776e+05      4.10e-07\npolygon 1464 (hole)        4 -2.17803e-06     -3.25e-18\npolygon 1465 (hole)        8 -3.10913e-06     -4.64e-18\npolygon 1466 (hole)        7 -1.03191e-06     -1.54e-18\npolygon 1467 (hole)        4 -4.56755e-07     -6.82e-19\npolygon 1468 (hole)       38 -2.28907e-05     -3.42e-17\npolygon 1469 (hole)       22 -2.02426e-05     -3.02e-17\npolygon 1470 (hole)        5 -7.03256e-06     -1.05e-17\npolygon 1471 (hole)        3 -4.53645e-06     -6.77e-18\npolygon 1472 (hole)        4 -2.57416e-06     -3.84e-18\npolygon 1473 (hole)        9 -3.17431e-06     -4.74e-18\npolygon 1474 (hole)        3 -8.14893e-07     -1.22e-18\npolygon 1475 (hole)        4 -2.92043e-07     -4.36e-19\npolygon 1476              21  5.34978e+05      7.99e-07\npolygon 1477              19  4.55347e+05      6.80e-07\npolygon 1478 (hole)       13 -3.65037e-06     -5.45e-18\npolygon 1479 (hole)       18 -5.91563e-06     -8.83e-18\npolygon 1480 (hole)       26 -2.22072e-05     -3.32e-17\npolygon 1481 (hole)        6 -4.11858e-06     -6.15e-18\npolygon 1482              71  3.42557e+06      5.11e-06\npolygon 1483 (hole)       10 -4.46830e-05     -6.67e-17\npolygon 1484 (hole)        3 -7.86478e-08     -1.17e-19\npolygon 1485 (hole)       10 -2.31548e-06     -3.46e-18\npolygon 1486 (hole)        8 -2.94599e-06     -4.40e-18\npolygon 1487 (hole)        3 -6.89871e-08     -1.03e-19\npolygon 1488 (hole)        4 -8.67038e-07     -1.29e-18\npolygon 1489 (hole)        7 -2.71749e-06     -4.06e-18\npolygon 1490 (hole)        4 -2.18103e-07     -3.26e-19\npolygon 1491 (hole)        8 -1.70822e-06     -2.55e-18\npolygon 1492 (hole)        7 -7.03541e-06     -1.05e-17\npolygon 1493 (hole)        9 -4.80516e-06     -7.17e-18\npolygon 1494              24  1.32420e+06      1.98e-06\npolygon 1495 (hole)        3 -2.86111e-07     -4.27e-19\npolygon 1496 (hole)        3 -2.78317e-07     -4.16e-19\npolygon 1497 (hole)        6 -1.83848e-06     -2.75e-18\npolygon 1498 (hole)       11 -6.96642e-06     -1.04e-17\npolygon 1499 (hole)        4 -3.39621e-07     -5.07e-19\npolygon 1500 (hole)        8 -9.82220e-07     -1.47e-18\npolygon 1501 (hole)        6 -1.98260e-06     -2.96e-18\npolygon 1502 (hole)       29 -4.25004e-05     -6.35e-17\npolygon 1503 (hole)        7 -4.40468e-06     -6.58e-18\npolygon 1504 (hole)        3 -1.88258e-07     -2.81e-19\npolygon 1505 (hole)       24 -2.40151e-05     -3.59e-17\npolygon 1506 (hole)       12 -1.45828e-05     -2.18e-17\npolygon 1507              15  3.26247e+05      4.87e-07\npolygon 1508 (hole)        8 -7.94382e-06     -1.19e-17\npolygon 1509              39  8.65790e+05      1.29e-06\npolygon 1510 (hole)        3 -7.78498e-08     -1.16e-19\npolygon 1511 (hole)        5 -4.56135e-06     -6.81e-18\npolygon 1512 (hole)       13 -4.85582e-06     -7.25e-18\npolygon 1513 (hole)        5 -1.96336e-06     -2.93e-18\npolygon 1514 (hole)        4 -3.15328e-06     -4.71e-18\npolygon 1515 (hole)        3 -4.51482e-07     -6.74e-19\npolygon 1516 (hole)        3 -1.07817e-06     -1.61e-18\npolygon 1517 (hole)       22 -1.73001e-05     -2.58e-17\npolygon 1518 (hole)        6 -6.52955e-06     -9.75e-18\npolygon 1519              43  1.41627e+06      2.11e-06\npolygon 1520 (hole)        6 -4.18463e-10     -6.25e-22\npolygon 1521 (hole)        8 -1.45698e-06     -2.18e-18\npolygon 1522 (hole)        5 -6.31841e-06     -9.43e-18\npolygon 1523              24  7.52068e+05      1.12e-06\npolygon 1524              96  1.32101e+07      1.97e-05\npolygon 1525 (hole)        4 -3.21780e-06     -4.80e-18\npolygon 1526 (hole)       22 -1.54606e-05     -2.31e-17\npolygon 1527              38  1.18003e+06      1.76e-06\npolygon 1528 (hole)        8 -4.32678e-06     -6.46e-18\npolygon 1529             429  5.99087e+08      8.95e-04\npolygon 1530 (hole)        4 -1.64135e-09     -2.45e-21\npolygon 1531 (hole)        4 -2.73107e-07     -4.08e-19\npolygon 1532 (hole)        4 -1.91370e-06     -2.86e-18\npolygon 1533 (hole)        4 -1.78855e-06     -2.67e-18\npolygon 1534 (hole)        4 -2.03383e-06     -3.04e-18\npolygon 1535 (hole)        4 -4.79569e-07     -7.16e-19\npolygon 1536              13  1.74105e+05      2.60e-07\npolygon 1537 (hole)        3 -3.72620e-09     -5.56e-21\npolygon 1538 (hole)        3 -7.54269e-07     -1.13e-18\npolygon 1539 (hole)        6 -1.22091e-06     -1.82e-18\npolygon 1540 (hole)        4 -6.55682e-07     -9.79e-19\npolygon 1541 (hole)        6 -1.41903e-06     -2.12e-18\npolygon 1542 (hole)        3 -2.08507e-07     -3.11e-19\npolygon 1543 (hole)       21 -5.68640e-06     -8.49e-18\npolygon 1544 (hole)        7 -4.14769e-06     -6.19e-18\npolygon 1545              19  2.52336e+05      3.77e-07\npolygon 1546              16  3.11495e+05      4.65e-07\npolygon 1547              11  9.11047e+04      1.36e-07\npolygon 1548              12  2.13470e+05      3.19e-07\npolygon 1549 (hole)        6 -3.42149e-07     -5.11e-19\npolygon 1550 (hole)        4 -1.13000e-06     -1.69e-18\npolygon 1551              17  5.82663e+05      8.70e-07\npolygon 1552 (hole)        7 -1.46618e-07     -2.19e-19\npolygon 1553 (hole)        4 -1.87323e-06     -2.80e-18\npolygon 1554 (hole)       22 -1.87611e-06     -2.80e-18\npolygon 1555 (hole)       18 -4.31626e-06     -6.44e-18\npolygon 1556 (hole)        8 -3.82791e-06     -5.72e-18\npolygon 1557 (hole)        8 -1.22826e-07     -1.83e-19\npolygon 1558 (hole)        6 -1.99743e-07     -2.98e-19\npolygon 1559 (hole)        6 -1.81367e-07     -2.71e-19\npolygon 1560 (hole)        6 -6.07369e-07     -9.07e-19\npolygon 1561 (hole)        6 -3.27160e-07     -4.89e-19\npolygon 1562 (hole)        4 -1.46273e-06     -2.18e-18\npolygon 1563              56  2.60440e+07      3.89e-05\npolygon 1564 (hole)        4 -2.49783e-08     -3.73e-20\npolygon 1565 (hole)       18 -2.72773e-06     -4.07e-18\npolygon 1566 (hole)       10 -1.60245e-05     -2.39e-17\npolygon 1567 (hole)        8 -3.87665e-06     -5.79e-18\npolygon 1568             107  4.91389e+06      7.34e-06\npolygon 1569 (hole)        4 -4.38590e-08     -6.55e-20\npolygon 1570 (hole)       23 -1.27065e-05     -1.90e-17\npolygon 1571 (hole)        4 -3.52441e-07     -5.26e-19\npolygon 1572 (hole)       14 -1.03893e-06     -1.55e-18\npolygon 1573 (hole)        4 -1.82700e-06     -2.73e-18\npolygon 1574 (hole)        4 -3.24845e-07     -4.85e-19\npolygon 1575 (hole)        4 -1.15005e-07     -1.72e-19\npolygon 1576 (hole)       17 -1.08039e-05     -1.61e-17\npolygon 1577 (hole)        3 -4.16747e-08     -6.22e-20\npolygon 1578 (hole)        7 -2.04281e-06     -3.05e-18\npolygon 1579 (hole)        7 -9.76038e-07     -1.46e-18\npolygon 1580 (hole)        4 -6.46463e-07     -9.65e-19\npolygon 1581 (hole)        6 -1.39092e-06     -2.08e-18\npolygon 1582 (hole)       14 -1.01022e-05     -1.51e-17\npolygon 1583 (hole)        8 -1.06753e-06     -1.59e-18\npolygon 1584 (hole)        5 -6.95110e-07     -1.04e-18\npolygon 1585 (hole)        6 -1.69667e-06     -2.53e-18\npolygon 1586 (hole)        6 -2.36309e-06     -3.53e-18\npolygon 1587 (hole)        4 -4.68481e-09     -7.00e-21\npolygon 1588 (hole)        4 -5.28613e-08     -7.89e-20\npolygon 1589 (hole)        4 -2.19566e-06     -3.28e-18\npolygon 1590 (hole)        4 -5.89715e-07     -8.81e-19\npolygon 1591 (hole)       10 -1.69640e-06     -2.53e-18\npolygon 1592 (hole)        6 -2.36204e-06     -3.53e-18\npolygon 1593 (hole)        8 -4.35762e-07     -6.51e-19\npolygon 1594 (hole)        4 -3.78991e-07     -5.66e-19\npolygon 1595 (hole)       11 -5.24079e-06     -7.83e-18\npolygon 1596 (hole)        4 -2.97757e-07     -4.45e-19\npolygon 1597 (hole)        6 -1.90442e-06     -2.84e-18\npolygon 1598 (hole)       12 -1.54359e-06     -2.30e-18\npolygon 1599 (hole)        4 -4.88715e-08     -7.30e-20\npolygon 1600 (hole)        6 -4.46422e-06     -6.67e-18\npolygon 1601 (hole)        4 -7.18182e-07     -1.07e-18\npolygon 1602              51  2.79076e+06      4.17e-06\npolygon 1603 (hole)        5 -1.30088e-06     -1.94e-18\npolygon 1604 (hole)        4 -3.44864e-09     -5.15e-21\npolygon 1605 (hole)        6 -4.08455e-07     -6.10e-19\npolygon 1606 (hole)       16 -1.17093e-05     -1.75e-17\npolygon 1607 (hole)        8 -1.88124e-06     -2.81e-18\npolygon 1608              89  1.61156e+07      2.41e-05\npolygon 1609 (hole)        4 -2.08345e-08     -3.11e-20\npolygon 1610 (hole)        8 -8.84457e-07     -1.32e-18\npolygon 1611 (hole)        6 -5.78902e-07     -8.64e-19\npolygon 1612 (hole)        3 -1.63520e-08     -2.44e-20\npolygon 1613 (hole)       24 -1.68721e-06     -2.52e-18\npolygon 1614 (hole)       44 -2.21857e-05     -3.31e-17\npolygon 1615              28  1.30499e+06      1.95e-06\npolygon 1616 (hole)        4 -5.63375e-07     -8.41e-19\npolygon 1617              11  1.27616e+05      1.91e-07\npolygon 1618 (hole)       14 -1.24709e-05     -1.86e-17\npolygon 1619 (hole)        4 -9.06970e-08     -1.35e-19\npolygon 1620 (hole)        3 -1.54971e-07     -2.31e-19\npolygon 1621 (hole)       12 -3.68707e-06     -5.51e-18\npolygon 1622 (hole)        7 -1.40269e-06     -2.09e-18\npolygon 1623 (hole)       14 -1.98158e-06     -2.96e-18\npolygon 1624 (hole)        6 -1.14775e-06     -1.71e-18\npolygon 1625              34  2.54199e+06      3.80e-06\npolygon 1626 (hole)        5 -4.92653e-07     -7.36e-19\npolygon 1627 (hole)        4 -6.94090e-08     -1.04e-19\npolygon 1628              27  1.72476e+06      2.58e-06\npolygon 1629 (hole)        5 -1.40448e-06     -2.10e-18\npolygon 1630 (hole)        7 -8.59950e-07     -1.28e-18\npolygon 1631 (hole)        3 -1.21743e-08     -1.82e-20\npolygon 1632 (hole)        4 -4.24830e-08     -6.34e-20\npolygon 1633 (hole)       10 -5.31444e-06     -7.94e-18\npolygon 1634 (hole)        4 -2.40976e-08     -3.60e-20\npolygon 1635 (hole)        6 -6.13864e-07     -9.17e-19\npolygon 1636 (hole)       14 -2.74358e-06     -4.10e-18\npolygon 1637              37  2.01882e+06      3.01e-06\npolygon 1638 (hole)        4 -3.44580e-07     -5.15e-19\npolygon 1639 (hole)        4 -5.85405e-07     -8.74e-19\npolygon 1640 (hole)        4 -2.98491e-07     -4.46e-19\npolygon 1641              23  1.65571e+06      2.47e-06\npolygon 1642 (hole)        4 -1.17689e-09     -1.76e-21\npolygon 1643 (hole)        4 -2.16214e-07     -3.23e-19\npolygon 1644 (hole)        4 -4.04928e-07     -6.05e-19\npolygon 1645 (hole)        5 -9.99138e-09     -1.49e-20\npolygon 1646 (hole)       10 -5.85947e-06     -8.75e-18\npolygon 1647 (hole)        6 -7.03787e-07     -1.05e-18\npolygon 1648 (hole)        4 -2.17558e-07     -3.25e-19\npolygon 1649 (hole)        4 -8.83660e-07     -1.32e-18\npolygon 1650 (hole)        8 -3.63328e-06     -5.43e-18\npolygon 1651 (hole)        5 -9.95934e-08     -1.49e-19\npolygon 1652 (hole)        8 -2.07837e-08     -3.10e-20\npolygon 1653 (hole)        4 -5.47865e-07     -8.18e-19\npolygon 1654 (hole)        6 -1.83399e-06     -2.74e-18\npolygon 1655 (hole)        4 -5.10743e-07     -7.63e-19\npolygon 1656 (hole)        6 -7.50815e-07     -1.12e-18\npolygon 1657 (hole)        4 -1.37158e-07     -2.05e-19\npolygon 1658 (hole)        4 -7.13833e-07     -1.07e-18\npolygon 1659 (hole)       16 -1.04407e-05     -1.56e-17\npolygon 1660 (hole)        4 -3.90398e-07     -5.83e-19\npolygon 1661 (hole)        4 -4.23935e-07     -6.33e-19\npolygon 1662 (hole)        4 -1.21166e-06     -1.81e-18\npolygon 1663 (hole)        3 -1.10293e-08     -1.65e-20\npolygon 1664 (hole)        4 -7.13134e-07     -1.06e-18\npolygon 1665 (hole)        3 -3.10439e-08     -4.64e-20\npolygon 1666 (hole)        4 -6.90386e-07     -1.03e-18\npolygon 1667 (hole)        3 -8.33411e-08     -1.24e-19\npolygon 1668 (hole)        4 -1.16037e-06     -1.73e-18\npolygon 1669 (hole)        4 -7.27735e-10     -1.09e-21\npolygon 1670 (hole)        8 -1.65989e-06     -2.48e-18\npolygon 1671 (hole)       16 -1.32050e-05     -1.97e-17\npolygon 1672 (hole)        4 -4.93692e-07     -7.37e-19\npolygon 1673 (hole)        4 -5.16743e-07     -7.72e-19\npolygon 1674 (hole)        3 -7.77350e-08     -1.16e-19\npolygon 1675 (hole)        4 -5.62314e-08     -8.40e-20\npolygon 1676 (hole)        4 -1.95564e-08     -2.92e-20\npolygon 1677 (hole)        3 -5.26487e-08     -7.86e-20\npolygon 1678 (hole)        4 -3.58834e-08     -5.36e-20\npolygon 1679 (hole)        4 -5.50151e-07     -8.21e-19\npolygon 1680 (hole)       14 -5.06833e-06     -7.57e-18\npolygon 1681 (hole)       22 -4.60302e-05     -6.87e-17\npolygon 1682 (hole)        4 -8.97690e-08     -1.34e-19\npolygon 1683              33  3.05816e+06      4.57e-06\npolygon 1684 (hole)        4 -5.38070e-08     -8.03e-20\npolygon 1685 (hole)       14 -4.93437e-06     -7.37e-18\npolygon 1686 (hole)        4 -4.76546e-07     -7.12e-19\npolygon 1687 (hole)        4 -5.02618e-07     -7.50e-19\npolygon 1688 (hole)        6 -5.13200e-06     -7.66e-18\npolygon 1689 (hole)        4 -8.36038e-07     -1.25e-18\npolygon 1690 (hole)        3 -5.36105e-12     -8.00e-24\npolygon 1691 (hole)        3 -2.71552e-08     -4.05e-20\npolygon 1692 (hole)        4 -3.60657e-09     -5.39e-21\npolygon 1693 (hole)        4 -1.33462e-06     -1.99e-18\npolygon 1694 (hole)       12 -4.86816e-05     -7.27e-17\npolygon 1695 (hole)        3 -1.34955e-07     -2.02e-19\npolygon 1696 (hole)        3 -2.12334e-07     -3.17e-19\npolygon 1697 (hole)        4 -4.20054e-09     -6.27e-21\npolygon 1698 (hole)        4 -5.33170e-07     -7.96e-19\npolygon 1699 (hole)       13 -5.30858e-06     -7.93e-18\npolygon 1700 (hole)        4 -8.06446e-08     -1.20e-19\npolygon 1701 (hole)        5 -3.68043e-07     -5.50e-19\npolygon 1702 (hole)        4 -2.33530e-07     -3.49e-19\npolygon 1703 (hole)        6 -1.39628e-06     -2.08e-18\npolygon 1704 (hole)        5 -1.06261e-06     -1.59e-18\npolygon 1705 (hole)        3 -4.46575e-08     -6.67e-20\npolygon 1706 (hole)        6 -1.13713e-08     -1.70e-20\npolygon 1707 (hole)        4 -8.74445e-09     -1.31e-20\npolygon 1708 (hole)        4 -2.67227e-07     -3.99e-19\npolygon 1709 (hole)        3 -1.84560e-08     -2.76e-20\npolygon 1710 (hole)        4 -1.60740e-06     -2.40e-18\npolygon 1711 (hole)        4 -3.53771e-07     -5.28e-19\npolygon 1712 (hole)        4 -3.46759e-07     -5.18e-19\npolygon 1713 (hole)        6 -9.05112e-07     -1.35e-18\npolygon 1714 (hole)        3 -1.56821e-08     -2.34e-20\npolygon 1715 (hole)        4 -4.47445e-08     -6.68e-20\npolygon 1716 (hole)        3 -6.29733e-08     -9.40e-20\npolygon 1717 (hole)        4 -1.63642e-06     -2.44e-18\npolygon 1718 (hole)        9 -1.75138e-06     -2.62e-18\npolygon 1719 (hole)        4 -2.87623e-07     -4.29e-19\npolygon 1720 (hole)        4 -8.67560e-11     -1.30e-22\npolygon 1721 (hole)        5 -1.31336e-06     -1.96e-18\npolygon 1722 (hole)        3 -3.04943e-07     -4.55e-19\npolygon 1723 (hole)        5 -2.68900e-06     -4.02e-18\npolygon 1724 (hole)        6 -6.90528e-07     -1.03e-18\npolygon 1725 (hole)       10 -1.92059e-06     -2.87e-18\npolygon 1726 (hole)        4 -2.00351e-07     -2.99e-19\npolygon 1727 (hole)        4 -2.86828e-07     -4.28e-19\npolygon 1728 (hole)        4 -7.73382e-07     -1.15e-18\npolygon 1729 (hole)        3 -1.11997e-08     -1.67e-20\npolygon 1730 (hole)        3 -9.20184e-08     -1.37e-19\npolygon 1731 (hole)        3 -1.32195e-07     -1.97e-19\npolygon 1732 (hole)        4 -3.29680e-07     -4.92e-19\npolygon 1733 (hole)        3 -2.80228e-08     -4.18e-20\npolygon 1734 (hole)        4 -2.99191e-07     -4.47e-19\npolygon 1735 (hole)        4 -2.05163e-07     -3.06e-19\npolygon 1736 (hole)       11 -1.40033e-05     -2.09e-17\npolygon 1737 (hole)        3 -3.24055e-07     -4.84e-19\npolygon 1738              14  3.23153e+05      4.83e-07\npolygon 1739 (hole)        4 -5.56091e-07     -8.30e-19\npolygon 1740              91  1.51209e+07      2.26e-05\npolygon 1741              12  2.42901e+05      3.63e-07\npolygon 1742 (hole)        8 -2.73012e-06     -4.08e-18\npolygon 1743 (hole)        3 -6.42965e-07     -9.60e-19\npolygon 1744 (hole)        4 -2.76407e-07     -4.13e-19\npolygon 1745 (hole)       26 -3.27735e-05     -4.89e-17\npolygon 1746 (hole)        3 -2.10943e-07     -3.15e-19\npolygon 1747 (hole)        8 -1.18263e-06     -1.77e-18\npolygon 1748 (hole)        9 -5.35231e-06     -7.99e-18\npolygon 1749 (hole)        5 -1.79697e-07     -2.68e-19\npolygon 1750 (hole)        6 -8.04294e-07     -1.20e-18\npolygon 1751 (hole)        3 -1.36326e-06     -2.04e-18\npolygon 1752 (hole)        4 -9.62895e-07     -1.44e-18\npolygon 1753 (hole)        4 -6.69034e-07     -9.99e-19\npolygon 1754 (hole)        3 -2.19453e-07     -3.28e-19\npolygon 1755 (hole)        5 -2.99322e-07     -4.47e-19\npolygon 1756 (hole)        8 -2.28509e-06     -3.41e-18\npolygon 1757 (hole)        4 -8.20274e-06     -1.22e-17\npolygon 1758 (hole)       11 -1.70474e-05     -2.55e-17\npolygon 1759 (hole)        3 -2.34922e-08     -3.51e-20\npolygon 1760 (hole)        4 -6.06276e-10     -9.05e-22\npolygon 1761 (hole)        5 -6.71399e-06     -1.00e-17\npolygon 1762 (hole)        5 -5.15199e-06     -7.69e-18\npolygon 1763 (hole)        3 -7.35162e-09     -1.10e-20\npolygon 1764 (hole)        3 -4.63827e-09     -6.93e-21\npolygon 1765 (hole)       12 -1.83303e-05     -2.74e-17\npolygon 1766 (hole)        3 -2.56734e-07     -3.83e-19\npolygon 1767 (hole)        4 -8.07600e-07     -1.21e-18\npolygon 1768 (hole)       26 -8.07401e-05     -1.21e-16\npolygon 1769 (hole)        4 -2.13280e-09     -3.18e-21\npolygon 1770 (hole)        7 -1.75631e-05     -2.62e-17\npolygon 1771 (hole)        5 -6.43614e-07     -9.61e-19\npolygon 1772              11  1.37889e+05      2.06e-07\npolygon 1773 (hole)        5 -5.08214e-07     -7.59e-19\npolygon 1774 (hole)        6 -2.73046e-06     -4.08e-18\npolygon 1775 (hole)        3 -2.19665e-08     -3.28e-20\npolygon 1776 (hole)       12 -4.56746e-06     -6.82e-18\npolygon 1777 (hole)       26 -3.51657e-05     -5.25e-17\npolygon 1778 (hole)        4 -7.78071e-07     -1.16e-18\npolygon 1779 (hole)       10 -4.26382e-06     -6.37e-18\npolygon 1780 (hole)        4 -7.81891e-07     -1.17e-18\npolygon 1781 (hole)        4 -2.17780e-07     -3.25e-19\npolygon 1782 (hole)        3 -5.33898e-09     -7.97e-21\npolygon 1783 (hole)        3 -2.25112e-08     -3.36e-20\npolygon 1784 (hole)       11 -4.16313e-06     -6.22e-18\npolygon 1785 (hole)        4 -1.65863e-08     -2.48e-20\npolygon 1786 (hole)        7 -4.09160e-06     -6.11e-18\npolygon 1787 (hole)        4 -1.10388e-06     -1.65e-18\npolygon 1788              58  2.29751e+07      3.43e-05\npolygon 1789 (hole)        7 -1.80837e-06     -2.70e-18\npolygon 1790 (hole)        4 -1.33063e-06     -1.99e-18\npolygon 1791 (hole)        6 -1.58632e-07     -2.37e-19\npolygon 1792 (hole)        9 -4.01274e-06     -5.99e-18\npolygon 1793 (hole)        4 -6.85939e-06     -1.02e-17\npolygon 1794 (hole)        3 -4.99275e-08     -7.46e-20\npolygon 1795              48  5.10265e+06      7.62e-06\npolygon 1796 (hole)        3 -6.23332e-08     -9.31e-20\npolygon 1797 (hole)        3 -1.69555e-07     -2.53e-19\npolygon 1798 (hole)        3 -2.32556e-08     -3.47e-20\npolygon 1799              22  1.30706e+06      1.95e-06\npolygon 1800 (hole)       13 -1.11426e-05     -1.66e-17\npolygon 1801 (hole)        4 -2.64657e-06     -3.95e-18\npolygon 1802 (hole)        9 -2.64074e-06     -3.94e-18\npolygon 1803 (hole)        5 -5.46390e-07     -8.16e-19\npolygon 1804 (hole)        4 -1.57487e-07     -2.35e-19\npolygon 1805 (hole)        3 -1.59808e-07     -2.39e-19\npolygon 1806 (hole)        3 -2.70704e-09     -4.04e-21\npolygon 1807              15  3.49480e+05      5.22e-07\npolygon 1808 (hole)        4 -5.66568e-07     -8.46e-19\npolygon 1809 (hole)        8 -1.11776e-05     -1.67e-17\npolygon 1810 (hole)       15 -2.05832e-05     -3.07e-17\npolygon 1811 (hole)        9 -3.23503e-06     -4.83e-18\npolygon 1812              17  1.57570e+06      2.35e-06\npolygon 1813 (hole)        4 -4.45505e-07     -6.65e-19\npolygon 1814 (hole)        4 -5.27258e-06     -7.87e-18\npolygon 1815 (hole)        6 -6.27130e-06     -9.36e-18\npolygon 1816 (hole)        4 -6.27149e-06     -9.36e-18\npolygon 1817 (hole)        6 -3.88162e-06     -5.80e-18\npolygon 1818 (hole)        6 -1.86717e-06     -2.79e-18\npolygon 1819 (hole)        4 -2.11130e-06     -3.15e-18\npolygon 1820 (hole)        3 -2.79157e-07     -4.17e-19\npolygon 1821 (hole)        9 -1.12712e-05     -1.68e-17\npolygon 1822 (hole)       14 -1.09777e-05     -1.64e-17\npolygon 1823 (hole)        3 -4.33570e-11     -6.47e-23\npolygon 1824 (hole)        3 -6.31536e-07     -9.43e-19\npolygon 1825 (hole)        5 -2.13138e-06     -3.18e-18\npolygon 1826 (hole)        4 -3.31303e-08     -4.95e-20\npolygon 1827 (hole)        4 -3.18416e-07     -4.75e-19\npolygon 1828 (hole)        3 -2.15696e-12     -3.22e-24\npolygon 1829 (hole)        6 -1.83220e-11     -2.74e-23\npolygon 1830 (hole)        7 -2.45238e-05     -3.66e-17\npolygon 1831 (hole)        4 -8.49859e-07     -1.27e-18\npolygon 1832 (hole)        5 -1.56820e-06     -2.34e-18\npolygon 1833 (hole)        4 -2.53338e-06     -3.78e-18\npolygon 1834 (hole)        4 -3.59630e-06     -5.37e-18\npolygon 1835 (hole)       10 -1.37731e-05     -2.06e-17\npolygon 1836 (hole)        8 -1.33011e-06     -1.99e-18\npolygon 1837 (hole)        3 -8.90672e-08     -1.33e-19\npolygon 1838 (hole)        5 -6.34059e-07     -9.47e-19\npolygon 1839 (hole)        4 -5.00802e-08     -7.48e-20\npolygon 1840 (hole)        3 -7.53308e-09     -1.12e-20\npolygon 1841 (hole)       18 -3.04655e-05     -4.55e-17\npolygon 1842 (hole)        4 -2.64560e-07     -3.95e-19\npolygon 1843 (hole)        4 -2.85284e-07     -4.26e-19\npolygon 1844 (hole)        3 -2.73112e-10     -4.08e-22\npolygon 1845 (hole)        6 -1.43732e-06     -2.15e-18\npolygon 1846 (hole)        5 -2.80662e-07     -4.19e-19\npolygon 1847 (hole)        4 -5.81052e-10     -8.68e-22\npolygon 1848 (hole)        4 -1.15507e-06     -1.72e-18\npolygon 1849 (hole)        7 -4.81395e-06     -7.19e-18\npolygon 1850 (hole)        3 -3.81212e-08     -5.69e-20\npolygon 1851 (hole)        8 -5.20229e-06     -7.77e-18\npolygon 1852 (hole)        4 -6.21730e-07     -9.28e-19\npolygon 1853 (hole)        4 -2.97528e-07     -4.44e-19\npolygon 1854 (hole)        4 -1.10667e-08     -1.65e-20\npolygon 1855 (hole)        6 -2.94240e-07     -4.39e-19\npolygon 1856 (hole)        4 -8.30125e-08     -1.24e-19\npolygon 1857 (hole)        6 -7.19520e-07     -1.07e-18\npolygon 1858 (hole)        4 -1.77073e-07     -2.64e-19\npolygon 1859 (hole)        3 -2.17674e-10     -3.25e-22\npolygon 1860 (hole)        4 -2.25466e-06     -3.37e-18\npolygon 1861 (hole)        6 -7.73253e-08     -1.15e-19\npolygon 1862 (hole)        4 -1.57357e-07     -2.35e-19\npolygon 1863 (hole)        5 -4.57468e-06     -6.83e-18\npolygon 1864 (hole)        8 -4.87707e-06     -7.28e-18\npolygon 1865 (hole)        4 -1.73318e-06     -2.59e-18\npolygon 1866 (hole)       10 -5.92931e-06     -8.85e-18\npolygon 1867 (hole)        3 -3.39743e-06     -5.07e-18\npolygon 1868 (hole)        5 -2.57467e-06     -3.84e-18\npolygon 1869               3  0.00000e+00      0.00e+00\npolygon 1870 (hole)       14 -1.90108e-06     -2.84e-18\npolygon 1871 (hole)        6 -7.61102e-07     -1.14e-18\npolygon 1872 (hole)        4 -5.32842e-07     -7.96e-19\npolygon 1873 (hole)        6 -1.13459e-06     -1.69e-18\npolygon 1874 (hole)        5 -1.11762e-06     -1.67e-18\npolygon 1875 (hole)        4 -1.47102e-07     -2.20e-19\npolygon 1876 (hole)        3 -1.28204e-08     -1.91e-20\npolygon 1877 (hole)        4 -4.11838e-07     -6.15e-19\npolygon 1878 (hole)        8 -1.40640e-06     -2.10e-18\npolygon 1879 (hole)        4 -1.19220e-07     -1.78e-19\npolygon 1880 (hole)       21 -6.24274e-06     -9.32e-18\npolygon 1881 (hole)        6 -1.02331e-06     -1.53e-18\npolygon 1882 (hole)        3 -6.32548e-07     -9.45e-19\npolygon 1883 (hole)        4 -1.74049e-07     -2.60e-19\npolygon 1884 (hole)        4 -6.72613e-07     -1.00e-18\npolygon 1885 (hole)        3 -1.26054e-07     -1.88e-19\npolygon 1886 (hole)        4 -1.56399e-07     -2.34e-19\npolygon 1887 (hole)        4 -1.07982e-06     -1.61e-18\npolygon 1888 (hole)        3 -1.75029e-10     -2.61e-22\npolygon 1889 (hole)        6 -1.21258e-06     -1.81e-18\npolygon 1890 (hole)        3 -2.18693e-10     -3.27e-22\npolygon 1891 (hole)        6 -1.98429e-06     -2.96e-18\npolygon 1892 (hole)        3 -7.44712e-08     -1.11e-19\npolygon 1893 (hole)        5 -1.73298e-07     -2.59e-19\npolygon 1894 (hole)        8 -1.11780e-06     -1.67e-18\npolygon 1895 (hole)        5 -2.92113e-07     -4.36e-19\npolygon 1896 (hole)        5 -4.17296e-07     -6.23e-19\npolygon 1897 (hole)        4 -8.74020e-08     -1.31e-19\npolygon 1898 (hole)       10 -4.80051e-06     -7.17e-18\npolygon 1899 (hole)        7 -3.92943e-06     -5.87e-18\npolygon 1900 (hole)        5 -6.39520e-08     -9.55e-20\npolygon 1901 (hole)        8 -2.97917e-06     -4.45e-18\npolygon 1902               3  7.90864e-13      1.18e-24\npolygon 1903 (hole)        3 -7.88717e-10     -1.18e-21\npolygon 1904 (hole)        7 -3.19924e-06     -4.78e-18\npolygon 1905 (hole)        3 -3.78263e-08     -5.65e-20\npolygon 1906 (hole)        4 -1.01393e-07     -1.51e-19\npolygon 1907 (hole)        6 -9.88893e-07     -1.48e-18\npolygon 1908 (hole)        4 -1.54280e-07     -2.30e-19\npolygon 1909 (hole)        6 -1.16613e-06     -1.74e-18\npolygon 1910 (hole)        4 -1.90529e-07     -2.84e-19\npolygon 1911 (hole)        5 -1.28177e-06     -1.91e-18\npolygon 1912 (hole)        7 -9.05878e-07     -1.35e-18\npolygon 1913 (hole)        6 -5.42790e-07     -8.10e-19\npolygon 1914 (hole)        7 -8.85090e-07     -1.32e-18\npolygon 1915 (hole)        4 -3.25811e-07     -4.86e-19\npolygon 1916 (hole)        4 -9.07403e-09     -1.35e-20\npolygon 1917 (hole)        8 -3.96105e-06     -5.91e-18\npolygon 1918 (hole)        3 -5.57654e-08     -8.33e-20\npolygon 1919 (hole)        8 -2.02385e-06     -3.02e-18\npolygon 1920 (hole)        4 -4.10371e-11     -6.13e-23\npolygon 1921 (hole)        4 -2.23459e-09     -3.34e-21\npolygon 1922 (hole)        4 -3.17182e-07     -4.74e-19\npolygon 1923 (hole)        6 -1.47194e-06     -2.20e-18\npolygon 1924 (hole)        7 -2.70870e-06     -4.04e-18\npolygon 1925 (hole)        3 -4.70586e-07     -7.03e-19\npolygon 1926              34  3.68725e+06      5.51e-06\npolygon 1927 (hole)        4 -2.48296e-06     -3.71e-18\npolygon 1928 (hole)        4 -2.95231e-06     -4.41e-18\npolygon 1929 (hole)        3 -8.03970e-08     -1.20e-19\npolygon 1930 (hole)        9 -6.25630e-06     -9.34e-18\npolygon 1931 (hole)        3 -2.04658e-07     -3.06e-19\npolygon 1932 (hole)        3 -2.71286e-08     -4.05e-20\npolygon 1933 (hole)        7 -5.33066e-06     -7.96e-18\npolygon 1934 (hole)        3 -3.77873e-09     -5.64e-21\npolygon 1935 (hole)        4 -4.50610e-07     -6.73e-19\npolygon 1936 (hole)        3 -1.06450e-06     -1.59e-18\npolygon 1937 (hole)        3 -5.75708e-06     -8.60e-18\npolygon 1938 (hole)        9 -3.72953e-06     -5.57e-18\npolygon 1939 (hole)        3 -3.46305e-07     -5.17e-19\npolygon 1940 (hole)        3 -2.24653e-07     -3.35e-19\npolygon 1941 (hole)       13 -1.13679e-05     -1.70e-17\npolygon 1942 (hole)        4 -3.04969e-07     -4.55e-19\npolygon 1943 (hole)        3 -1.30594e-08     -1.95e-20\npolygon 1944              34  5.21904e+06      7.79e-06\npolygon 1945 (hole)        7 -1.20248e-06     -1.80e-18\npolygon 1946 (hole)        7 -2.99564e-06     -4.47e-18\npolygon 1947 (hole)        8 -2.27618e-06     -3.40e-18\npolygon 1948 (hole)        4 -8.16830e-07     -1.22e-18\npolygon 1949 (hole)        3 -8.06707e-08     -1.20e-19\npolygon 1950 (hole)        4 -8.83594e-07     -1.32e-18\npolygon 1951 (hole)        4 -3.49086e-07     -5.21e-19\npolygon 1952 (hole)        3 -5.35261e-11     -7.99e-23\npolygon 1953 (hole)        4 -2.92210e-07     -4.36e-19\npolygon 1954 (hole)        4 -7.86447e-07     -1.17e-18\npolygon 1955 (hole)        4 -6.63060e-07     -9.90e-19\npolygon 1956 (hole)        6 -1.07789e-06     -1.61e-18\npolygon 1957 (hole)        4 -5.25771e-12     -7.85e-24\npolygon 1958 (hole)        4 -1.34866e-07     -2.01e-19\npolygon 1959 (hole)        8 -6.41469e-06     -9.58e-18\npolygon 1960 (hole)        4 -7.44965e-07     -1.11e-18\npolygon 1961              24  5.42734e+06      8.10e-06\npolygon 1962 (hole)        4 -3.75451e-07     -5.61e-19\npolygon 1963 (hole)        4 -4.44089e-07     -6.63e-19\npolygon 1964 (hole)        4 -6.92738e-06     -1.03e-17\npolygon 1965 (hole)        4 -1.38608e-06     -2.07e-18\npolygon 1966 (hole)       10 -3.04397e-06     -4.55e-18\npolygon 1967 (hole)       15 -4.51401e-05     -6.74e-17\npolygon 1968 (hole)        4 -3.82102e-06     -5.71e-18\npolygon 1969 (hole)        4 -4.82557e-08     -7.21e-20\npolygon 1970 (hole)        3 -1.56615e-06     -2.34e-18\npolygon 1971 (hole)        4 -2.81604e-07     -4.20e-19\npolygon 1972 (hole)        9 -7.13750e-06     -1.07e-17\npolygon 1973 (hole)        5 -1.16161e-05     -1.73e-17\npolygon 1974 (hole)        4 -4.23687e-08     -6.33e-20\npolygon 1975 (hole)        7 -5.75328e-06     -8.59e-18\npolygon 1976 (hole)        4 -7.88434e-08     -1.18e-19\npolygon 1977 (hole)        3 -7.85294e-08     -1.17e-19\npolygon 1978 (hole)        3 -1.69793e-08     -2.54e-20\npolygon 1979 (hole)        3 -5.42914e-07     -8.11e-19\npolygon 1980 (hole)        3 -6.51153e-07     -9.72e-19\npolygon 1981 (hole)        3 -1.44007e-06     -2.15e-18\npolygon 1982 (hole)        7 -8.09157e-07     -1.21e-18\npolygon 1983 (hole)        4 -6.98998e-07     -1.04e-18\npolygon 1984 (hole)        7 -3.44263e-07     -5.14e-19\npolygon 1985 (hole)        5 -3.15301e-07     -4.71e-19\npolygon 1986 (hole)       10 -1.92220e-06     -2.87e-18\npolygon 1987 (hole)        5 -6.25364e-07     -9.34e-19\npolygon 1988 (hole)        4 -4.68617e-09     -7.00e-21\npolygon 1989 (hole)        8 -9.34370e-07     -1.40e-18\npolygon 1990 (hole)        3 -2.63319e-10     -3.93e-22\npolygon 1991 (hole)       19 -1.21335e-05     -1.81e-17\npolygon 1992 (hole)        4 -6.83716e-07     -1.02e-18\npolygon 1993 (hole)       10 -1.81498e-05     -2.71e-17\npolygon 1994 (hole)        3 -9.85058e-08     -1.47e-19\npolygon 1995 (hole)        4 -8.01189e-09     -1.20e-20\npolygon 1996 (hole)        4 -4.21768e-07     -6.30e-19\npolygon 1997 (hole)        4 -1.38283e-07     -2.06e-19\npolygon 1998 (hole)        4 -5.22449e-07     -7.80e-19\npolygon 1999 (hole)        5 -4.09813e-06     -6.12e-18\npolygon 2000 (hole)        5 -2.18080e-06     -3.26e-18\npolygon 2001 (hole)        4 -1.61278e-07     -2.41e-19\npolygon 2002 (hole)        3 -3.01255e-07     -4.50e-19\npolygon 2003 (hole)        3 -2.00013e-08     -2.99e-20\npolygon 2004 (hole)        4 -5.49179e-07     -8.20e-19\npolygon 2005 (hole)        4 -7.24606e-09     -1.08e-20\npolygon 2006 (hole)        5 -2.94956e-07     -4.40e-19\npolygon 2007 (hole)        4 -3.38012e-08     -5.05e-20\npolygon 2008 (hole)        6 -5.04061e-07     -7.53e-19\npolygon 2009 (hole)        4 -1.96209e-06     -2.93e-18\npolygon 2010 (hole)        3 -1.01879e-07     -1.52e-19\npolygon 2011 (hole)        4 -1.76019e-07     -2.63e-19\npolygon 2012 (hole)        8 -2.45591e-06     -3.67e-18\npolygon 2013 (hole)        6 -6.04926e-07     -9.03e-19\npolygon 2014 (hole)        4 -8.28359e-07     -1.24e-18\npolygon 2015 (hole)        7 -7.54811e-06     -1.13e-17\npolygon 2016             422  4.66497e+08      6.97e-04\npolygon 2017 (hole)        4 -1.69285e-06     -2.53e-18\npolygon 2018 (hole)       15 -1.37891e-05     -2.06e-17\npolygon 2019 (hole)        3 -1.12114e-07     -1.67e-19\npolygon 2020 (hole)        4 -5.26294e-07     -7.86e-19\npolygon 2021 (hole)        8 -4.26164e-06     -6.36e-18\npolygon 2022 (hole)        3 -1.29708e-08     -1.94e-20\npolygon 2023 (hole)        5 -2.60038e-06     -3.88e-18\npolygon 2024 (hole)        4 -1.73366e-11     -2.59e-23\npolygon 2025 (hole)        5 -2.51174e-07     -3.75e-19\npolygon 2026 (hole)        3 -7.10799e-07     -1.06e-18\npolygon 2027 (hole)        4 -5.00120e-06     -7.47e-18\npolygon 2028 (hole)        4 -2.59465e-08     -3.87e-20\npolygon 2029 (hole)        3 -1.60619e-06     -2.40e-18\npolygon 2030 (hole)        3 -1.02278e-07     -1.53e-19\npolygon 2031 (hole)       14 -2.46813e-06     -3.69e-18\npolygon 2032 (hole)        3 -2.46492e-07     -3.68e-19\npolygon 2033 (hole)        3 -2.43835e-07     -3.64e-19\npolygon 2034 (hole)        4 -7.47139e-08     -1.12e-19\npolygon 2035 (hole)        4 -4.64820e-07     -6.94e-19\npolygon 2036 (hole)        9 -1.68186e-05     -2.51e-17\npolygon 2037 (hole)        3 -3.82957e-07     -5.72e-19\npolygon 2038 (hole)        4 -1.05052e-07     -1.57e-19\npolygon 2039 (hole)        3 -4.31120e-07     -6.44e-19\npolygon 2040 (hole)        5 -2.43377e-06     -3.63e-18\npolygon 2041 (hole)        5 -5.52177e-06     -8.24e-18\npolygon 2042 (hole)        4 -9.06788e-07     -1.35e-18\npolygon 2043 (hole)        3 -6.49923e-09     -9.70e-21\npolygon 2044 (hole)        8 -2.22540e-06     -3.32e-18\npolygon 2045 (hole)        4 -9.76475e-06     -1.46e-17\npolygon 2046 (hole)        3 -1.04451e-06     -1.56e-18\npolygon 2047 (hole)        4 -6.93267e-07     -1.04e-18\npolygon 2048 (hole)        3 -2.17536e-07     -3.25e-19\npolygon 2049 (hole)        4 -1.70220e-06     -2.54e-18\npolygon 2050 (hole)        3 -7.21990e-07     -1.08e-18\npolygon 2051 (hole)        9 -2.65177e-05     -3.96e-17\npolygon 2052 (hole)        4 -5.04179e-07     -7.53e-19\npolygon 2053 (hole)        4 -1.55992e-07     -2.33e-19\npolygon 2054             142  2.98767e+07      4.46e-05\npolygon 2055 (hole)        4 -8.39573e-08     -1.25e-19\npolygon 2056 (hole)        4 -1.74434e-06     -2.60e-18\npolygon 2057 (hole)        7 -6.44608e-06     -9.63e-18\npolygon 2058 (hole)        6 -5.03620e-06     -7.52e-18\npolygon 2059 (hole)       13 -2.48012e-05     -3.70e-17\npolygon 2060 (hole)        3 -2.64876e-07     -3.96e-19\npolygon 2061 (hole)        4 -7.68739e-07     -1.15e-18\npolygon 2062 (hole)        5 -5.68020e-06     -8.48e-18\npolygon 2063 (hole)        3 -5.13041e-07     -7.66e-19\npolygon 2064 (hole)        7 -5.71177e-06     -8.53e-18\npolygon 2065 (hole)        7 -3.71420e-06     -5.55e-18\npolygon 2066 (hole)        3 -4.35895e-09     -6.51e-21\npolygon 2067 (hole)        3 -8.76864e-07     -1.31e-18\npolygon 2068 (hole)        3 -1.71724e-08     -2.56e-20\npolygon 2069 (hole)        4 -5.38469e-07     -8.04e-19\npolygon 2070               3  2.20807e-13      3.30e-25\npolygon 2071 (hole)        9 -6.86726e-06     -1.03e-17\npolygon 2072 (hole)        7 -3.28723e-06     -4.91e-18\npolygon 2073 (hole)        4 -1.28046e-06     -1.91e-18\npolygon 2074 (hole)        4 -6.95615e-07     -1.04e-18\npolygon 2075 (hole)       12 -4.26089e-06     -6.36e-18\npolygon 2076 (hole)        4 -3.28508e-07     -4.91e-19\npolygon 2077 (hole)        3 -2.24959e-11     -3.36e-23\npolygon 2078 (hole)        4 -3.80264e-07     -5.68e-19\npolygon 2079 (hole)        5 -1.91389e-07     -2.86e-19\npolygon 2080 (hole)        5 -1.53721e-06     -2.30e-18\npolygon 2081             132  2.18707e+07      3.27e-05\npolygon 2082 (hole)        6 -1.60022e-07     -2.39e-19\npolygon 2083 (hole)        9 -3.02353e-06     -4.51e-18\npolygon 2084 (hole)        3 -1.22648e-09     -1.83e-21\npolygon 2085 (hole)        3 -3.29740e-12     -4.92e-24\npolygon 2086 (hole)        4 -6.03872e-10     -9.02e-22\npolygon 2087 (hole)        6 -5.71380e-07     -8.53e-19\npolygon 2088 (hole)        4 -1.04156e-07     -1.56e-19\npolygon 2089 (hole)        3 -2.12278e-07     -3.17e-19\npolygon 2090 (hole)        4 -4.15594e-07     -6.21e-19\npolygon 2091 (hole)        4 -6.49628e-07     -9.70e-19\npolygon 2092 (hole)        3 -2.34310e-10     -3.50e-22\npolygon 2093 (hole)        4 -2.36408e-06     -3.53e-18\npolygon 2094 (hole)        3 -1.27392e-07     -1.90e-19\npolygon 2095              19  5.88230e+05      8.78e-07\npolygon 2096              22  1.77611e+06      2.65e-06\npolygon 2097 (hole)        4 -6.42918e-04     -9.60e-16\npolygon 2098              40  4.09952e+06      6.12e-06\npolygon 2099 (hole)        3 -2.52078e-03     -3.76e-15\npolygon 2100 (hole)        3 -1.79689e-06     -2.68e-18\npolygon 2101 (hole)       18 -7.15276e-05     -1.07e-16\npolygon 2102              28  1.47685e+06      2.21e-06\npolygon 2103 (hole)        8 -8.93463e-02     -1.33e-13\npolygon 2104 (hole)        4 -3.84605e-07     -5.74e-19\npolygon 2105 (hole)       10 -2.92175e-06     -4.36e-18\npolygon 2106 (hole)        3 -4.05147e-09     -6.05e-21\npolygon 2107 (hole)        4 -7.00102e-08     -1.05e-19\npolygon 2108 (hole)        5 -8.60119e-07     -1.28e-18\npolygon 2109 (hole)        6 -3.80978e-06     -5.69e-18\npolygon 2110              67  9.99685e+06      1.49e-05\npolygon 2111 (hole)        4 -1.03949e-06     -1.55e-18\npolygon 2112 (hole)        5 -2.91434e-06     -4.35e-18\npolygon 2113 (hole)        3 -7.18397e-07     -1.07e-18\npolygon 2114 (hole)        6 -1.39936e-06     -2.09e-18\npolygon 2115 (hole)        8 -6.36344e-02     -9.50e-14\npolygon 2116 (hole)        6 -7.57977e-02     -1.13e-13\npolygon 2117 (hole)        3 -4.31917e-06     -6.45e-18\npolygon 2118 (hole)        4 -1.90194e-06     -2.84e-18\npolygon 2119 (hole)        4 -2.24224e-02     -3.35e-14\npolygon 2120 (hole)        5 -9.35663e-02     -1.40e-13\npolygon 2121 (hole)       13 -1.39251e-01     -2.08e-13\npolygon 2122 (hole)        7 -1.46533e-01     -2.19e-13\npolygon 2123 (hole)        6 -7.59070e-02     -1.13e-13\npolygon 2124 (hole)        7 -5.15914e-03     -7.70e-15\npolygon 2125 (hole)        4 -1.90641e-02     -2.85e-14\npolygon 2126 (hole)       21 -1.86624e-01     -2.79e-13\npolygon 2127 (hole)        6 -2.18823e-02     -3.27e-14\npolygon 2128 (hole)        3 -1.69684e-02     -2.53e-14\npolygon 2129 (hole)        8 -4.08363e-02     -6.10e-14\npolygon 2130 (hole)        3 -1.73631e-02     -2.59e-14\npolygon 2131 (hole)        5 -1.41820e-02     -2.12e-14\npolygon 2132 (hole)       10 -6.15227e-02     -9.19e-14\npolygon 2133 (hole)        4 -2.78853e-02     -4.16e-14\npolygon 2134 (hole)        4 -1.19272e-03     -1.78e-15\npolygon 2135 (hole)        8 -6.15579e-02     -9.19e-14\npolygon 2136 (hole)        4 -7.46409e-04     -1.11e-15\npolygon 2137 (hole)        4 -1.05431e-02     -1.57e-14\npolygon 2138 (hole)        4 -8.25150e-03     -1.23e-14\npolygon 2139 (hole)        6 -3.60199e-06     -5.38e-18\npolygon 2140 (hole)        5 -2.09549e-06     -3.13e-18\npolygon 2141 (hole)       10 -7.09078e-06     -1.06e-17\npolygon 2142 (hole)        9 -3.77501e-07     -5.64e-19\npolygon 2143 (hole)        3 -5.11518e-07     -7.64e-19\npolygon 2144 (hole)        4 -3.78585e-08     -5.65e-20\npolygon 2145 (hole)        3 -2.59990e-02     -3.88e-14\npolygon 2146 (hole)        4 -1.96870e-02     -2.94e-14\npolygon 2147 (hole)        3 -4.55390e-07     -6.80e-19\npolygon 2148 (hole)        6 -9.09753e-03     -1.36e-14\npolygon 2149 (hole)        4 -1.83409e-06     -2.74e-18\npolygon 2150 (hole)        3 -1.66969e-07     -2.49e-19\npolygon 2151 (hole)        3 -4.01451e-05     -5.99e-17\npolygon 2152 (hole)        9 -2.41806e-02     -3.61e-14\npolygon 2153 (hole)        6 -1.10855e-02     -1.66e-14\npolygon 2154 (hole)        3 -6.54186e-08     -9.77e-20\npolygon 2155 (hole)        4 -6.36389e-06     -9.50e-18\npolygon 2156 (hole)        4 -4.86960e-08     -7.27e-20\npolygon 2157 (hole)        4 -2.05561e-06     -3.07e-18\npolygon 2158 (hole)        3 -7.64008e-09     -1.14e-20\npolygon 2159 (hole)        4 -6.02970e-07     -9.00e-19\npolygon 2160 (hole)        4 -2.92540e-07     -4.37e-19\npolygon 2161               3  0.00000e+00      0.00e+00\npolygon 2162 (hole)       12 -1.49534e-06     -2.23e-18\npolygon 2163 (hole)        7 -9.38954e-06     -1.40e-17\npolygon 2164 (hole)        7 -5.73306e-02     -8.56e-14\npolygon 2165 (hole)        4 -1.34343e-07     -2.01e-19\npolygon 2166 (hole)        4 -4.68446e-07     -6.99e-19\npolygon 2167 (hole)        4 -4.26733e-02     -6.37e-14\npolygon 2168 (hole)        8 -3.37463e-06     -5.04e-18\npolygon 2169 (hole)        6 -1.57810e-06     -2.36e-18\npolygon 2170 (hole)        4 -1.38595e-06     -2.07e-18\npolygon 2171 (hole)        4 -2.50695e-09     -3.74e-21\npolygon 2172 (hole)        3 -1.35315e-08     -2.02e-20\npolygon 2173 (hole)        3 -9.56323e-03     -1.43e-14\npolygon 2174 (hole)        3 -6.33450e-07     -9.46e-19\npolygon 2175 (hole)        4 -7.12425e-07     -1.06e-18\npolygon 2176 (hole)        6 -7.41009e-03     -1.11e-14\npolygon 2177 (hole)        3 -4.71206e-07     -7.04e-19\npolygon 2178 (hole)        5 -7.41968e-07     -1.11e-18\npolygon 2179 (hole)        7 -1.51404e-06     -2.26e-18\npolygon 2180 (hole)        3 -1.01038e-07     -1.51e-19\npolygon 2181 (hole)        8 -1.54048e-01     -2.30e-13\npolygon 2182 (hole)        5 -3.39011e-06     -5.06e-18\npolygon 2183 (hole)        4 -1.79444e-07     -2.68e-19\npolygon 2184 (hole)        4 -1.01916e-07     -1.52e-19\npolygon 2185 (hole)        5 -1.67978e-06     -2.51e-18\npolygon 2186 (hole)        3 -2.99097e-08     -4.47e-20\npolygon 2187 (hole)       14 -1.04855e-06     -1.57e-18\npolygon 2188 (hole)        5 -9.77385e-07     -1.46e-18\npolygon 2189 (hole)        4 -6.05021e-08     -9.03e-20\npolygon 2190 (hole)        3 -1.05617e-02     -1.58e-14\npolygon 2191 (hole)        3 -1.29808e-08     -1.94e-20\npolygon 2192 (hole)        4 -2.82867e-07     -4.22e-19\npolygon 2193              25  4.82266e+05      7.20e-07\npolygon 2194 (hole)        6 -3.72419e-02     -5.56e-14\npolygon 2195 (hole)        8 -3.08351e-02     -4.60e-14\npolygon 2196 (hole)        7 -4.08889e-02     -6.11e-14\npolygon 2197 (hole)        3 -1.86764e-10     -2.79e-22\npolygon 2198 (hole)        4 -6.69685e-03     -1.00e-14\npolygon 2199 (hole)        4 -1.15923e-02     -1.73e-14\npolygon 2200 (hole)        6 -3.11062e-03     -4.64e-15\npolygon 2201 (hole)       12 -1.45672e-01     -2.18e-13\npolygon 2202 (hole)        3 -1.27666e-07     -1.91e-19\npolygon 2203 (hole)        4 -8.78676e-09     -1.31e-20\npolygon 2204 (hole)       18 -2.22540e-05     -3.32e-17\npolygon 2205 (hole)        4 -8.20702e-07     -1.23e-18\npolygon 2206 (hole)        3 -8.21758e-10     -1.23e-21\npolygon 2207 (hole)        4 -5.64735e-02     -8.43e-14\npolygon 2208 (hole)        8 -5.98509e-06     -8.94e-18\npolygon 2209 (hole)       23 -4.21367e-05     -6.29e-17\npolygon 2210 (hole)        4 -6.04233e-06     -9.02e-18\npolygon 2211 (hole)        3 -1.01598e-06     -1.52e-18\npolygon 2212 (hole)        3 -1.11161e-02     -1.66e-14\npolygon 2213 (hole)        4 -8.31680e-07     -1.24e-18\npolygon 2214 (hole)        5 -3.52144e-06     -5.26e-18\npolygon 2215 (hole)       11 -6.45407e-02     -9.64e-14\npolygon 2216 (hole)        8 -5.54170e-06     -8.27e-18\npolygon 2217 (hole)        4 -2.59927e-02     -3.88e-14\npolygon 2218 (hole)        8 -8.20152e-06     -1.22e-17\npolygon 2219 (hole)        4 -3.56192e-07     -5.32e-19\npolygon 2220 (hole)       28 -3.14027e-05     -4.69e-17\npolygon 2221 (hole)        6 -5.28056e-07     -7.88e-19\npolygon 2222 (hole)        3 -5.66072e-08     -8.45e-20\npolygon 2223 (hole)        5 -1.00901e-02     -1.51e-14\npolygon 2224 (hole)       30 -9.61047e-06     -1.44e-17\npolygon 2225 (hole)       12 -1.03526e-01     -1.55e-13\npolygon 2226 (hole)        4 -1.06402e-06     -1.59e-18\npolygon 2227 (hole)        9 -2.47071e-06     -3.69e-18\npolygon 2228 (hole)        8 -9.91238e-06     -1.48e-17\npolygon 2229 (hole)        3 -1.57906e-07     -2.36e-19\npolygon 2230 (hole)        6 -5.99495e-06     -8.95e-18\npolygon 2231 (hole)        4 -2.68076e-06     -4.00e-18\npolygon 2232 (hole)        4 -1.73764e-06     -2.59e-18\npolygon 2233 (hole)        6 -4.21775e-07     -6.30e-19\npolygon 2234 (hole)       20 -8.40914e-02     -1.26e-13\npolygon 2235 (hole)       10 -5.36188e-06     -8.01e-18\npolygon 2236 (hole)        6 -2.47728e-06     -3.70e-18\npolygon 2237 (hole)        5 -4.89811e-08     -7.31e-20\npolygon 2238 (hole)        4 -4.35520e-07     -6.50e-19\npolygon 2239 (hole)        3 -1.00561e-06     -1.50e-18\npolygon 2240 (hole)       18 -7.56039e-06     -1.13e-17\npolygon 2241 (hole)        6 -7.35348e-06     -1.10e-17\npolygon 2242 (hole)        5 -2.57731e-07     -3.85e-19\npolygon 2243 (hole)       29 -2.47987e-05     -3.70e-17\npolygon 2244 (hole)        6 -5.04624e-06     -7.53e-18\npolygon 2245 (hole)        6 -2.69437e-06     -4.02e-18\npolygon 2246 (hole)        8 -3.05527e-06     -4.56e-18\npolygon 2247 (hole)        6 -1.76078e-06     -2.63e-18\npolygon 2248 (hole)        9 -4.78506e-02     -7.14e-14\npolygon 2249 (hole)        3 -8.27525e-08     -1.24e-19\npolygon 2250 (hole)        3 -4.28106e-07     -6.39e-19\npolygon 2251 (hole)        6 -1.19058e-05     -1.78e-17\npolygon 2252 (hole)        3 -5.14628e-08     -7.68e-20\npolygon 2253 (hole)        4 -1.57810e-04     -2.36e-16\npolygon 2254 (hole)        6 -9.18635e-06     -1.37e-17\npolygon 2255 (hole)        4 -6.73218e-03     -1.01e-14\npolygon 2256 (hole)        9 -1.29124e-05     -1.93e-17\npolygon 2257 (hole)        5 -2.61896e-06     -3.91e-18\npolygon 2258 (hole)        4 -1.48299e-07     -2.21e-19\npolygon 2259              16  4.14093e+05      6.18e-07\npolygon 2260 (hole)        3 -9.48943e-07     -1.42e-18\npolygon 2261 (hole)        3 -7.85491e-07     -1.17e-18\npolygon 2262 (hole)        4 -6.18440e-07     -9.23e-19\npolygon 2263 (hole)        8 -5.54818e-06     -8.28e-18\npolygon 2264 (hole)       10 -1.17641e-05     -1.76e-17\npolygon 2265 (hole)        4 -5.95135e-07     -8.89e-19\npolygon 2266 (hole)        3 -7.78656e-08     -1.16e-19\npolygon 2267 (hole)        8 -5.87062e-06     -8.77e-18\npolygon 2268 (hole)        4 -1.33330e-06     -1.99e-18\npolygon 2269 (hole)        6 -1.02486e-06     -1.53e-18\npolygon 2270 (hole)       14 -2.91314e-05     -4.35e-17\npolygon 2271 (hole)       18 -1.96184e-05     -2.93e-17\npolygon 2272 (hole)        7 -1.78414e-06     -2.66e-18\npolygon 2273 (hole)       10 -5.01021e-06     -7.48e-18\npolygon 2274 (hole)        9 -1.89555e-06     -2.83e-18\npolygon 2275 (hole)        4 -1.02471e-06     -1.53e-18\npolygon 2276 (hole)        4 -5.32915e-07     -7.96e-19\npolygon 2277 (hole)        4 -7.83688e-07     -1.17e-18\npolygon 2278 (hole)        4 -3.12453e-06     -4.67e-18\npolygon 2279 (hole)        4 -5.36628e-03     -8.01e-15\npolygon 2280 (hole)        3 -8.82083e-04     -1.32e-15\npolygon 2281 (hole)        3 -1.42602e-02     -2.13e-14\npolygon 2282 (hole)        5 -3.17574e-06     -4.74e-18\npolygon 2283 (hole)        3 -1.39382e-13     -2.08e-25\npolygon 2284 (hole)        3 -2.12834e-10     -3.18e-22\npolygon 2285 (hole)        4 -4.37230e-03     -6.53e-15\npolygon 2286 (hole)        4 -1.36348e-02     -2.04e-14\npolygon 2287 (hole)        4 -3.84223e-02     -5.74e-14\npolygon 2288 (hole)        3 -2.20269e-10     -3.29e-22\npolygon 2289 (hole)        3 -6.14988e-12     -9.18e-24\npolygon 2290 (hole)        3 -7.55761e-03     -1.13e-14\npolygon 2291 (hole)       10 -1.02237e-05     -1.53e-17\npolygon 2292 (hole)        5 -4.50829e-07     -6.73e-19\npolygon 2293 (hole)        3 -3.20234e-07     -4.78e-19\npolygon 2294 (hole)       12 -1.71171e-05     -2.56e-17\npolygon 2295 (hole)        4 -8.03830e-03     -1.20e-14\npolygon 2296 (hole)        4 -3.71804e-09     -5.55e-21\npolygon 2297 (hole)       14 -2.61174e-05     -3.90e-17\npolygon 2298 (hole)        9 -2.53645e-02     -3.79e-14\npolygon 2299 (hole)        3 -3.35341e-08     -5.01e-20\npolygon 2300 (hole)        5 -5.31894e-02     -7.94e-14\npolygon 2301 (hole)        5 -6.16073e-08     -9.20e-20\npolygon 2302 (hole)        4 -1.15582e-02     -1.73e-14\npolygon 2303 (hole)        3 -2.16455e-03     -3.23e-15\npolygon 2304 (hole)        6 -4.67283e-02     -6.98e-14\npolygon 2305 (hole)        4 -3.80001e-07     -5.67e-19\npolygon 2306 (hole)        3 -4.78090e-08     -7.14e-20\npolygon 2307 (hole)        4 -4.34510e-07     -6.49e-19\npolygon 2308 (hole)        3 -1.85398e-07     -2.77e-19\npolygon 2309 (hole)        3 -2.87031e-03     -4.29e-15\npolygon 2310 (hole)        5 -2.49134e-08     -3.72e-20\npolygon 2311 (hole)        6 -7.95643e-07     -1.19e-18\npolygon 2312 (hole)        8 -5.42898e-06     -8.11e-18\npolygon 2313 (hole)        4 -5.42399e-02     -8.10e-14\npolygon 2314 (hole)        3 -4.75063e-03     -7.09e-15\npolygon 2315 (hole)        4 -3.44954e-02     -5.15e-14\npolygon 2316 (hole)       16 -8.32281e-06     -1.24e-17\npolygon 2317 (hole)        4 -4.63562e-07     -6.92e-19\npolygon 2318 (hole)        3 -5.74400e-03     -8.58e-15\npolygon 2319 (hole)        4 -4.76976e-09     -7.12e-21\npolygon 2320 (hole)        3 -2.47398e-13     -3.69e-25\npolygon 2321 (hole)        3 -1.45890e-03     -2.18e-15\npolygon 2322 (hole)       60 -1.21557e-04     -1.82e-16\npolygon 2323               3  0.00000e+00      0.00e+00\npolygon 2324 (hole)        4 -8.16295e-08     -1.22e-19\npolygon 2325 (hole)        6 -7.72840e-07     -1.15e-18\npolygon 2326 (hole)        4 -2.01252e-02     -3.01e-14\npolygon 2327 (hole)        4 -1.01152e-07     -1.51e-19\npolygon 2328 (hole)        6 -1.34176e-06     -2.00e-18\npolygon 2329 (hole)        6 -1.06947e-07     -1.60e-19\npolygon 2330 (hole)        3 -1.22081e-07     -1.82e-19\npolygon 2331 (hole)        4 -2.58759e-02     -3.86e-14\npolygon 2332 (hole)        7 -1.14651e-06     -1.71e-18\npolygon 2333 (hole)       10 -9.35195e-02     -1.40e-13\npolygon 2334 (hole)        3 -4.61430e-07     -6.89e-19\npolygon 2335 (hole)        4 -7.98706e-07     -1.19e-18\npolygon 2336 (hole)        3 -1.09293e-06     -1.63e-18\npolygon 2337 (hole)        6 -7.33464e-02     -1.10e-13\npolygon 2338 (hole)        3 -1.64006e-07     -2.45e-19\npolygon 2339 (hole)        3 -6.62731e-03     -9.90e-15\npolygon 2340 (hole)        6 -9.99205e-08     -1.49e-19\npolygon 2341 (hole)        4 -1.30906e-03     -1.95e-15\npolygon 2342 (hole)        7 -3.28624e-06     -4.91e-18\npolygon 2343               4  7.42222e-11      1.11e-22\npolygon 2344 (hole)        9 -6.94527e-06     -1.04e-17\npolygon 2345 (hole)        5 -9.92050e-03     -1.48e-14\npolygon 2346 (hole)        4 -9.97759e-07     -1.49e-18\npolygon 2347 (hole)        4 -9.31965e-03     -1.39e-14\npolygon 2348 (hole)        3 -2.29050e-07     -3.42e-19\npolygon 2349 (hole)        4 -7.16173e-06     -1.07e-17\npolygon 2350 (hole)        4 -2.73827e-02     -4.09e-14\npolygon 2351 (hole)        4 -1.09830e-07     -1.64e-19\npolygon 2352 (hole)        6 -2.07477e-06     -3.10e-18\npolygon 2353 (hole)        5 -3.08857e-07     -4.61e-19\npolygon 2354 (hole)        3 -1.55741e-06     -2.33e-18\npolygon 2355 (hole)       31 -4.35364e-05     -6.50e-17\npolygon 2356 (hole)        3 -1.15057e-02     -1.72e-14\npolygon 2357 (hole)        4 -3.27832e-08     -4.90e-20\npolygon 2358 (hole)        3 -1.88027e-08     -2.81e-20\npolygon 2359 (hole)        6 -1.83247e-06     -2.74e-18\npolygon 2360 (hole)        6 -8.77895e-02     -1.31e-13\npolygon 2361 (hole)        7 -2.49873e-06     -3.73e-18\npolygon 2362 (hole)        3 -7.17366e-07     -1.07e-18\npolygon 2363 (hole)       10 -9.54495e-06     -1.43e-17\npolygon 2364              26  3.03928e+06      4.54e-06\npolygon 2365 (hole)       12 -1.76530e-02     -2.64e-14\npolygon 2366 (hole)        6 -8.99151e-02     -1.34e-13\npolygon 2367 (hole)        6 -1.05801e-06     -1.58e-18\npolygon 2368 (hole)       21 -2.06889e-05     -3.09e-17\npolygon 2369 (hole)        4 -4.56220e-07     -6.81e-19\npolygon 2370 (hole)        5 -5.14858e-02     -7.69e-14\npolygon 2371 (hole)        4 -1.67308e-06     -2.50e-18\npolygon 2372 (hole)        3 -1.43546e-03     -2.14e-15\npolygon 2373 (hole)       22 -1.80547e-05     -2.70e-17\npolygon 2374 (hole)        4 -1.74107e-08     -2.60e-20\npolygon 2375 (hole)        3 -1.25515e-07     -1.87e-19\npolygon 2376 (hole)        6 -6.18043e-06     -9.23e-18\npolygon 2377 (hole)        4 -3.03801e-07     -4.54e-19\npolygon 2378 (hole)        6 -1.02159e-06     -1.53e-18\npolygon 2379 (hole)        8 -2.02876e-06     -3.03e-18\npolygon 2380 (hole)        8 -1.69866e-01     -2.54e-13\npolygon 2381 (hole)        4 -1.36177e-06     -2.03e-18\npolygon 2382 (hole)        8 -7.11268e-06     -1.06e-17\npolygon 2383 (hole)       14 -3.82760e-06     -5.72e-18\npolygon 2384 (hole)        4 -2.35677e-06     -3.52e-18\npolygon 2385 (hole)        3 -1.51419e-07     -2.26e-19\npolygon 2386 (hole)       16 -3.46141e-05     -5.17e-17\npolygon 2387 (hole)        9 -1.03675e-01     -1.55e-13\npolygon 2388 (hole)        6 -2.18370e-06     -3.26e-18\npolygon 2389 (hole)       11 -4.86649e-06     -7.27e-18\npolygon 2390 (hole)        5 -8.20744e-02     -1.23e-13\npolygon 2391 (hole)        4 -3.79155e-07     -5.66e-19\npolygon 2392 (hole)       28 -7.78123e-01     -1.16e-12\npolygon 2393 (hole)        3 -2.68393e-07     -4.01e-19\npolygon 2394 (hole)        4 -1.42174e-09     -2.12e-21\npolygon 2395 (hole)        3 -3.99165e-08     -5.96e-20\npolygon 2396 (hole)        4 -1.91195e-13     -2.85e-25\npolygon 2397 (hole)        4 -9.42612e-08     -1.41e-19\npolygon 2398 (hole)        7 -6.89272e-06     -1.03e-17\npolygon 2399 (hole)        3 -6.93058e-12     -1.03e-23\npolygon 2400 (hole)        4 -1.74499e-07     -2.61e-19\npolygon 2401 (hole)        3 -2.12142e-08     -3.17e-20\npolygon 2402 (hole)       42 -8.67486e-05     -1.30e-16\npolygon 2403 (hole)        4 -2.21895e-08     -3.31e-20\npolygon 2404 (hole)        3 -1.56351e-07     -2.33e-19\npolygon 2405 (hole)        4 -3.84292e-02     -5.74e-14\npolygon 2406 (hole)        3 -3.18587e-09     -4.76e-21\npolygon 2407 (hole)        3 -1.01893e-06     -1.52e-18\npolygon 2408 (hole)        3 -6.39753e-03     -9.55e-15\npolygon 2409 (hole)        4 -5.95131e-02     -8.89e-14\npolygon 2410 (hole)        4 -1.29410e-07     -1.93e-19\npolygon 2411 (hole)        4 -2.73737e-07     -4.09e-19\npolygon 2412 (hole)        3 -1.48909e-02     -2.22e-14\npolygon 2413 (hole)        4 -7.02051e-02     -1.05e-13\npolygon 2414 (hole)        4 -3.46193e-08     -5.17e-20\npolygon 2415 (hole)        9 -2.86407e-01     -4.28e-13\npolygon 2416 (hole)        5 -1.16314e-06     -1.74e-18\npolygon 2417 (hole)        6 -4.00973e-06     -5.99e-18\npolygon 2418 (hole)       16 -4.43785e-05     -6.63e-17\npolygon 2419 (hole)        8 -4.44582e-06     -6.64e-18\npolygon 2420 (hole)        4 -2.34017e-07     -3.49e-19\npolygon 2421 (hole)        3 -1.59007e-06     -2.37e-18\npolygon 2422 (hole)        3 -2.03249e-07     -3.03e-19\npolygon 2423 (hole)        5 -6.67829e-06     -9.97e-18\npolygon 2424 (hole)        4 -1.27598e-07     -1.91e-19\npolygon 2425 (hole)        5 -2.99429e-07     -4.47e-19\npolygon 2426 (hole)       10 -1.99499e-05     -2.98e-17\npolygon 2427              14  1.53563e+05      2.29e-07\npolygon 2428 (hole)        4 -1.28677e-07     -1.92e-19\npolygon 2429 (hole)        3 -1.09066e-06     -1.63e-18\npolygon 2430 (hole)        4 -4.35427e-07     -6.50e-19\npolygon 2431 (hole)        5 -4.01475e-07     -5.99e-19\npolygon 2432 (hole)       10 -3.23006e-06     -4.82e-18\npolygon 2433 (hole)        6 -2.28366e-07     -3.41e-19\npolygon 2434 (hole)        4 -4.86543e-07     -7.26e-19\npolygon 2435 (hole)        4 -8.79983e-09     -1.31e-20\npolygon 2436 (hole)        6 -6.03221e-06     -9.01e-18\npolygon 2437 (hole)        6 -7.17094e-06     -1.07e-17\npolygon 2438 (hole)        4 -4.89122e-08     -7.30e-20\npolygon 2439 (hole)        8 -6.88778e-07     -1.03e-18\npolygon 2440 (hole)        3 -7.91360e-10     -1.18e-21\npolygon 2441 (hole)        5 -1.95097e-07     -2.91e-19\npolygon 2442 (hole)        4 -1.94886e-07     -2.91e-19\npolygon 2443 (hole)        4 -5.21246e-07     -7.78e-19\npolygon 2444 (hole)       19 -4.74938e-05     -7.09e-17\npolygon 2445 (hole)        3 -5.79729e-07     -8.66e-19\npolygon 2446 (hole)        6 -6.34161e-06     -9.47e-18\npolygon 2447 (hole)        5 -3.32720e-02     -4.97e-14\npolygon 2448 (hole)        4 -1.48720e-08     -2.22e-20\npolygon 2449 (hole)        6 -1.14569e-06     -1.71e-18\npolygon 2450 (hole)       15 -1.98328e-01     -2.96e-13\npolygon 2451 (hole)        3 -4.92079e-08     -7.35e-20\npolygon 2452 (hole)        5 -1.31468e-06     -1.96e-18\npolygon 2453 (hole)        5 -4.16895e-08     -6.22e-20\npolygon 2454 (hole)        6 -5.60994e-08     -8.38e-20\npolygon 2455 (hole)        4 -4.28929e-07     -6.40e-19\npolygon 2456 (hole)        4 -4.04858e-07     -6.05e-19\npolygon 2457 (hole)        3 -3.83836e-11     -5.73e-23\npolygon 2458 (hole)        8 -1.28289e-06     -1.92e-18\npolygon 2459 (hole)        4 -2.03496e-08     -3.04e-20\npolygon 2460 (hole)        4 -1.31286e-07     -1.96e-19\npolygon 2461 (hole)       23 -6.12091e-05     -9.14e-17\npolygon 2462 (hole)        4 -2.19484e-09     -3.28e-21\npolygon 2463 (hole)        4 -9.79970e-10     -1.46e-21\npolygon 2464 (hole)        3 -9.11371e-08     -1.36e-19\npolygon 2465 (hole)        3 -1.32947e-07     -1.99e-19\npolygon 2466 (hole)        6 -5.97562e-07     -8.92e-19\npolygon 2467 (hole)        3 -4.30863e-08     -6.43e-20\npolygon 2468 (hole)        4 -9.80746e-08     -1.46e-19\npolygon 2469 (hole)        5 -5.53950e-08     -8.27e-20\npolygon 2470 (hole)        7 -1.59619e-06     -2.38e-18\npolygon 2471 (hole)        4 -3.34799e-07     -5.00e-19\npolygon 2472 (hole)        3 -2.27202e-11     -3.39e-23\npolygon 2473 (hole)        6 -1.63296e-06     -2.44e-18\npolygon 2474 (hole)        6 -1.18203e-06     -1.76e-18\npolygon 2475 (hole)        7 -5.25325e-06     -7.84e-18\npolygon 2476 (hole)        3 -5.38218e-08     -8.04e-20\npolygon 2477 (hole)        4 -5.38038e-07     -8.03e-19\npolygon 2478 (hole)        6 -5.49779e-07     -8.21e-19\npolygon 2479 (hole)        3 -2.10037e-11     -3.14e-23\npolygon 2480 (hole)        4 -4.37273e-08     -6.53e-20\npolygon 2481 (hole)        6 -2.27632e-02     -3.40e-14\npolygon 2482 (hole)        4 -1.60641e-06     -2.40e-18\npolygon 2483 (hole)        3 -1.19044e-02     -1.78e-14\npolygon 2484 (hole)       10 -2.69221e-06     -4.02e-18\npolygon 2485 (hole)        6 -1.15784e-06     -1.73e-18\npolygon 2486 (hole)        6 -5.27572e-07     -7.88e-19\npolygon 2487 (hole)        7 -3.84976e-06     -5.75e-18\npolygon 2488 (hole)        6 -2.63715e-06     -3.94e-18\npolygon 2489 (hole)        8 -1.06138e-05     -1.58e-17\npolygon 2490 (hole)        3 -6.96187e-12     -1.04e-23\npolygon 2491 (hole)        3 -1.58801e-07     -2.37e-19\npolygon 2492 (hole)        4 -8.49704e-08     -1.27e-19\npolygon 2493 (hole)        4 -3.42483e-07     -5.11e-19\npolygon 2494 (hole)        3 -4.58008e-07     -6.84e-19\npolygon 2495 (hole)        9 -4.53619e-06     -6.77e-18\npolygon 2496 (hole)        6 -2.12504e-07     -3.17e-19\npolygon 2497 (hole)        4 -2.98938e-07     -4.46e-19\npolygon 2498 (hole)        5 -1.21578e-06     -1.82e-18\npolygon 2499 (hole)        4 -1.92580e-06     -2.88e-18\npolygon 2500 (hole)        4 -2.10998e-07     -3.15e-19\npolygon 2501 (hole)        6 -4.29808e-07     -6.42e-19\npolygon 2502 (hole)        7 -6.54698e-06     -9.78e-18\npolygon 2503 (hole)        5 -2.80654e-07     -4.19e-19\npolygon 2504 (hole)        7 -1.81404e-05     -2.71e-17\npolygon 2505 (hole)       11 -3.73921e-06     -5.58e-18\npolygon 2506 (hole)        9 -1.47173e-06     -2.20e-18\npolygon 2507 (hole)        9 -4.26694e-06     -6.37e-18\npolygon 2508 (hole)       13 -1.40633e-02     -2.10e-14\npolygon 2509 (hole)        4 -9.21069e-07     -1.38e-18\npolygon 2510 (hole)       11 -2.27006e-06     -3.39e-18\npolygon 2511 (hole)        4 -4.48256e-07     -6.69e-19\npolygon 2512 (hole)        3 -9.56982e-09     -1.43e-20\npolygon 2513 (hole)        4 -4.46900e-07     -6.67e-19\npolygon 2514 (hole)        6 -2.76240e-02     -4.12e-14\npolygon 2515 (hole)        3 -3.74159e-02     -5.59e-14\npolygon 2516 (hole)        3 -2.72933e-02     -4.08e-14\npolygon 2517 (hole)        3 -1.16808e-02     -1.74e-14\npolygon 2518 (hole)       10 -4.10712e-03     -6.13e-15\npolygon 2519 (hole)       10 -9.86353e-06     -1.47e-17\npolygon 2520 (hole)       10 -1.67989e-06     -2.51e-18\npolygon 2521 (hole)        4 -9.91732e-02     -1.48e-13\npolygon 2522 (hole)       29 -5.84355e-05     -8.73e-17\npolygon 2523 (hole)        4 -5.97857e-06     -8.93e-18\npolygon 2524 (hole)        3 -2.56908e-08     -3.84e-20\npolygon 2525 (hole)       13 -5.16283e-06     -7.71e-18\npolygon 2526 (hole)        3 -3.48567e-08     -5.20e-20\npolygon 2527 (hole)        3 -1.56057e-07     -2.33e-19\npolygon 2528 (hole)        5 -3.13410e-07     -4.68e-19\npolygon 2529 (hole)        4 -9.18613e-07     -1.37e-18\npolygon 2530 (hole)        3 -2.15505e-06     -3.22e-18\npolygon 2531 (hole)        3 -1.81043e-08     -2.70e-20\npolygon 2532 (hole)        4 -7.89918e-02     -1.18e-13\npolygon 2533 (hole)        9 -2.70918e-05     -4.05e-17\npolygon 2534 (hole)        3 -1.07902e-03     -1.61e-15\npolygon 2535 (hole)        3 -8.74114e-04     -1.31e-15\npolygon 2536 (hole)        3 -3.75811e-08     -5.61e-20\npolygon 2537 (hole)        5 -1.38118e-06     -2.06e-18\npolygon 2538 (hole)       10 -2.09344e-05     -3.13e-17\npolygon 2539 (hole)        4 -1.15257e-06     -1.72e-18\npolygon 2540 (hole)        3 -7.12225e-08     -1.06e-19\npolygon 2541 (hole)        3 -2.96726e-07     -4.43e-19\npolygon 2542 (hole)       10 -5.59448e-02     -8.35e-14\npolygon 2543 (hole)        4 -1.59959e-08     -2.39e-20\npolygon 2544 (hole)        8 -5.58056e-06     -8.33e-18\npolygon 2545 (hole)        6 -6.80814e-07     -1.02e-18\npolygon 2546 (hole)       20 -3.06842e-05     -4.58e-17\npolygon 2547 (hole)        7 -2.13964e-05     -3.19e-17\npolygon 2548 (hole)       11 -1.11827e-05     -1.67e-17\npolygon 2549 (hole)        4 -2.13156e-05     -3.18e-17\npolygon 2550 (hole)        3 -1.84183e-08     -2.75e-20\npolygon 2551 (hole)        5 -4.32139e-07     -6.45e-19\npolygon 2552 (hole)       10 -1.05174e-05     -1.57e-17\npolygon 2553 (hole)        4 -3.15454e-06     -4.71e-18\npolygon 2554 (hole)        4 -4.61106e-08     -6.89e-20\npolygon 2555 (hole)        7 -2.12793e-06     -3.18e-18\npolygon 2556 (hole)        4 -2.12390e-07     -3.17e-19\npolygon 2557 (hole)        5 -7.52951e-06     -1.12e-17\npolygon 2558 (hole)        8 -1.76365e-06     -2.63e-18\npolygon 2559 (hole)        3 -1.70045e-11     -2.54e-23\npolygon 2560 (hole)        5 -1.95134e-07     -2.91e-19\npolygon 2561 (hole)       13 -1.43289e-05     -2.14e-17\npolygon 2562 (hole)        4 -1.65674e-06     -2.47e-18\npolygon 2563 (hole)        8 -9.79398e-07     -1.46e-18\npolygon 2564 (hole)        4 -1.74825e-06     -2.61e-18\npolygon 2565 (hole)        4 -1.94604e-06     -2.91e-18\npolygon 2566 (hole)        8 -7.65404e-06     -1.14e-17\npolygon 2567 (hole)        3 -4.32641e-07     -6.46e-19\npolygon 2568              19  5.08538e+05      7.59e-07\npolygon 2569 (hole)        6 -3.61785e-06     -5.40e-18\npolygon 2570 (hole)        7 -5.16775e-06     -7.72e-18\npolygon 2571 (hole)        6 -1.56320e-06     -2.33e-18\npolygon 2572 (hole)        6 -7.78003e-06     -1.16e-17\npolygon 2573 (hole)        3 -5.53252e-07     -8.26e-19\npolygon 2574 (hole)        8 -5.08598e-06     -7.59e-18\npolygon 2575 (hole)        5 -4.83185e-06     -7.21e-18\npolygon 2576 (hole)        6 -1.45583e-02     -2.17e-14\npolygon 2577              16  1.80565e+05      2.70e-07\npolygon 2578 (hole)        3 -1.58832e-08     -2.37e-20\npolygon 2579 (hole)        3 -1.07630e-06     -1.61e-18\npolygon 2580              26  9.75091e+05      1.46e-06\npolygon 2581 (hole)        4 -1.31328e-06     -1.96e-18\npolygon 2582 (hole)        4 -1.90718e-03     -2.85e-15\npolygon 2583 (hole)        7 -7.17369e-06     -1.07e-17\npolygon 2584 (hole)        7 -1.90588e-06     -2.85e-18\npolygon 2585 (hole)        5 -1.62634e-06     -2.43e-18\npolygon 2586 (hole)        7 -5.75219e-06     -8.59e-18\npolygon 2587 (hole)        6 -3.47421e-06     -5.19e-18\npolygon 2588 (hole)        4 -7.35304e-08     -1.10e-19\npolygon 2589 (hole)       13 -1.23833e-05     -1.85e-17\npolygon 2590 (hole)        6 -1.06451e-05     -1.59e-17\npolygon 2591 (hole)        3 -3.61751e-10     -5.40e-22\npolygon 2592 (hole)        8 -1.20501e-06     -1.80e-18\npolygon 2593 (hole)       12 -3.54873e-06     -5.30e-18\npolygon 2594 (hole)        5 -9.07099e-07     -1.35e-18\npolygon 2595 (hole)        4 -1.07687e-07     -1.61e-19\npolygon 2596 (hole)        6 -9.12655e-06     -1.36e-17\npolygon 2597               3  1.47054e-11      2.20e-23\npolygon 2598 (hole)       16 -2.32365e-06     -3.47e-18\npolygon 2599 (hole)        3 -7.26239e-03     -1.08e-14\npolygon 2600 (hole)        7 -9.81301e-06     -1.47e-17\npolygon 2601 (hole)        3 -6.77695e-10     -1.01e-21\npolygon 2602 (hole)        4 -5.87183e-07     -8.77e-19\npolygon 2603 (hole)        3 -2.80799e-02     -4.19e-14\npolygon 2604 (hole)        7 -5.31797e-03     -7.94e-15\npolygon 2605 (hole)        5 -4.47715e-09     -6.69e-21\npolygon 2606 (hole)        8 -9.25352e-06     -1.38e-17\npolygon 2607 (hole)        4 -3.60431e-07     -5.38e-19\npolygon 2608 (hole)       11 -1.50187e-05     -2.24e-17\npolygon 2609 (hole)        7 -1.63258e-06     -2.44e-18\npolygon 2610 (hole)        8 -9.48669e-06     -1.42e-17\npolygon 2611 (hole)       11 -9.73981e-06     -1.45e-17\npolygon 2612 (hole)        4 -1.02049e-07     -1.52e-19\npolygon 2613 (hole)        5 -5.68710e-07     -8.49e-19\npolygon 2614 (hole)        4 -8.92337e-06     -1.33e-17\npolygon 2615 (hole)        3 -8.15809e-11     -1.22e-22\npolygon 2616 (hole)        6 -5.28842e-06     -7.90e-18\npolygon 2617 (hole)        5 -7.76167e-07     -1.16e-18\npolygon 2618 (hole)        7 -8.38899e-06     -1.25e-17\npolygon 2619 (hole)        4 -1.21498e-07     -1.81e-19\npolygon 2620 (hole)       33 -6.46533e-05     -9.65e-17\npolygon 2621 (hole)        4 -1.65043e-11     -2.46e-23\npolygon 2622 (hole)        3 -6.43313e-07     -9.61e-19\npolygon 2623 (hole)        3 -1.45532e-02     -2.17e-14\npolygon 2624 (hole)        6 -2.85727e-06     -4.27e-18\npolygon 2625 (hole)        4 -2.82801e-07     -4.22e-19\npolygon 2626 (hole)        8 -7.81354e-07     -1.17e-18\npolygon 2627 (hole)       13 -7.98578e-06     -1.19e-17\npolygon 2628 (hole)        4 -6.13839e-08     -9.17e-20\npolygon 2629 (hole)        5 -8.64019e-08     -1.29e-19\npolygon 2630 (hole)        3 -8.07318e-08     -1.21e-19\npolygon 2631 (hole)        4 -6.75369e-07     -1.01e-18\npolygon 2632 (hole)        3 -2.28792e-02     -3.42e-14\npolygon 2633 (hole)       24 -4.44393e-05     -6.64e-17\npolygon 2634 (hole)        3 -8.83453e-10     -1.32e-21\npolygon 2635 (hole)        4 -1.67958e-06     -2.51e-18\npolygon 2636 (hole)        4 -8.89442e-07     -1.33e-18\npolygon 2637 (hole)        4 -9.00791e-07     -1.35e-18\npolygon 2638 (hole)        3 -1.34341e-11     -2.01e-23\npolygon 2639 (hole)        4 -1.59141e-06     -2.38e-18\npolygon 2640 (hole)       21 -3.60033e-05     -5.38e-17\npolygon 2641 (hole)        4 -8.98025e-08     -1.34e-19\npolygon 2642 (hole)        4 -5.60583e-07     -8.37e-19\npolygon 2643 (hole)        4 -2.85938e-06     -4.27e-18\npolygon 2644 (hole)        5 -1.72617e-02     -2.58e-14\npolygon 2645 (hole)        3 -4.96797e-03     -7.42e-15\npolygon 2646 (hole)        6 -1.85788e-02     -2.77e-14\npolygon 2647 (hole)        4 -8.61206e-03     -1.29e-14\npolygon 2648 (hole)        7 -2.02548e-06     -3.02e-18\npolygon 2649 (hole)        3 -1.66630e-03     -2.49e-15\npolygon 2650 (hole)        3 -3.56709e-03     -5.33e-15\npolygon 2651 (hole)       10 -1.31120e-02     -1.96e-14\npolygon 2652 (hole)        3 -1.35148e-06     -2.02e-18\npolygon 2653 (hole)        6 -4.33085e-07     -6.47e-19\npolygon 2654 (hole)        4 -9.56624e-08     -1.43e-19\npolygon 2655 (hole)        8 -1.33452e-05     -1.99e-17\npolygon 2656 (hole)        3 -1.06301e-09     -1.59e-21\npolygon 2657 (hole)       10 -1.02237e-05     -1.53e-17\npolygon 2658 (hole)        4 -1.74458e-06     -2.60e-18\npolygon 2659 (hole)        3 -3.77828e-08     -5.64e-20\npolygon 2660 (hole)        3 -3.11105e-07     -4.65e-19\npolygon 2661 (hole)        7 -1.30518e-06     -1.95e-18\npolygon 2662 (hole)        6 -4.60116e-06     -6.87e-18\npolygon 2663 (hole)        4 -2.10022e-07     -3.14e-19\npolygon 2664 (hole)        4 -3.20566e-08     -4.79e-20\npolygon 2665 (hole)        4 -3.45893e-08     -5.16e-20\npolygon 2666 (hole)        7 -1.53471e-06     -2.29e-18\npolygon 2667 (hole)       25 -3.64681e-06     -5.45e-18\npolygon 2668 (hole)        8 -3.92770e-07     -5.86e-19\npolygon 2669 (hole)        4 -1.91016e-07     -2.85e-19\npolygon 2670 (hole)        4 -3.07804e-07     -4.60e-19\npolygon 2671 (hole)        8 -4.33354e-07     -6.47e-19\npolygon 2672 (hole)        5 -5.74716e-07     -8.58e-19\npolygon 2673 (hole)        3 -1.03719e-07     -1.55e-19\npolygon 2674 (hole)        3 -7.72839e-09     -1.15e-20\npolygon 2675 (hole)        4 -7.71708e-07     -1.15e-18\npolygon 2676 (hole)        4 -6.96229e-08     -1.04e-19\npolygon 2677 (hole)       10 -2.69957e-06     -4.03e-18\npolygon 2678 (hole)       21 -4.53206e-06     -6.77e-18\npolygon 2679 (hole)        4 -3.63692e-07     -5.43e-19\npolygon 2680 (hole)        8 -4.27852e-06     -6.39e-18\npolygon 2681 (hole)        3 -1.42404e-09     -2.13e-21\npolygon 2682 (hole)       12 -1.28708e-06     -1.92e-18\npolygon 2683 (hole)        4 -6.19988e-07     -9.26e-19\npolygon 2684 (hole)        8 -1.56870e-05     -2.34e-17\npolygon 2685 (hole)        5 -1.12265e-05     -1.68e-17\npolygon 2686 (hole)        5 -4.74519e-07     -7.09e-19\npolygon 2687 (hole)        3 -8.38530e-08     -1.25e-19\npolygon 2688 (hole)        4 -8.10514e-07     -1.21e-18\npolygon 2689 (hole)        6 -1.56555e-06     -2.34e-18\npolygon 2690 (hole)        4 -5.70802e-07     -8.52e-19\npolygon 2691 (hole)        8 -2.18995e-06     -3.27e-18\npolygon 2692 (hole)        5 -4.48081e-08     -6.69e-20\npolygon 2693 (hole)        4 -4.66125e-07     -6.96e-19\npolygon 2694 (hole)        3 -3.58820e-09     -5.36e-21\npolygon 2695 (hole)        7 -4.51404e-06     -6.74e-18\npolygon 2696 (hole)        5 -2.08256e-07     -3.11e-19\npolygon 2697 (hole)        4 -1.69919e-10     -2.54e-22\npolygon 2698 (hole)        4 -8.94228e-09     -1.34e-20\npolygon 2699 (hole)        4 -1.40653e-07     -2.10e-19\npolygon 2700 (hole)        8 -1.28003e-06     -1.91e-18\npolygon 2701 (hole)        3 -4.50808e-11     -6.73e-23\npolygon 2702 (hole)        8 -1.27602e-05     -1.91e-17\npolygon 2703 (hole)        8 -2.77035e-06     -4.14e-18\npolygon 2704 (hole)        3 -1.35749e-06     -2.03e-18\npolygon 2705 (hole)        5 -7.47957e-06     -1.12e-17\npolygon 2706 (hole)       11 -3.65081e-06     -5.45e-18\npolygon 2707 (hole)       10 -3.21208e-06     -4.80e-18\npolygon 2708 (hole)        7 -4.83493e-07     -7.22e-19\npolygon 2709 (hole)       10 -2.60273e-06     -3.89e-18\npolygon 2710 (hole)        3 -1.74435e-07     -2.60e-19\npolygon 2711 (hole)        7 -3.54602e-06     -5.29e-18\npolygon 2712 (hole)        3 -1.43658e-08     -2.15e-20\npolygon 2713 (hole)        7 -5.61451e-06     -8.38e-18\npolygon 2714 (hole)       14 -2.82609e-06     -4.22e-18\npolygon 2715 (hole)       10 -1.66881e-05     -2.49e-17\npolygon 2716 (hole)        4 -2.40869e-07     -3.60e-19\npolygon 2717 (hole)       19 -6.13564e-06     -9.16e-18\npolygon 2718 (hole)        6 -7.26266e-06     -1.08e-17\npolygon 2719 (hole)       32 -8.46988e-05     -1.26e-16\npolygon 2720 (hole)        5 -5.82655e-07     -8.70e-19\npolygon 2721 (hole)        8 -2.68128e-06     -4.00e-18\npolygon 2722 (hole)       15 -6.55635e-06     -9.79e-18\npolygon 2723 (hole)       12 -5.77137e-06     -8.62e-18\npolygon 2724 (hole)        4 -7.33285e-07     -1.09e-18\npolygon 2725 (hole)        3 -2.39229e-08     -3.57e-20\npolygon 2726 (hole)       16 -9.46751e-06     -1.41e-17\npolygon 2727 (hole)       14 -8.44455e-06     -1.26e-17\npolygon 2728 (hole)        4 -1.05937e-06     -1.58e-18\npolygon 2729 (hole)        8 -3.29755e-07     -4.92e-19\npolygon 2730 (hole)        4 -3.66402e-06     -5.47e-18\npolygon 2731 (hole)        4 -1.07888e-06     -1.61e-18\npolygon 2732 (hole)        7 -1.49763e-06     -2.24e-18\npolygon 2733 (hole)        3 -1.28527e-07     -1.92e-19\npolygon 2734 (hole)       12 -7.08585e-07     -1.06e-18\npolygon 2735 (hole)        8 -2.39026e-06     -3.57e-18\npolygon 2736 (hole)        7 -6.28998e-07     -9.39e-19\npolygon 2737 (hole)        4 -1.48952e-06     -2.22e-18\npolygon 2738 (hole)       16 -4.15919e-06     -6.21e-18\npolygon 2739 (hole)       34 -1.71338e-05     -2.56e-17\npolygon 2740 (hole)        4 -1.63533e-06     -2.44e-18\npolygon 2741 (hole)        4 -2.17974e-07     -3.25e-19\npolygon 2742 (hole)        8 -5.79581e-06     -8.65e-18\npolygon 2743 (hole)        3 -6.63547e-08     -9.91e-20\npolygon 2744 (hole)        8 -6.30877e-07     -9.42e-19\npolygon 2745 (hole)        4 -1.22777e-06     -1.83e-18\npolygon 2746 (hole)        3 -3.71645e-09     -5.55e-21\npolygon 2747 (hole)        6 -1.48809e-06     -2.22e-18\npolygon 2748 (hole)        8 -1.39025e-06     -2.08e-18\npolygon 2749 (hole)        6 -1.74681e-06     -2.61e-18\npolygon 2750 (hole)       11 -5.05686e-06     -7.55e-18\npolygon 2751 (hole)       15 -9.75367e-06     -1.46e-17\npolygon 2752 (hole)        6 -9.49033e-07     -1.42e-18\npolygon 2753 (hole)        4 -4.34250e-07     -6.48e-19\npolygon 2754 (hole)       14 -1.06614e-06     -1.59e-18\npolygon 2755               3  0.00000e+00      0.00e+00\npolygon 2756 (hole)        6 -4.55277e-07     -6.80e-19\npolygon 2757 (hole)        4 -5.59661e-07     -8.36e-19\npolygon 2758 (hole)        6 -1.16690e-07     -1.74e-19\npolygon 2759 (hole)        8 -5.06501e-07     -7.56e-19\npolygon 2760 (hole)        6 -1.50149e-06     -2.24e-18\npolygon 2761 (hole)        9 -2.30168e-06     -3.44e-18\npolygon 2762 (hole)        4 -6.45567e-07     -9.64e-19\npolygon 2763 (hole)       11 -1.84860e-06     -2.76e-18\npolygon 2764 (hole)        4 -4.65480e-07     -6.95e-19\npolygon 2765 (hole)        3 -4.98575e-09     -7.44e-21\npolygon 2766 (hole)       30 -1.29726e-05     -1.94e-17\npolygon 2767 (hole)        3 -1.27049e-07     -1.90e-19\npolygon 2768 (hole)       10 -5.10962e-06     -7.63e-18\npolygon 2769 (hole)        3 -3.22220e-09     -4.81e-21\npolygon 2770 (hole)        3 -2.49870e-08     -3.73e-20\npolygon 2771 (hole)       10 -2.29265e-06     -3.42e-18\npolygon 2772 (hole)        4 -2.68307e-07     -4.01e-19\npolygon 2773 (hole)        5 -4.90757e-07     -7.33e-19\npolygon 2774 (hole)       50 -2.64916e-05     -3.96e-17\npolygon 2775 (hole)        4 -8.77056e-07     -1.31e-18\npolygon 2776 (hole)       10 -6.86850e-07     -1.03e-18\npolygon 2777 (hole)        6 -2.66668e-06     -3.98e-18\npolygon 2778 (hole)       14 -1.47976e-06     -2.21e-18\npolygon 2779 (hole)        6 -2.24397e-06     -3.35e-18\npolygon 2780 (hole)        4 -2.50989e-06     -3.75e-18\npolygon 2781 (hole)        4 -1.10271e-07     -1.65e-19\npolygon 2782 (hole)        5 -1.71933e-06     -2.57e-18\npolygon 2783 (hole)        4 -2.01831e-06     -3.01e-18\npolygon 2784 (hole)        5 -1.73111e-07     -2.58e-19\npolygon 2785 (hole)       10 -1.93711e-06     -2.89e-18\npolygon 2786 (hole)        4 -5.17126e-08     -7.72e-20\npolygon 2787 (hole)        4 -1.73096e-06     -2.58e-18\npolygon 2788 (hole)       10 -3.87688e-06     -5.79e-18\npolygon 2789 (hole)        6 -2.21490e-06     -3.31e-18\npolygon 2790 (hole)        6 -8.97703e-07     -1.34e-18\npolygon 2791 (hole)        6 -1.63609e-06     -2.44e-18\npolygon 2792 (hole)        6 -2.09339e-06     -3.13e-18\npolygon 2793 (hole)       25 -1.88970e-05     -2.82e-17\npolygon 2794 (hole)       12 -4.48821e-06     -6.70e-18\npolygon 2795 (hole)        6 -9.80352e-07     -1.46e-18\npolygon 2796 (hole)        4 -7.39046e-08     -1.10e-19\npolygon 2797 (hole)        4 -1.38245e-08     -2.06e-20\npolygon 2798 (hole)       12 -2.22048e-06     -3.32e-18\npolygon 2799 (hole)        4 -3.51142e-07     -5.24e-19\npolygon 2800 (hole)       17 -4.99387e-06     -7.46e-18\npolygon 2801 (hole)        4 -1.38206e-07     -2.06e-19\npolygon 2802 (hole)       10 -4.06130e-07     -6.06e-19\npolygon 2803 (hole)        4 -2.40911e-07     -3.60e-19\npolygon 2804 (hole)       51 -1.00490e-05     -1.50e-17\npolygon 2805 (hole)        3 -1.77845e-07     -2.66e-19\npolygon 2806 (hole)       14 -6.81459e-06     -1.02e-17\npolygon 2807 (hole)       12 -4.68440e-06     -6.99e-18\npolygon 2808 (hole)        5 -5.12776e-07     -7.66e-19\npolygon 2809 (hole)        7 -6.33486e-07     -9.46e-19\npolygon 2810 (hole)        5 -4.23206e-07     -6.32e-19\npolygon 2811 (hole)        4 -1.68997e-07     -2.52e-19\npolygon 2812 (hole)       10 -5.22706e-06     -7.80e-18\npolygon 2813 (hole)        4 -6.33443e-07     -9.46e-19\npolygon 2814 (hole)        4 -1.62263e-07     -2.42e-19\npolygon 2815 (hole)       12 -4.19155e-06     -6.26e-18\npolygon 2816              19  2.15295e+05      3.21e-07\npolygon 2817 (hole)        7 -5.39354e-07     -8.05e-19\npolygon 2818 (hole)        4 -5.34541e-08     -7.98e-20\npolygon 2819 (hole)       29 -1.00200e-05     -1.50e-17\npolygon 2820 (hole)        6 -3.86679e-07     -5.77e-19\npolygon 2821 (hole)       10 -1.64656e-06     -2.46e-18\npolygon 2822 (hole)        6 -2.08436e-07     -3.11e-19\npolygon 2823 (hole)       13 -1.44312e-06     -2.15e-18\npolygon 2824 (hole)        6 -6.48605e-07     -9.68e-19\npolygon 2825 (hole)        6 -6.30489e-07     -9.41e-19\npolygon 2826 (hole)        3 -4.41471e-08     -6.59e-20\npolygon 2827 (hole)       20 -3.01848e-06     -4.51e-18\npolygon 2828 (hole)       10 -7.06261e-07     -1.05e-18\npolygon 2829 (hole)        5 -1.07332e-07     -1.60e-19\npolygon 2830 (hole)       12 -2.51235e-06     -3.75e-18\npolygon 2831 (hole)        3 -1.09230e-07     -1.63e-19\npolygon 2832 (hole)        4 -1.16148e-07     -1.73e-19\npolygon 2833 (hole)        8 -1.46898e-06     -2.19e-18\npolygon 2834 (hole)       31 -4.78968e-06     -7.15e-18\npolygon 2835 (hole)        9 -3.44274e-06     -5.14e-18\npolygon 2836 (hole)       13 -2.04389e-05     -3.05e-17\npolygon 2837 (hole)       14 -2.02081e-05     -3.02e-17\npolygon 2838 (hole)        4 -7.21752e-07     -1.08e-18\npolygon 2839 (hole)        5 -1.92895e-06     -2.88e-18\npolygon 2840 (hole)       11 -8.82465e-06     -1.32e-17\npolygon 2841 (hole)        7 -1.63492e-06     -2.44e-18\npolygon 2842 (hole)        8 -6.55256e-07     -9.78e-19\npolygon 2843 (hole)        5 -4.61426e-07     -6.89e-19\npolygon 2844 (hole)        3 -4.86698e-08     -7.27e-20\npolygon 2845 (hole)        5 -4.32951e-08     -6.46e-20\npolygon 2846 (hole)       13 -1.78357e-06     -2.66e-18\npolygon 2847 (hole)        5 -1.01484e-06     -1.52e-18\npolygon 2848 (hole)        9 -5.04962e-07     -7.54e-19\npolygon 2849 (hole)       14 -1.44657e-06     -2.16e-18\npolygon 2850 (hole)        4 -4.25409e-07     -6.35e-19\npolygon 2851 (hole)        4 -1.51406e-06     -2.26e-18\npolygon 2852 (hole)        7 -3.17111e-06     -4.74e-18\npolygon 2853 (hole)       17 -1.38583e-05     -2.07e-17\npolygon 2854 (hole)        5 -1.06313e-06     -1.59e-18\npolygon 2855 (hole)        8 -2.18189e-06     -3.26e-18\npolygon 2856 (hole)        6 -1.71148e-07     -2.56e-19\npolygon 2857 (hole)        8 -4.87991e-07     -7.29e-19\npolygon 2858 (hole)        9 -4.25949e-07     -6.36e-19\npolygon 2859 (hole)        6 -7.05408e-06     -1.05e-17\npolygon 2860 (hole)       14 -2.99877e-05     -4.48e-17\npolygon 2861 (hole)       10 -1.19796e-05     -1.79e-17\npolygon 2862 (hole)       17 -3.81199e-05     -5.69e-17\npolygon 2863 (hole)        9 -6.24807e-06     -9.33e-18\npolygon 2864 (hole)        3 -2.21670e-08     -3.31e-20\npolygon 2865 (hole)        7 -1.26269e-06     -1.89e-18\npolygon 2866 (hole)        3 -2.73689e-07     -4.09e-19\npolygon 2867 (hole)        4 -4.88945e-07     -7.30e-19\npolygon 2868 (hole)        8 -1.10428e-05     -1.65e-17\npolygon 2869 (hole)        7 -4.39022e-06     -6.56e-18\npolygon 2870 (hole)        5 -1.16748e-06     -1.74e-18\npolygon 2871 (hole)        3 -7.28232e-08     -1.09e-19\npolygon 2872 (hole)        4 -3.38675e-07     -5.06e-19\npolygon 2873 (hole)        5 -1.61736e-06     -2.42e-18\npolygon 2874 (hole)        6 -1.27166e-06     -1.90e-18\npolygon 2875 (hole)        3 -5.00856e-08     -7.48e-20\npolygon 2876 (hole)        9 -7.53212e-06     -1.12e-17\npolygon 2877 (hole)        5 -2.41989e-06     -3.61e-18\npolygon 2878 (hole)        6 -4.39938e-07     -6.57e-19\npolygon 2879 (hole)        6 -2.73478e-06     -4.08e-18\npolygon 2880 (hole)        8 -6.27417e-06     -9.37e-18\npolygon 2881 (hole)        3 -3.32579e-07     -4.97e-19\npolygon 2882 (hole)        8 -9.50574e-06     -1.42e-17\npolygon 2883 (hole)       34 -2.55436e-05     -3.81e-17\npolygon 2884 (hole)        3 -2.77071e-06     -4.14e-18\npolygon 2885 (hole)        6 -8.38765e-06     -1.25e-17\npolygon 2886 (hole)       31 -4.97007e-05     -7.42e-17\npolygon 2887              16  3.50061e+05      5.23e-07\npolygon 2888 (hole)        6 -6.08264e-06     -9.08e-18\npolygon 2889 (hole)       13 -5.96071e-06     -8.90e-18\npolygon 2890 (hole)       23 -5.32578e-06     -7.95e-18\npolygon 2891 (hole)        4 -9.01200e-07     -1.35e-18\npolygon 2892 (hole)        3 -1.27697e-06     -1.91e-18\npolygon 2893 (hole)        3 -4.91375e-07     -7.34e-19\npolygon 2894 (hole)        4 -9.28230e-07     -1.39e-18\npolygon 2895 (hole)        7 -5.06681e-06     -7.57e-18\npolygon 2896 (hole)       10 -6.09722e-06     -9.10e-18\npolygon 2897 (hole)       11 -3.98095e-06     -5.94e-18\npolygon 2898 (hole)        3 -4.74198e-09     -7.08e-21\npolygon 2899 (hole)        6 -4.45010e-06     -6.64e-18\npolygon 2900 (hole)        4 -1.09328e-06     -1.63e-18\npolygon 2901 (hole)       28 -3.37389e-05     -5.04e-17\npolygon 2902 (hole)        5 -7.83002e-07     -1.17e-18\npolygon 2903 (hole)        4 -3.07809e-08     -4.60e-20\npolygon 2904 (hole)        7 -6.53156e-07     -9.75e-19\npolygon 2905 (hole)        4 -8.24580e-08     -1.23e-19\npolygon 2906 (hole)        4 -2.40591e-06     -3.59e-18\npolygon 2907 (hole)       15 -2.93651e-05     -4.38e-17\npolygon 2908 (hole)        7 -1.29803e-05     -1.94e-17\npolygon 2909 (hole)        7 -8.37636e-06     -1.25e-17\npolygon 2910 (hole)        3 -1.05752e-08     -1.58e-20\npolygon 2911 (hole)       16 -1.07268e-05     -1.60e-17\npolygon 2912 (hole)       11 -2.12302e-05     -3.17e-17\npolygon 2913 (hole)        3 -1.78834e+02     -2.67e-10\npolygon 2914 (hole)       13 -9.55329e-06     -1.43e-17\npolygon 2915 (hole)        6 -9.35033e-06     -1.40e-17\npolygon 2916 (hole)        5 -4.04103e-06     -6.03e-18\npolygon 2917 (hole)        4 -8.66743e-07     -1.29e-18\npolygon 2918 (hole)        3 -3.22713e-09     -4.82e-21\npolygon 2919 (hole)        3 -1.03567e-06     -1.55e-18\npolygon 2920 (hole)       21 -4.94601e-06     -7.39e-18\npolygon 2921 (hole)       10 -3.76192e-06     -5.62e-18\npolygon 2922 (hole)        6 -5.31745e-07     -7.94e-19\npolygon 2923 (hole)       15 -1.09628e-05     -1.64e-17\npolygon 2924 (hole)        4 -8.57688e-07     -1.28e-18\npolygon 2925 (hole)        8 -2.06106e-06     -3.08e-18\npolygon 2926 (hole)        4 -8.67878e-07     -1.30e-18\npolygon 2927              14  2.11571e+05      3.16e-07\npolygon 2928 (hole)       14 -4.17234e-06     -6.23e-18\npolygon 2929 (hole)        3 -5.14394e-07     -7.68e-19\npolygon 2930 (hole)        5 -5.21585e-07     -7.79e-19\npolygon 2931 (hole)       15 -4.29269e-06     -6.41e-18\npolygon 2932 (hole)        8 -1.40085e-06     -2.09e-18\npolygon 2933 (hole)       14 -2.07309e-06     -3.10e-18\npolygon 2934 (hole)       17 -2.28653e-06     -3.41e-18\npolygon 2935 (hole)       10 -4.38843e-06     -6.55e-18\npolygon 2936 (hole)        3 -1.41922e-06     -2.12e-18\npolygon 2937 (hole)       12 -3.12076e-06     -4.66e-18\npolygon 2938 (hole)        4 -8.63952e-08     -1.29e-19\npolygon 2939 (hole)        4 -4.11085e-08     -6.14e-20\npolygon 2940 (hole)       10 -8.55483e-06     -1.28e-17\npolygon 2941 (hole)        4 -9.60467e-07     -1.43e-18\npolygon 2942 (hole)       12 -3.98128e-06     -5.94e-18\npolygon 2943 (hole)        4 -3.02319e-06     -4.51e-18\npolygon 2944              11  1.59536e+05      2.38e-07\npolygon 2945             111  7.35028e+07      1.10e-04\npolygon 2946              54  9.35305e+06      1.40e-05\npolygon 2947              19  6.34649e+05      9.48e-07\npolygon 2948              10  3.74827e+04      5.60e-08\npolygon 2949              13  1.37100e+05      2.05e-07\npolygon 2950              31  4.47193e+06      6.68e-06\npolygon 2951              19  1.23742e+06      1.85e-06\npolygon 2952              20  1.79201e+06      2.68e-06\npolygon 2953              16  2.19464e+05      3.28e-07\npolygon 2954              11  7.94092e+04      1.19e-07\npolygon 2955              14  1.45779e+05      2.18e-07\npolygon 2956              31  6.24672e+05      9.33e-07\npolygon 2957              11  2.29288e+04      3.42e-08\npolygon 2958              18  2.10998e+05      3.15e-07\npolygon 2959              26  2.52571e+06      3.77e-06\npolygon 2960              16  5.77783e+05      8.63e-07\npolygon 2961              26  8.87985e+05      1.33e-06\npolygon 2962              13  1.10557e+05      1.65e-07\npolygon 2963              21  9.55338e+05      1.43e-06\npolygon 2964              32  2.18189e+06      3.26e-06\npolygon 2965              18  7.64830e+05      1.14e-06\npolygon 2966              34  1.71336e+06      2.56e-06\npolygon 2967             115  9.29594e+05      1.39e-06\npolygon 2968              68  2.06761e+05      3.09e-07\npolygon 2969              40  4.87851e+06      7.28e-06\npolygon 2970              10  7.43137e+04      1.11e-07\npolygon 2971              17  5.95020e+05      8.88e-07\npolygon 2972              21  4.02132e+05      6.00e-07\npolygon 2973              21  1.09635e+06      1.64e-06\npolygon 2974              14  1.15356e+05      1.72e-07\npolygon 2975              20  3.13610e+05      4.68e-07\npolygon 2976             275  3.92648e+08      5.86e-04\npolygon 2977              16  2.19612e+05      3.28e-07\npolygon 2978              13  2.64858e+05      3.95e-07\npolygon 2979              23  1.25549e+06      1.87e-06\npolygon 2980               9  1.79312e+05      2.68e-07\npolygon 2981              15  2.93132e+05      4.38e-07\npolygon 2982              15  5.29892e+05      7.91e-07\npolygon 2983              23  4.95351e+05      7.40e-07\npolygon 2984              14  4.41976e+05      6.60e-07\npolygon 2985              19  3.32318e+05      4.96e-07\npolygon 2986              16  4.15914e+05      6.21e-07\npolygon 2987              22  5.10526e+05      7.62e-07\npolygon 2988              48  1.87148e+07      2.79e-05\npolygon 2989              18  1.62882e+06      2.43e-06\npolygon 2990              71  2.43615e+07      3.64e-05\npolygon 2991             116  5.16444e+07      7.71e-05\npolygon 2992              19  1.54144e+06      2.30e-06\npolygon 2993              11  2.01013e+05      3.00e-07\npolygon 2994              20  2.31201e+06      3.45e-06\npolygon 2995              15  5.94674e+05      8.88e-07\npolygon 2996             218  1.56252e+08      2.33e-04\npolygon 2997             162  8.80247e+07      1.31e-04\npolygon 2998              16  3.69968e+05      5.52e-07\npolygon 2999              14  1.61451e+05      2.41e-07\npolygon 3000              18  5.54566e+05      8.28e-07\npolygon 3001              19  5.07078e+05      7.57e-07\npolygon 3002              57  6.86475e+06      1.03e-05\npolygon 3003              15  6.56018e+05      9.80e-07\npolygon 3004              21  6.65092e+05      9.93e-07\npolygon 3005              15  5.97784e+05      8.93e-07\npolygon 3006              37  2.56010e+06      3.82e-06\npolygon 3007              13  1.66996e+05      2.49e-07\npolygon 3008              20  8.18381e+05      1.22e-06\npolygon 3009              21  2.89704e+06      4.33e-06\npolygon 3010              15  4.08213e+05      6.10e-07\npolygon 3011             104  4.71547e+07      7.04e-05\npolygon 3012              28  3.80443e+06      5.68e-06\npolygon 3013              67  3.17343e+07      4.74e-05\npolygon 3014             730  9.20735e+08      1.37e-03\npolygon 3015              16  2.01576e+05      3.01e-07\npolygon 3016              12  1.41506e+05      2.11e-07\npolygon 3017              15  4.92125e+05      7.35e-07\npolygon 3018              18  1.58128e+06      2.36e-06\npolygon 3019              25  1.94322e+06      2.90e-06\npolygon 3020              12  2.51373e+05      3.75e-07\npolygon 3021             412  4.47936e+08      6.69e-04\npolygon 3022              22  7.57105e+05      1.13e-06\npolygon 3023              16  6.97434e+05      1.04e-06\npolygon 3024              39  4.45130e+06      6.65e-06\npolygon 3025              13  8.83786e+05      1.32e-06\npolygon 3026              10  2.06200e+05      3.08e-07\npolygon 3027              76  3.60497e+07      5.38e-05\npolygon 3028              13  4.56433e+05      6.82e-07\npolygon 3029              28  2.30613e+06      3.44e-06\npolygon 3030              27  2.50338e+06      3.74e-06\npolygon 3031              14  4.69238e+05      7.01e-07\npolygon 3032              10  1.69886e+05      2.54e-07\npolygon 3033              16  5.42822e+05      8.11e-07\npolygon 3034              10  1.17633e+05      1.76e-07\npolygon 3035               8  7.08579e+04      1.06e-07\npolygon 3036             144  7.85300e+07      1.17e-04\npolygon 3037              37  1.93477e+06      2.89e-06\npolygon 3038              25  5.59996e+05      8.36e-07\npolygon 3039              44  2.86031e+06      4.27e-06\npolygon 3040              26  1.26276e+06      1.89e-06\npolygon 3041             149  1.37840e+08      2.06e-04\npolygon 3042              18  4.84958e+05      7.24e-07\npolygon 3043              73  2.93195e+07      4.38e-05\npolygon 3044              45  6.87481e+06      1.03e-05\npolygon 3045              64  1.80880e+07      2.70e-05\npolygon 3046              12  8.76879e+05      1.31e-06\npolygon 3047              26  2.78381e+06      4.16e-06\npolygon 3048              35  8.72326e+06      1.30e-05\npolygon 3049              53  1.06237e+07      1.59e-05\npolygon 3050              26  5.40467e+06      8.07e-06\npolygon 3051             148  1.05037e+08      1.57e-04\npolygon 3052              21  8.32798e+05      1.24e-06\npolygon 3053              21  2.23023e+06      3.33e-06\npolygon 3054               8  6.30805e+05      9.42e-07\npolygon 3055              78  3.67603e+07      5.49e-05\npolygon 3056              18  1.64745e+06      2.46e-06\npolygon 3057              58  1.31747e+07      1.97e-05\npolygon 3058              94  1.16837e+07      1.74e-05\npolygon 3059              53  3.17801e+06      4.75e-06\npolygon 3060             137  8.46454e+06      1.26e-05\npolygon 3061              23  4.36507e+05      6.52e-07\npolygon 3062              27  9.72136e+05      1.45e-06\npolygon 3063 (hole)        5 -7.00763e-07     -1.05e-18\npolygon 3064 (hole)        8 -3.52860e-06     -5.27e-18\npolygon 3065              55  1.98854e+06      2.97e-06\npolygon 3066 (hole)        3 -2.04762e-08     -3.06e-20\npolygon 3067 (hole)        4 -6.13894e-07     -9.17e-19\npolygon 3068 (hole)        4 -2.39436e-07     -3.58e-19\npolygon 3069 (hole)       10 -2.80823e-06     -4.19e-18\npolygon 3070 (hole)        3 -7.19460e-09     -1.07e-20\npolygon 3071 (hole)        4 -1.10286e-06     -1.65e-18\npolygon 3072 (hole)        6 -1.93232e-06     -2.89e-18\npolygon 3073 (hole)        4 -1.46798e-07     -2.19e-19\npolygon 3074 (hole)       10 -7.07158e-06     -1.06e-17\npolygon 3075 (hole)        6 -2.20372e-07     -3.29e-19\npolygon 3076 (hole)        4 -2.88487e-07     -4.31e-19\npolygon 3077 (hole)        4 -1.75003e-07     -2.61e-19\npolygon 3078 (hole)        6 -7.13334e-07     -1.07e-18\npolygon 3079 (hole)        4 -1.22582e-06     -1.83e-18\npolygon 3080 (hole)        3 -2.17510e-08     -3.25e-20\npolygon 3081 (hole)        4 -9.25393e-07     -1.38e-18\npolygon 3082 (hole)        7 -1.62217e-06     -2.42e-18\npolygon 3083 (hole)        4 -3.05872e-07     -4.57e-19\npolygon 3084 (hole)        4 -2.78483e-07     -4.16e-19\npolygon 3085 (hole)       10 -4.42907e-06     -6.61e-18\npolygon 3086 (hole)        4 -1.73147e-06     -2.59e-18\npolygon 3087 (hole)        5 -1.26707e-06     -1.89e-18\npolygon 3088 (hole)        6 -1.04486e-06     -1.56e-18\npolygon 3089 (hole)       10 -1.02127e-06     -1.52e-18\npolygon 3090 (hole)       10 -4.75980e-06     -7.11e-18\npolygon 3091 (hole)        3 -5.18256e-08     -7.74e-20\npolygon 3092 (hole)        4 -4.52721e-07     -6.76e-19\npolygon 3093 (hole)       14 -6.59378e-06     -9.85e-18\npolygon 3094 (hole)        4 -1.90018e-07     -2.84e-19\npolygon 3095 (hole)        3 -2.15566e-08     -3.22e-20\npolygon 3096 (hole)        5 -7.90507e-07     -1.18e-18\npolygon 3097 (hole)        4 -9.81894e-08     -1.47e-19\npolygon 3098 (hole)        3 -1.62733e-08     -2.43e-20\npolygon 3099 (hole)        4 -3.64370e-07     -5.44e-19\npolygon 3100 (hole)        4 -2.24802e-07     -3.36e-19\npolygon 3101 (hole)        8 -2.34948e-06     -3.51e-18\npolygon 3102 (hole)        4 -6.98334e-08     -1.04e-19\npolygon 3103 (hole)        5 -5.36729e-07     -8.01e-19\npolygon 3104 (hole)        3 -7.57743e-08     -1.13e-19\npolygon 3105 (hole)        4 -1.25414e-07     -1.87e-19\npolygon 3106 (hole)        7 -1.04558e-06     -1.56e-18\npolygon 3107 (hole)       10 -2.48395e-06     -3.71e-18\npolygon 3108 (hole)        7 -7.37366e-07     -1.10e-18\npolygon 3109 (hole)        7 -3.14276e-07     -4.69e-19\npolygon 3110 (hole)       12 -7.14304e-06     -1.07e-17\npolygon 3111 (hole)        6 -5.26802e-07     -7.87e-19\npolygon 3112 (hole)       12 -4.30314e-06     -6.43e-18\npolygon 3113 (hole)        5 -5.75573e-07     -8.59e-19\npolygon 3114 (hole)        4 -2.63421e-07     -3.93e-19\npolygon 3115 (hole)        4 -1.12275e-07     -1.68e-19\npolygon 3116 (hole)        7 -6.08788e-07     -9.09e-19\npolygon 3117 (hole)        7 -6.12903e-06     -9.15e-18\npolygon 3118 (hole)        3 -2.30647e-08     -3.44e-20\npolygon 3119 (hole)        3 -6.63760e-09     -9.91e-21\npolygon 3120 (hole)        4 -2.85676e-07     -4.27e-19\npolygon 3121 (hole)        8 -3.03154e-06     -4.53e-18\npolygon 3122 (hole)        4 -1.35016e-07     -2.02e-19\npolygon 3123 (hole)        4 -8.96261e-09     -1.34e-20\npolygon 3124 (hole)        4 -3.38689e-07     -5.06e-19\npolygon 3125 (hole)        4 -6.23841e-07     -9.32e-19\npolygon 3126 (hole)        4 -1.86883e-07     -2.79e-19\npolygon 3127 (hole)        5 -4.25398e-07     -6.35e-19\npolygon 3128 (hole)        3 -1.19726e-07     -1.79e-19\npolygon 3129 (hole)        3 -3.16269e-08     -4.72e-20\npolygon 3130 (hole)       14 -1.35532e-05     -2.02e-17\npolygon 3131 (hole)        4 -2.43960e-07     -3.64e-19\npolygon 3132 (hole)        5 -7.25464e-08     -1.08e-19\npolygon 3133 (hole)        3 -2.88165e-08     -4.30e-20\npolygon 3134 (hole)        6 -3.50530e-06     -5.23e-18\npolygon 3135 (hole)        3 -2.48487e-09     -3.71e-21\npolygon 3136 (hole)        8 -1.63849e-06     -2.45e-18\npolygon 3137 (hole)        3 -3.55226e-08     -5.30e-20\npolygon 3138 (hole)        4 -1.34961e-07     -2.02e-19\npolygon 3139 (hole)        6 -1.48117e-06     -2.21e-18\npolygon 3140 (hole)        4 -1.85605e-06     -2.77e-18\npolygon 3141 (hole)        5 -7.05883e-07     -1.05e-18\npolygon 3142 (hole)        6 -9.15044e-07     -1.37e-18\npolygon 3143 (hole)        4 -7.20366e-07     -1.08e-18\npolygon 3144 (hole)        6 -1.69196e-06     -2.53e-18\npolygon 3145              48  1.02651e+07      1.53e-05\npolygon 3146 (hole)       12 -5.63666e-06     -8.42e-18\npolygon 3147 (hole)        3 -6.55798e-07     -9.79e-19\npolygon 3148 (hole)        4 -7.53000e-07     -1.12e-18\npolygon 3149 (hole)        3 -4.80262e-07     -7.17e-19\npolygon 3150 (hole)        4 -1.40559e-06     -2.10e-18\npolygon 3151 (hole)        4 -3.54028e-06     -5.29e-18\npolygon 3152 (hole)        3 -1.96889e-09     -2.94e-21\npolygon 3153 (hole)       20 -1.44585e-05     -2.16e-17\npolygon 3154 (hole)        5 -4.25973e-07     -6.36e-19\npolygon 3155 (hole)       39 -1.89578e-05     -2.83e-17\npolygon 3156 (hole)        6 -7.08690e-07     -1.06e-18\npolygon 3157 (hole)        3 -5.33030e-08     -7.96e-20\npolygon 3158 (hole)        3 -4.27398e-08     -6.38e-20\npolygon 3159 (hole)        6 -1.19415e-06     -1.78e-18\npolygon 3160 (hole)        5 -1.19455e-07     -1.78e-19\npolygon 3161 (hole)        4 -7.81733e-08     -1.17e-19\npolygon 3162 (hole)        8 -1.14379e-06     -1.71e-18\npolygon 3163 (hole)        3 -2.13254e-08     -3.18e-20\npolygon 3164 (hole)        7 -1.60059e-07     -2.39e-19\npolygon 3165 (hole)        3 -1.12670e-09     -1.68e-21\npolygon 3166 (hole)        3 -6.90646e-09     -1.03e-20\npolygon 3167 (hole)        3 -7.88862e-08     -1.18e-19\npolygon 3168 (hole)        3 -3.58374e-09     -5.35e-21\npolygon 3169 (hole)        3 -1.15918e-08     -1.73e-20\npolygon 3170 (hole)        3 -5.52933e-11     -8.26e-23\npolygon 3171 (hole)        3 -3.48620e-09     -5.21e-21\npolygon 3172 (hole)        4 -5.44548e-07     -8.13e-19\npolygon 3173 (hole)        4 -6.02637e-08     -9.00e-20\npolygon 3174 (hole)        3 -1.18351e-08     -1.77e-20\npolygon 3175 (hole)        4 -6.91302e-08     -1.03e-19\npolygon 3176 (hole)        4 -4.55722e-07     -6.80e-19\npolygon 3177 (hole)        4 -7.91420e-07     -1.18e-18\npolygon 3178 (hole)        4 -1.33268e-06     -1.99e-18\npolygon 3179              15  3.16153e+05      4.72e-07\npolygon 3180              22  8.93201e+05      1.33e-06\npolygon 3181              18  2.91538e+05      4.35e-07\npolygon 3182              59  3.70736e+06      5.54e-06\npolygon 3183              11  1.55205e+05      2.32e-07\npolygon 3184              14  1.87401e+05      2.80e-07\npolygon 3185              11  6.54128e+04      9.77e-08\npolygon 3186              11  8.64659e+04      1.29e-07\npolygon 3187              12  2.25129e+05      3.36e-07\npolygon 3188              30  2.72178e+06      4.06e-06\npolygon 3189 (hole)        3 -2.26252e+00     -3.38e-12\npolygon 3190             180  1.80314e+07      2.69e-05\npolygon 3191              14  4.01942e+05      6.00e-07\npolygon 3192             103  1.33467e+07      1.99e-05\npolygon 3193              14  2.07708e+05      3.10e-07\npolygon 3194              55  4.38623e+06      6.55e-06\npolygon 3195              41  4.69733e+06      7.01e-06\npolygon 3196              74  3.92633e+06      5.86e-06\npolygon 3197              31  2.79477e+06      4.17e-06\npolygon 3198              17  8.74607e+05      1.31e-06\npolygon 3199              26  4.50962e+05      6.73e-07\npolygon 3200              18  1.15065e+06      1.72e-06\npolygon 3201             164  1.48037e+07      2.21e-05\npolygon 3202              12  3.17290e+05      4.74e-07\npolygon 3203              69  2.59551e+07      3.88e-05\npolygon 3204              37  7.85963e+05      1.17e-06\npolygon 3205              14  3.37873e+05      5.05e-07\npolygon 3206              12  1.77980e+05      2.66e-07\npolygon 3207              21  6.46195e+05      9.65e-07\npolygon 3208              24  2.69998e+06      4.03e-06\npolygon 3209              30  1.00675e+06      1.50e-06\npolygon 3210              57  4.22747e+06      6.31e-06\npolygon 3211              23  8.63543e+05      1.29e-06\npolygon 3212              11  2.01925e+05      3.02e-07\npolygon 3213              95  2.88232e+07      4.30e-05\npolygon 3214             452  9.64208e+07      1.44e-04\npolygon 3215              77  1.72297e+07      2.57e-05\npolygon 3216              16  3.33522e+05      4.98e-07\npolygon 3217              19  6.82895e+05      1.02e-06\npolygon 3218              43  3.95062e+06      5.90e-06\npolygon 3219              29  1.00709e+06      1.50e-06\npolygon 3220              21  8.90014e+05      1.33e-06\npolygon 3221              22  7.93453e+05      1.18e-06\npolygon 3222              13  4.52813e+05      6.76e-07\npolygon 3223              30  1.49817e+06      2.24e-06\npolygon 3224              48  4.23996e+06      6.33e-06\npolygon 3225              37  1.20290e+06      1.80e-06\npolygon 3226              19  4.85805e+05      7.25e-07\npolygon 3227              46  2.18001e+06      3.26e-06\npolygon 3228               7  1.33723e+05      2.00e-07\npolygon 3229              54  1.82059e+07      2.72e-05\npolygon 3230              10  8.57866e+05      1.28e-06\npolygon 3231              14  1.98445e+05      2.96e-07\npolygon 3232              19  4.68357e+05      6.99e-07\npolygon 3233              52  8.57765e+06      1.28e-05\npolygon 3234              73  7.91998e+06      1.18e-05\npolygon 3235              23  8.19561e+06      1.22e-05\npolygon 3236              10  1.06594e+05      1.59e-07\npolygon 3237             169  1.39462e+07      2.08e-05\npolygon 3238              17  2.55915e+05      3.82e-07\npolygon 3239              12  1.81516e+05      2.71e-07\npolygon 3240              16  3.68509e+05      5.50e-07\npolygon 3241              12  1.24954e+05      1.87e-07\npolygon 3242            1012  4.61886e+08      6.90e-04\npolygon 3243              15  5.42647e+05      8.10e-07\npolygon 3244              12  5.53088e+05      8.26e-07\npolygon 3245              24  1.06455e+06      1.59e-06\npolygon 3246              14  3.17038e+05      4.73e-07\npolygon 3247              17  1.25559e+06      1.87e-06\npolygon 3248              16  1.92407e+06      2.87e-06\npolygon 3249              80  1.86306e+07      2.78e-05\npolygon 3250              11  6.83880e+04      1.02e-07\npolygon 3251             166  4.21470e+07      6.29e-05\npolygon 3252              22  1.36174e+06      2.03e-06\npolygon 3253              31  6.07363e+05      9.07e-07\npolygon 3254              10  1.27067e+05      1.90e-07\npolygon 3255             164  5.02951e+07      7.51e-05\npolygon 3256              17  1.20798e+06      1.80e-06\npolygon 3257              59  2.41720e+06      3.61e-06\npolygon 3258              12  2.52952e+05      3.78e-07\npolygon 3259              14  2.44407e+05      3.65e-07\npolygon 3260              43  4.89177e+06      7.30e-06\npolygon 3261              40  3.86642e+06      5.77e-06\npolygon 3262              23  4.59203e+05      6.86e-07\npolygon 3263              14  1.79442e+05      2.68e-07\npolygon 3264              13  1.61191e+05      2.41e-07\npolygon 3265              43  1.33365e+06      1.99e-06\npolygon 3266              75  1.20247e+07      1.80e-05\npolygon 3267              17  9.96466e+04      1.49e-07\npolygon 3268              22  1.60660e+06      2.40e-06\npolygon 3269             730  1.16983e+08      1.75e-04\npolygon 3270             129  7.87539e+06      1.18e-05\npolygon 3271              22  4.66256e+05      6.96e-07\npolygon 3272              19  5.44519e+05      8.13e-07\npolygon 3273              16  3.73911e+05      5.58e-07\npolygon 3274              88  3.47678e+07      5.19e-05\npolygon 3275              46  3.23711e+06      4.83e-06\npolygon 3276              47  9.17482e+05      1.37e-06\npolygon 3277              14  4.44869e+05      6.64e-07\npolygon 3278              43  1.29527e+06      1.93e-06\npolygon 3279              65  3.20974e+06      4.79e-06\npolygon 3280             306  1.83695e+07      2.74e-05\npolygon 3281              17  4.25486e+05      6.35e-07\npolygon 3282              29  1.08467e+06      1.62e-06\npolygon 3283              26  1.16602e+06      1.74e-06\npolygon 3284             135  4.90655e+06      7.33e-06\npolygon 3285              23  1.87723e+06      2.80e-06\npolygon 3286              21  7.02338e+05      1.05e-06\npolygon 3287              30  4.99970e+06      7.47e-06\npolygon 3288              21  7.71571e+05      1.15e-06\npolygon 3289              13  1.47832e+05      2.21e-07\npolygon 3290              26  3.17307e+06      4.74e-06\npolygon 3291              17  1.03642e+06      1.55e-06\npolygon 3292             100  8.74537e+06      1.31e-05\npolygon 3293              11  1.13950e+05      1.70e-07\npolygon 3294              26  8.27840e+05      1.24e-06\npolygon 3295              17  4.10882e+05      6.14e-07\npolygon 3296              13  1.49250e+05      2.23e-07\npolygon 3297              35  1.76408e+06      2.63e-06\npolygon 3298              15  2.03390e+05      3.04e-07\npolygon 3299              18  1.70982e+05      2.55e-07\npolygon 3300              32  7.98599e+06      1.19e-05\npolygon 3301              27  3.20839e+05      4.79e-07\npolygon 3302             539  1.17139e+08      1.75e-04\npolygon 3303              51  1.57614e+06      2.35e-06\npolygon 3304              19  3.60772e+05      5.39e-07\npolygon 3305              58  2.10060e+06      3.14e-06\npolygon 3306              13  1.70224e+05      2.54e-07\npolygon 3307              11  6.11736e+05      9.13e-07\npolygon 3308              35  5.26152e+06      7.86e-06\npolygon 3309              16  1.99371e+05      2.98e-07\npolygon 3310              14  4.48979e+05      6.70e-07\npolygon 3311              25  1.92913e+06      2.88e-06\npolygon 3312              16  4.26157e+05      6.36e-07\npolygon 3313              46  1.88229e+06      2.81e-06\npolygon 3314              17  2.29456e+05      3.43e-07\npolygon 3315              36  4.01418e+06      5.99e-06\npolygon 3316              57  1.77153e+07      2.65e-05\npolygon 3317              20  5.72298e+05      8.55e-07\npolygon 3318              14  2.46782e+05      3.68e-07\npolygon 3319              29  1.01300e+06      1.51e-06\npolygon 3320              90  8.54955e+06      1.28e-05\npolygon 3321              21  3.99098e+05      5.96e-07\npolygon 3322              12  2.81650e+05      4.21e-07\npolygon 3323              52  3.19337e+06      4.77e-06\npolygon 3324              13  3.40300e+05      5.08e-07\npolygon 3325              29  9.08533e+05      1.36e-06\npolygon 3326              20  3.07393e+05      4.59e-07\npolygon 3327              19  1.15906e+06      1.73e-06\npolygon 3328              17  1.16182e+06      1.73e-06\npolygon 3329              21  2.60877e+06      3.90e-06\npolygon 3330              15  1.09001e+05      1.63e-07\npolygon 3331              37  1.31921e+06      1.97e-06\npolygon 3332              53  1.46854e+06      2.19e-06\npolygon 3333              59  8.92822e+06      1.33e-05\npolygon 3334               9  7.44981e+04      1.11e-07\npolygon 3335              14  2.41462e+05      3.61e-07\npolygon 3336              96  7.25940e+06      1.08e-05\npolygon 3337              11  1.06055e+05      1.58e-07\npolygon 3338              49  1.87834e+06      2.80e-06\npolygon 3339              23  6.08310e+05      9.08e-07\npolygon 3340              50  6.76488e+05      1.01e-06\npolygon 3341              22  4.83089e+05      7.21e-07\npolygon 3342              17  1.17278e+05      1.75e-07\npolygon 3343              13  8.98786e+05      1.34e-06\npolygon 3344              43  1.01757e+06      1.52e-06\npolygon 3345              52  1.68377e+06      2.51e-06\npolygon 3346             348  2.50314e+08      3.74e-04\npolygon 3347              43  1.29120e+06      1.93e-06\npolygon 3348              71  2.02836e+06      3.03e-06\npolygon 3349 (hole)        4 -4.12791e+00     -6.16e-12\npolygon 3350             141  4.53240e+06      6.77e-06\npolygon 3351              52  3.62008e+06      5.41e-06\npolygon 3352              20  7.69539e+05      1.15e-06\npolygon 3353              88  8.88904e+06      1.33e-05\npolygon 3354              12  1.44668e+05      2.16e-07\npolygon 3355              46  2.28026e+06      3.40e-06\npolygon 3356              39  4.79165e+06      7.15e-06\npolygon 3357              53  2.86736e+06      4.28e-06\npolygon 3358              38  3.22508e+06      4.82e-06\npolygon 3359              18  4.44863e+05      6.64e-07\npolygon 3360              45  1.45134e+06      2.17e-06\npolygon 3361              86  2.56400e+07      3.83e-05\npolygon 3362             158  1.74510e+07      2.61e-05\npolygon 3363              14  2.50383e+05      3.74e-07\npolygon 3364             120  7.17019e+06      1.07e-05\npolygon 3365             146  2.28448e+07      3.41e-05\npolygon 3366             143  2.34472e+07      3.50e-05\npolygon 3367              20  3.47415e+05      5.19e-07\npolygon 3368              84  3.86387e+06      5.77e-06\npolygon 3369              68  1.10850e+07      1.66e-05\npolygon 3370             863  7.47702e+07      1.12e-04\npolygon 3371              53  7.54742e+06      1.13e-05\npolygon 3372              64  2.11016e+06      3.15e-06\npolygon 3373             103  1.47525e+07      2.20e-05\npolygon 3374              26  3.40345e+06      5.08e-06\npolygon 3375             103  8.40445e+06      1.25e-05\npolygon 3376              23  4.92041e+05      7.35e-07\npolygon 3377              27  5.53625e+05      8.27e-07\npolygon 3378              60  3.56102e+06      5.32e-06\npolygon 3379             151  1.51314e+07      2.26e-05\npolygon 3380             708  4.18129e+08      6.24e-04\npolygon 3381             120  1.32857e+07      1.98e-05\npolygon 3382             856  2.53898e+08      3.79e-04\npolygon 3383              13  2.47298e+05      3.69e-07\npolygon 3384              16  7.35754e+05      1.10e-06\npolygon 3385              21  5.31633e+05      7.94e-07\npolygon 3386              72  1.03185e+07      1.54e-05\npolygon 3387              38  1.34734e+06      2.01e-06\npolygon 3388               8  4.09489e+05      6.11e-07\npolygon 3389              17  2.46995e+05      3.69e-07\npolygon 3390              14  1.42285e+05      2.12e-07\npolygon 3391               9  1.56346e+05      2.33e-07\npolygon 3392              42  5.49581e+05      8.21e-07\npolygon 3393              59  1.15813e+06      1.73e-06\npolygon 3394              12  1.16845e+05      1.74e-07\npolygon 3395              11  6.00122e+04      8.96e-08\npolygon 3396              14  1.63465e+05      2.44e-07\npolygon 3397               8  4.73674e+04      7.07e-08\npolygon 3398              23  6.69330e+05      9.99e-07\npolygon 3399             144  6.48346e+06      9.68e-06\npolygon 3400              74  4.79923e+06      7.17e-06\npolygon 3401             116  1.02706e+07      1.53e-05\npolygon 3402              16  2.74005e+05      4.09e-07\npolygon 3403              97  4.72599e+06      7.06e-06\npolygon 3404              18  6.15583e+05      9.19e-07\npolygon 3405             146  1.38979e+07      2.08e-05\npolygon 3406              32  1.94516e+06      2.90e-06\npolygon 3407              26  9.81356e+05      1.47e-06\npolygon 3408              82  4.39797e+06      6.57e-06\npolygon 3409              33  9.36113e+05      1.40e-06\npolygon 3410              47  1.51844e+06      2.27e-06\npolygon 3411             196  2.32689e+07      3.47e-05\npolygon 3412              53  1.30069e+06      1.94e-06\npolygon 3413              70  1.00802e+07      1.51e-05\npolygon 3414              10  5.33870e+05      7.97e-07\npolygon 3415             211  2.73026e+07      4.08e-05\npolygon 3416              41  1.44141e+06      2.15e-06\npolygon 3417               9  5.20220e+05      7.77e-07\npolygon 3418             316  6.66808e+07      9.96e-05\npolygon 3419              17  7.48505e+05      1.12e-06\npolygon 3420              15  1.49799e+05      2.24e-07\npolygon 3421              24  4.99500e+05      7.46e-07\npolygon 3422              12  2.24463e+05      3.35e-07\npolygon 3423             100  1.06028e+07      1.58e-05\npolygon 3424              11  1.24267e+05      1.86e-07\npolygon 3425             143  1.89581e+07      2.83e-05\npolygon 3426              60  7.07802e+06      1.06e-05\npolygon 3427             124  1.23476e+07      1.84e-05\npolygon 3428              34  5.67625e+06      8.48e-06\npolygon 3429             797  1.86955e+08      2.79e-04\npolygon 3430              15  7.15891e+05      1.07e-06\npolygon 3431              20  1.61624e+06      2.41e-06\npolygon 3432              13  1.73955e+05      2.60e-07\npolygon 3433              60  2.42590e+06      3.62e-06\npolygon 3434              20  3.86365e+05      5.77e-07\npolygon 3435             213  3.69421e+07      5.52e-05\npolygon 3436              15  4.55574e+05      6.80e-07\npolygon 3437              35  1.56058e+06      2.33e-06\npolygon 3438              32  1.42419e+06      2.13e-06\npolygon 3439              68  2.30711e+06      3.44e-06\npolygon 3440             240  5.93935e+07      8.87e-05\npolygon 3441             145  1.58875e+07      2.37e-05\npolygon 3442              39  3.67239e+06      5.48e-06\npolygon 3443              54  3.84847e+06      5.75e-06\npolygon 3444              32  1.14073e+06      1.70e-06\npolygon 3445              18  3.58549e+05      5.35e-07\npolygon 3446              25  8.06470e+05      1.20e-06\npolygon 3447              15  2.67818e+05      4.00e-07\npolygon 3448              26  1.43681e+06      2.15e-06\npolygon 3449              18  3.10061e+05      4.63e-07\npolygon 3450              18  4.71644e+05      7.04e-07\npolygon 3451              16  5.04146e+05      7.53e-07\npolygon 3452              72  7.33720e+06      1.10e-05\npolygon 3453              27  1.37772e+06      2.06e-06\npolygon 3454              15  3.17217e+05      4.74e-07\npolygon 3455              37  1.17498e+06      1.75e-06\npolygon 3456              21  7.05388e+05      1.05e-06\npolygon 3457             216  2.05399e+07      3.07e-05\npolygon 3458              16  2.40093e+05      3.59e-07\npolygon 3459              29  1.71282e+06      2.56e-06\npolygon 3460              30  1.28695e+06      1.92e-06\npolygon 3461              36  2.29670e+06      3.43e-06\npolygon 3462             129  1.97698e+07      2.95e-05\npolygon 3463              65  2.65969e+06      3.97e-06\npolygon 3464             283  3.30575e+07      4.94e-05\npolygon 3465              28  7.06271e+05      1.05e-06\npolygon 3466              28  5.50158e+05      8.21e-07\npolygon 3467              49  2.25015e+06      3.36e-06\npolygon 3468              26  1.24280e+06      1.86e-06\npolygon 3469              28  9.02794e+05      1.35e-06\npolygon 3470              18  4.84064e+05      7.23e-07\npolygon 3471              47  2.33442e+06      3.49e-06\npolygon 3472              17  2.23835e+05      3.34e-07\npolygon 3473              34  7.32504e+05      1.09e-06\npolygon 3474              41  7.15538e+05      1.07e-06\npolygon 3475              21  5.81687e+05      8.69e-07\npolygon 3476              63  3.83819e+06      5.73e-06\npolygon 3477              27  1.33192e+06      1.99e-06\npolygon 3478              46  2.95028e+06      4.41e-06\npolygon 3479              10  1.34210e+05      2.00e-07\npolygon 3480              16  2.38274e+05      3.56e-07\npolygon 3481              18  4.18536e+05      6.25e-07\npolygon 3482              46  1.26584e+06      1.89e-06\npolygon 3483              14  2.14679e+05      3.21e-07\npolygon 3484              76  3.63371e+06      5.43e-06\npolygon 3485             339  4.44685e+07      6.64e-05\npolygon 3486             109  6.29786e+06      9.40e-06\npolygon 3487              14  2.89570e+05      4.32e-07\npolygon 3488              37  9.07704e+05      1.36e-06\npolygon 3489              68  3.86104e+06      5.77e-06\npolygon 3490             183  1.45458e+07      2.17e-05\npolygon 3491              44  1.64355e+06      2.45e-06\npolygon 3492              26  1.21667e+06      1.82e-06\npolygon 3493              13  1.95710e+05      2.92e-07\npolygon 3494              38  1.44402e+06      2.16e-06\npolygon 3495              14  3.29394e+05      4.92e-07\npolygon 3496              14  1.79828e+05      2.69e-07\npolygon 3497              44  2.11118e+06      3.15e-06\npolygon 3498             643  1.79215e+08      2.68e-04\npolygon 3499              24  1.10979e+06      1.66e-06\npolygon 3500              30  1.57106e+06      2.35e-06\npolygon 3501              46  3.61716e+06      5.40e-06\npolygon 3502              93  7.56340e+05      1.13e-06\npolygon 3503              57  3.07732e+06      4.59e-06\npolygon 3504              18  2.16224e+05      3.23e-07\npolygon 3505              17  5.12388e+05      7.65e-07\npolygon 3506               9  7.44780e+04      1.11e-07\npolygon 3507              57  8.09122e+06      1.21e-05\npolygon 3508              16  4.01323e+05      5.99e-07\npolygon 3509             118  2.90304e+07      4.33e-05\npolygon 3510              22  4.44693e+05      6.64e-07\npolygon 3511              43  2.28763e+06      3.42e-06\npolygon 3512              27  1.15444e+06      1.72e-06\npolygon 3513              25  1.21695e+06      1.82e-06\npolygon 3514              53  4.49228e+06      6.71e-06\npolygon 3515 (hole)        5 -1.32594e-07     -1.98e-19\npolygon 3516 (hole)        8 -1.14003e-01     -1.70e-13\npolygon 3517 (hole)        4 -2.95787e-06     -4.42e-18\npolygon 3518 (hole)        4 -5.05161e-02     -7.54e-14\npolygon 3519 (hole)        6 -1.43572e-06     -2.14e-18\npolygon 3520 (hole)       16 -6.18752e-06     -9.24e-18\npolygon 3521 (hole)        4 -5.13774e-07     -7.67e-19\npolygon 3522 (hole)        4 -9.76021e-08     -1.46e-19\npolygon 3523 (hole)       25 -9.13265e-06     -1.36e-17\npolygon 3524 (hole)       14 -8.08260e-06     -1.21e-17\npolygon 3525 (hole)        4 -2.00100e-08     -2.99e-20\npolygon 3526 (hole)       12 -9.59384e-06     -1.43e-17\npolygon 3527 (hole)        8 -6.52012e-06     -9.74e-18\npolygon 3528 (hole)        4 -1.41510e-06     -2.11e-18\npolygon 3529 (hole)        9 -1.86239e-07     -2.78e-19\npolygon 3530 (hole)        6 -1.66292e-06     -2.48e-18\npolygon 3531 (hole)       17 -1.08446e-05     -1.62e-17\npolygon 3532 (hole)       10 -1.35870e-05     -2.03e-17\npolygon 3533 (hole)       42 -3.06814e-05     -4.58e-17\npolygon 3534 (hole)        4 -2.90869e-06     -4.34e-18\npolygon 3535 (hole)       10 -5.73486e-06     -8.56e-18\npolygon 3536 (hole)       10 -1.70481e-06     -2.55e-18\npolygon 3537 (hole)        4 -6.12218e-07     -9.14e-19\npolygon 3538 (hole)       14 -4.81318e-06     -7.19e-18\npolygon 3539 (hole)        4 -6.22776e-07     -9.30e-19\npolygon 3540 (hole)        4 -2.60334e-07     -3.89e-19\npolygon 3541 (hole)       12 -1.65832e-05     -2.48e-17\npolygon 3542 (hole)        8 -1.25761e-05     -1.88e-17\npolygon 3543 (hole)        6 -6.42552e-02     -9.59e-14\npolygon 3544 (hole)        4 -5.15531e-03     -7.70e-15\npolygon 3545 (hole)        6 -4.64838e-06     -6.94e-18\npolygon 3546 (hole)        3 -7.03476e-08     -1.05e-19\npolygon 3547 (hole)        4 -1.88745e-02     -2.82e-14\npolygon 3548 (hole)        6 -1.94353e-06     -2.90e-18\npolygon 3549 (hole)       16 -1.56064e-05     -2.33e-17\npolygon 3550 (hole)        8 -2.24831e-06     -3.36e-18\npolygon 3551 (hole)        4 -8.57161e-07     -1.28e-18\npolygon 3552 (hole)        5 -3.71984e-07     -5.55e-19\npolygon 3553              79  1.47390e+07      2.20e-05\npolygon 3554           37623  6.60254e+11      9.86e-01\npolygon 3555 (hole)        8 -3.42133e-06     -5.11e-18\nenclosing rectangle: [-210008.6, 724647.6] x [1072026.3, 3158467.1] units\n                     (934700 x 2086000 units)\nWindow area = 6.69714e+11 square units\nFraction of frame area: 0.343\n\n\nWe can now perform spatial-temporal KDE (STKDE).\n\nst_kde &lt;- spattemp.density(acled_mya_quarters_ppp)\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\nsummary(st_kde)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 42825.93 (spatial)\n  lambda = 0.0051 (temporal)\n\nNo. of observations\n  53551 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 15]\n\nEvaluation\n  128 x 128 x 15 trivariate lattice\n  Density range: [9.794759e-26, 2.083818e-10]\n\n\nAfter performing STKDE, we are able to plot the quarterly STKDE objects between 2021 and September 2024. The full set of plots can be found in Annex A, but the plot for Q1 2021 (id 15) is of particular interest.\n\ni = 15\nplot(st_kde, quarter_numbers[i], override.par=FALSE, fix.range=TRUE, main=paste(\"Spatial-temporal KDE for\", quarters[i]))"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.6-high-conflict-areas-of-interest",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.6-high-conflict-areas-of-interest",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.6 High Conflict Areas of Interest",
    "text": "TH1.6 High Conflict Areas of Interest\nThe preliminary KDE plot identified large clusters of armed conflict in the Yangon area in the south off the Andaman sea, as well as the Saigaing and Chin areas to the central-west. These indications make good candidates for further investigation.\nAdditionally, we will be exploring the Rakhine state area bordering Bangladesh, and the Kra Isthmus, the narrow isthmus linking central Thailand to Peninsula Malaysia. Rakhine state is the epicentre of the Rohingya crisis facing the eponymous Muslim ethnic group, which has actually been facing discrimination since the late 1970s\n\nTH1.6.1 Fixed-bandwidth KDE\n\n\nTH1.6.2 Adaptive-bandwidth KDE\n\n\nTH1.6.3 Nearest neighbour analysis\n\n\nTH1.6.4 Second order spatial point patterns analysis\n\nTH1.6.4.1 F-function\n\n\nTH1.6.4.2 G-function\n\n\nTH1.6.4.3 K-function\n\n\nTH1.6.4.4 L-function"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.7-rakhine-state",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.7-rakhine-state",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.7 Rakhine State",
    "text": "TH1.7 Rakhine State\n\nTH1.7.1 Fixed-bandwidth KDE\n\n\nTH1.7.2 Adaptive-bandwidth KDE\n\n\nTH1.7.3 Nearest neighbour analysis\n\n\nTH1.7.4 Second order spatial point patterns analysis\n\nTH1.7.4.1 F-function\n\n\nTH1.7.4.2 G-function\n\n\nTH1.7.4.3 K-function\n\n\nTH1.7.4.4 L-function"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.6-first-order-stppa-spatio-temporal-kde",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.6-first-order-stppa-spatio-temporal-kde",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.6 First Order STPPA: Spatio-temporal KDE",
    "text": "TH1.6 First Order STPPA: Spatio-temporal KDE"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.7-first-order-sppa-nearest-neighbour-analysis",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.7-first-order-sppa-nearest-neighbour-analysis",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.7 First-order SPPA: Nearest Neighbour Analysis",
    "text": "TH1.7 First-order SPPA: Nearest Neighbour Analysis\nTo determine whether the plotted armed conflict events are clustered, dispersed or random, we can use the Clark-Evans test. Since tensions between Myanmar’s different ethnic groups already existed before the 2021 coup, it would be a good idea to run the test on the subsets of data both before and after the coup."
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.7-second-order-sppa",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.7-second-order-sppa",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.7 Second-order SPPA",
    "text": "TH1.7 Second-order SPPA\nSecond order SPPA deals with variations in observations due to the way they interact with one another. The methods used for second order SPPA are the F-, G-, K- and L-functions. In this section, we will perform second-order SPPA on the conflict dataset, applying the F-, G-, K- and L-functions on subsets of the data before and after the 2021 coup.\n\nTH1.7.1 F-function\n\n\nTH1.7.2 G-function\n\n\nTH1.7.3 K-function\n\n\nTH1.7.4 L-function"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#annex-b-all-quarterly-fixed-bandwidth-kde-plots",
    "href": "TakeHome/TakeHome1/take-home-1.html#annex-b-all-quarterly-fixed-bandwidth-kde-plots",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "Annex B: All quarterly fixed-bandwidth KDE plots",
    "text": "Annex B: All quarterly fixed-bandwidth KDE plots"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#annex-c-all-quarterly-adaptive-bandwidth-kde-plots",
    "href": "TakeHome/TakeHome1/take-home-1.html#annex-c-all-quarterly-adaptive-bandwidth-kde-plots",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "Annex C: All quarterly adaptive-bandwidth KDE plots",
    "text": "Annex C: All quarterly adaptive-bandwidth KDE plots"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#annex-a-full-quarterly-stkde-plots-for-jan-2021--sep-2024",
    "href": "TakeHome/TakeHome1/take-home-1.html#annex-a-full-quarterly-stkde-plots-for-jan-2021--sep-2024",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "Annex A: Full Quarterly STKDE Plots for Jan 2021- Sep 2024",
    "text": "Annex A: Full Quarterly STKDE Plots for Jan 2021- Sep 2024\n\nA1: Full STKDE Plots\n\nfor (i in 1: length(quarter_numbers)) {\n  plot(st_kde, quarter_numbers[i], override.par=FALSE, fix.range=TRUE, main=paste(\"Spatial-temporal KDE for\", quarters[i]))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA2: For events with civilian targeting only\n\nfor (i in 1: length(quarter_numbers)) {\n  plot(st_kde_againstCivilians, quarter_numbers[i], override.par=FALSE, fix.range=TRUE, main=paste(\"Spatial-temporal KDE for violence against civilians events in quarter\", quarters[i]))\n}"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.5-preliminary-analysis",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.5-preliminary-analysis",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.5 Preliminary analysis",
    "text": "TH1.5 Preliminary analysis\n\nTH1.5.1 Exploratory Data Analysis (EDA)\nWe can quickly gain some meaningful insights from our dataset using basic EDA techniques. For instance, with the following code chunk, we can retrieve the total number of fatalities from the armed violence during the study period on a quarterly basis, and print its corresponding summary statistics.\n\nTH1.5.1.1 Getting yearly and quarterly distribution of fatalities and summary statistics\n\nacled_mya_fatalities_by_quarter &lt;- acled_mya_sf %&gt;%\n  group_by(Quarter_num) %&gt;%\n  summarise(`All fatalities` = sum(fatalities)) %&gt;%\n  ungroup()\n# acled_mya_fatalities_by_quarter\nsummary(acled_mya_fatalities_by_quarter)\n\n  Quarter_num   All fatalities          geometry \n Min.   : 1.0   Min.   : 803   MULTIPOINT   :15  \n 1st Qu.: 4.5   1st Qu.:3640   epsg:32647   : 0  \n Median : 8.0   Median :3955   +proj=utm ...: 0  \n Mean   : 8.0   Mean   :3935                     \n 3rd Qu.:11.5   3rd Qu.:4798                     \n Max.   :15.0   Max.   :5862                     \n\n\nOn average, we can establish that 3935 people die from the armed violence each quarter.\n\nacled_mya_fatalities_by_year &lt;- acled_mya_sf %&gt;%\n  group_by(year) %&gt;%\n  summarise(`All fatalities` = sum(fatalities)) %&gt;%\n  ungroup()\n\nggplot(acled_mya_fatalities_by_year, aes(x=year, y=`All fatalities`)) +\n  geom_bar(stat = \"identity\", fill = \"darkgreen\") +\n      labs(title = \"Fatalities by year in Myanmar\",\n         x = \"Year\",\n         y = \"All Fatalities\") +\n    theme_minimal()\n\n\n\n\n\n\n\n\n\n\nTH1.5.1.2 Plotting yearly and quarterly distribution of fatalities as a line chart\n\nggplot(acled_mya_fatalities_by_quarter, aes(x=Quarter_num, y=`All fatalities`)) +     \n  # geom_bar(stat = \"identity\", fill = \"red4\") +\n  geom_line(color = \"red4\") + geom_point() +\n    labs(title = \"Total Fatalities from the Armed Conflict in Myanmar by Quarter\", subtitle = \"1 = Q1 2021, 6 = Q2 2022, 11 = Q3 2023, 15 = Q3 2024\",\n         x = \"Quarter\",\n         y = \"All Fatalities\") +\n    theme_minimal()\n\n\n\n\n\n\n\n\nThere were fewer deaths from armed conflict in the first three quarters of 2021 - at the very start of the conflict - than Q4 2021 onwards.\n\n\nTH1.5.1.3 Getting quarterly distribution of incidents involving civilian targeting\nUsing the same code structure, we can also plot the distribution of armed conflict events involving civilian targeting.\n\nacled_mya_civilianTargeting_by_quarter &lt;- acled_mya_sf %&gt;%\n  group_by(Quarter_num) %&gt;%\n  summarise(\n    Count = n(),\n    Civilians_targeted = sum(civilian_targeting == \"Civilian targeting\", na.rm = TRUE)\n  ) %&gt;%\n  mutate(Percentage_incidents_civilians_targeting = (Civilians_targeted / Count) * 100) %&gt;%\n  ungroup()\n# acled_mya_civilianTargeting_by_quarter\nsummary(acled_mya_civilianTargeting_by_quarter)\n\n  Quarter_num       Count      Civilians_targeted          geometry \n Min.   : 1.0   Min.   :2100   Min.   :354.0      MULTIPOINT   :15  \n 1st Qu.: 4.5   1st Qu.:3229   1st Qu.:641.5      epsg:32647   : 0  \n Median : 8.0   Median :3689   Median :697.0      +proj=utm ...: 0  \n Mean   : 8.0   Mean   :3577   Mean   :681.8                        \n 3rd Qu.:11.5   3rd Qu.:3999   3rd Qu.:758.0                        \n Max.   :15.0   Max.   :4727   Max.   :841.0                        \n Percentage_incidents_civilians_targeting\n Min.   : 9.581                          \n 1st Qu.:18.388                          \n Median :20.279                          \n Mean   :19.629                          \n 3rd Qu.:22.451                          \n Max.   :26.961                          \n\nggplot(acled_mya_civilianTargeting_by_quarter, aes(x=Quarter_num, y=Percentage_incidents_civilians_targeting)) +     \n  # geom_bar(stat = \"identity\", fill = \"red4\") +\n  geom_line(color = \"skyblue1\") + geom_point() +\n    labs(title = \"Percentage of Incidents involving civilian targeting in Myanmar by Quarter\", subtitle = \"1 = Q1 2021, 6 = Q2 2022, 11 = Q3 2023, 15 = Q3 2024\",\n         x = \"Quarter\",\n         y = \"% Incidents with civilian targeting\") +\n    theme_minimal()\n\n\n\n\n\n\n\n\nThe percentage of violent conflict incidents targeting civilians trended upwards throughout the study duration. On average, 19.6% of all armed conflict incidents throughout the study period targeted civilians.\n\n\nTH1.5.1.4 Plotting proportion of fatalities by type of conflict\nWe can also plot the proportion of fatalities by the type of conflict. The ACLED classifies armed conflict events by mode and intensity of attack and by whether civilians are targeted. From the graph and pie chart below, the largest proportion of fatalities comes from battles, closely followed by explosions and remote violence. However, violence against civilians makes up a sizable 11.4% of fatalities over the study period.\n\nunique(acled_mya_sf$event_type)\n\n[1] \"Battles\"                    \"Explosions/Remote violence\"\n[3] \"Strategic developments\"     \"Protests\"                  \n[5] \"Violence against civilians\" \"Riots\"                     \n\n\n\nacled_mya_fatalities_by_event_type &lt;- acled_mya_sf %&gt;%\n  group_by(event_type) %&gt;%\n  summarise(`All fatalities` = sum(fatalities)) %&gt;%\n  ungroup()\nsummary(acled_mya_fatalities_by_event_type)\n\n  event_type        All fatalities             geometry\n Length:6           Min.   :  127.0   MULTIPOINT   :6  \n Class :character   1st Qu.:  288.8   epsg:32647   :0  \n Mode  :character   Median : 3556.0   +proj=utm ...:0  \n                    Mean   : 9838.2                    \n                    3rd Qu.:11037.5                    \n                    Max.   :39059.0                    \n\n\n\nggplot(acled_mya_fatalities_by_event_type, aes(x=event_type, y=`All fatalities`)) +\n  geom_bar(stat = \"identity\", fill = \"red4\") +\n      labs(title = \"Fatalities by event type in Myanmar\",\n         x = \"Event type\",\n         y = \"All Fatalities\") +\n    theme_minimal()\n\n\n\n\n\n\n\n\n\ntotal_fatalities &lt;- sum(acled_mya_fatalities_by_event_type$`All fatalities`)\npercentages &lt;- 100 * acled_mya_fatalities_by_event_type$`All fatalities` / total_fatalities\n\n# Set plotting area size\npar(mar = c(1, 1, 2, 1))  # Adjust margins if needed\n\npie(acled_mya_fatalities_by_event_type$`All fatalities`, labels = paste0(round(percentages, 1), \"%\"), \n    col = rainbow(length(acled_mya_fatalities_by_event_type$event_type)), \n    main = \"Fatalities by event type in Myanmar\",\n    cex = 1  \n)\n    \nlegend(\"topright\", paste(acled_mya_fatalities_by_event_type$event_type, \":\", round(percentages, 1), \"%\"), fill = rainbow(length(acled_mya_fatalities_by_event_type$event_type)), cex = 0.7)\n\n\n\n\n\n\n\n\nWe can further narrow down the scope of this analysis by limiting our data to a certain year, and to events where the civilian_targeting column is filled. The year 2022 saw the highest fatality numbers across the entire study period, so we shall take a closer look.\n\nacled_mya_fatalities_by_event_type_2022 &lt;- acled_mya_sf %&gt;%\n  filter(year == \"2022\") %&gt;%\n  filter(civilian_targeting == \"Civilian targeting\") %&gt;%\n  group_by(event_type) %&gt;%\n  summarise(`All fatalities` = sum(fatalities)) %&gt;%\n  ungroup()\n\nggplot(acled_mya_fatalities_by_event_type_2022, aes(x=event_type, y=`All fatalities`)) +\n  geom_bar(stat = \"identity\", fill = \"red4\") +\n      labs(title = \"Fatalities by event type in 2022 with civilian_targeting filled\",\n         x = \"Quarter\",\n         y = \"All Fatalities\") +\n    theme_minimal()\n\n\n\n\n\n\n\n\n\n\nTH1.5.1.5 Mapping fatalities and violence against civilians\nFinally, we can plot choropleth maps displaying 2 crucial pieces of information: the locations with the greatest number of fatalities, and the locations where civilians are targeted in the violence the most in 2022. In the code chunks we will write to create the plots, we have to refer to the original tibble objects instead of the sf objects.\n\nacled_mya_fatalities_by_admin1_2022 &lt;- acled_mya %&gt;%\n  filter(year == 2022) %&gt;%\n  mutate(admin1 = case_when(\n      admin1 %in% c(\"Shan-North\", \"Shan-South\", \"Shan-East\") ~ \"Shan\",\n      admin1 %in% c(\"Bago-East\", \"Bago-West\") ~ \"Bago\",\n      TRUE ~ admin1\n    )) %&gt;%\n  group_by(admin1) %&gt;%\n  summarise(`All_Fatalities` = sum(fatalities)) %&gt;%\n  ungroup()\ncombined &lt;- left_join(mmr_admin1, acled_mya_fatalities_by_admin1_2022, by = c(\"ST\" = \"admin1\"))\ntm_shape(combined) + \n  tm_fill(\"All_Fatalities\", n = 8, style = \"kmeans\") + \n  tm_borders(alpha = 0.5) + \n  tm_layout(title = \"admin1 by number of fatalities, 2022\", legend.outside = TRUE)\n\n\n\n\n\n\n\n\nThe above map shows Sagaing region as the location with the highest number of fatalities in 2022, followed by Magaway region.\n\n#|echo: false\ncombined\n\nSimple feature collection with 15 features and 7 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -210008.6 ymin: 1072026 xmax: 724647.6 ymax: 3158467\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 10 features:\n   OBJECTID          ST ST_PCODE           ST_RG          ST_MMR PCode_V\n1         1  Ayeyarwady   MMR017          Region  ဧရာဝတီတိုင်းဒေသကြီး     9.4\n2         2        Bago   MMR111          Region    ပဲခူးတိုင်းဒေသကြီး     9.4\n3         4        Chin   MMR004           State       ချင်းပြည်နယ်     9.4\n4         5      Kachin   MMR001           State       ကချင်ပြည်နယ်     9.4\n5         6       Kayah   MMR002           State       ကယားပြည်နယ်     9.4\n6         7       Kayin   MMR003           State        ကရင်ပြည်နယ်     9.4\n7         8      Magway   MMR009          Region   မကွေးတိုင်းဒေသကြီး     9.4\n8         9    Mandalay   MMR010          Region မန္တလေးတိုင်းဒေသကြီး     9.4\n9        10         Mon   MMR011           State         မွန်ပြည်နယ်     9.4\n10       11 Nay Pyi Taw   MMR018 Union Territory        နေပြည်တော်     9.4\n   All_Fatalities                       geometry\n1              57 MULTIPOLYGON (((93411.72 17...\n2             364 MULTIPOLYGON (((203949.9 21...\n3            1158 MULTIPOLYGON (((-72918.03 2...\n4             756 MULTIPOLYGON (((362696.3 31...\n5            1008 MULTIPOLYGON (((309155.7 22...\n6            1021 MULTIPOLYGON (((373551.3 18...\n7            2488 MULTIPOLYGON (((-1717.607 2...\n8            1068 MULTIPOLYGON (((208184.3 26...\n9             711 MULTIPOLYGON (((364238.4 16...\n10             13 MULTIPOLYGON (((220155 2248...\n\n\n\nacled_mya_civiliansTargeted_by_admin1_2022 &lt;- acled_mya %&gt;%\n  filter(year == 2022) %&gt;%\n  mutate(admin1 = case_when(\n      admin1 %in% c(\"Shan-North\", \"Shan-South\", \"Shan-East\") ~ \"Shan\",\n      admin1 %in% c(\"Bago-East\", \"Bago-West\") ~ \"Bago\",\n      TRUE ~ admin1\n    )) %&gt;%\n  group_by(admin1) %&gt;%\n  summarise(\n    count = n(),\n    Civilians_targeted = sum(civilian_targeting == \"Civilian targeting\", na.rm = TRUE)\n  )%&gt;%\n  ungroup() %&gt;%\n  mutate(`%_with_Civilian_Targeting` = (`Civilians_targeted` / `count`) * 100)\n# acled_mya_civiliansTargeted_by_admin1_2022\ncombined &lt;- left_join(mmr_admin1, acled_mya_civiliansTargeted_by_admin1_2022, by = c(\"ST\" = \"admin1\"))\n# combined\ntm_shape(combined) + \n  tm_fill(\"%_with_Civilian_Targeting\", n = 8, style = \"kmeans\") + \n  tm_borders(alpha = 0.5) + \n  tm_layout(title = \"admin1 by % of incidents targeting civilians, 2022\", legend.outside = TRUE)\n\n\n\n\n\n\n\n\nThe above map shows that the highest proportion of armed conflicts in the westernmost Rakhine state and easternmost Shan state involves violence against civilians. This state is the epicentre of the 2017 Rohingya crisis facing the eponymous Muslim ethnic group, discrimination against whom, in fact, goes as far back as the 1970s (Albert & Maizland, 2020). In joint second are the regions of Bago and Yangon.\n\n\n\nTH1.5.2 Overarching Spatial-Temporal KDE\nNext, we can try spatial-temporal kernel density estimation (STKDE) on the entire study area and period. As always, we start by creating ppp objects out of our sf objects, and checking for duplicates.\n\nacled_mya_sf_quarters &lt;- acled_mya_sf %&gt;% select(Quarter_num)\nacled_mya_quarters_ppp &lt;- as.ppp(acled_mya_sf_quarters)\nacled_mya_quarters_ppp\n\nMarked planar point pattern: 53653 points\nmarks are numeric, of storage type  'double'\nwindow: rectangle = [-208804.4, 640934.5] x [1103500.1, 3042960.3] units\n\nany(duplicated(acled_mya_quarters_ppp))\n\n[1] TRUE\n\n\nSince there are duplicates, we need to handle them using jittering.\n\nacled_mya_quarters_ppp &lt;- rjitter(acled_mya_quarters_ppp, retry=TRUE, nsim=1, drop=TRUE)\nany(duplicated(acled_mya_quarters_ppp))\n\n[1] FALSE\n\n\nFinally, we join the owin object mapping the borders of Myanmar to the ppp object.\n\nacled_mya_quarters_ppp &lt;- acled_mya_quarters_ppp[mmr_admin1_owin]\nplot(acled_mya_quarters_ppp)\n\n\n\n\n\n\n\n\nWe can now perform spatial-temporal KDE (STKDE).\n\nst_kde &lt;- spattemp.density(acled_mya_quarters_ppp)\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\nsummary(st_kde)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 42825.74 (spatial)\n  lambda = 0.0051 (temporal)\n\nNo. of observations\n  53571 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 15]\n\nEvaluation\n  128 x 128 x 15 trivariate lattice\n  Density range: [9.512004e-26, 2.087401e-10]\n\n\nAfter performing STKDE, we are able to plot the quarterly STKDE objects between January 2021 and September 2024. The full set of plots can be found in Annex A, but the plot for Q1 2021 (id 15) is of particular interest because of the larger than usual densities around the Sagaing and Chin areas, as well as near Yangon.\n\ni = 15\nplot(st_kde, quarter_numbers[i], override.par=FALSE, fix.range=TRUE, main=paste(\"Spatial-temporal KDE for\", quarters[i]))\n\n\n\n\n\n\n\n\n\n\nTH1.5.3 STKDE on Data Subset\nKnowing that a significant part of the armed violence in Myanmar is due to systemic discrimination on the part of the government or military, it would make sense to repeat the process and plot STKDEs on the subset of the data concerning violence against civilians. The full plots can also be found in Annex A.\n\n\n[1] \"Battles\"                    \"Explosions/Remote violence\"\n[3] \"Strategic developments\"     \"Protests\"                  \n[5] \"Violence against civilians\" \"Riots\"                     \n\n\n\nacled_sf_againstCivilians &lt;- acled_mya_sf %&gt;% filter(event_type == \"Violence against civilians\")\n# acled_sf_againstCivilians\nacled_sf_againstCivilians &lt;- acled_sf_againstCivilians %&gt;% select(Quarter_num)\n\n\nacled_mya_againstCivilians_ppp &lt;- as.ppp(acled_sf_againstCivilians)\nany(duplicated(acled_mya_againstCivilians_ppp))\n\n[1] TRUE\n\nacled_mya_againstCivilians_ppp &lt;- rjitter(acled_mya_againstCivilians_ppp, retry=TRUE, nsim=1, drop=TRUE)\nany(duplicated(acled_mya_againstCivilians_ppp))\n\n[1] FALSE\n\nacled_mya_againstCivilians_ppp &lt;- acled_mya_againstCivilians_ppp[mmr_admin1_owin]\nplot(acled_mya_againstCivilians_ppp)\n\n\n\n\n\n\n\n\n\nst_kde_againstCivilians &lt;- spattemp.density(acled_mya_quarters_ppp)\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\nsummary(st_kde_againstCivilians)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 42825.74 (spatial)\n  lambda = 0.0051 (temporal)\n\nNo. of observations\n  53571 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 15]\n\nEvaluation\n  128 x 128 x 15 trivariate lattice\n  Density range: [9.512004e-26, 2.087401e-10]\n\nplot(st_kde_againstCivilians, quarter_numbers[15], override.par=FALSE, fix.range=TRUE, main=paste(\"Spatial-temporal KDE for violence against civilians events in quarter\", quarters[i]))"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.6-zooming-in",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.6-zooming-in",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.6 Zooming in",
    "text": "TH1.6 Zooming in\nSTKDE on the entire country has not been able to yield satisfactory results thus far. Despite this, though, the preliminary KDE plot identified large clusters of armed conflict in the Yangon area in the south off the Andaman sea, as well as the Sagaing region and Chin state to the central-west. At the same time, from the chropleth maps, Yangon was shown as the area with the second highest degree of civilian targeting, while Sagaing had the most fatalities from the conflict.\nIt might be more effective to select a subset of regions and perform SPPA and STPPA by region. From our EDA and overarching STKDE, focusing on Sagaing, Shan, Rakhine, Chin and Yangon makes the most sense. Additionally, an analysis on the Tanintharyi region will cover the Kra Isthmus, the narrow isthmus linking central Thailand to Peninsula Malaysia, to study the scale of the part of the conflict that is geographically closest to the more stable and prosperous Malaysia and Singapore."
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.7-spatial-point-patterns-analysis",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.7-spatial-point-patterns-analysis",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.7 Spatial Point Patterns Analysis",
    "text": "TH1.7 Spatial Point Patterns Analysis\n\nTH1.7.1 Extracting and plotting study areas\nThe first step is to extract the study areas and create owin objects.\n\nstudy_names &lt;- c(\"Sagaing\", \"Shan\", \"Rakhine\", \"Chin\", \"Yangon\", \"Tanintharyi\")\nstudy_areas &lt;- list(\"Sagaing\" = (mmr_admin1 %&gt;% filter(ST == \"Sagaing\")),\n                    \"Shan\" = (mmr_admin1 %&gt;% filter(ST == \"Shan\")),\n                    \"Rakhine\" = (mmr_admin1 %&gt;% filter(ST == \"Rakhine\")),\n                    \"Chin\" = (mmr_admin1 %&gt;% filter(ST == \"Chin\")),\n                    \"Yangon\" = (mmr_admin1 %&gt;% filter(ST == \"Yangon\")),\n                    \"Tanintharyi\" = (mmr_admin1 %&gt;% filter(ST == \"Tanintharyi\"))\n)\npar(mfrow = c(1, 4))\nfor (study_name in study_names) {\n  print(paste(\"Study area:\", study_name))\n  plot(study_areas[[study_name]], main = study_name) \n}\n\n[1] \"Study area: Sagaing\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Shan\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Rakhine\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Chin\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Yangon\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Tanintharyi\"\n\n\n\n\n\n\n\n\nstudy_ppps &lt;- list()\npar(mfrow = c(1, 3))\nfor (study_name in study_names) {\n  print(paste(\"Creating ppp for\", study_name))\n  study_owin &lt;- as.owin(study_areas[[study_name]])\n  study_ppps[[study_name]] &lt;- rescale.ppp(acled_mya_quarters_ppp[study_owin], 1000, \"km\")\n  plot(study_ppps[[study_name]], main=paste(\"ppp for\", study_name))\n}\n\n[1] \"Creating ppp for Sagaing\"\n\n\n[1] \"Creating ppp for Shan\"\n\n\n[1] \"Creating ppp for Rakhine\"\n\n\n\n\n\n\n\n\n\n[1] \"Creating ppp for Chin\"\n\n\n[1] \"Creating ppp for Yangon\"\n\n\n[1] \"Creating ppp for Tanintharyi\"\n\n\n\n\n\n\n\n\n\n\n\nTH1.6.2 Fixed-bandwidth KDE\n\nfixed_bandwidth_kde_acled &lt;- list()\npar(mfrow = c(1, 3))\nfor (study_name in study_names) {\n  fixed_bandwidth_kde_acled[[study_name]] &lt;- density(study_ppps[[study_name]],\n               sigma=bw.scott,\n               edge=TRUE,\n               kernel=\"gaussian\"\n               )\n  plot(fixed_bandwidth_kde_acled[[study_name]], \n       main = paste(\"Fixed-bandwidth KDE for\", study_name))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTH1.6.3 Adaptive-bandwidth KDE\n\nadaptive_bandwidth_kde_acled &lt;- list()\npar(mfrow = c(1, 3))\nfor (study_name in study_names) {\n  adaptive_bandwidth_kde_acled[[study_name]] &lt;- adaptive.density(study_ppps[[study_name]],\n               method = \"kernel\"\n               )\n  plot(adaptive_bandwidth_kde_acled[[study_name]], \n       main = paste(\"Adaptive-bandwidth KDE for\", study_name))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFixed bandwidth KDE using bw.scott and the gaussian kernel returned a more meaningful result than adaptive bandwidth KDE.\nJust for completeness, we will now attempt to map the results of fixed-bandwidth KDE for Rakhine state by creating a RasterLayer.\n\nrakhine_kde &lt;- fixed_bandwidth_kde_acled[[\"Rakhine\"]]\ngridded &lt;- as(rakhine_kde, \"SpatialGridDataFrame\")\nspplot(gridded)\n\n\n\n\n\n\n\nraster &lt;- raster(rakhine_kde)\nprojection(raster) &lt;- CRS(\"+init=EPSG:32647\")\ntm_shape(raster) + tm_raster(\"layer\", palette = \"viridis\") + tm_layout(legend.position = c(\"left\", \"bottom\"), frame = FALSE)\n\n\n\n\n\n\n\n\n\n\nTH1.6.4 Spatial-temporal KDE\nWe can also plot spatial-temporal KDEs for each of our selected regions. The full plots can be found in Annex B.\n\nstkde_six_regions &lt;- list()\nfor (study_name in study_names) {\n  print(study_name)\n  stkde_six_regions[[study_name]] &lt;- spattemp.density(study_ppps[[study_name]])\n}\n\n[1] \"Sagaing\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Shan\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Rakhine\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Chin\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Yangon\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Tanintharyi\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n\n\nTH1.6.5 Nearest neighbour analysis\nFor each of the 6 regions we are analysing, we can use nearest neighbour analysis to find out whether the spatial point patterns of our armed conflict events exhibit clustering, dispersion or random distribution. The nearest neighbour analysis is done by performing the Clark-Evans test on the hypothesis that the distribution of armed conflict events is random.\n\nfor (study_name in study_names) {\n  print(study_name)\n  ppp &lt;- study_ppps[[study_name]]\n  # plot(ppp)\n  print(clarkevans.test(ppp, correction = \"none\", clipregion = NULL, alternative = c(\"two.sided\"), nsim = 99))\n}\n\n[1] \"Sagaing\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.16523, p-value &lt; 2.2e-16\nalternative hypothesis: two-sided\n\n[1] \"Shan\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.16189, p-value &lt; 2.2e-16\nalternative hypothesis: two-sided\n\n[1] \"Rakhine\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.21369, p-value &lt; 2.2e-16\nalternative hypothesis: two-sided\n\n[1] \"Chin\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.17452, p-value &lt; 2.2e-16\nalternative hypothesis: two-sided\n\n[1] \"Yangon\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.13365, p-value &lt; 2.2e-16\nalternative hypothesis: two-sided\n\n[1] \"Tanintharyi\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.12985, p-value &lt; 2.2e-16\nalternative hypothesis: two-sided\n\n\n\n\nTH1.6.5 Second order spatial point patterns analysis\n\nTH1.6.5.1 F-function\n\n\nTH1.6.5.2 G-function\n\n\nTH1.6.5.3 K-function\n\n\nTH1.6.5.4 L-function"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#annex-b-region-specific-stkde-plots",
    "href": "TakeHome/TakeHome1/take-home-1.html#annex-b-region-specific-stkde-plots",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "Annex B: Region-specific STKDE plots",
    "text": "Annex B: Region-specific STKDE plots\n\nfor (study_name in study_names) {\n  for (i in 1: length(quarter_numbers)) {\n    print(study_name)\n    print(quarter_numbers[i])\n    plot(stkde_six_regions[[study_name]], quarter_numbers[i], override.par=FALSE, fix.range=TRUE, main=paste(\"STKDE for\", study_name , \"in quarter\", quarters[i]))\n  }\n}\n\n[1] \"Sagaing\"\n[1] 15\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 14\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 13\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 12\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 11\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 10\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 9\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 8\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 7\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 6\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 5\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 4\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 3\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 2\n\n\n\n\n\n\n\n\n\n[1] \"Sagaing\"\n[1] 1\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 15\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 14\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 13\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 12\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 11\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 10\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 9\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 8\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 7\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 6\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 5\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 4\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 3\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 2\n\n\n\n\n\n\n\n\n\n[1] \"Shan\"\n[1] 1\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 15\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 14\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 13\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 12\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 11\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 10\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 9\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 8\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 7\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 6\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 5\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 4\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 3\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 2\n\n\n\n\n\n\n\n\n\n[1] \"Rakhine\"\n[1] 1\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 15\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 14\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 13\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 12\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 11\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 10\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 9\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 8\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 7\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 6\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 5\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 4\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 3\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 2\n\n\n\n\n\n\n\n\n\n[1] \"Chin\"\n[1] 1\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 15\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 14\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 13\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 12\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 11\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 10\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 9\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 8\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 7\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 6\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 5\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 4\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 3\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 2\n\n\n\n\n\n\n\n\n\n[1] \"Yangon\"\n[1] 1\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 15\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 14\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 13\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 12\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 11\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 10\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 9\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 8\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 7\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 6\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 5\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 4\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 3\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 2\n\n\n\n\n\n\n\n\n\n[1] \"Tanintharyi\"\n[1] 1"
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.7-first-order-spatial-point-patterns-analysis",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.7-first-order-spatial-point-patterns-analysis",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.7 First-order Spatial Point Patterns Analysis",
    "text": "TH1.7 First-order Spatial Point Patterns Analysis\n\nTH1.7.1 Extracting and plotting study areas\nThe first step is to extract the study areas and create owin objects.\n\nstudy_names &lt;- c(\"Sagaing\", \"Shan\", \"Rakhine\", \"Chin\", \"Yangon\", \"Tanintharyi\")\nstudy_areas &lt;- list(\"Sagaing\" = (mmr_admin1 %&gt;% filter(ST == \"Sagaing\")),\n                    \"Shan\" = (mmr_admin1 %&gt;% filter(ST == \"Shan\")),\n                    \"Rakhine\" = (mmr_admin1 %&gt;% filter(ST == \"Rakhine\")),\n                    \"Chin\" = (mmr_admin1 %&gt;% filter(ST == \"Chin\")),\n                    \"Yangon\" = (mmr_admin1 %&gt;% filter(ST == \"Yangon\")),\n                    \"Tanintharyi\" = (mmr_admin1 %&gt;% filter(ST == \"Tanintharyi\"))\n)\npar(mfrow = c(1, 4))\nfor (study_name in study_names) {\n  print(paste(\"Study area:\", study_name))\n  plot(study_areas[[study_name]], main = study_name) \n}\n\n[1] \"Study area: Sagaing\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Shan\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Rakhine\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Chin\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Yangon\"\n\n\n\n\n\n\n\n\n\n[1] \"Study area: Tanintharyi\"\n\n\n\n\n\n\n\n\nstudy_ppps &lt;- list()\nstudy_ppps_original &lt;- list()\nstudy_owins &lt;- list()\npar(mfrow = c(1, 3))\nfor (study_name in study_names) {\n  print(paste(\"Creating ppp for\", study_name))\n  study_owin &lt;- as.owin(study_areas[[study_name]])\n  study_owins[[study_name]] &lt;- study_owin\n  study_ppps_original[[study_name]] &lt;- acled_mya_quarters_ppp[study_owin]\n  study_ppps[[study_name]] &lt;- rescale.ppp(acled_mya_quarters_ppp[study_owin], 1000, \"km\")\n  plot(study_ppps[[study_name]], main=paste(\"ppp for\", study_name))\n}\n\n[1] \"Creating ppp for Sagaing\"\n\n\n[1] \"Creating ppp for Shan\"\n\n\n[1] \"Creating ppp for Rakhine\"\n\n\n\n\n\n\n\n\n\n[1] \"Creating ppp for Chin\"\n\n\n[1] \"Creating ppp for Yangon\"\n\n\n[1] \"Creating ppp for Tanintharyi\"\n\n\n\n\n\n\n\n\n\n\n\nTH1.7.2 Fixed-bandwidth KDE\n\nfixed_bandwidth_kde_acled &lt;- list()\npar(mfrow = c(1, 3))\nfor (study_name in study_names) {\n  fixed_bandwidth_kde_acled[[study_name]] &lt;- density(study_ppps[[study_name]],\n               sigma=bw.scott,\n               edge=TRUE,\n               kernel=\"gaussian\"\n               )\n  plot(fixed_bandwidth_kde_acled[[study_name]], \n       main = paste(\"Fixed-bandwidth KDE for\", study_name))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe fixed-bandwidth KDE returned dense clusters at the following areas for each state or region:\n\nSagaing region: toward the south and southwest\nShan state: towards the northwest, with a secondary cluster towards the southwest\nRakhine state: one large cluster towards the northwest\nChin state: one cluster in the central-north and southeast\nYangon region: one dense cluster towards the south coast\nTanintharyi region: one dense cluster skirting the northwest coast\n\n\n\nTH1.7.3 Adaptive-bandwidth KDE\n\nadaptive_bandwidth_kde_acled &lt;- list()\npar(mfrow = c(1, 3))\nfor (study_name in study_names) {\n  adaptive_bandwidth_kde_acled[[study_name]] &lt;- adaptive.density(study_ppps[[study_name]],\n               method = \"kernel\"\n               )\n  plot(adaptive_bandwidth_kde_acled[[study_name]], \n       main = paste(\"Adaptive-bandwidth KDE for\", study_name))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFixed bandwidth KDE using bw.scott and the gaussian kernel returned a more meaningful result than adaptive bandwidth KDE.\nThe bw.scott method applies Scott’s Rule for Bandwidth Selection for Kernel Density (Scott, 1992), which calculates a bandwidth \\(\\sigma\\) that is proportional to \\(n^{\\frac{-1}{d-4}}\\), for number of points \\(n\\) and number of spatial dimension \\(d\\). This rule is fast to compute and, as we’ve seen, was able to produce a larger bandwidth than the mean-square error criterion defined with the bw.diggle() method (Diggle, 1985)\nJust for completeness, we will now attempt to map the results of fixed-bandwidth KDE for Rakhine state by creating a RasterLayer.\n\nrakhine_kde &lt;- fixed_bandwidth_kde_acled[[\"Rakhine\"]]\ngridded &lt;- as(rakhine_kde, \"SpatialGridDataFrame\")\nspplot(gridded)\n\n\n\n\n\n\n\n\n\nraster &lt;- raster(rakhine_kde)\nraster\n\nclass      : RasterLayer \ndimensions : 128, 128, 16384  (nrow, ncol, ncell)\nresolution : 2.158983, 3.656088  (x, y)\nextent     : -210.0086, 66.34123, 1921.825, 2389.805  (xmin, xmax, ymin, ymax)\ncrs        : NA \nsource     : memory\nnames      : layer \nvalues     : 0.0007077697, 0.3824713  (min, max)\n\nprojection(raster) &lt;- CRS(\"+init=EPSG:32647\")\nraster\n\nclass      : RasterLayer \ndimensions : 128, 128, 16384  (nrow, ncol, ncell)\nresolution : 2.158983, 3.656088  (x, y)\nextent     : -210.0086, 66.34123, 1921.825, 2389.805  (xmin, xmax, ymin, ymax)\ncrs        : +proj=utm +zone=47 +datum=WGS84 +units=m +no_defs \nsource     : memory\nnames      : layer \nvalues     : 0.0007077697, 0.3824713  (min, max)\n\n\n\ntm_shape(raster) + tm_raster(\"layer\", palette = \"viridis\") + tm_layout(legend.position = c(\"left\", \"bottom\"), frame = FALSE)\n\n\n\n\n\n\n\n\n\n\nTH1.7.4 Spatial-temporal KDE\nWe can also plot spatial-temporal KDEs for each of our selected regions. The full plots can be found in Annex B, but the results can be summarised as follows:\n\nIn Sagaing region, the bulk of the fighting took place in 2022 towards the south, before dying down thereafter.\nIn Shan state, fierce fighting took place towards the northwest at the start of the conflict in 2021 and gradually died down, surging again in 4Q 2023 and again in 3Q 2024.\nRakhine state saw little fighting from 2021 until 4Q 2023, when fighting intensified primarily towards the northwest, bordering Bangladesh.\nChin state witnessed the most fighting throughout the state in 1Q 2021.\nYangon saw brief periods of conflict in the first half of 2021, and\nTanintharyi region is largely spared, with small pockets towards its northwest.\n\n\nstkde_six_regions &lt;- list()\nfor (study_name in study_names) {\n  print(study_name)\n  stkde_six_regions[[study_name]] &lt;- spattemp.density(study_ppps[[study_name]])\n}\n\n[1] \"Sagaing\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Shan\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Rakhine\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Chin\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Yangon\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n[1] \"Tanintharyi\"\n\n\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n\n\n\n\nTH1.7.5 Nearest neighbour analysis\nFor each of the 6 regions we are analysing, we can use nearest neighbour analysis to find out whether the spatial point patterns of our armed conflict events exhibit clustering, dispersion or random distribution. The nearest neighbour analysis is done by performing the Clark-Evans test on the hypothesis that the distribution of armed conflict events is random.\n\nfor (study_name in study_names) {\n  print(study_name)\n  ppp &lt;- study_ppps[[study_name]]\n  # plot(ppp)\n  print(clarkevans.test(ppp, correction = \"none\", clipregion = NULL, alternative = c(\"clustered\"), nsim = 99))\n}\n\n[1] \"Sagaing\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.1643, p-value &lt; 2.2e-16\nalternative hypothesis: clustered (R &lt; 1)\n\n[1] \"Shan\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.16241, p-value &lt; 2.2e-16\nalternative hypothesis: clustered (R &lt; 1)\n\n[1] \"Rakhine\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.21242, p-value &lt; 2.2e-16\nalternative hypothesis: clustered (R &lt; 1)\n\n[1] \"Chin\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.18396, p-value &lt; 2.2e-16\nalternative hypothesis: clustered (R &lt; 1)\n\n[1] \"Yangon\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.13382, p-value &lt; 2.2e-16\nalternative hypothesis: clustered (R &lt; 1)\n\n[1] \"Tanintharyi\"\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  ppp\nR = 0.13163, p-value &lt; 2.2e-16\nalternative hypothesis: clustered (R &lt; 1)\n\n\nThe nearest neighbour analyses for all our regions returned identical p-values of 2.2e-16. Thus, we can conclude that the spatial point patterns for all our target regions are clustered. We can corroborate this test result with the fixed-bandwidth KDE visualisations, which indicate the presence of densely-packed conflict areas."
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.8-second-order-spatial-point-patterns-analysis",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.8-second-order-spatial-point-patterns-analysis",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.8 Second order spatial point patterns analysis",
    "text": "TH1.8 Second order spatial point patterns analysis\nSecond order SPPA investigates variations in observations due to the way they interact with one another. In this section, we will use the F- and G-functions to analyse the spatial point patterns in our 6 selected regions.\nThe F-function (nearest neighbor distribution) and G-function (empty space function) are limited to analyzing specific distances or single-scale proximity between points. Ripley’s K-function overcomes this issue among others- it valuates the distribution of points over a range of distances, giving insight into spatial clustering or dispersion at different scales. This makes it a more comprehensive analysis of spatial point patterns at multiple spatial scales, at the exepense of it being more computationally complex. An attempt to run Ripley’s K-function on armed conflict data in Sagaing - both for the entire study period and just in 2022 - led to a half-hour long freeze, so it will be omitted.\n\nTH1.8.1 Extracting study period\nThe functions run slower when fed with more data. Hence, we need to extract a smaller study period. Since the year 2022 saw more fatalities, it makes sense to extract only the events that occurred in 2022.\n\nacled_mya_2022_sf &lt;- acled_mya_sf %&gt;% filter(Quarter_num &gt;= 5 & Quarter_num &lt; 7) %&gt;% select(Quarter_num)\nacled_mya_2022_ppp &lt;- as.ppp(acled_mya_2022_sf)\nacled_mya_2022_ppp &lt;- rjitter(acled_mya_2022_ppp, retry=TRUE, nsim=1, drop=TRUE)\nstudy_ppps_2022 &lt;- list()\nfor (study_name in study_names) {\n  print(paste(\"Creating ppp for\", study_name))\n  study_owin &lt;- study_owins[[study_name]]\n  study_ppps_2022[[study_name]] &lt;- acled_mya_2022_ppp[study_owin]\n}\n\n[1] \"Creating ppp for Sagaing\"\n[1] \"Creating ppp for Shan\"\n[1] \"Creating ppp for Rakhine\"\n[1] \"Creating ppp for Chin\"\n[1] \"Creating ppp for Yangon\"\n[1] \"Creating ppp for Tanintharyi\"\n\n\n\n\nTH1.8.1 Sagaing Region\n\nTH1.8.1.1 G-function\n\nstudy_name = \"Sagaing\"\nG_function &lt;- Gest(study_ppps_2022[[study_name]], correction = \"border\")\nplot(G_function, xlim=c(0,500), main = paste(\"G-function estimation for\", study_name))\n\n\n\n\n\n\n\nG_csr &lt;- envelope(ppp, Gest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(G_csr, main = paste(\"G function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\nTH1.8.1.2 F-function\n\nF_function &lt;- Fest(study_ppps_2022[[study_name]])\nplot(F_function, xlim=c(0,500), main = paste(\"F-function estimation for\", study_name))\n\n\n\n\n\n\n\n\nError in bestlegendpos(...) : All objects were empty\n\nF_csr &lt;- envelope(ppp, Fest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(F_csr, main = paste(\"F function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\n\nTH1.8.2 Shan State\n\nTH1.8.2.1 G-function\n\nstudy_name = \"Shan\"\nG_function &lt;- Gest(study_ppps_2022[[study_name]], correction = \"border\")\nplot(G_function, xlim=c(0,500), main = paste(\"G-function estimation for\", study_name))\n\n\n\n\n\n\n\nG_csr &lt;- envelope(ppp, Gest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(G_csr, main = paste(\"G function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\nTH1.8.2.2 F-function\n\nF_function &lt;- Fest(study_ppps_2022[[study_name]])\nplot(F_function, xlim=c(0,500), main = paste(\"F-function estimation for\", study_name))\n\n\n\n\n\n\n\n\nError in bestlegendpos(...) : All objects were empty\n\nF_csr &lt;- envelope(ppp, Fest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(F_csr, main = paste(\"F function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\n\nTH1.8.3 Rakhine State\n\nTH1.8.3.1 G-function\n\nstudy_name = \"Rakhine\"\nG_function &lt;- Gest(study_ppps_2022[[study_name]], correction = \"border\")\nplot(G_function, xlim=c(0,500), main = paste(\"G-function estimation for\", study_name))\n\n\n\n\n\n\n\nG_csr &lt;- envelope(ppp, Gest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(G_csr, main = paste(\"G function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\nTH1.8.3.2 F-function\n\nF_function &lt;- Fest(study_ppps_2022[[study_name]])\nplot(F_function, xlim=c(0,500), main = paste(\"F-function estimation for\", study_name))\n\n\n\n\n\n\n\n\nError in bestlegendpos(...) : All objects were empty\n\nF_csr &lt;- envelope(ppp, Fest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(F_csr, main = paste(\"F function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\n\nTH1.8.4 Chin State\n\nTH1.8.4.1 G-function\n\nstudy_name = \"Chin\"\nG_function &lt;- Gest(study_ppps_2022[[study_name]], correction = \"border\")\nplot(G_function, xlim=c(0,500), main = paste(\"G-function estimation for\", study_name))\n\n\n\n\n\n\n\nG_csr &lt;- envelope(ppp, Gest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(G_csr, main = paste(\"G function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\nTH1.8.4.2 F-function\n\nF_function &lt;- Fest(study_ppps_2022[[study_name]])\nplot(F_function, xlim=c(0,500), main = paste(\"F-function estimation for\", study_name))\n\n\n\n\n\n\n\nF_csr &lt;- envelope(ppp, Fest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(F_csr, main = paste(\"F function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\n\nTH1.8.5 Yangon Region\n\nTH1.8.5.1 G-function\n\nstudy_name = \"Yangon\"\nG_function &lt;- Gest(study_ppps_2022[[study_name]], correction = \"border\")\nplot(G_function, xlim=c(0,500), main = paste(\"G-function estimation for\", study_name))\n\n\n\n\n\n\n\nG_csr &lt;- envelope(ppp, Gest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(G_csr, main = paste(\"G function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\nTH1.8.5.2 F-function\n\nF_function &lt;- Fest(study_ppps_2022[[study_name]])\nplot(F_function, xlim=c(0,500), main = paste(\"F-function estimation for\", study_name))\n\n\n\n\n\n\n\n\nError in bestlegendpos(...) : All objects were empty\n\nF_csr &lt;- envelope(ppp, Fest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(F_csr, main = paste(\"F function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\n\nTH1.8.6 Tanintharyi Region\n\nTH1.8.6.1 G-function\n\nstudy_name = \"Tanintharyi\"\nG_function &lt;- Gest(study_ppps_2022[[study_name]], correction = \"border\")\nplot(G_function, xlim=c(0,500), main = paste(\"G-function estimation for\", study_name))\n\n\n\n\n\n\n\nG_csr &lt;- envelope(ppp, Gest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(G_csr, main = paste(\"G function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\n\n\nTH1.8.6.2 F-function\n\nF_function &lt;- Fest(study_ppps_2022[[study_name]])\nplot(F_function, xlim=c(0,500), main = paste(\"F-function estimation for\", study_name))\n\n\n\n\n\n\n\nF_csr &lt;- envelope(ppp, Fest, nsim = 99)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\nplot(F_csr, main = paste(\"F function test for spatial randomness for\", study_name))\n\n\n\n\n\n\n\n\nSince all F-functions lie entirely below the envelope, and all G-functions lie entirely above the envelope, we can conclude that the armed conflict areas exhibit clustering. This is backed up by the KDE plots, which show the presence of dense clusters."
  },
  {
    "objectID": "HandsOn/hands-on-6.html",
    "href": "HandsOn/hands-on-6.html",
    "title": "HX6: Spatial Autocorrelation",
    "section": "",
    "text": "In spatial policy, a development objective of local government and planners is to ensure equal distribution of development. The appropriate spatial statistical methods can be applied to discover if development is evenly distributed, and if not, to find out if and where there are signs of spatial clustering.\nToday, we return to Hunan province in the People’s Republic of China to examine the spatial distribution of GDP per capita. Just like the previous exercise, we will import the Hunan province administrative boundaries, and 2012 development indicators.\n\n\n\n\n\n\npacman::p_load(sf, spdep, tmap, tidyverse)\n\n\n\n\n\nhunan &lt;- st_read(dsn=\"data/geospatial\", layer=\"Hunan\")\n\nReading layer `Hunan' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\n\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nHere, we will left join the attribute fields of the Hunan dataframe with the geographical boundaries of Hunan province.\n\nhunan &lt;- left_join(hunan, hunan2012) %&gt;% select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`"
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.1-the-analytical-question",
    "href": "HandsOn/hands-on-6.html#hx6.1-the-analytical-question",
    "title": "HX6: Spatial Autocorrelation",
    "section": "",
    "text": "In spatial policy, a development objective of local government and planners is to ensure equal distribution of development. The appropriate spatial statistical methods can be applied to discover if development is evenly distributed, and if not, to find out if and where there are signs of spatial clustering.\nToday, we return to Hunan province in the People’s Republic of China to examine the spatial distribution of GDP per capita. Just like the previous exercise, we will import the Hunan province administrative boundaries, and 2012 development indicators.\n\n\n\n\n\n\npacman::p_load(sf, spdep, tmap, tidyverse)\n\n\n\n\n\nhunan &lt;- st_read(dsn=\"data/geospatial\", layer=\"Hunan\")\n\nReading layer `Hunan' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\n\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nHere, we will left join the attribute fields of the Hunan dataframe with the geographical boundaries of Hunan province.\n\nhunan &lt;- left_join(hunan, hunan2012) %&gt;% select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`"
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.3-basic-visualisation",
    "href": "HandsOn/hands-on-6.html#hx6.3-basic-visualisation",
    "title": "HX6: Spatial Autocorrelation",
    "section": "HX6.3 Basic visualisation",
    "text": "HX6.3 Basic visualisation\nBefore performing any analysis, it is a good practice to create some basic visualisations.\n\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)"
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.4-global-measures-of-spatial-autocorrelation",
    "href": "HandsOn/hands-on-6.html#hx6.4-global-measures-of-spatial-autocorrelation",
    "title": "HX6: Spatial Autocorrelation",
    "section": "HX6.4 Global Measures of Spatial Autocorrelation",
    "text": "HX6.4 Global Measures of Spatial Autocorrelation\nBefore computing any global spatial autocorrelation statistics, we first need to construct the spatial weights of the study area. These are used to define the neighbourhood relationships between the geographical units in the study area.\n\nHX6.4.1 Contiguity Spatial Weights\nIn the code chunk below, poly2nb() from the spdep pckage is used to compute contiguity weight matrices for the study area. Today, we will create a QUEEN contiguity weight matrix.\n\nwm_q &lt;- poly2nb(hunan, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n\n\nHX6.4.2 Creating Row-standardised Weights Matrix\nFollowing this, we need to assign weights to each neighbouring polygon. In our case, we will assign each neighbouring polygon an equal weight, by taking the inverse of the number of neighbours, using style=\"W\" for simplicity.\n\nMore options, such as style=\"B\", are available.\n\n\nrswm_q &lt;- nb2listw(wm_q, style=\"W\", zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147"
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.5-morans-i",
    "href": "HandsOn/hands-on-6.html#hx6.5-morans-i",
    "title": "HX6: Spatial Autocorrelation",
    "section": "HX6.5 Moran’s I",
    "text": "HX6.5 Moran’s I\nMoran’s I describes how features differ from the values in the study area as a whole. Positive (I &gt; 0) values indicate clustering, with observations tending to be similar, while negative (I &lt; 0) values indicate dispersion, where observations tend to be dissimilar. When I is approximately 0, it indicates observations are randomly arranged in space. Moran’s I approaches 1 when similar values are clustered, and approaches -1 when dissimilar values tend to cluster.\nMoran’s I statistics testing can be conducted using moran.test() from the spdep package.\n\nmoran.test(hunan$GDPPC, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\nThe Moran’s I statistic is approximately 0.3007, which indicates a tendency for similar values to be clustered together in space. This means regions with high GDP per capita are likely to be near other similar regions, and vice-versa.\nFurthermore, the standard deviate is 4.74 and the p-value is 1.095e-06. We can reject the null hypothesis that there is no spatial autocorrelation, and since there is significant evidence of positive spatial autocorrelation, we accept this alternative hypothesis.\n\nHX6.5.1 Monte Carlo on Moran’s I\nWe can perform a Monte Carlo permutation test for the Moran’s I statistic using moran.mc() and visualise the results.\n\nset.seed(1234)\nbperm= moran.mc(hunan$GDPPC, \n                listw=rswm_q, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\nsummary(bperm$res[1:999])\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\nhist(bperm$res, \n     freq=TRUE, \n     breaks=20, \n     xlab=\"Simulated Moran's I\")\nabline(v=0, \n       col=\"red\") \n\n\n\n\n\n\n\n\nThe Moran’s I statistic is 0.30075. Since the p-value is 0.001, this shows that the result is statistically significant. Since we have a slightly left-skewed distribution of simulated values, this high level of clustering is unlikely to occur by chance."
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.6-gearys-c",
    "href": "HandsOn/hands-on-6.html#hx6.6-gearys-c",
    "title": "HX6: Spatial Autocorrelation",
    "section": "HX6.6 Geary’s C",
    "text": "HX6.6 Geary’s C\nGeary’s C describes how features differ from their immediate neighbours. When C &gt; 1, the points are dispersed, and while C &lt; 1, the points are clustered. A C value of 1 indicates observations are randomly arranged in space. Geary’s C approaches 0 when similar values are clustered, and approaches 3 when dissimilar values are clustered. Geary’s C is inversely proportional to Moran’s I, so higher Cs correspond to lower Is.\nGeary’s C testing can be performed by calling geary.test(), also from spdedp.\n\ngeary.test(hunan$GDPPC, listw=rswm_q)\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q   \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\nThe C statistic is 0.6907, which suggests positive spatial autocorrelation. With a very low p-value of 0.0001, we can reject the null hypothesis that there is no spatial autocorrelation.\n\nHX6.6.1 Monte Carlo on Geary’s C\nSimilar to Moran’s I, we can perform a Monte Carlo permutation test on Geary’s C and visualise the results.\n\nset.seed(1234)\nbperm=geary.mc(hunan$GDPPC, \n               listw=rswm_q, \n               nsim=999)\nbperm\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\nsummary(bperm$res[1:999])\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\nhist(bperm$res, freq=TRUE, breaks=20, xlab=\"Simulated Geary c\")\nabline(v=1, col=\"red\") \n\n\n\n\n\n\n\n\nThe distribution of the simulated values indicates a high tendancy towards C-values of 1 or greater, indicating a tendency towards no or negative spatial autocorrelation under random correlations."
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.7-spatial-correlograms",
    "href": "HandsOn/hands-on-6.html#hx6.7-spatial-correlograms",
    "title": "HX6: Spatial Autocorrelation",
    "section": "HX6.7 Spatial Correlograms",
    "text": "HX6.7 Spatial Correlograms\nSpatial correlograms help us examine patterns of spatial autocorrelation. We can create correlograms for both Moran’s I and Geary’s C.\n\nHX6.7.1 Moran’s I\n\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"I\", \n                          style=\"W\")\nplot(MI_corr)\n\n\n\n\n\n\n\nprint(MI_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nHX6.7.2 Geary’s C\n\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"C\", \n                          style=\"W\")\nplot(GC_corr)\n\n\n\n\n\n\n\nprint(GC_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.9-creating-a-lisa-cluster-map",
    "href": "HandsOn/hands-on-6.html#hx6.9-creating-a-lisa-cluster-map",
    "title": "HX6: Spatial Autocorrelation",
    "section": "HX6.9 Creating a LISA cluster map",
    "text": "HX6.9 Creating a LISA cluster map\nLISA cluster maps show significant locations colour-coded by type of spatial autocorrelation.\n\nHX6.9.1 Plotting Moran scatterplot\nBefore creating a LISA cluster map, we should first create a Moran scatterplot. This scatterplot illustrates the relationship between the values of our chosen attribute at each location and the average value of the same attribute at neighbouring locations. We can plot a Moran scatterplot for GDP per capita in 2012 using the moran.plot() from spdep.\n\nnci &lt;- moran.plot(hunan$GDPPC, rswm_q,\n                  labels=as.character(hunan$County), \n                  xlab=\"GDPPC 2012\", \n                  ylab=\"Spatially Lagged GDPPC 2012\")\n\n\n\n\n\n\n\n\nNotice that the plot is split in 4 quadrants. The top right corner corresponds to areas that have high GDP per capita and are surrounded by other areas that have the average level of GDP per capita (i.e. positive autocorrelation - clustering).\n\n\nHX6.9.2 Plotting Moran scatterplot with standardised variable\nWe can use scale() to center and scale our variable. Here centering is done by subtracting the mean (omitting NAs) the corresponding columns, and scaling is done by dividing the (centered) variable by their standard deviations.\n\nhunan$Z.GDPPC &lt;- scale(hunan$GDPPC) %&gt;% \n  as.vector \n# Ensures we get a vector that maps neatly into our dataframe\n\nnci2 &lt;- moran.plot(hunan$Z.GDPPC, rswm_q,\n                   labels=as.character(hunan$County),\n                   xlab=\"z-GDPPC 2012\", \n                   ylab=\"Spatially Lag z-GDPPC 2012\")\n\n\n\n\n\n\n\n\n\n\nHX6.9.3 Preparing LISA map classes\nThe code chunks below showcase the steps to prepare a LISA cluster map.\n\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\n\nNext, we derive the spatially lagged variable of interest (i.e. GDPPC) and centers the spatially lagged variable around its mean.\n\nhunan$lag_GDPPC &lt;- lag.listw(rswm_q, hunan$GDPPC)\nDV &lt;- hunan$lag_GDPPC - mean(hunan$lag_GDPPC)     \n\nThis is followed by centering the local Moran’s around the mean.\n\nLM_I &lt;- localMI[,1] - mean(localMI[,1])    \n\nNext, we set a statistical significance level for the local Moran.\n\nsignif &lt;- 0.05       \n\nThese four lines define the low-low (1), low-high (2), high-low (3) and high-high (4) categories.\n\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4      \n\nLastly, we place the non-significant Moran in the category 0.\n\nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\n\n\nHX6.9.4 Plotting LISA map\nFinally, we can build our LISA map as below.\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\n\n\n\n\n\n\n\nFor a more effective interpretation, it is good practice to plot our basemap, local Moran’s I values map and p-value map side by side.\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\nLISAmap &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\ntmap_arrange(gdppc, LISAmap, \n             asp=1, ncol=2)"
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.8-local-measures-of-spatial-autocorrelation",
    "href": "HandsOn/hands-on-6.html#hx6.8-local-measures-of-spatial-autocorrelation",
    "title": "HX6: Spatial Autocorrelation",
    "section": "HX6.8 Local Measures of Spatial Autocorrelation",
    "text": "HX6.8 Local Measures of Spatial Autocorrelation\nLocal measures of spatial autocorrelation (LMSA) focuses on the relationships between each observation and its surroundings, unlike global measures of spatial autocorrelation where a single summary of these relationships is investigated across the map. In this sense, LMSA does not generate summary statistics, but rather, scores that allow us to learn more about the saptial structure in our data.\n\nHX6.8.0.1 Local Indicators of Spatial Association\nLocal indicators of spatial association (LISA) are statistics that evaluate the existence of clusters and/or outliers in the spatial arrangement of a given variable. If we are studying GDP per capita, for instance, local clusters in GDP per capita mean that there are areas that have higher or lower rates than is to be expected by chance alone; that is, the values occurring are above or below those of a random distribution in space.\n\n\nHX6.8.1 Computing Local Moran’s I\nThe Moran’s I statistic can be calculated locally, giving us li values given a set of zi values and a listw object providing neighbour weighting information for the polygon associated with the zi values.\nWe can compute and list the values of the derived Moran’s I matrix using the code chunk below.\n\nfips &lt;- order(hunan$County)\nlocalMI &lt;- localmoran(hunan$GDPPC, rswm_q)\nhead(localMI)\n\n            Ii          E.Ii       Var.Ii        Z.Ii Pr(z != E(Ii))\n1 -0.001468468 -2.815006e-05 4.723841e-04 -0.06626904      0.9471636\n2  0.025878173 -6.061953e-04 1.016664e-02  0.26266425      0.7928094\n3 -0.011987646 -5.366648e-03 1.133362e-01 -0.01966705      0.9843090\n4  0.001022468 -2.404783e-07 5.105969e-06  0.45259801      0.6508382\n5  0.014814881 -6.829362e-05 1.449949e-03  0.39085814      0.6959021\n6 -0.038793829 -3.860263e-04 6.475559e-03 -0.47728835      0.6331568\n\nprintCoefmat(data.frame(\n  localMI[fips,], \n  row.names=hunan$County[fips]),\n  check.names=FALSE)\n\n                       Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..\nAnhua         -2.2493e-02 -5.0048e-03  5.8235e-02 -7.2467e-02         0.9422\nAnren         -3.9932e-01 -7.0111e-03  7.0348e-02 -1.4791e+00         0.1391\nAnxiang       -1.4685e-03 -2.8150e-05  4.7238e-04 -6.6269e-02         0.9472\nBaojing        3.4737e-01 -5.0089e-03  8.3636e-02  1.2185e+00         0.2230\nChaling        2.0559e-02 -9.6812e-04  2.7711e-02  1.2932e-01         0.8971\nChangning     -2.9868e-05 -9.0010e-09  1.5105e-07 -7.6828e-02         0.9388\nChangsha       4.9022e+00 -2.1348e-01  2.3194e+00  3.3590e+00         0.0008\nChengbu        7.3725e-01 -1.0534e-02  2.2132e-01  1.5895e+00         0.1119\nChenxi         1.4544e-01 -2.8156e-03  4.7116e-02  6.8299e-01         0.4946\nCili           7.3176e-02 -1.6747e-03  4.7902e-02  3.4200e-01         0.7324\nDao            2.1420e-01 -2.0824e-03  4.4123e-02  1.0297e+00         0.3032\nDongan         1.5210e-01 -6.3485e-04  1.3471e-02  1.3159e+00         0.1882\nDongkou        5.2918e-01 -6.4461e-03  1.0748e-01  1.6338e+00         0.1023\nFenghuang      1.8013e-01 -6.2832e-03  1.3257e-01  5.1198e-01         0.6087\nGuidong       -5.9160e-01 -1.3086e-02  3.7003e-01 -9.5104e-01         0.3416\nGuiyang        1.8240e-01 -3.6908e-03  3.2610e-02  1.0305e+00         0.3028\nGuzhang        2.8466e-01 -8.5054e-03  1.4152e-01  7.7931e-01         0.4358\nHanshou        2.5878e-02 -6.0620e-04  1.0167e-02  2.6266e-01         0.7928\nHengdong       9.9964e-03 -4.9063e-04  6.7742e-03  1.2742e-01         0.8986\nHengnan        2.8064e-02 -3.2160e-04  3.7597e-03  4.6294e-01         0.6434\nHengshan      -5.8201e-03 -3.0437e-05  5.1076e-04 -2.5618e-01         0.7978\nHengyang       6.2997e-02 -1.3046e-03  2.1865e-02  4.3486e-01         0.6637\nHongjiang      1.8790e-01 -2.3019e-03  3.1725e-02  1.0678e+00         0.2856\nHuarong       -1.5389e-02 -1.8667e-03  8.1030e-02 -4.7503e-02         0.9621\nHuayuan        8.3772e-02 -8.5569e-04  2.4495e-02  5.4072e-01         0.5887\nHuitong        2.5997e-01 -5.2447e-03  1.1077e-01  7.9685e-01         0.4255\nJiahe         -1.2431e-01 -3.0550e-03  5.1111e-02 -5.3633e-01         0.5917\nJianghua       2.8651e-01 -3.8280e-03  8.0968e-02  1.0204e+00         0.3076\nJiangyong      2.4337e-01 -2.7082e-03  1.1746e-01  7.1800e-01         0.4728\nJingzhou       1.8270e-01 -8.5106e-04  2.4363e-02  1.1759e+00         0.2396\nJinshi        -1.1988e-02 -5.3666e-03  1.1334e-01 -1.9667e-02         0.9843\nJishou        -2.8680e-01 -2.6305e-03  4.4028e-02 -1.3543e+00         0.1756\nLanshan        6.3334e-02 -9.6365e-04  2.0441e-02  4.4972e-01         0.6529\nLeiyang        1.1581e-02 -1.4948e-04  2.5082e-03  2.3422e-01         0.8148\nLengshuijiang -1.7903e+00 -8.2129e-02  2.1598e+00 -1.1623e+00         0.2451\nLi             1.0225e-03 -2.4048e-07  5.1060e-06  4.5260e-01         0.6508\nLianyuan      -1.4672e-01 -1.8983e-03  1.9145e-02 -1.0467e+00         0.2952\nLiling         1.3774e+00 -1.5097e-02  4.2601e-01  2.1335e+00         0.0329\nLinli          1.4815e-02 -6.8294e-05  1.4499e-03  3.9086e-01         0.6959\nLinwu         -2.4621e-03 -9.0703e-06  1.9258e-04 -1.7676e-01         0.8597\nLinxiang       6.5904e-02 -2.9028e-03  2.5470e-01  1.3634e-01         0.8916\nLiuyang        3.3688e+00 -7.7502e-02  1.5180e+00  2.7972e+00         0.0052\nLonghui        8.0801e-01 -1.1377e-02  1.5538e-01  2.0787e+00         0.0376\nLongshan       7.5663e-01 -1.1100e-02  3.1449e-01  1.3690e+00         0.1710\nLuxi           1.8177e-01 -2.4855e-03  3.4249e-02  9.9561e-01         0.3194\nMayang         2.1852e-01 -5.8773e-03  9.8049e-02  7.1663e-01         0.4736\nMiluo          1.8704e+00 -1.6927e-02  2.7925e-01  3.5715e+00         0.0004\nNan           -9.5789e-03 -4.9497e-04  6.8341e-03 -1.0988e-01         0.9125\nNingxiang      1.5607e+00 -7.3878e-02  8.0012e-01  1.8274e+00         0.0676\nNingyuan       2.0910e-01 -7.0884e-03  8.2306e-02  7.5356e-01         0.4511\nPingjiang     -9.8964e-01 -2.6457e-03  5.6027e-02 -4.1698e+00         0.0000\nQidong         1.1806e-01 -2.1207e-03  2.4747e-02  7.6396e-01         0.4449\nQiyang         6.1966e-02 -7.3374e-04  8.5743e-03  6.7712e-01         0.4983\nRucheng       -3.6992e-01 -8.8999e-03  2.5272e-01 -7.1814e-01         0.4727\nSangzhi        2.5053e-01 -4.9470e-03  6.8000e-02  9.7972e-01         0.3272\nShaodong      -3.2659e-02 -3.6592e-05  5.0546e-04 -1.4510e+00         0.1468\nShaoshan       2.1223e+00 -5.0227e-02  1.3668e+00  1.8583e+00         0.0631\nShaoyang       5.9499e-01 -1.1253e-02  1.3012e-01  1.6807e+00         0.0928\nShimen        -3.8794e-02 -3.8603e-04  6.4756e-03 -4.7729e-01         0.6332\nShuangfeng     9.2835e-03 -2.2867e-03  3.1516e-02  6.5174e-02         0.9480\nShuangpai      8.0591e-02 -3.1366e-04  8.9838e-03  8.5358e-01         0.3933\nSuining        3.7585e-01 -3.5933e-03  4.1870e-02  1.8544e+00         0.0637\nTaojiang      -2.5394e-01 -1.2395e-03  1.4477e-02 -2.1002e+00         0.0357\nTaoyuan        1.4729e-02 -1.2039e-04  8.5103e-04  5.0903e-01         0.6107\nTongdao        4.6482e-01 -6.9870e-03  1.9879e-01  1.0582e+00         0.2900\nWangcheng      4.4220e+00 -1.1067e-01  1.3596e+00  3.8873e+00         0.0001\nWugang         7.1003e-01 -7.8144e-03  1.0710e-01  2.1935e+00         0.0283\nXiangtan       2.4530e-01 -3.6457e-04  3.2319e-03  4.3213e+00         0.0000\nXiangxiang     2.6271e-01 -1.2703e-03  2.1290e-02  1.8092e+00         0.0704\nXiangyin       5.4525e-01 -4.7442e-03  7.9236e-02  1.9539e+00         0.0507\nXinhua         1.1810e-01 -6.2649e-03  8.6001e-02  4.2409e-01         0.6715\nXinhuang       1.5725e-01 -4.1820e-03  3.6648e-01  2.6667e-01         0.7897\nXinning        6.8928e-01 -9.6674e-03  2.0328e-01  1.5502e+00         0.1211\nXinshao        5.7578e-02 -8.5932e-03  1.1769e-01  1.9289e-01         0.8470\nXintian       -7.4050e-03 -5.1493e-03  1.0877e-01 -6.8395e-03         0.9945\nXupu           3.2406e-01 -5.7468e-03  5.7735e-02  1.3726e+00         0.1699\nYanling       -6.9021e-02 -5.9211e-04  9.9306e-03 -6.8667e-01         0.4923\nYizhang       -2.6844e-01 -2.2463e-03  4.7588e-02 -1.2202e+00         0.2224\nYongshun       6.3064e-01 -1.1350e-02  1.8830e-01  1.4795e+00         0.1390\nYongxing       4.3411e-01 -9.0735e-03  1.5088e-01  1.1409e+00         0.2539\nYou            7.8750e-02 -7.2728e-03  1.2116e-01  2.4714e-01         0.8048\nYuanjiang      2.0004e-04 -1.7760e-04  2.9798e-03  6.9181e-03         0.9945\nYuanling       8.7298e-03 -2.2981e-06  2.3221e-05  1.8121e+00         0.0700\nYueyang        4.1189e-02 -1.9768e-04  2.3113e-03  8.6085e-01         0.3893\nZhijiang       1.0476e-01 -7.8123e-04  1.3100e-02  9.2214e-01         0.3565\nZhongfang     -2.2685e-01 -2.1455e-03  3.5927e-02 -1.1855e+00         0.2358\nZhuzhou        3.2864e-01 -5.2432e-04  7.2391e-03  3.8688e+00         0.0001\nZixing        -7.6849e-01 -8.8210e-02  9.4057e-01 -7.0144e-01         0.4830\n\n\n\n\nHX6.8.1 Mapping Local Moran’s I\nOnce we have our matrix, we are able to plot these values on a tmap. Before mapping the Moran’s I matrix, it is wise to append the dataframe onto the Hunan polygon featureset.\n\nhunan.localMI &lt;- cbind(hunan,localMI) %&gt;%\n  rename(Pr.Ii = Pr.z....E.Ii..)\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\",\n          palette = \"RdBu\",\n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\nHX6.8.1.1 Mapping p-values\nThe choropleth map shows evidence of both positive and negative Ii values. However, it is useful to also consider the p-values for each of these values.\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\nHX6.8.1.2 Plotting them together\nWe can also plot both maps side by side with the following code chunk.\n\nlocalMI.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\", \n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\npvalue.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(localMI.map, pvalue.map, asp=1, ncol=2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "HandsOn/hands-on-6.html#hx6.10-hot-spot-and-cold-spot-areas-analysis",
    "href": "HandsOn/hands-on-6.html#hx6.10-hot-spot-and-cold-spot-areas-analysis",
    "title": "HX6: Spatial Autocorrelation",
    "section": "HX6.10 Hot Spot and Cold Spot Areas Analysis",
    "text": "HX6.10 Hot Spot and Cold Spot Areas Analysis\nLocalised spatial statistics can also be used to detect hot spot and/or cold spot areas. One way to do this is by creating Getis and Ord’s G-Statistics. It looks at neighbours within a defined proximity to identify whether either high or low values cluster spatially. The analysis consists of three steps:\n\nDeriving spatial weight matrix\nComputing Gi statistics\nMapping Gi statistics\n\n\nHX6.10.1 Deriving distance-based weight matrix\nFirst, we need to define a new set of neighbours based on distance. There are two types of distance-based proximity matrices: fixed-distance, and adaptive-distance.\n\nHX6.10.1.1 Deriving the centroid\nWe will need points to associate with each polygon before we can create our connectivity graph. It will be a little more complicated than just running st_centroid() on the sf object; we need the coordinates in a separate data frame for this to work. To do this we will use a mapping function. The mapping function applies a given function to each element of a vector and returns a vector of the same length. Our input vector will be the geometry column of us.bound. Our function will be st_centroid().\nTo get our longitude values we map the st_centroid() function over the geometry column of us.bound and access the longitude value through double bracket notation [[]] and 1. This allows us to get only the longitude, which is the first value in each centroid.\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\nWe do the same for latitude with one key difference. We access the second value per each centroid with [[2]].\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\nNow that we have latitude and longitude, we can use cbind to put longitude and latitude into the same object.\n\ncoords &lt;- cbind(longitude, latitude)\n\n\n\nHX6.10.1.2 Determining the cutoff distance\nWe now need to determine the upper limit for our distance band.\n\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\nThe summary report shows that the largest first nearest neighbour distance is 61.79 km, so using this as the upper threshold gives certainty that all units will have at least one neighbour.\n\n\nHX6.10.1.3 Computing fixed-distance weight matrix\nWe can now compute our distance weight matrix with dnearneigh(), and spatial weights object with nb2listw().\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B')\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \nLink number distribution:\n\n 1  2  3  4  5  6 \n 6 15 14 26 20  7 \n6 least connected regions:\n6 15 30 32 56 65 with 1 link\n7 most connected regions:\n21 28 35 45 50 52 82 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1   S2\nB 88 7744 324 648 5440\n\n\n\n\n\nHX6.10.2 Computing adaptive distance weight matrix\nA fixed distance weight matrix can cause more densely settled areas (usually urban areas) to have more neighbours, and less densly settled areas (usually rural areas) to have fewer neighbours. Having many neighbours smoothes the neighbour relationship across more neighbours.\nIt is possible to control the numbers of neighbours directly using k-nearest neighbours, either accepting asymmetric neighbours or imposing symmetry.\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\n\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n88 \n88 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n88 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 704 1300 23014\n\n\n\n\nHX6.10.3 Computing Gi statistics\nGi-statistics show us where features with either high (i.e. hot spots) or low (i.e. cold spots) cluster spatially. Hot spot areas are areas that are significant and positive if location i is associated with relatively high values of the surrounding locations, while cold spot areas are areas that are significant and negative if location i is associated with relatively low values in surrounding locations.\n\nHX6.10.3.1 Gi statistics using fixed distance\n\nfips &lt;- order(hunan$County)\ngi.fixed &lt;- localG(hunan$GDPPC, wm62_lw)\ngi.fixed\n\n [1]  0.436075843 -0.265505650 -0.073033665  0.413017033  0.273070579\n [6] -0.377510776  2.863898821  2.794350420  5.216125401  0.228236603\n[11]  0.951035346 -0.536334231  0.176761556  1.195564020 -0.033020610\n[16]  1.378081093 -0.585756761 -0.419680565  0.258805141  0.012056111\n[21] -0.145716531 -0.027158687 -0.318615290 -0.748946051 -0.961700582\n[26] -0.796851342 -1.033949773 -0.460979158 -0.885240161 -0.266671512\n[31] -0.886168613 -0.855476971 -0.922143185 -1.162328599  0.735582222\n[36] -0.003358489 -0.967459309 -1.259299080 -1.452256513 -1.540671121\n[41] -1.395011407 -1.681505286 -1.314110709 -0.767944457 -0.192889342\n[46]  2.720804542  1.809191360 -1.218469473 -0.511984469 -0.834546363\n[51] -0.908179070 -1.541081516 -1.192199867 -1.075080164 -1.631075961\n[56] -0.743472246  0.418842387  0.832943753 -0.710289083 -0.449718820\n[61] -0.493238743 -1.083386776  0.042979051  0.008596093  0.136337469\n[66]  2.203411744  2.690329952  4.453703219 -0.340842743 -0.129318589\n[71]  0.737806634 -1.246912658  0.666667559  1.088613505 -0.985792573\n[76]  1.233609606 -0.487196415  1.626174042 -1.060416797  0.425361422\n[81] -0.837897118 -0.314565243  0.371456331  4.424392623 -0.109566928\n[86]  1.364597995 -1.029658605 -0.718000620\nattr(,\"internals\")\n               Gi      E(Gi)        V(Gi)        Z(Gi) Pr(z != E(Gi))\n [1,] 0.064192949 0.05747126 2.375922e-04  0.436075843   6.627817e-01\n [2,] 0.042300020 0.04597701 1.917951e-04 -0.265505650   7.906200e-01\n [3,] 0.044961480 0.04597701 1.933486e-04 -0.073033665   9.417793e-01\n [4,] 0.039475779 0.03448276 1.461473e-04  0.413017033   6.795941e-01\n [5,] 0.049767939 0.04597701 1.927263e-04  0.273070579   7.847990e-01\n [6,] 0.008825335 0.01149425 4.998177e-05 -0.377510776   7.057941e-01\n [7,] 0.050807266 0.02298851 9.435398e-05  2.863898821   4.184617e-03\n [8,] 0.083966739 0.04597701 1.848292e-04  2.794350420   5.200409e-03\n [9,] 0.115751554 0.04597701 1.789361e-04  5.216125401   1.827045e-07\n[10,] 0.049115587 0.04597701 1.891013e-04  0.228236603   8.194623e-01\n[11,] 0.045819180 0.03448276 1.420884e-04  0.951035346   3.415864e-01\n[12,] 0.049183846 0.05747126 2.387633e-04 -0.536334231   5.917276e-01\n[13,] 0.048429181 0.04597701 1.924532e-04  0.176761556   8.596957e-01\n[14,] 0.034733752 0.02298851 9.651140e-05  1.195564020   2.318667e-01\n[15,] 0.011262043 0.01149425 4.945294e-05 -0.033020610   9.736582e-01\n[16,] 0.065131196 0.04597701 1.931870e-04  1.378081093   1.681783e-01\n[17,] 0.027587075 0.03448276 1.385862e-04 -0.585756761   5.580390e-01\n[18,] 0.029409313 0.03448276 1.461397e-04 -0.419680565   6.747188e-01\n[19,] 0.061466754 0.05747126 2.383385e-04  0.258805141   7.957856e-01\n[20,] 0.057656917 0.05747126 2.371303e-04  0.012056111   9.903808e-01\n[21,] 0.066518379 0.06896552 2.820326e-04 -0.145716531   8.841452e-01\n[22,] 0.045599896 0.04597701 1.928108e-04 -0.027158687   9.783332e-01\n[23,] 0.030646753 0.03448276 1.449523e-04 -0.318615290   7.500183e-01\n[24,] 0.035635552 0.04597701 1.906613e-04 -0.748946051   4.538897e-01\n[25,] 0.032606647 0.04597701 1.932888e-04 -0.961700582   3.362000e-01\n[26,] 0.035001352 0.04597701 1.897172e-04 -0.796851342   4.255374e-01\n[27,] 0.012746354 0.02298851 9.812587e-05 -1.033949773   3.011596e-01\n[28,] 0.061287917 0.06896552 2.773884e-04 -0.460979158   6.448136e-01\n[29,] 0.014277403 0.02298851 9.683314e-05 -0.885240161   3.760271e-01\n[30,] 0.009622875 0.01149425 4.924586e-05 -0.266671512   7.897221e-01\n[31,] 0.014258398 0.02298851 9.705244e-05 -0.886168613   3.755267e-01\n[32,] 0.005453443 0.01149425 4.986245e-05 -0.855476971   3.922871e-01\n[33,] 0.043283712 0.05747126 2.367109e-04 -0.922143185   3.564539e-01\n[34,] 0.020763514 0.03448276 1.393165e-04 -1.162328599   2.451020e-01\n[35,] 0.081261843 0.06896552 2.794398e-04  0.735582222   4.619850e-01\n[36,] 0.057419907 0.05747126 2.338437e-04 -0.003358489   9.973203e-01\n[37,] 0.013497133 0.02298851 9.624821e-05 -0.967459309   3.333145e-01\n[38,] 0.019289310 0.03448276 1.455643e-04 -1.259299080   2.079223e-01\n[39,] 0.025996272 0.04597701 1.892938e-04 -1.452256513   1.464303e-01\n[40,] 0.016092694 0.03448276 1.424776e-04 -1.540671121   1.233968e-01\n[41,] 0.035952614 0.05747126 2.379439e-04 -1.395011407   1.630124e-01\n[42,] 0.031690963 0.05747126 2.350604e-04 -1.681505286   9.266481e-02\n[43,] 0.018750079 0.03448276 1.433314e-04 -1.314110709   1.888090e-01\n[44,] 0.015449080 0.02298851 9.638666e-05 -0.767944457   4.425202e-01\n[45,] 0.065760689 0.06896552 2.760533e-04 -0.192889342   8.470456e-01\n[46,] 0.098966900 0.05747126 2.326002e-04  2.720804542   6.512325e-03\n[47,] 0.085415780 0.05747126 2.385746e-04  1.809191360   7.042128e-02\n[48,] 0.038816536 0.05747126 2.343951e-04 -1.218469473   2.230456e-01\n[49,] 0.038931873 0.04597701 1.893501e-04 -0.511984469   6.086619e-01\n[50,] 0.055098610 0.06896552 2.760948e-04 -0.834546363   4.039732e-01\n[51,] 0.033405005 0.04597701 1.916312e-04 -0.908179070   3.637836e-01\n[52,] 0.043040784 0.06896552 2.829941e-04 -1.541081516   1.232969e-01\n[53,] 0.011297699 0.02298851 9.615920e-05 -1.192199867   2.331829e-01\n[54,] 0.040968457 0.05747126 2.356318e-04 -1.075080164   2.823388e-01\n[55,] 0.023629663 0.04597701 1.877170e-04 -1.631075961   1.028743e-01\n[56,] 0.006281129 0.01149425 4.916619e-05 -0.743472246   4.571958e-01\n[57,] 0.063918654 0.05747126 2.369553e-04  0.418842387   6.753313e-01\n[58,] 0.070325003 0.05747126 2.381374e-04  0.832943753   4.048765e-01\n[59,] 0.025947288 0.03448276 1.444058e-04 -0.710289083   4.775249e-01\n[60,] 0.039752578 0.04597701 1.915656e-04 -0.449718820   6.529132e-01\n[61,] 0.049934283 0.05747126 2.334965e-04 -0.493238743   6.218439e-01\n[62,] 0.030964195 0.04597701 1.920248e-04 -1.083386776   2.786368e-01\n[63,] 0.058129184 0.05747126 2.343319e-04  0.042979051   9.657182e-01\n[64,] 0.046096514 0.04597701 1.932637e-04  0.008596093   9.931414e-01\n[65,] 0.012459080 0.01149425 5.008051e-05  0.136337469   8.915545e-01\n[66,] 0.091447733 0.05747126 2.377744e-04  2.203411744   2.756574e-02\n[67,] 0.049575872 0.02298851 9.766513e-05  2.690329952   7.138140e-03\n[68,] 0.107907212 0.04597701 1.933581e-04  4.453703219   8.440175e-06\n[69,] 0.019616151 0.02298851 9.789454e-05 -0.340842743   7.332220e-01\n[70,] 0.032923393 0.03448276 1.454032e-04 -0.129318589   8.971056e-01\n[71,] 0.030317663 0.02298851 9.867859e-05  0.737806634   4.606320e-01\n[72,] 0.019437582 0.03448276 1.455870e-04 -1.246912658   2.124295e-01\n[73,] 0.055245460 0.04597701 1.932838e-04  0.666667559   5.049845e-01\n[74,] 0.074278054 0.05747126 2.383538e-04  1.088613505   2.763244e-01\n[75,] 0.013269580 0.02298851 9.719982e-05 -0.985792573   3.242349e-01\n[76,] 0.049407829 0.03448276 1.463785e-04  1.233609606   2.173484e-01\n[77,] 0.028605749 0.03448276 1.455139e-04 -0.487196415   6.261191e-01\n[78,] 0.039087662 0.02298851 9.801040e-05  1.626174042   1.039126e-01\n[79,] 0.031447120 0.04597701 1.877464e-04 -1.060416797   2.889550e-01\n[80,] 0.064005294 0.05747126 2.359641e-04  0.425361422   6.705732e-01\n[81,] 0.044606529 0.05747126 2.357330e-04 -0.837897118   4.020885e-01\n[82,] 0.063700493 0.06896552 2.801427e-04 -0.314565243   7.530918e-01\n[83,] 0.051142205 0.04597701 1.933560e-04  0.371456331   7.102977e-01\n[84,] 0.102121112 0.04597701 1.610278e-04  4.424392623   9.671399e-06\n[85,] 0.021901462 0.02298851 9.843172e-05 -0.109566928   9.127528e-01\n[86,] 0.064931813 0.04597701 1.929430e-04  1.364597995   1.723794e-01\n[87,] 0.031747344 0.04597701 1.909867e-04 -1.029658605   3.031703e-01\n[88,] 0.015893319 0.02298851 9.765131e-05 -0.718000620   4.727569e-01\nattr(,\"cluster\")\n [1] Low  Low  High High High High High High High Low  Low  High Low  Low  Low \n[16] High High High High Low  High High Low  Low  High Low  Low  Low  Low  Low \n[31] Low  Low  Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low \n[46] High High Low  Low  Low  Low  High Low  Low  Low  Low  Low  High Low  Low \n[61] Low  Low  Low  High High High Low  High Low  Low  High Low  High High Low \n[76] High Low  Low  Low  Low  Low  Low  High High Low  High Low  Low \nLevels: Low High\nattr(,\"gstari\")\n[1] FALSE\nattr(,\"call\")\nlocalG(x = hunan$GDPPC, listw = wm62_lw)\nattr(,\"class\")\n[1] \"localG\"\n\n\nThe Gi statistics are represented as a Z-score. Higher Z-scores represent a greater intensity of clustering, while the direction (positive or negative) indicates high or low clusters.\nNow, we will join the Gi values to the hunan dataframe.\n\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.fixed)) %&gt;%\n  rename(gstat_fixed = as.matrix.gi.fixed.)\n\n\n\nHX6.10.3.2 Mapping Gi values with fixed distance weights\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;-tm_shape(hunan.gi) +\n  tm_fill(col = \"gstat_fixed\", \n          style = \"pretty\",\n          palette=\"-RdBu\",\n          title = \"local Gi\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, Gimap, asp=1, ncol=2)\n\nVariable(s) \"gstat_fixed\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\nHX6.10.3.3 Gi statistics with adaptive distance\n\nfips &lt;- order(hunan$County)\ngi.adaptive &lt;- localG(hunan$GDPPC, knn_lw)\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.adaptive)) %&gt;%\n  rename(gstat_adaptive = as.matrix.gi.adaptive.)\n\n\n\nHX6.10.3.4 Mapping Gi values with adaptive distance weights\n\ngdppc&lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;- tm_shape(hunan.gi) + \n  tm_fill(col = \"gstat_adaptive\", \n          style = \"pretty\", \n          palette=\"-RdBu\", \n          title = \"local Gi\") + \n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, \n             Gimap, \n             asp=1, \n             ncol=2)\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThe hot spot areas are the high GDP per capta areas clustered towards the northeast of the study region, while the cold spot areas are clustered towards the south and southwest."
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.9-concluding-thoughts",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.9-concluding-thoughts",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "TH1.9 Concluding thoughts",
    "text": "TH1.9 Concluding thoughts\nIn conclusion, we have explored different spatial point pattern analysis methods using armed conflict data in Myanmar. We attempted spatial-temporal KDE on the entire study period and identified dense areas around the Sagaing and Chin areas. Following that, we identified a subset of states and regions for deeper analysis based on exploratory data analysis and the STKDE plots and attempted fixed- and adaptive-bandwidth KDE on these areas, as well as second-order SPPA using the F- and G-functions. We have found bw.scott() to be more effective in performing KDE on this dataset than the usual bw.diggle(), and the conflict points in all regions to exhibit clustering.\nNow that we know how the points behave and where they are clustered, one possible extension of this study could be to do deeper research on Myanmar’s municipalities, townships and diverse ethnic groups, and repeat the SPPA process with the admin2 or admin3 plots. This is so that we better identify the needs and desires of each ethnic group, helping diplomats and policymakers formulate more targeted solutions for the ethnic divide and conflict in the country. In addition, Ripley’s K- function, as well as Besag’s L-function, could be attempted again given more time and computing power, along with the incorporation of other data sources, such as economic data, which could enhance our understanding of the relationship between the conflict and the country’s overall economic development. It is worth noting, however, that no amount of geospatial analytics or field studies will be effective without a strong, morally upright and benevolent government in Myanmar, with the political will and know-how to formulate and implement sound policies in response to analyses such as this one, for the betterment of their people and country.\nAs a long-time Python programmer and learner of data analytics, this exercise has been a rigourous introduction not only to R programming, but to wrangling and analysing points in geographical space. Though frustrating at times, I strongly believe that the best learning comes from experiencing and recovering from adversity, and I look forward to the subsequent exercises and concepts to come."
  },
  {
    "objectID": "TakeHome/TakeHome1/take-home-1.html#th1.1-introduction",
    "href": "TakeHome/TakeHome1/take-home-1.html#th1.1-introduction",
    "title": "TH1: Geospatial Analytics for Social Good",
    "section": "",
    "text": "Millions of people have their lives shattered by armed conflict every year. One of these is the Myanmar Civil War, a significant escalation of the long-running Myanmar Conflict in response to the 2021 coup d’etat.\nGeospatial analtyics holds the potential to address complex problems facing society, such as this one. This study serves to discover the sptial and spatio-temporal distribution (spread) of the latest armed conflict in Myanmar by applying spatial point pattern analysis (SPPA) methods.\n\n\nThe R packages we will use today are:\n\nsf\ntmap\nspatstat\nsparr\nraster\nmaptools\n\n\npacman::p_load(sf, raster, spatstat, sparr, tmap, tidyverse)"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html",
    "href": "TakeHome/TakeHome2/take-home-2.html",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "",
    "text": "Drug abuse brings with it significant negative health, financial and social consequences. Yet, illicit drug consumption remains highly prevalent and continues to be a growing problem worldwide. The UNODC has reported an increase in the number of people using illicit drugs to 292 million people worldwide in the decade leading up to 2022. Of these, 228 million people consumed cannabis, 60 million people consumed opiods, 30 million used amphetamines, 23 million used cocaine and 20 million took ecstasy. Further, they found an increase in overdose deaths following the emergence of nitazenes, which is a group of synthetic opioids potentially more dangerous than fentanyl – in several high-income countries. (World Drug Day Report Highlights Spike in Drug Use, Increased Trafficking | UN News, 2024).\nThe aim of today’s study is to discover:\n\nHow the trend of drug offences in Thailand has varied over the past 6 years,\nIf the key indicators of drug abuse and trafficking in Thailand are independent from space,\nIf the indicators of drug abuse and trafficking are indeed spatially-dependent, and if so, where the clusters, outliers and hotspots are located,\nHow these indicators have varied over the past 6 years, by means of emerging hot spot analysis.\n\n\n\nA map of Thailand’s provinces can be accessed here."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.1-setting-the-scene",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.1-setting-the-scene",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "",
    "text": "Drug abuse brings with it significant negative health, financial and social consequences. Yet, illicit drug consumption remains highly prevalent and continues to be a growing problem worldwide. The UNODC has reported an increase in the number of people using illicit drugs to 292 million people worldwide in the decade leading up to 2022. Of these, 228 million people consumed cannabis, 60 million people consumed opiods, 30 million used amphetamines, 23 million used cocaine and 20 million took ecstasy. Further, they found an increase in overdose deaths following the emergence of nitazenes, which is a group of synthetic opioids potentially more dangerous than fentanyl – in several high-income countries. (World Drug Day Report Highlights Spike in Drug Use, Increased Trafficking | UN News, 2024).\nThe aim of today’s study is to discover:\n\nHow the trend of drug offences in Thailand has varied over the past 6 years,\nIf the key indicators of drug abuse and trafficking in Thailand are independent from space,\nIf the indicators of drug abuse and trafficking are indeed spatially-dependent, and if so, where the clusters, outliers and hotspots are located,\nHow these indicators have varied over the past 6 years, by means of emerging hot spot analysis.\n\n\n\nA map of Thailand’s provinces can be accessed here."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.2-the-drug-problem-in-thailand",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.2-the-drug-problem-in-thailand",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.2 The Drug Problem in Thailand",
    "text": "TH2.2 The Drug Problem in Thailand\nThailand (2024 GDP per capita - PPP: $23,401; Gini coefficient: 35.1 - medium; HDI: 0.083 - very high) (International Monetary Fund, 2024) (World Bank, n.d.) (United Nations Development Programme, 2024) is located in close proximity to the Golden Triangle, which comprises the northern part of the country along with northeastern Myanmar and northern Laos. In 2021, its drug trafficking situation remained critical, with 337,186 drug cases in total. While seizures of ketamine decreased between 2020 and 2021, seizures of methamphetamine, ice and heroin increased in the same period, with heroin seeing the biggest increase from 1873kg in 2020 to 4520kg in 2021 (Kanato et al., 2022). Considering that the COVID-19 pandemic - which caused a global economic depression among other socio-economic effects - occurred around this time, it can be theorised that those who encountered economic hardship as a result of the pandemic might turn to drug trafficking to support themselves and their families.\nThe maximum penalty for drug trafficking in Thailand, as is neighbouring Laos, Malaysia and Singapore, is death (Thailand, n.d.). Despite this, smugglers have innovated on new routes through the northern and northeastern borders of the country, and even go so far as to hide shipments in cargo vessels bound for the likes of Singapore, New Zealand, Australia and South Korea. 575 smuggling cases by sea occurred in 2021, in which 4554kg of heroin, 2.4 times more than the previous year, were seized (Kanato et al., 2022).\nDrug use in the country is as problematic. In 2018, 39% of Thais aged between 15 and 24 were involved in illicit drugs. Of youth aged between 15 and 19, there are 300000 who need treatment, and a significant majority attend vocational schools (as opposed to grade schools). Kongjareon et al. (2022) found in a study of 638 students in four vocational schools, that 11.3% reported poly-drug use. Among LGBT students this figure was 20.2%, and among hetrosexual students 9.8%. Factors contributing to the former’s use of drugs include, among other things, counselling needs, intoxicated sex and GPA."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.3-importing-data-and-r-packages",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.3-importing-data-and-r-packages",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.3 Importing data and R packages",
    "text": "TH2.3 Importing data and R packages\nThe R packages we will use today are:\n\nsf\nKendall for computing Kendall rank correction and Mann-Kendall trend test\ntmap\nspatstat\nsfdep and spdep for measures of spatial autocorrelation, and\nsparr\n\n\npacman::p_load(sf, raster, spatstat, sfdep, spdep, sparr, tmap, tidyverse, gridExtra, zoo, Kendall)\n\nWe will be examining a dataset of drug offences in Thailand between 2017 and 2022 retrieved from Kaggle, superimposed against the provincial boundaries of the country. This dataset encompasses a number of drug offence categories, from usage to trafficking and posession and export.\n\nthailand &lt;- st_read(dsn=\"data/geospatial\", layer=\"tha_admbnda_adm1_rtsd_20220121\") %&gt;% st_transform(crs = 4326)\n\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/TakeHome/TakeHome2/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n\nthailand\n\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\nFirst 10 features:\n   Shape_Leng Shape_Area                  ADM1_EN       ADM1_TH ADM1_PCODE\n1    2.417227 0.13133873                  Bangkok  กรุงเทพมหานคร       TH10\n2    1.695100 0.07926199             Samut Prakan    สมุทรปราการ       TH11\n3    1.251111 0.05323766               Nonthaburi         นนทบุรี       TH12\n4    1.884945 0.12698345             Pathum Thani        ปทุมธานี       TH13\n5    3.041716 0.21393797 Phra Nakhon Si Ayutthaya พระนครศรีอยุธยา       TH14\n6    1.739908 0.07920961                Ang Thong        อ่างทอง       TH15\n7    5.693342 0.54578838                 Lop Buri          ลพบุรี       TH16\n8    1.778326 0.06872655                Sing Buri         สิงห์บุรี       TH17\n9    2.896316 0.20907828                 Chai Nat         ชัยนาท       TH18\n10   4.766446 0.29208711                 Saraburi         สระบุรี       TH19\n   ADM1_REF ADM1ALT1EN ADM1ALT2EN ADM1ALT1TH ADM1ALT2TH  ADM0_EN   ADM0_TH\n1      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n2      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n3      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n4      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n5      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n6      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n7      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n8      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n9      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n10     &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n   ADM0_PCODE       date    validOn validTo                       geometry\n1          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((100.6139 13...\n2          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((100.7306 13...\n3          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((100.3415 14...\n4          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((100.8916 14...\n5          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((100.5131 14...\n6          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((100.3332 14...\n7          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((101.3453 15...\n8          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((100.3691 15...\n9          TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((100.1199 15...\n10         TH 2019-02-18 2022-01-22    &lt;NA&gt; MULTIPOLYGON (((101.3994 15...\n\nthailand_drug &lt;- read_csv(\"data/aspatial/thai_drug_offenses_2017_2022.csv\")\n\nRows: 7392 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): types_of_drug_offenses, province_th, province_en\ndbl (2): fiscal_year, no_cases\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nthailand_drug\n\n# A tibble: 7,392 × 5\n   fiscal_year types_of_drug_offenses no_cases province_th   province_en        \n         &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;              \n 1        2017 drug_use_cases            11871 กรุงเทพมหานคร  Bangkok            \n 2        2017 drug_use_cases              200 ชัยนาท         Chai Nat           \n 3        2017 drug_use_cases              553 นนทบุรี         Nonthaburi         \n 4        2017 drug_use_cases              450 ปทุมธานี        Pathum Thani       \n 5        2017 drug_use_cases              378 พระนครศรีอยุธยา Phra Nakhon Si Ayu…\n 6        2017 drug_use_cases              727 ลพบุรี          Loburi             \n 7        2017 drug_use_cases              820 สมุทรปราการ    Samut Prakan       \n 8        2017 drug_use_cases               69 สระบุรี         Saraburi           \n 9        2017 drug_use_cases              127 สิงห์บุรี         Sing Buri          \n10        2017 drug_use_cases              208 อ่างทอง        Ang Thong          \n# ℹ 7,382 more rows\n\n\n\nTH2.3.1 Data Cleansing\nThere are discrepancies in the spelling of the province names between the shapefile and drug offence data, and R does not appear to support table joins if the values are not in English (which means a join by their Thai names is not possible). The only way to ensure all data is accounted for correctly later is to update the names of provinces in the drug offence table so that they match those in the shapefile - otherwise, the provinces with name mismatches will be reflected as missing data. Luckily, only 2 provinces have name mismatches: Bueng Kan and Lop Buri.\n\nthailand_drug &lt;- thailand_drug %&gt;%\n  mutate(province_en = case_when(\n    province_en %in% c(\"buogkan\") ~ \"Bueng Kan\",\n    province_en %in% c(\"Loburi\") ~ \"Lop Buri\",\n    TRUE ~ province_en\n  ))"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.4",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.4",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.4",
    "text": "TH2.4"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#references",
    "href": "TakeHome/TakeHome2/take-home-2.html#references",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "References",
    "text": "References\n\nAnselin, L. (1995). Local indicators of spatial association—LISA. Geographical Analysis, 27(2), 93–115. https://doi.org/10.1111/j.1538-4632.1995.tb00338.x\nGilbert, R. O. (1987). Statistical methods for environmental pollution monitoring. Van Nostrand Reinhold.\nHo, M. (2024, March 1). Take-Home Exercise 2. https://is415-gaa-matthew-ho.netlify.app/takehomeex/takehomeex2/the2\nInternational Monetary Fund. (2024, April 16). World Economic Outlook Database, April 2024 Edition: Thailand. https://www.imf.org/en/Publications/WEO/weo-database/2024/April\nKam, T. S. (2022). R for Geospatial Data Science and Analytics. https://r4gdsa.netlify.app\nKhambhammettu, P. (2005). Mann-Kendall Analysis for the Fort Ord Site (Report No. OU-1 2004 Annual Groundwater Monitoring Report-Former Fort Ord, California). HydroGeoLogic, Inc.\nKhant, M. N. (2024, February 10). Take-Home Exercise 02: Spatio-Temporal Analysis of Dengue Fever Outbreak in Tainan City, Taiwan. https://is415-geospatial-with-khant.netlify.app/take-home_ex/take-home_ex02/take-home_ex02\nKongjareon, Y., Samoh, N., Peerawaranun, P. et al. Pride-based violence, intoxicated sex and poly-drug use: a vocational school-based study of heterosexual and LGBT students in Bangkok. BMC Psychiatry 22, 148 (2022). https://doi.org/10.1186/s12888-022-03777-7\nKanato, M., Sarasiri, R., & Leyatikul, P. (Eds.). (2022). ASEAN drug monitoring report 2021. ASEAN Narcotics Cooperation Center. https://asean.org/wp-content/uploads/2023/11/Drug-Monitoring-Report-2021.pdf\nMoraga, P. (2024). Spatial neighbourhood matrices. In Spatial statistics for Data Science: Theory and practice with R (pp. 83–94). CRC Press.\nThailand. (n.d.). Hands-Off Cain. Retrieved 23 September 2024, from https://www.handsoffcain.info/bancadati/asia-middle-east-australia-and-oceania/thailand-17000464\nThe Lancet Regional Health – Southeast Asia. (2023). Escape from quicksand: Illicit drug use among youth in southeast Asia. The Lancet Regional Health - Southeast Asia, 10, 100175. https://doi.org/10.1016/j.lansea.2023.100175\nTobler, W. R. (1970). A computer movie simulating urban growth in the Detroit region. Economic Geography (Supplement: Proceedings, International Geographical Union. Commission on Quantitative Methods), 46, 234-240. https://doi.org/10.2307/143141\nUnited Nations Development Programme. (2024, March 13). Human Development Report 2023/2024 (PDF). Retrieved September 23, 2024, from https://hdr.undp.org/sites/default/files/reports/3503/hdr2023-24reporten.pdf\nWorld Bank. (n.d.). Gini index. Retrieved September 23, 2024, from https://www.worldbank.org/en/topic/poverty/brief/gini-index\nWorld Bank Open Data. (n.d.). Unemployment, total (% of total labor force) (national estimate) - Thailand. Retrieved 27 September 2024, from https://data.worldbank.org/indicator/SL.UEM.TOTL.NE.ZS?end=2023&locations=TH\nWorld Drug Day report highlights spike in drug use, increased trafficking | UN News. (2024, June 26). United Nations. https://news.un.org/en/story/2024/06/1151446"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html",
    "href": "InClass/ICE5/in-class-6.html",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "",
    "text": "pacman::p_load(sf, sfdep, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.1-import-packages",
    "href": "InClass/ICE5/in-class-6.html#ce6.1-import-packages",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "",
    "text": "pacman::p_load(sf, sfdep, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.2-preparing-data",
    "href": "InClass/ICE5/in-class-6.html#ce6.2-preparing-data",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.2 Preparing data",
    "text": "CE6.2 Preparing data\n\nCE6.2.1 Importing Hunan data shapefile\n\nhunan &lt;- st_read(dsn = \"data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/InClass/ICE5/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\nCE6.2.2 Importing Hunan 2012 Census Data\n\ndev_2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\nCE6.2.3 Performing relational join\n\nhunan &lt;- left_join(hunan, dev_2012) %&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`\n\n  # Only selects fields we are interested in, in this case GDP per capita"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.3-deriving-continuity-weights-queen-method",
    "href": "InClass/ICE5/in-class-6.html#ce6.3-deriving-continuity-weights-queen-method",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.3 Deriving continuity weights: QUEEN method",
    "text": "CE6.3 Deriving continuity weights: QUEEN method\n\nwm_q &lt;- hunan %&gt;%\n    mutate(nb = st_contiguity(geometry),\n            wt = st_weights(nb, style = \"W\"),\n            .before = 1) # Insert into the front - easier to examine later\nwm_q\n\nSimple feature collection with 88 features and 8 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\nFirst 10 features:\n                               nb\n1                 2, 3, 4, 57, 85\n2               1, 57, 58, 78, 85\n3                     1, 4, 5, 85\n4                      1, 3, 5, 6\n5                     3, 4, 6, 85\n6                4, 5, 69, 75, 85\n7                  67, 71, 74, 84\n8       9, 46, 47, 56, 78, 80, 86\n9           8, 66, 68, 78, 84, 86\n10 16, 17, 19, 20, 22, 70, 72, 73\n                                                                            wt\n1                                                      0.2, 0.2, 0.2, 0.2, 0.2\n2                                                      0.2, 0.2, 0.2, 0.2, 0.2\n3                                                       0.25, 0.25, 0.25, 0.25\n4                                                       0.25, 0.25, 0.25, 0.25\n5                                                       0.25, 0.25, 0.25, 0.25\n6                                                      0.2, 0.2, 0.2, 0.2, 0.2\n7                                                       0.25, 0.25, 0.25, 0.25\n8  0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571\n9             0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667\n10                      0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125\n     NAME_2  ID_3    NAME_3   ENGTYPE_3    County GDPPC\n1   Changde 21098   Anxiang      County   Anxiang 23667\n2   Changde 21100   Hanshou      County   Hanshou 20981\n3   Changde 21101    Jinshi County City    Jinshi 34592\n4   Changde 21102        Li      County        Li 24473\n5   Changde 21103     Linli      County     Linli 25554\n6   Changde 21104    Shimen      County    Shimen 27137\n7  Changsha 21109   Liuyang County City   Liuyang 63118\n8  Changsha 21110 Ningxiang      County Ningxiang 62202\n9  Changsha 21111 Wangcheng      County Wangcheng 70666\n10 Chenzhou 21112     Anren      County     Anren 12761\n                         geometry\n1  POLYGON ((112.0625 29.75523...\n2  POLYGON ((112.2288 29.11684...\n3  POLYGON ((111.8927 29.6013,...\n4  POLYGON ((111.3731 29.94649...\n5  POLYGON ((111.6324 29.76288...\n6  POLYGON ((110.8825 30.11675...\n7  POLYGON ((113.9905 28.5682,...\n8  POLYGON ((112.7181 28.38299...\n9  POLYGON ((112.7914 28.52688...\n10 POLYGON ((113.1757 26.82734..."
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.4-computing-global-morans-i",
    "href": "InClass/ICE5/in-class-6.html#ce6.4-computing-global-morans-i",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.4 Computing Global Moran’s I",
    "text": "CE6.4 Computing Global Moran’s I\n\nmoranI &lt;- global_moran(wm_q$GDPPC, wm_q$nb, wm_q$wt)\nglimpse(moranI)\n\nList of 2\n $ I: num 0.301\n $ K: num 7.64\n\n# K = average neighbours found"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.5-performing-global-morans-i-test",
    "href": "InClass/ICE5/in-class-6.html#ce6.5-performing-global-morans-i-test",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.5 Performing Global Moran’s I Test",
    "text": "CE6.5 Performing Global Moran’s I Test\n\n# Frequentist method\nglobal_moran_test(wm_q$GDPPC, wm_q$nb, wm_q$wt)\n\n\n    Moran I test under randomisation\n\ndata:  x  \nweights: listw    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n# If p &lt; a (usually 0.05), reject null hypothesis H0"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.6-permutation-test",
    "href": "InClass/ICE5/in-class-6.html#ce6.6-permutation-test",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.6 Permutation Test",
    "text": "CE6.6 Permutation Test\n\n# Bayesian vs frequentist inference\nset.seed(1234)\nglobal_moran_perm(wm_q$GDPPC, wm_q$nb, wm_q$wt, nsim = 999) # Try to run as many trials as possible\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.7-computing-local-morans-i",
    "href": "InClass/ICE5/in-class-6.html#ce6.7-computing-local-morans-i",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.7 Computing Local Moran’s I",
    "text": "CE6.7 Computing Local Moran’s I\n\nlisa &lt;- wm_q %&gt;% mutate(local_moran = local_moran(GDPPC, nb, wt, nsim = 999), .before = 1) %&gt;%\n        unnest(local_moran) # Create one single table\nlisa\n\nSimple feature collection with 88 features and 20 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n# A tibble: 88 × 21\n         ii        eii    var_ii     z_ii    p_ii p_ii_sim p_folded_sim skewness\n      &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;\n 1 -0.00147  0.000241    5.19e-4 -0.0750  9.40e-1    0.808        0.404   -1.05 \n 2  0.0259  -0.00256     1.16e-2  0.264   7.92e-1    0.956        0.478   -1.02 \n 3 -0.0120  -0.0140      1.12e-1  0.00601 9.95e-1    0.84         0.42     0.934\n 4  0.00102 -0.0000553   4.97e-6  0.483   6.29e-1    0.572        0.286    0.962\n 5  0.0148   0.00232     1.48e-3  0.325   7.45e-1    0.658        0.329    0.820\n 6 -0.0388  -0.00627     6.09e-3 -0.417   6.77e-1    0.822        0.411    0.902\n 7  3.37    -0.0727      1.66e+0  2.67    7.55e-3    0.046        0.023    1.16 \n 8  1.56    -0.118       8.52e-1  1.82    6.89e-2    0.112        0.056    0.887\n 9  4.42    -0.131       1.58e+0  3.63    2.88e-4    0.008        0.004    1.03 \n10 -0.399   -0.00763     7.87e-2 -1.40    1.63e-1    0.178        0.089   -0.897\n# ℹ 78 more rows\n# ℹ 13 more variables: kurtosis &lt;dbl&gt;, mean &lt;fct&gt;, median &lt;fct&gt;, pysal &lt;fct&gt;,\n#   nb &lt;nb&gt;, wt &lt;list&gt;, NAME_2 &lt;chr&gt;, ID_3 &lt;int&gt;, NAME_3 &lt;chr&gt;,\n#   ENGTYPE_3 &lt;chr&gt;, County &lt;chr&gt;, GDPPC &lt;dbl&gt;, geometry &lt;POLYGON [°]&gt;\n\n# p_folded_sim: k-fold replacement\n# p_ii_sim: Moran's I sim\n# Mean, median, skewness:\n# Left skewed/right skewed: use MEDIAN\n# Close to 0: use MEAN"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.8-visualising-local-morans-i",
    "href": "InClass/ICE5/in-class-6.html#ce6.8-visualising-local-morans-i",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.8 Visualising Local Moran’s I",
    "text": "CE6.8 Visualising Local Moran’s I\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) + tm_fill(\"ii\") + tm_borders(alpha = 0.5) + tm_view(set.zoom.limits = c(7, 8)) + tm_layout(main.title = \"Local Moran's I of GDPPC\", main.title.size = 1)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.9-visualising-p-values",
    "href": "InClass/ICE5/in-class-6.html#ce6.9-visualising-p-values",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.9 Visualising p-values",
    "text": "CE6.9 Visualising p-values\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\np_value_map &lt;- tm_shape(lisa) + tm_fill(\"p_ii_sim\") + tm_borders(alpha = 0.5) + tm_view(set.zoom.limits = c(7, 8)) + tm_layout(main.title = \"Local Moran's I of GDPPC\", main.title.size = 1)\n\n# To plot 2 maps side by side, save the maps to an output and refer to them\n# using tmap_arrange()\ntmap_arrange(local_moran_map, p_value_map, ncol = 2)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce6.8-visualising-local-morans-i-and-p-values",
    "href": "InClass/ICE5/in-class-6.html#ce6.8-visualising-local-morans-i-and-p-values",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE6.8 Visualising Local Moran’s I and p-values",
    "text": "CE6.8 Visualising Local Moran’s I and p-values\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nlocal_moran_map &lt;- tm_shape(lisa) + tm_fill(\"ii\") + tm_borders(alpha = 0.5) + tm_view(set.zoom.limits = c(7, 8)) + tm_layout(main.title = \"Local Moran's I of GDPPC\", main.title.size = 1)"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce5.10-lisa-map",
    "href": "InClass/ICE5/in-class-6.html#ce5.10-lisa-map",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE5.10 LISA map",
    "text": "CE5.10 LISA map\n\nlisa_sig &lt;- lisa %&gt;% filter(p_ii &lt; 0.05) # Significant\ntm_shape(lisa) + tm_polygons() + tm_borders(alpha = 0.5) + tm_shape(lisa_sig) + tm_fill(\"mean\") + tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\n\n\n\n# Purple: low-high outlier\n# Green: low-low cluster\n# Red: high-high cluster"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce5.11-computing-local-gi-statistics",
    "href": "InClass/ICE5/in-class-6.html#ce5.11-computing-local-gi-statistics",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE5.11 Computing local Gi* statistics",
    "text": "CE5.11 Computing local Gi* statistics\n\n# Gstat methods give us hot spots and cold spots\n# LISAs give us clusters and outliers\nwm_idw &lt;- hunan %&gt;% \n    mutate(nb = st_contiguity(geometry),\n            wts = st_inverse_distance(nb, geometry, scale = 1, alpha = 1),\n            .before = 1)\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wts = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\nwm_idw\n\nSimple feature collection with 88 features and 8 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\nFirst 10 features:\n                               nb\n1                 2, 3, 4, 57, 85\n2               1, 57, 58, 78, 85\n3                     1, 4, 5, 85\n4                      1, 3, 5, 6\n5                     3, 4, 6, 85\n6                4, 5, 69, 75, 85\n7                  67, 71, 74, 84\n8       9, 46, 47, 56, 78, 80, 86\n9           8, 66, 68, 78, 84, 86\n10 16, 17, 19, 20, 22, 70, 72, 73\n                                                                                              wts\n1                                      0.01526149, 0.03515537, 0.02176677, 0.02836978, 0.01029857\n2                                      0.01526149, 0.01601100, 0.01911052, 0.02327058, 0.01591694\n3                                                  0.03515537, 0.04581089, 0.04116397, 0.01208437\n4                                                  0.02176677, 0.04581089, 0.04637578, 0.01585302\n5                                                  0.04116397, 0.04637578, 0.01896212, 0.01351099\n6                                      0.01585302, 0.01896212, 0.02710909, 0.01140718, 0.01080890\n7                                                  0.01621067, 0.01536702, 0.01133628, 0.01836488\n8              0.01930410, 0.02675555, 0.02151751, 0.01076895, 0.02608065, 0.01519804, 0.01337412\n9                          0.01930410, 0.01651371, 0.01798519, 0.01473155, 0.03015561, 0.01612293\n10 0.02737233, 0.01390810, 0.01458881, 0.02156771, 0.02419268, 0.02350470, 0.01784174, 0.01621545\n     NAME_2  ID_3    NAME_3   ENGTYPE_3    County GDPPC\n1   Changde 21098   Anxiang      County   Anxiang 23667\n2   Changde 21100   Hanshou      County   Hanshou 20981\n3   Changde 21101    Jinshi County City    Jinshi 34592\n4   Changde 21102        Li      County        Li 24473\n5   Changde 21103     Linli      County     Linli 25554\n6   Changde 21104    Shimen      County    Shimen 27137\n7  Changsha 21109   Liuyang County City   Liuyang 63118\n8  Changsha 21110 Ningxiang      County Ningxiang 62202\n9  Changsha 21111 Wangcheng      County Wangcheng 70666\n10 Chenzhou 21112     Anren      County     Anren 12761\n                         geometry\n1  POLYGON ((112.0625 29.75523...\n2  POLYGON ((112.2288 29.11684...\n3  POLYGON ((111.8927 29.6013,...\n4  POLYGON ((111.3731 29.94649...\n5  POLYGON ((111.6324 29.76288...\n6  POLYGON ((110.8825 30.11675...\n7  POLYGON ((113.9905 28.5682,...\n8  POLYGON ((112.7181 28.38299...\n9  POLYGON ((112.7914 28.52688...\n10 POLYGON ((113.1757 26.82734...\n\nHCSA &lt;- wm_idw %&gt;% mutate(local_Gi = local_gstar_perm(GDPPC, nb, wt, nsim = 999), .before = 1) %&gt;%\nunnest(local_Gi)\nHCSA\n\nSimple feature collection with 88 features and 18 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n# A tibble: 88 × 19\n   gi_star cluster   e_gi    var_gi  std_dev p_value p_sim p_folded_sim skewness\n     &lt;dbl&gt; &lt;fct&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;\n 1  0.0416 Low     0.0113   6.30e-6  0.0769  9.39e-1 0.786        0.393    0.890\n 2 -0.333  Low     0.0111   7.06e-6 -0.260   7.95e-1 0.954        0.477    0.916\n 3  0.281  High    0.0122   7.77e-6  0.00601 9.95e-1 0.81         0.405    1.17 \n 4  0.411  High    0.0113   7.63e-6  0.489   6.25e-1 0.558        0.279    1.00 \n 5  0.387  High    0.0116   8.72e-6  0.326   7.45e-1 0.62         0.31     1.01 \n 6 -0.368  High    0.0114   6.22e-6 -0.425   6.71e-1 0.802        0.401    0.841\n 7  3.56   High    0.0149   7.44e-6  2.67    7.57e-3 0.04         0.02     1.06 \n 8  2.52   High    0.0134   4.88e-6  1.77    7.72e-2 0.112        0.056    0.880\n 9  4.56   High    0.0142   4.97e-6  3.89    9.92e-5 0.006        0.003    0.770\n10  1.16   Low     0.0108   4.92e-6  1.39    1.63e-1 0.21         0.105    0.730\n# ℹ 78 more rows\n# ℹ 10 more variables: kurtosis &lt;dbl&gt;, nb &lt;nb&gt;, wts &lt;list&gt;, NAME_2 &lt;chr&gt;,\n#   ID_3 &lt;int&gt;, NAME_3 &lt;chr&gt;, ENGTYPE_3 &lt;chr&gt;, County &lt;chr&gt;, GDPPC &lt;dbl&gt;,\n#   geometry &lt;POLYGON [°]&gt;"
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce5.12-visualising-gi-statistics",
    "href": "InClass/ICE5/in-class-6.html#ce5.12-visualising-gi-statistics",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE5.12 Visualising Gi* statistics",
    "text": "CE5.12 Visualising Gi* statistics\n\ntm_shape(HCSA) + tm_fill(\"gi_star\") + tm_borders(alpha = 0.5) + tm_view(set.zoom.limits = c(6, 8))\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "InClass/ICE5/in-class-6.html#ce5.13-visualising-hot-and-cold-spot-areas",
    "href": "InClass/ICE5/in-class-6.html#ce5.13-visualising-hot-and-cold-spot-areas",
    "title": "CE6: Measures of Spatial Autocorrelation",
    "section": "CE5.13 Visualising hot and cold spot areas",
    "text": "CE5.13 Visualising hot and cold spot areas\n\nHCSA_sig &lt;- HCSA %&gt;% filter(p_sim &lt; 0.05)\ntm_shape(HCSA) + tm_polygons() + tm_borders(alpha = 0.5) + tm_shape(HCSA_sig) + tm_fill(\"gi_star\") + tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.4-data-exploration-and-preprocessing",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.4-data-exploration-and-preprocessing",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.4 Data exploration and preprocessing",
    "text": "TH2.4 Data exploration and preprocessing\nThe code chunk below prints the unique types of drug offence cases.\n\nunique_drug &lt;- thailand_drug %&gt;% distinct(types_of_drug_offenses)\nunique_drug\n\n# A tibble: 16 × 1\n   types_of_drug_offenses                                \n   &lt;chr&gt;                                                 \n 1 drug_use_cases                                        \n 2 suspects_in_drug_use_cases                            \n 3 possession_cases                                      \n 4 suspects_in_possession_cases                          \n 5 possession_with_intent_to_distribute_cases            \n 6 suspects_in_possession_with_intent_to_distribute_cases\n 7 trafficking_cases                                     \n 8 suspects_in_trafficking_cases                         \n 9 production_cases                                      \n10 suspects_in_production_cases                          \n11 import_cases                                          \n12 suspects_in_import_cases                              \n13 export_cases                                          \n14 suspects_in_export_cases                              \n15 conspiracy_cases                                      \n16 suspects_in_conspiracy_cases"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.4-exploratory-data-analysis",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.4-exploratory-data-analysis",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.4 Exploratory Data Analysis",
    "text": "TH2.4 Exploratory Data Analysis\nThe code chunk below prints the total number of each unique type of drug offence cases.\n\nthailand_drug_analysis &lt;- thailand_drug %&gt;% \n  group_by(types_of_drug_offenses) %&gt;% \n  summarise(total_cases = sum(no_cases)) %&gt;% ungroup()\nthailand_drug_analysis\n\n# A tibble: 16 × 2\n   types_of_drug_offenses                                 total_cases\n   &lt;chr&gt;                                                        &lt;dbl&gt;\n 1 conspiracy_cases                                               920\n 2 drug_use_cases                                              915529\n 3 export_cases                                                    84\n 4 import_cases                                                   860\n 5 possession_cases                                            538893\n 6 possession_with_intent_to_distribute_cases                  341283\n 7 production_cases                                             56892\n 8 suspects_in_conspiracy_cases                                  2332\n 9 suspects_in_drug_use_cases                                  930768\n10 suspects_in_export_cases                                       102\n11 suspects_in_import_cases                                      1066\n12 suspects_in_possession_cases                                566999\n13 suspects_in_possession_with_intent_to_distribute_cases      386946\n14 suspects_in_production_cases                                 66247\n15 suspects_in_trafficking_cases                                79997\n16 trafficking_cases                                            68379\n\n\nThere are a total of 8 different types of cases, with another 8 unique values dedicated to suspected instances of cases.\nWe are particularly interested in drug use and trafficking cases, so we will now attempt to plot the changes in the number of each type of case between 2017 and 2022. This analysis will help us select study periods to analyse later.\n\nTH2.4.1 Plotting changes in drug trafficking cases by time\n\nthailand_drug_trafficking &lt;- thailand_drug %&gt;% filter(types_of_drug_offenses %in% c(\"trafficking_cases\", \"suspects_in_trafficking_cases\", \"possession_with_intent_to_distribute_cases\", \"suspects_in_possession_with_intent_to_distribute_cases\")) %&gt;%\n  group_by(fiscal_year) %&gt;%\n  summarise(total_cases = sum(no_cases[types_of_drug_offenses == \"trafficking_cases\"]),\n    total_suspect_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_trafficking_cases\"]),\n    total_posession_intent_cases = sum(no_cases[types_of_drug_offenses == \"possession_with_intent_to_distribute_cases\"]),\n    total_suspect_posession_intent_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_possession_with_intent_to_distribute_cases\"])) %&gt;%\n  ungroup()\nthailand_drug_trafficking\n\n# A tibble: 6 × 5\n  fiscal_year total_cases total_suspect_cases total_posession_intent_cases\n        &lt;dbl&gt;       &lt;dbl&gt;               &lt;dbl&gt;                        &lt;dbl&gt;\n1        2017       13089               15603                        55644\n2        2018       12034               14630                        64205\n3        2019       11366               13498                        63194\n4        2020       12248               13918                        67014\n5        2021       10847               12395                        68681\n6        2022        8795                9953                        22545\n# ℹ 1 more variable: total_suspect_posession_intent_cases &lt;dbl&gt;\n\nggplot(data = thailand_drug_trafficking, aes(x = fiscal_year)) +     \n  geom_line(aes(y = total_cases, color = \"trafficking_cases\"), size = 1) + \n  geom_point(aes(y = total_cases, color = \"trafficking_cases\"), size = 2) +\n  geom_line(aes(y = total_suspect_cases, color = \"suspects_in_trafficking_cases\"), size = 1) + \n  geom_point(aes(y = total_suspect_cases, color = \"suspects_in_trafficking_cases\"), size = 2) +\n  labs(title = \"Trafficking Cases and Suspects\",\n       x = \"Year\",\n       y = \"Number of cases\") +\n  scale_color_manual(values = c(\"trafficking_cases\" = \"purple3\", \"suspects_in_trafficking_cases\" = \"plum\")) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\", \n        legend.justification = \"right\") +\n  guides(color = guide_legend(title = \"Legend\"))\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\nggplot(data = thailand_drug_trafficking, aes(x = fiscal_year)) +\n  geom_line(aes(y = total_posession_intent_cases, color = \"possession_with_intent_to_distribute_cases\"), size = 1) + \n  geom_point(aes(y = total_posession_intent_cases, color = \"possession_with_intent_to_distribute_cases\"), size = 2) +\n  geom_line(aes(y = total_suspect_posession_intent_cases, color = \"suspects_in_possession_with_intent_to_distribute_cases\"), size = 1) + \n  geom_point(aes(y = total_suspect_posession_intent_cases, color = \"suspects_in_possession_with_intent_to_distribute_cases\"), size = 2) +\n  labs(title = \"Possession with Intent to Distribute Cases and Suspects\",\n       x = \"Year\",\n       y = \"Number of cases\") +\n  scale_color_manual(values = c(\"possession_with_intent_to_distribute_cases\" = \"black\", \n                                \"suspects_in_possession_with_intent_to_distribute_cases\" = \"gray\")) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\", \n        legend.justification = \"right\") +\n  guides(color = guide_legend(title = \"Legend\"))\n\n\n\n\n\n\n\n# grid.arrange(plot1, plot2, ncol = 2)\n\nThe number of trafficking cases generally trended downwards between 2017 and 2022, though there was a momentary increase between 2019 and 2020. Meanwhile the number of posession cases with intent to distribute rose steadily until 2021, before plunging in 2022.\n\n\nTH2.4.2 Plotting changes in drug use cases by time\n\nthailand_drug_trafficking &lt;- thailand_drug %&gt;% filter(types_of_drug_offenses %in% c(\"drug_use_cases\", \"suspects_in_drug_use_cases\", \"possession_cases\", \"suspects_in_possession_cases\")) %&gt;%\n  group_by(fiscal_year) %&gt;%\n  summarise(total_use_cases = sum(no_cases[types_of_drug_offenses == \"drug_use_cases\"]),\n    total_suspect_use_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_drug_use_cases\"]),\n    total_posession_cases = sum(no_cases[types_of_drug_offenses == \"possession_cases\"]),\n    total_suspect_posession_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_possession_cases\"])) %&gt;%\n  ungroup()\nthailand_drug_trafficking\n\n# A tibble: 6 × 5\n  fiscal_year total_use_cases total_suspect_use_cases total_posession_cases\n        &lt;dbl&gt;           &lt;dbl&gt;                   &lt;dbl&gt;                 &lt;dbl&gt;\n1        2017           91444                   93895                 90845\n2        2018          146761                  150049                100941\n3        2019          177078                  179823                104365\n4        2020          141570                  141761                 87997\n5        2021          231406                  235803                 93976\n6        2022          127270                  129437                 60769\n# ℹ 1 more variable: total_suspect_posession_cases &lt;dbl&gt;\n\nggplot(data = thailand_drug_trafficking, aes(x = fiscal_year)) +     \n  # geom_bar(stat = \"identity\", fill = \"red4\") +\n  geom_line(aes(x = fiscal_year, y = total_use_cases, color = \"drug_use\"), size = 1) + geom_point(aes(x = fiscal_year, y = total_use_cases, color = \"drug_use\"), size = 2) +\n  geom_line(aes(x = fiscal_year, y = total_suspect_use_cases, color = \"suspects_in_drug_use_cases\"), size = 1) + geom_point(aes(x = fiscal_year, y = total_suspect_use_cases, color = \"suspects_in_drug_use_cases\"), size = 2) +\n  geom_line(aes(x = fiscal_year, y = total_posession_cases, color = \"possession_cases\"), size = 1) + geom_point(aes(x = fiscal_year, y = total_posession_cases, color = \"possession_cases\"), size = 2) +\n  geom_line(aes(x = fiscal_year, y = total_suspect_posession_cases, color = \"suspects_in_possession_cases\"), size = 1) + geom_point(aes(x = fiscal_year, y = total_suspect_posession_cases, color = \"suspects_in_possession_cases\"), size = 2) +\n    labs(title = \"Drug use and suspected cases by year\",\n         x = \"Year\",\n         y = \"Number of cases\") +\n    scale_color_manual(values = c(\"drug_use\" = \"skyblue1\", \"suspects_in_drug_use_cases\" = \"green3\", \"possession_cases\" = \"red2\", \"suspects_in_possession_cases\" = \"yellow3\")) +\n    theme_minimal() +\n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(title = \"Legend\"))\n\n\n\n\n\n\n\n\nThere was a spike in the number of drug use cases in 2021 in an otherwise variable set of data. Meanwhile, drug possession cases generally declined after 2019, though there was a slight increase in 2021.\nFrom both analysis steps, it makes sense to select the drug use and trafficking cases in 2021 for further analysis. The year 2021 coincided with a rise in the country’s unemployment rate to 1.2% from 0.7% two years prior (World Bank Open Data, n.d.), as the Thai economy was still recovering from the COVID-19 pandemic. Unemployment increases susceptibility to, among other negative effects, drug use."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.4.3-creating-filtered-table-for-2021-observations",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.4.3-creating-filtered-table-for-2021-observations",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.4.3 Creating filtered table for 2021 observations",
    "text": "TH2.4.3 Creating filtered table for 2021 observations\nThe following code chunks create a filtered table for the confirmed drug use and trafficking observations that occurred in 2021, groups and summarises them by province, and plots the numbers onto the provincial map of Thailand.\n\nthailand_2021_drug &lt;- thailand_drug %&gt;%\n  filter(fiscal_year == \"2021\") %&gt;%\n  filter(types_of_drug_offenses %in% c(\"drug_use_cases\", \"trafficking_cases\")) %&gt;%\n  group_by(province_en) %&gt;%\n  summarise(total_use_cases = sum(no_cases[types_of_drug_offenses == \"drug_use_cases\"]),\n            total_trafficking_cases = sum(no_cases[types_of_drug_offenses == \"trafficking_cases\"])) %&gt;%\n  ungroup()\n\nthailand_2021_drug\n\n# A tibble: 77 × 3\n   province_en   total_use_cases total_trafficking_cases\n   &lt;chr&gt;                   &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Amnat Charoen            3012                     164\n 2 Ang Thong                 755                      51\n 3 Bangkok                  9625                     250\n 4 Bueng Kan                2705                      20\n 5 Buri Ram                 5110                     399\n 6 Chachoengsao             4111                     197\n 7 Chai Nat                  763                      97\n 8 Chaiyaphum               4620                     181\n 9 Chanthaburi              2200                      31\n10 Chiang Mai               8623                     640\n# ℹ 67 more rows\n\nthailand_2021 &lt;- left_join(thailand, thailand_2021_drug, by = c(\"ADM1_EN\" = \"province_en\"))\nthailand_2021\n\nSimple feature collection with 77 features and 18 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\nFirst 10 features:\n   Shape_Leng Shape_Area                  ADM1_EN       ADM1_TH ADM1_PCODE\n1    2.417227 0.13133873                  Bangkok  กรุงเทพมหานคร       TH10\n2    1.695100 0.07926199             Samut Prakan    สมุทรปราการ       TH11\n3    1.251111 0.05323766               Nonthaburi         นนทบุรี       TH12\n4    1.884945 0.12698345             Pathum Thani        ปทุมธานี       TH13\n5    3.041716 0.21393797 Phra Nakhon Si Ayutthaya พระนครศรีอยุธยา       TH14\n6    1.739908 0.07920961                Ang Thong        อ่างทอง       TH15\n7    5.693342 0.54578838                 Lop Buri          ลพบุรี       TH16\n8    1.778326 0.06872655                Sing Buri         สิงห์บุรี       TH17\n9    2.896316 0.20907828                 Chai Nat         ชัยนาท       TH18\n10   4.766446 0.29208711                 Saraburi         สระบุรี       TH19\n   ADM1_REF ADM1ALT1EN ADM1ALT2EN ADM1ALT1TH ADM1ALT2TH  ADM0_EN   ADM0_TH\n1      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n2      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n3      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n4      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n5      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n6      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n7      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n8      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n9      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n10     &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n   ADM0_PCODE       date    validOn validTo total_use_cases\n1          TH 2019-02-18 2022-01-22    &lt;NA&gt;            9625\n2          TH 2019-02-18 2022-01-22    &lt;NA&gt;            2515\n3          TH 2019-02-18 2022-01-22    &lt;NA&gt;            3202\n4          TH 2019-02-18 2022-01-22    &lt;NA&gt;            1747\n5          TH 2019-02-18 2022-01-22    &lt;NA&gt;            1766\n6          TH 2019-02-18 2022-01-22    &lt;NA&gt;             755\n7          TH 2019-02-18 2022-01-22    &lt;NA&gt;            1925\n8          TH 2019-02-18 2022-01-22    &lt;NA&gt;             683\n9          TH 2019-02-18 2022-01-22    &lt;NA&gt;             763\n10         TH 2019-02-18 2022-01-22    &lt;NA&gt;            1106\n   total_trafficking_cases                       geometry\n1                      250 MULTIPOLYGON (((100.6139 13...\n2                      159 MULTIPOLYGON (((100.7306 13...\n3                       60 MULTIPOLYGON (((100.3415 14...\n4                      106 MULTIPOLYGON (((100.8916 14...\n5                      112 MULTIPOLYGON (((100.5131 14...\n6                       51 MULTIPOLYGON (((100.3332 14...\n7                      142 MULTIPOLYGON (((101.3453 15...\n8                       40 MULTIPOLYGON (((100.3691 15...\n9                       97 MULTIPOLYGON (((100.1199 15...\n10                      69 MULTIPOLYGON (((101.3994 15...\n\n\n\nuse_map &lt;- tm_shape(thailand_2021) + tm_fill(\"total_use_cases\", n = 8, style = \"quantile\") + tm_borders(alpha = 0.5)\nuse_map_equal &lt;- tm_shape(thailand_2021) + tm_fill(\"total_use_cases\", n = 6, style = \"equal\") + tm_borders(alpha = 0.5)\ntmap_arrange(use_map + tm_layout(main.title = \"Drug use across Thailand (quantile)\", main.title.size = 1.2, frame = TRUE), use_map_equal + tm_layout(main.title = \"Drug use across Thailand (equal)\", main.title.size = 1.2, frame = TRUE), asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\nConsidering only confirmed cases of drug use and drug trafficking (and ignoring suspected ones), the provinces with the highest number of drug use cases appear clustered to the northeast, around Sakon Nakhon, and north, around Chiang Mai and Chiang Rai. Both these general regions are either within, or in close proximity to, the Golden Triangle that also encompasses northern Laos and northeastern Myanmar. There are also pockets of high use around the capital Bangkok near the Gulf of Thailand, and the southern provinces including Songkhla province on the border with Kedah, Malaysia, and the resort island province of Phuket. Surprisingly, provinces such as Kanchanaburi and Sing Buri, which are also close to the Golden Triangle, see relatively muted drug use.\n\ntrafficking_map &lt;- tm_shape(thailand_2021) + tm_fill(\"total_trafficking_cases\", n = 8, style = \"quantile\") + tm_borders(alpha = 0.5)\ntrafficking_map_equal &lt;- tm_shape(thailand_2021) + tm_fill(\"total_trafficking_cases\", n = 6, style = \"equal\") + tm_borders(alpha = 0.5)\ntmap_arrange(trafficking_map  + tm_layout(main.title = \"Drug trafficking across Thailand (quantile)\", main.title.size = 1, frame = TRUE), trafficking_map_equal  + tm_layout(main.title = \"Drug trafficking across Thailand (equal)\", main.title.size = 1, frame = TRUE), asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\nThis same general region in the north-northeast also sees the highest concentration of drug trafficking cases throughout the country, with the eastern province of Ubon Ratchatani seeing the largest number of all. The further south within the country, the lower the concentration of drug cases, with one notable anomaly being Surat Thani Province, which contains another resort island - Koh Samui.\nWe will now proceed to rigourously verify these observations using global and local spatial autocorrelation techniques, such as global and local Moran’s I, Geary’s C and G-statistics. In particular, we want to verify if the indicators of drug abuse are indeed spatially dependent, i.e. provinces that see less drug use are clustered with one another and vice-versa, and if so, whether the high-concentration areas identified in the choropleth maps above are indeed hot spots."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.3-importing-data-and-r-packages-1",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.3-importing-data-and-r-packages-1",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.3 Importing data and R packages",
    "text": "TH2.3 Importing data and R packages\nThe R packages we will use today are:\n\nsf\ntmap\nspatstat\nspdep for measures of spatial autocorrelation, and\nsparr\n\n\npacman::p_load(sf, raster, spatstat, spdep, sparr, tmap, tidyverse, gridExtra)\n\nWe will be examining a dataset of drug offences in Thailand between 2017 and 2022 retrieved from Kaggle, superimposed against the provincial boundaries of the country.\n\nthailand &lt;- st_read(dsn=\"data/geospatial\", layer=\"tha_admbnda_adm1_rtsd_20220121\")\n\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `/Users/kendricktty/Gits/SMU_CS/is415-site/TakeHome/TakeHome2/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(thailand) + tm_polygons()\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\nthailand_drug &lt;- read_csv(\"data/aspatial/thai_drug_offenses_2017_2022.csv\") %&gt;% select(fiscal_year, types_of_drug_offenses, no_cases, province_en)\n\nRows: 7392 Columns: 5\n\n\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): types_of_drug_offenses, province_th, province_en\ndbl (2): fiscal_year, no_cases\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nthailand_drug\n\n# A tibble: 7,392 × 4\n   fiscal_year types_of_drug_offenses no_cases province_en             \n         &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;                   \n 1        2017 drug_use_cases            11871 Bangkok                 \n 2        2017 drug_use_cases              200 Chai Nat                \n 3        2017 drug_use_cases              553 Nonthaburi              \n 4        2017 drug_use_cases              450 Pathum Thani            \n 5        2017 drug_use_cases              378 Phra Nakhon Si Ayutthaya\n 6        2017 drug_use_cases              727 Loburi                  \n 7        2017 drug_use_cases              820 Samut Prakan            \n 8        2017 drug_use_cases               69 Saraburi                \n 9        2017 drug_use_cases              127 Sing Buri               \n10        2017 drug_use_cases              208 Ang Thong               \n# ℹ 7,382 more rows"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.4-exploratory-data-analysis-1",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.4-exploratory-data-analysis-1",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.4 Exploratory Data Analysis",
    "text": "TH2.4 Exploratory Data Analysis\nThe code chunk below prints the total number of each unique type of drug offence cases.\n\nthailand_drug_analysis &lt;- thailand_drug %&gt;% \n  group_by(types_of_drug_offenses) %&gt;% \n  summarise(total_cases = sum(no_cases)) %&gt;% ungroup()\nthailand_drug_analysis\n\n# A tibble: 16 × 2\n   types_of_drug_offenses                                 total_cases\n   &lt;chr&gt;                                                        &lt;dbl&gt;\n 1 conspiracy_cases                                               920\n 2 drug_use_cases                                              915529\n 3 export_cases                                                    84\n 4 import_cases                                                   860\n 5 possession_cases                                            538893\n 6 possession_with_intent_to_distribute_cases                  341283\n 7 production_cases                                             56892\n 8 suspects_in_conspiracy_cases                                  2332\n 9 suspects_in_drug_use_cases                                  930768\n10 suspects_in_export_cases                                       102\n11 suspects_in_import_cases                                      1066\n12 suspects_in_possession_cases                                566999\n13 suspects_in_possession_with_intent_to_distribute_cases      386946\n14 suspects_in_production_cases                                 66247\n15 suspects_in_trafficking_cases                                79997\n16 trafficking_cases                                            68379\n\n\nThere are a total of 8 different types of cases, with another 8 unique values dedicated to suspected instances of cases.\nWe are particularly interested in drug use, possession and trafficking cases, so we will now attempt to plot the changes in the number of each type of case between 2017 and 2022. This analysis will help us select study periods to analyse later.\n\nTH2.4.1 Plotting changes in drug trafficking cases by time\n\nthailand_drug_trafficking &lt;- thailand_drug %&gt;% filter(types_of_drug_offenses %in% c(\"trafficking_cases\", \"suspects_in_trafficking_cases\", \"possession_with_intent_to_distribute_cases\", \"suspects_in_possession_with_intent_to_distribute_cases\")) %&gt;%\n  group_by(fiscal_year) %&gt;%\n  summarise(total_cases = sum(no_cases[types_of_drug_offenses == \"trafficking_cases\"]),\n    total_suspect_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_trafficking_cases\"]),\n    total_posession_intent_cases = sum(no_cases[types_of_drug_offenses == \"possession_with_intent_to_distribute_cases\"]),\n    total_suspect_posession_intent_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_possession_with_intent_to_distribute_cases\"])) %&gt;%\n  ungroup()\nthailand_drug_trafficking\n\n# A tibble: 6 × 5\n  fiscal_year total_cases total_suspect_cases total_posession_intent_cases\n        &lt;dbl&gt;       &lt;dbl&gt;               &lt;dbl&gt;                        &lt;dbl&gt;\n1        2017       13089               15603                        55644\n2        2018       12034               14630                        64205\n3        2019       11366               13498                        63194\n4        2020       12248               13918                        67014\n5        2021       10847               12395                        68681\n6        2022        8795                9953                        22545\n# ℹ 1 more variable: total_suspect_posession_intent_cases &lt;dbl&gt;\n\nggplot(data = thailand_drug_trafficking, aes(x = fiscal_year)) +     \n  geom_line(aes(y = total_cases, color = \"trafficking_cases\"), size = 1) + \n  geom_point(aes(y = total_cases, color = \"trafficking_cases\"), size = 2) +\n  geom_line(aes(y = total_suspect_cases, color = \"suspects_in_trafficking_cases\"), size = 1) + \n  geom_point(aes(y = total_suspect_cases, color = \"suspects_in_trafficking_cases\"), size = 2) +\n  labs(title = \"Trafficking Cases and Suspects\",\n       x = \"Year\",\n       y = \"Number of cases\") +\n  scale_color_manual(values = c(\"trafficking_cases\" = \"purple3\", \"suspects_in_trafficking_cases\" = \"plum\")) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\", \n        legend.justification = \"right\") +\n  guides(color = guide_legend(title = \"Legend\"))\n\n\n\n\n\n\n\nggplot(data = thailand_drug_trafficking, aes(x = fiscal_year)) +\n  geom_line(aes(y = total_posession_intent_cases, color = \"possession_with_intent_to_distribute_cases\"), size = 1) + \n  geom_point(aes(y = total_posession_intent_cases, color = \"possession_with_intent_to_distribute_cases\"), size = 2) +\n  geom_line(aes(y = total_suspect_posession_intent_cases, color = \"suspects_in_possession_with_intent_to_distribute_cases\"), size = 1) + \n  geom_point(aes(y = total_suspect_posession_intent_cases, color = \"suspects_in_possession_with_intent_to_distribute_cases\"), size = 2) +\n  labs(title = \"Possession with Intent to Distribute Cases and Suspects\",\n       x = \"Year\",\n       y = \"Number of cases\") +\n  scale_color_manual(values = c(\"possession_with_intent_to_distribute_cases\" = \"black\", \n                                \"suspects_in_possession_with_intent_to_distribute_cases\" = \"gray\")) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\", \n        legend.justification = \"right\") +\n  guides(color = guide_legend(title = \"Legend\"))\n\n\n\n\n\n\n\n# grid.arrange(plot1, plot2, ncol = 2)\n\nThe number of trafficking cases generally trended downwards between 2017 and 2022, though there was a momentary increase between 2019 and 2020. Meanwhile the number of posession cases with intent to distribute rose steadily until 2021, before plunging in 2022.\n\n\nTH2.4.2 Plotting changes in drug use cases by time\n\nthailand_drug_trafficking &lt;- thailand_drug %&gt;% filter(types_of_drug_offenses %in% c(\"drug_use_cases\", \"suspects_in_drug_use_cases\", \"possession_cases\", \"suspects_in_possession_cases\")) %&gt;%\n  group_by(fiscal_year) %&gt;%\n  summarise(total_use_cases = sum(no_cases[types_of_drug_offenses == \"drug_use_cases\"]),\n    total_suspect_use_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_drug_use_cases\"]),\n    total_posession_cases = sum(no_cases[types_of_drug_offenses == \"possession_cases\"]),\n    total_suspect_posession_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_possession_cases\"])) %&gt;%\n  ungroup()\nthailand_drug_trafficking\n\n# A tibble: 6 × 5\n  fiscal_year total_use_cases total_suspect_use_cases total_posession_cases\n        &lt;dbl&gt;           &lt;dbl&gt;                   &lt;dbl&gt;                 &lt;dbl&gt;\n1        2017           91444                   93895                 90845\n2        2018          146761                  150049                100941\n3        2019          177078                  179823                104365\n4        2020          141570                  141761                 87997\n5        2021          231406                  235803                 93976\n6        2022          127270                  129437                 60769\n# ℹ 1 more variable: total_suspect_posession_cases &lt;dbl&gt;\n\nggplot(data = thailand_drug_trafficking, aes(x = fiscal_year)) +     \n  # geom_bar(stat = \"identity\", fill = \"red4\") +\n  geom_line(aes(x = fiscal_year, y = total_use_cases, color = \"drug_use\"), size = 1) + geom_point(aes(x = fiscal_year, y = total_use_cases, color = \"drug_use\"), size = 2) +\n  geom_line(aes(x = fiscal_year, y = total_suspect_use_cases, color = \"suspects_in_drug_use_cases\"), size = 1) + geom_point(aes(x = fiscal_year, y = total_suspect_use_cases, color = \"suspects_in_drug_use_cases\"), size = 2) +\n  geom_line(aes(x = fiscal_year, y = total_posession_cases, color = \"possession_cases\"), size = 1) + geom_point(aes(x = fiscal_year, y = total_posession_cases, color = \"possession_cases\"), size = 2) +\n  geom_line(aes(x = fiscal_year, y = total_suspect_posession_cases, color = \"suspects_in_possession_cases\"), size = 1) + geom_point(aes(x = fiscal_year, y = total_suspect_posession_cases, color = \"suspects_in_possession_cases\"), size = 2) +\n    labs(title = \"Drug use and suspected cases by year\",\n         x = \"Year\",\n         y = \"Number of cases\") +\n    scale_color_manual(values = c(\"drug_use\" = \"skyblue1\", \"suspects_in_drug_use_cases\" = \"green3\", \"possession_cases\" = \"red2\", \"suspects_in_possession_cases\" = \"yellow3\")) +\n    theme_minimal() +\n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(title = \"Legend\"))\n\n\n\n\n\n\n\n\nThere was a spike in the number of drug use cases in 2021 in an otherwise variable set of data. Meanwhile, drug possession cases generally declined after 2019, though there was a slight increase in 2021.\nIt therefore makes sense to select the drug use and drug possession cases in 2021 for further analysis. The year 2021 coincided with a rise in the country’s unemployment rate to 1.2% from 0.7% two years prior (World Bank Open Data, n.d.), as the Thai economy was still recovering from the COVID-19 pandemic. Unemployment increases susceptibility to, among other negative effects, drug use."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.4.3-creating-filtered-table-for-2021-observations-1",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.4.3-creating-filtered-table-for-2021-observations-1",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.4.3 Creating filtered table for 2021 observations",
    "text": "TH2.4.3 Creating filtered table for 2021 observations\n\nthailand_2021_drug &lt;- thailand_drug %&gt;% \n  filter(fiscal_year == \"2021\") %&gt;% \n  filter(types_of_drug_offenses %in% c(\"drug_use_cases\", \"suspects_in_drug_use_cases\", \"possession_cases\", \"suspects_in_possession_cases\", \"trafficking_cases\", \"possession_with_intent_to_distribute_cases\")) %&gt;%\n  group_by(province_en) %&gt;%\n  summarise(total_use_cases = sum(no_cases[types_of_drug_offenses == \"drug_use_cases\"]),\n    total_suspect_use_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_drug_use_cases\"]),\n    total_posession_cases = sum(no_cases[types_of_drug_offenses == \"possession_cases\"]),\n    total_suspect_posession_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_possession_cases\"]),\n    total_trafficking_cases = sum(no_cases[types_of_drug_offenses == \"trafficking_cases\"]),\n    total_suspect_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_trafficking_cases\"]),\n    total_posession_intent_cases = sum(no_cases[types_of_drug_offenses == \"possession_with_intent_to_distribute_cases\"]),\n    total_suspect_posession_intent_cases = sum(no_cases[types_of_drug_offenses == \"suspects_in_possession_with_intent_to_distribute_cases\"])\n)\nthailand_2021_drug\n\n# A tibble: 77 × 9\n   province_en   total_use_cases total_suspect_use_cases total_posession_cases\n   &lt;chr&gt;                   &lt;dbl&gt;                   &lt;dbl&gt;                 &lt;dbl&gt;\n 1 Amnat Charoen            3012                    3066                   505\n 2 Ang Thong                 755                     763                   511\n 3 Bangkok                  9625                    9797                  5121\n 4 Buri Ram                 5110                    5217                   729\n 5 Chachoengsao             4111                    4160                  1033\n 6 Chai Nat                  763                     765                   232\n 7 Chaiyaphum               4620                    4663                  1172\n 8 Chanthaburi              2200                    2236                   514\n 9 Chiang Mai               8623                    8714                  2279\n10 Chiang Rai               5634                    5706                  1324\n# ℹ 67 more rows\n# ℹ 5 more variables: total_suspect_posession_cases &lt;dbl&gt;,\n#   total_trafficking_cases &lt;dbl&gt;, total_suspect_cases &lt;dbl&gt;,\n#   total_posession_intent_cases &lt;dbl&gt;,\n#   total_suspect_posession_intent_cases &lt;dbl&gt;\n\nthailand_2021 &lt;- left_join(thailand, thailand_2021_drug, by = c(\"ADM1_EN\" = \"province_en\"))\nthailand_2021\n\nSimple feature collection with 77 features and 24 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\nFirst 10 features:\n   Shape_Leng Shape_Area                  ADM1_EN       ADM1_TH ADM1_PCODE\n1    2.417227 0.13133873                  Bangkok  กรุงเทพมหานคร       TH10\n2    1.695100 0.07926199             Samut Prakan    สมุทรปราการ       TH11\n3    1.251111 0.05323766               Nonthaburi         นนทบุรี       TH12\n4    1.884945 0.12698345             Pathum Thani        ปทุมธานี       TH13\n5    3.041716 0.21393797 Phra Nakhon Si Ayutthaya พระนครศรีอยุธยา       TH14\n6    1.739908 0.07920961                Ang Thong        อ่างทอง       TH15\n7    5.693342 0.54578838                 Lop Buri          ลพบุรี       TH16\n8    1.778326 0.06872655                Sing Buri         สิงห์บุรี       TH17\n9    2.896316 0.20907828                 Chai Nat         ชัยนาท       TH18\n10   4.766446 0.29208711                 Saraburi         สระบุรี       TH19\n   ADM1_REF ADM1ALT1EN ADM1ALT2EN ADM1ALT1TH ADM1ALT2TH  ADM0_EN   ADM0_TH\n1      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n2      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n3      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n4      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n5      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n6      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n7      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n8      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n9      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n10     &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย\n   ADM0_PCODE       date    validOn validTo total_use_cases\n1          TH 2019-02-18 2022-01-22    &lt;NA&gt;            9625\n2          TH 2019-02-18 2022-01-22    &lt;NA&gt;            2515\n3          TH 2019-02-18 2022-01-22    &lt;NA&gt;            3202\n4          TH 2019-02-18 2022-01-22    &lt;NA&gt;            1747\n5          TH 2019-02-18 2022-01-22    &lt;NA&gt;            1766\n6          TH 2019-02-18 2022-01-22    &lt;NA&gt;             755\n7          TH 2019-02-18 2022-01-22    &lt;NA&gt;              NA\n8          TH 2019-02-18 2022-01-22    &lt;NA&gt;             683\n9          TH 2019-02-18 2022-01-22    &lt;NA&gt;             763\n10         TH 2019-02-18 2022-01-22    &lt;NA&gt;            1106\n   total_suspect_use_cases total_posession_cases total_suspect_posession_cases\n1                     9797                  5121                          5488\n2                     2536                  2310                          2470\n3                     3210                   880                           927\n4                     1756                  1518                          1583\n5                     1779                  1048                          1077\n6                      763                   511                           522\n7                       NA                    NA                            NA\n8                      689                   298                           300\n9                      765                   232                           233\n10                    1127                  1249                          1275\n   total_trafficking_cases total_suspect_cases total_posession_intent_cases\n1                      250                   0                         2821\n2                      159                   0                         1179\n3                       60                   0                          868\n4                      106                   0                          901\n5                      112                   0                          974\n6                       51                   0                          385\n7                       NA                  NA                           NA\n8                       40                   0                          390\n9                       97                   0                          423\n10                      69                   0                          873\n   total_suspect_posession_intent_cases                       geometry\n1                                     0 MULTIPOLYGON (((100.6139 13...\n2                                     0 MULTIPOLYGON (((100.7306 13...\n3                                     0 MULTIPOLYGON (((100.3415 14...\n4                                     0 MULTIPOLYGON (((100.8916 14...\n5                                     0 MULTIPOLYGON (((100.5131 14...\n6                                     0 MULTIPOLYGON (((100.3332 14...\n7                                    NA MULTIPOLYGON (((101.3453 15...\n8                                     0 MULTIPOLYGON (((100.3691 15...\n9                                     0 MULTIPOLYGON (((100.1199 15...\n10                                    0 MULTIPOLYGON (((101.3994 15...\n\n\n\ndrug_usage_2021 &lt;- tm_shape(thailand_2021) + tm_fill(\"total_use_cases\", n = 8, style = \"quantile\") + tm_borders(alpha = 0.5)\ndrug_trafficking_2021 &lt;- tm_shape(thailand_2021) + tm_fill(\"total_trafficking_cases\", n = 8, style = \"quantile\") + tm_borders(alpha = 0.5)"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#references-1",
    "href": "TakeHome/TakeHome2/take-home-2.html#references-1",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "References",
    "text": "References\n\nInternational Monetary Fund. (2024, April 16). World Economic Outlook Database, April 2024 Edition: Thailand. https://www.imf.org/en/Publications/WEO/weo-database/2024/April\nKongjareon, Y., Samoh, N., Peerawaranun, P. et al. Pride-based violence, intoxicated sex and poly-drug use: a vocational school-based study of heterosexual and LGBT students in Bangkok. BMC Psychiatry 22, 148 (2022). https://doi.org/10.1186/s12888-022-03777-7\nKanato, M., Sarasiri, R., & Leyatikul, P. (Eds.). (2022). ASEAN drug monitoring report 2021. ASEAN Narcotics Cooperation Center.\nThailand. (n.d.). Hands-Off Cain. Retrieved 23 September 2024, from https://www.handsoffcain.info/bancadati/asia-middle-east-australia-and-oceania/thailand-17000464\nUnited Nations Development Programme. (2024, March 13). Human Development Report 2023/2024 (PDF). Retrieved September 23, 2024, from https://hdr.undp.org/sites/default/files/reports/3503/hdr2023-24reporten.pdf\nWorld Bank. (n.d.). Gini index. Retrieved September 23, 2024, from https://www.worldbank.org/en/topic/poverty/brief/gini-index\nWorld Bank Open Data. (n.d.). Unemployment, total (% of total labor force) (national estimate) - Thailand. Retrieved 27 September 2024, from https://data.worldbank.org/indicator/SL.UEM.TOTL.NE.ZS?end=2023&locations=TH\nWorld Drug Day report highlights spike in drug use, increased trafficking | UN News. (2024, June 26). United Nations. https://news.un.org/en/story/2024/06/1151446"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.5-deriving-global-measures-of-spatial-autocorrelation",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.5-deriving-global-measures-of-spatial-autocorrelation",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.5 Deriving Global Measures of Spatial Autocorrelation",
    "text": "TH2.5 Deriving Global Measures of Spatial Autocorrelation\nTobler’s (1970) first law of geography states that everything is related to everything else, but near things are more related than distant things. Spatial autocorrelation seeks to determine the extent of Tobler’s first law on a variable or measurement - in our case, the number of drug use and drug trafficking cases. As the illustration below (Khant, 2024) (Moraga, 2023) shows, positive spatial autocorrelation is when adjacent observations have similar data values. In contrast, negative spatial autocorrelation is when adjacent observations have contrasting values, and when the data values appear randomly distributed, no spatial autocorrelation occurs.\n\n\n\nAn illustration on the methods of spatial autocorrelation. (Moraga, 2023)\n\n\nWe will first focus on the global measures of spatial autocorrelation: Moran’s I and Geary’s C. While both seek to determine if the measured variables (in this case, our drug use and drug trafficking statistics) are clustered, dispersed or random, the former looks at the study area as a whole, and the latter quantifies how different each subdivision (province) is different from its immediate neighbours.\n\nTH2.5.1 Data Preparation - Spatial Weights\nBefore computing any global spatial autocorrelation statistics, we first need to construct the spatial weights of the study area. The first step in doing so will be to compute the queen contiguity spatial weights. This means we will consider all neighbours for each province that share an edge and vertex, i.e. are horizontally, vertically and diagonally adjacent.\nWe will create 2 row-standardised spatial weights matrices for confirmed cases only - one for our drug use statistics and another for our drug trafficking statistics. Row-standardisation will take the inverse of the number of neighbours each province has, as derived from our vanilla queen contiguity spatial weights matrix.\n\nthailand_2021_use &lt;- thailand_2021 %&gt;% select(1:3, 17)\nthailand_2021_trafficking &lt;- thailand_2021 %&gt;% select(1:3, 18)\nwm_q_use &lt;- poly2nb(thailand_2021_use, queen=TRUE)\nwm_q_tr &lt;- poly2nb(thailand_2021_trafficking, queen=TRUE)\n\n\nprint(\"Weights matrix for drug use cases\")\n\n[1] \"Weights matrix for drug use cases\"\n\nsummary(wm_q_use)\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6  7  8  9 \n 1  1  5 17 15 17 10  5  4  2 \n1 least connected region:\n14 with 1 link\n2 most connected regions:\n29 51 with 9 links\n\nprint(\"Weights matrix for drug trafficking cases\")\n\n[1] \"Weights matrix for drug trafficking cases\"\n\nsummary(wm_q_tr)\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6  7  8  9 \n 1  1  5 17 15 17 10  5  4  2 \n1 least connected region:\n14 with 1 link\n2 most connected regions:\n29 51 with 9 links\n\n\n\nrswm_q_use &lt;- nb2listw(wm_q_use, style = \"W\", zero.policy = TRUE)\nrswm_q_tr &lt;- nb2listw(wm_q_tr, style = \"W\", zero.policy = TRUE)\n\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1      S2\nW 76 5776 76 36.26113 315.652\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1      S2\nW 76 5776 76 36.26113 315.652\n\n\nWe will also define our null and alternative hypotheses as such:\n\nNull Hypotheses \\(H_0\\):\n\nFor Moran’s I: \\(H_0\\): \\(I = E[I] = 0\\); indicates no spatial autocorrelation, or;\nFor Geary’s C: \\(H_0\\): \\(C = E[C] = 1\\)\n\nAlternative Hypotheses : the tests indicate the presence of spatial autocorrelation:\n\nFor Moran’s I: \\(H_1\\): \\(-1 ≤ I &lt; E[I] \\land E[I] &lt; I ≤ 1\\), and;\nFor Geary’s C: \\(H_1\\) \\(0 ≤ C &lt; E[C] \\land E[C] &lt; C ≤ 3\\)"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.6-gearys-c",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.6-gearys-c",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.6 Geary’s \\(C\\)",
    "text": "TH2.6 Geary’s \\(C\\)\nGeary’s \\(C\\) is another measure of global spatial autocorrelation that describes how features differ from their immediate neighbours. When \\(C &gt; 1\\), the points are dispersed, and when \\(C &lt; 1\\), the points are clustered. A \\(C\\) value of \\(1\\) indicates observations are randomly arranged in space. Geary’s \\(C\\) approaches \\(0\\) when similar values are clustered, and approaches \\(3\\) when dissimilar values are clustered. Geary’s \\(C\\) is inversely proportional to Moran’s I, so higher \\(C\\)s correspond to lower \\(I\\)s.\nJust as before, we will now perform Geary’s C on both our drug_use and drug_trafficking statistics.\n\nTH2.6.1 Geary’s \\(C\\) on drug_use statistics\n\ngeary.test(thailand_2021$total_use_cases, listw=rswm_q_use, zero.policy = TRUE, na.action = na.omit)\n\n\n    Geary C test under randomisation\n\ndata:  thailand_2021$total_use_cases \nweights: rswm_q_use  \nn reduced by no-neighbour observations \n\nGeary C statistic standard deviate = 1.8151, p-value = 0.03476\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n      0.843832653       1.000000000       0.007402704 \n\nset.seed(1234)\nbperm_use &lt;- geary.mc(thailand_2021$total_use_cases, \n                listw=rswm_q_use, \n                nsim=999,\n                zero.policy = TRUE,\n                na.action = na.omit)\nbperm_use\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  thailand_2021$total_use_cases \nweights: rswm_q_use  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.84383, observed rank = 61, p-value = 0.061\nalternative hypothesis: greater\n\nhist(bperm_use$res, main = \"Geary's C Simulation Results for drug_use\", xlab=\"Monte-Carlo Results\", ylab=\"Frequency\") \nabline(v = bperm_use$statistic, col = \"green4\")\n\n\n\n\n\n\n\n\nFrom the output above:\n\nThe Geary’s C statistic is approximately 0.84, which is lower than the expected value of 1.0. Just as a high Moran’s I indicates positive spatial correlation, our Geary’s C statistic, which is less than 1, indicates likewise. Similarly to the conclusion of our Moran’s I investigation, the Geary’s C statistic only indicates moderate positive spatial correlation.\nWith a standard deviation of 3.24 and p-value of0.035 &lt; 0.05`, the test result is statistically significant. If we were to only run the test once, we should be able to reject the null hypothesis of a lack of spatial autocorrelation.\nHowever, while running 1000 permutations yielded a similar Geary’s C observation of 0.84383, this time, our p-value of 0.061 is greater than our threshold of 0.05 at the 95% confidence level. Had we only used Geary’s C, we would not have strong statistical evidence to reject our null hypothesis.\n\nHence, the Geary’s C statistic on drug use cases in 2021 yielded inconclusive results.\n\n\nTH2.6.2 Geary’s \\(C\\) on drug_trafficking statistics\n\ngeary.test(thailand_2021$total_trafficking_cases, listw=rswm_q_tr, zero.policy = TRUE, na.action = na.omit)\n\n\n    Geary C test under randomisation\n\ndata:  thailand_2021$total_trafficking_cases \nweights: rswm_q_tr  \nn reduced by no-neighbour observations \n\nGeary C statistic standard deviate = 2.3998, p-value = 0.008202\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n       0.73939266        1.00000000        0.01179295 \n\nset.seed(1234)\nbperm_tr &lt;- geary.mc(thailand_2021$total_trafficking_cases, \n                listw=rswm_q_tr, \n                nsim=999, zero.policy = TRUE, na.action = na.omit)\nbperm_tr\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  thailand_2021$total_trafficking_cases \nweights: rswm_q_tr  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.73939, observed rank = 20, p-value = 0.02\nalternative hypothesis: greater\n\nhist(bperm_use$res, main = \"Global Geary's C Simulation Results for drug_trafficking\", xlab=\"Monte-Carlo Results\", ylab=\"Frequency\") \nabline(v = bperm_tr$statistic, col = \"purple4\")\n\n\n\n\n\n\n\n\nWhen Geary’s C is run on the drug_trafficking statistics:\n\nThe result yielded is approximately 0.74, which is lower than the expected value of 1.0. It is also lower than the Geary’s C for the drug use data, which indicates that the clustering of drug trafficking hotspots is stronger than that for drug use.\nWith a standard deviation of 2.40 and p-value of 0.008 &lt; 0.05 for a 95% confidence level, the test result is statistically significant. If we were to only run the test once, we should be able to reject the null hypothesis of a lack of spatial autocorrelation.\nNow, running 1000 permutations yielded a similar Geary’s C observation of 0.73939 and a p-value of 0.02 &lt; 0.05 at the 95% confidence level. Even though the p-value is uncomfortably close to the threshold, we can still conclude that our derived Geary’s C for our drug trafficking data is statistically significant.\n\nHence, the Geary’s C measure on drug trafficking cases in 2021 indicates mild positive spatial autocorrelation, albeit stronger than that observed on our drug use statistics."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.7-deriving-local-measures-of-spatial-autocorrelation",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.7-deriving-local-measures-of-spatial-autocorrelation",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.7 Deriving Local Measures of Spatial Autocorrelation",
    "text": "TH2.7 Deriving Local Measures of Spatial Autocorrelation\nBoth Global Moran’s I and Geary’s C only return a surface observation on how Thailand’s drug crime is distributed by province. To identify where the clusters are located, we need to use local indicators of spatial association (LISA), which indicate the extent of spatial clustering around each observation (Anselin, 1995) (Khant, 2024).\nAn example of a LISA is local Moran’s I, which is essentially Moran’s I calculated for each geographical subdivision, in this case the provinces of Thailand. However, with these localised measures, we are able to visualise our findings on a choropleth map, and from there, identify the locations of noteworthy clusters.\nAs before, we will derive the local Moran’s I statistics for both our drug trafficking and drug use data. The localmoran() function use here returns a matrix whose columns mean the following (Kam, 2022):\n\nIi: the local Moran’s I statistics\nE.Ii: the expectation of the local Moran’s I statistics under the randomisation hypothesis\nVar.Ii: the variance of the local Moran’s I statistics under the randomisation hypothesis\nZ.Ii:the standard deviation, and\nPr(): the p-value.\n\n\nlocal_MI_use &lt;- localmoran(thailand_2021$total_use_cases, rswm_q_use)\nlocal_MI_trafficking &lt;- localmoran(thailand_2021$total_trafficking_cases, rswm_q_tr)\n\n# Bind local Moran's I to the Thailand dataset\nthailand_2021_use.localMI &lt;- cbind(thailand_2021, local_MI_use) %&gt;% rename(Pr.Ii = Pr.z....E.Ii..)\nthailand_2021_trafficking.localMI &lt;- cbind(thailand_2021, local_MI_trafficking) %&gt;% rename(Pr.Ii = Pr.z....E.Ii..)\n\nWe can then proceed to map the local Moran’s I statistics and p-values. The colour palette used for mapping local Moran’s I p-values (Khant, 2024) helps us easily identify statistically significant results, once again for a 95% confidence interval.\n\nTH2.7.1 Mapping Local Moran’s I statistics for drug_use cases\n\nuse.localMI.map &lt;- tm_shape(thailand_2021_use.localMI) + tm_fill(col = \"Ii\", style = \"pretty\", title = \"drug_use local Moran\") + tm_borders(alpha = 0.5)\nuse.pv.map &lt;- tm_shape(thailand_2021_use.localMI) + tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=c(\"#b7dce9\",\"#c9e3d2\",\"#f5f3a6\",\"#ec9a64\",\"#d21b1c\"), \n          title = \"drug_use p-values\") +\n  tm_borders(alpha = 0.5)\ntmap_arrange(use.localMI.map, use.pv.map, asp = 1, ncol = 2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThere are statistcally significant instances of dissimilar clustering toward the south in Krabi and Phattalung provinces, and a handful towards the central and north. With p-values of 0.1 or more, the local Moran’s I values for the rest of the country cannot be considered to be statistically significant. This is a surprising result for our drug_use data.\n\n\nTH2.7.2 Mapping Local Moran’s I statistics for drug_trafficking cases\n\ntr.localMI.map &lt;- tm_shape(thailand_2021_trafficking.localMI) + tm_fill(col = \"Ii\", style = \"pretty\", title = \"drug_trafficking local Moran\") + tm_borders(alpha = 0.5)\ntr.pv.map &lt;- tm_shape(thailand_2021_trafficking.localMI) + tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=c(\"#b7dce9\",\"#c9e3d2\",\"#f5f3a6\",\"#ec9a64\",\"#d21b1c\"), \n          title = \"drug_trafficking p-values\") +\n  tm_borders(alpha = 0.5)\ntmap_arrange(tr.localMI.map, tr.pv.map, asp = 1, ncol = 2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nAnd likewise for our drug_trafficking statistics. The only statistically significant observation that confirms the hypothesis is Chiang Rai province up north, and Si Sa Ket, the western neighbour of Ubon Ratchathani province, to the east.\n\n\nTH2.7.3 Performing Local Moran’s I Monte Carlo test for drug_use cases\nJust like with global Moran’s I, we can also perform a Monte Carlo permutation test for local Moran’s I, and hopefully return a more realistic result.\n\nlocal_MI_use &lt;- localmoran_perm(thailand_2021$total_use_cases, rswm_q_use, nsim = 999)\nlocal_MI_trafficking &lt;- localmoran_perm(thailand_2021$total_trafficking_cases, rswm_q_tr, nsim = 999)\n\n# Bind local Moran's I permutation to the Thailand dataset\nthailand_2021_use.localMI &lt;- cbind(thailand_2021, local_MI_use) %&gt;% rename(Pr.Ii = Pr.z....E.Ii..)\nthailand_2021_trafficking.localMI &lt;- cbind(thailand_2021, local_MI_trafficking) %&gt;% rename(Pr.Ii = Pr.z....E.Ii..)\n\n\nuse.localMI.map &lt;- tm_shape(thailand_2021_use.localMI) + tm_fill(col = \"Ii\", style = \"pretty\", title = \"drug_use local Moran\") + tm_borders(alpha = 0.5)\nuse.pv.map &lt;- tm_shape(thailand_2021_use.localMI) + tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=c(\"#b7dce9\",\"#c9e3d2\",\"#f5f3a6\",\"#ec9a64\",\"#d21b1c\"), \n          title = \"drug_use p-values\") +\n  tm_borders(alpha = 0.5)\ntmap_arrange(use.localMI.map, use.pv.map, asp = 1, ncol = 2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\nTH2.7.4 Performing Local Moran’s I Monte Carlo test for drug_trafficking cases\n\ntr.localMI.map &lt;- tm_shape(thailand_2021_trafficking.localMI) + tm_fill(col = \"Ii\", style = \"pretty\", title = \"drug_trafficking local Moran\") + tm_borders(alpha = 0.5)\ntr.pv.map &lt;- tm_shape(thailand_2021_trafficking.localMI) + tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=c(\"#b7dce9\",\"#c9e3d2\",\"#f5f3a6\",\"#ec9a64\",\"#d21b1c\"), \n          title = \"drug_trafficking p-values\") +\n  tm_borders(alpha = 0.5)\ntmap_arrange(tr.localMI.map, tr.pv.map, asp = 1, ncol = 2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nJust like last time, the only statistically significant areas to confirm the hypothesis are Chiang Rai and Si Sa Ket.\nEven after 999 simulations, we get results with p-values exceeding 0.05 for a 95% confidence interval, rendering the local Moran’s I values generated to be inconclusive. Nonetheless, by plotting these values on a map anyway, we can still paint a sufficiently high-level picture of the drug situation in the area."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.7.5-drawing-local-morans-i-scatterplots",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.7.5-drawing-local-morans-i-scatterplots",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.7.5 Drawing local Moran’s I scatterplots",
    "text": "TH2.7.5 Drawing local Moran’s I scatterplots\nThe local Moran’s I scatterplot illustrates the relationship between the drug use and trafficking statistics at each location, and the average values at neighbouring locations. It returns a plot with four quardrants as shown in the image below (Kam, 2022).\nInterpretation of Local Moran’s I scatterplot\n\nnci_use &lt;- moran.plot(thailand_2021_use$total_use_cases, rswm_q_use, labels = thailand_2021_use$ADM1_EN, xlab = \"total_use_cases\", ylab = \"Spatially lagged total_use_cases\")\n\n\n\n\n\n\n\nnci_tr &lt;- moran.plot(thailand_2021_trafficking$total_trafficking_cases, rswm_q_tr, labels = thailand_2021_trafficking$ADM1_EN, xlab = \"total_trafficking_cases\", ylab = \"Spatially lagged total_trafficking_cases\")\n\n\n\n\n\n\n\n\nIn terms of drug usage, notable high outliers among low neighbours are Chiang Mai, Bangkok and Phuket, whereas a notable low outlier among high neighbours is Samut Prakan, which is Bangkok’s southeastern neighbour.\nIn terms of drug trafficking, a notable low outlier among high neighbours is Mae Hong Song, on the eastern border with Myanmar and within the Golden Triangle. Major provinces within the Triangle - namely Chiang Rai and Chiang Mai - are considered to be clustered with neighbours also seeing high trafficking.\n\nTH2.7.6 Creating LISA cluster map\nThe above information can also be plotted onto a map colourcoded by the type of spatial autocorrelation. The code chunks below create our LISA maps from our local Moran’s I statistics, and plots the resulting quadrant map along with their corresponding quantile-classified basemaps.\n\nTH2.7.6.1 LISA cluster map for drug use data\n\nquadrant &lt;- vector(mode = \"numeric\", length = nrow(local_MI_use))\nthailand_2021_use$lag_total_use &lt;- lag.listw(rswm_q_use, thailand_2021_use$total_use_cases)\nDV &lt;- thailand_2021_use$lag_total_use - mean(thailand_2021_use$lag_total_use)\nLM_I &lt;- local_MI_use[,1] - mean(local_MI_use[,1])\nsignif &lt;- 0.05\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4    \nquadrant[local_MI_use[,5]&gt;signif] &lt;- 0\nthailand_2021_use.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\n\nuse_LISA &lt;- tm_shape(thailand_2021_use.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\ntmap_arrange(use_LISA, use_map)\n\n\n\n\n\n\n\n\n\n\nTH2.7.6.2 LISA cluster map for drug trafficking data\n\nquadrant &lt;- vector(mode = \"numeric\", length = nrow(local_MI_trafficking))\nthailand_2021_trafficking$lag_total_trafficking &lt;- lag.listw(rswm_q_use, thailand_2021_trafficking$total_trafficking_cases)\nDV &lt;- thailand_2021_trafficking$lag_total_trafficking - mean(thailand_2021_trafficking$lag_total_trafficking)\nLM_I &lt;- local_MI_trafficking[,1] - mean(local_MI_trafficking[,1])\nsignif &lt;- 0.05\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4    \nquadrant[local_MI_trafficking[,5]&gt;signif] &lt;- 0\nthailand_2021_trafficking.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\n\ntr_LISA &lt;- tm_shape(thailand_2021_trafficking.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\ntmap_arrange(tr_LISA, trafficking_map)"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.8-using-local-gi-statistics-to-perform-hot-and-cold-spot-analysis",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.8-using-local-gi-statistics-to-perform-hot-and-cold-spot-analysis",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.8 Using Local Gi* statistics to perform hot and cold spot analysis",
    "text": "TH2.8 Using Local Gi* statistics to perform hot and cold spot analysis\nWe need more local indicators to determine the extent of clustering in our drug crime data. Another method we can use is creating Gertis and Ord’s G-statistics. One of the earliest LISAs (Khant, 2024), they seek to determine the locations of clusters of high and low values - in our case, clusters of provinces with high incidences of drug trafficking, and clusters of those with low incidences of such. These scores are typically reported as z-scores, where positive values indicate a high-high cluster, and negative values indicate a low-low cluster.\nThe analysis consists of three steps:\n\nDeriving the spatial weight matrix,\nComputing the Gi statistics\nMapping the Gi statistics\n\n\nTH2.8.1 drug_use dataset\n\nTH2.8.1.1 Deriving distance-based weight matrices\nFirst, we define an adaptive distance-based weight matrix. We will do this by creating centroids - points associated with each polygon - by extracting longitudes and latitudes. This is done by mapping the st_centroid() function to each polygon in our dataset.\n\n# drug_use data\nlongitude &lt;- map_dbl(thailand_2021_use$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(thailand_2021_use$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Determine cutoff distance\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  21.55   51.92   64.33   63.24   76.77  110.94 \n\n# Compute fixed-distance weight matrix\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B', zero.policy = TRUE)\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6 \n42 16  6  5  4  3  1 \n16 least connected regions:\n7 12 26 30 32 34 41 43 56 62 69 70 73 74 75 77 with 1 link\n1 most connected region:\n3 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn S0  S1   S2\nB 35 1225 80 160 1040\n\n\n\n\nTH2.8.1.2 Computing adaptive distance weight matrix\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 616 \nPercentage nonzero weights: 10.38961 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n77 \n77 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n77 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 77 5929 616 1088 20466\n\n\n\n\nTH2.8.1.3 Computing Gi statistics\n\ngi &lt;- localG(thailand_2021_use$total_use_cases, knn_lw)\nthailand_2021_use.gi &lt;- cbind(thailand_2021_use, as.matrix(gi)) %&gt;% rename(gstat_adaptive = as.matrix.gi.)\n\n\n\nTH2.8.1.4 Plotting drug_use Gi statistics on map\n\ngi_map &lt;- tm_shape(thailand_2021_use.gi) + tm_fill(col = \"gstat_adaptive\", breaks=c(-3, -2, -1.96, -1.65, -1, 0, 1, 1.65, 1.96, 2, 3), palette = \"-RdBu\", title = \"drug_use local Gi\") + tm_borders(alpha = 0.5)\ntmap_arrange(use_map, gi_map)\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThere is one large cold spot to the northwest of the map towards the border with Myanmar, but as far as hot spots are concerned, the best candidate for that is located in the east, towards the border with Cambodia and Laos, and appears lukewarm. Most of that area is only suggestive of a hotspot at a 90% confidence interval, with only 3 provinces - Maha-Sarakham, Amnat-Charoen and Surin - showing strong evidence of a hotspot at a 95% confidence interval.\n\n\n\nTH2.8.2 drug_trafficking dataset\nWe can repeat the entire process again with our drug_trafficking dataset.\n\nTH2.8.2.1 Deriving distance-based weight matrices\n\n# drug_trafficking data\nlongitude &lt;- map_dbl(thailand_2021_trafficking$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(thailand_2021_trafficking$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Determine cutoff distance\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  21.55   51.92   64.33   63.24   76.77  110.94 \n\n# Compute fixed-distance weight matrix\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B', zero.policy = TRUE)\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6 \n42 16  6  5  4  3  1 \n16 least connected regions:\n7 12 26 30 32 34 41 43 56 62 69 70 73 74 75 77 with 1 link\n1 most connected region:\n3 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn S0  S1   S2\nB 35 1225 80 160 1040\n\n\n\n\nTH2.8.2.2 Computing adaptive distance weight matrix\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 616 \nPercentage nonzero weights: 10.38961 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n77 \n77 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n77 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 77 5929 616 1088 20466\n\n\n\n\nTH2.8.2.3 Computing Gi statistics\n\ngi &lt;- localG(thailand_2021_trafficking$total_trafficking_cases, knn_lw)\nthailand_2021_trafficking.gi &lt;- cbind(thailand_2021_trafficking, as.matrix(gi)) %&gt;% rename(gstat_adaptive = as.matrix.gi.)\n\n\n\nTH2.8.2.4 Plotting drug_use Gi statistics on map\n\ngi_map &lt;- tm_shape(thailand_2021_trafficking.gi) + tm_fill(col = \"gstat_adaptive\", breaks=c(-3, -2, -1.96, -1.65, -1, 0, 1, 1.65, 1.96, 2, 3), palette = \"-RdBu\", title = \"drug_trafficking local Gi\") + tm_borders(alpha = 0.5)\ntmap_arrange(use_map, gi_map)\n\nWarning: Values have found that are higher than the highest break\n\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\nWarning: Values have found that are higher than the highest break\n\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThere are no visible cold spots for our drug trafficking data, but there is one suggestive hot spot around Chiang Mai and Chiang Rai to the north (with only Chiang Rai showing a strong possibility), and three statistically significant clusters to the east."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.8.1-deriving-distance-based-weight-matrix",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.8.1-deriving-distance-based-weight-matrix",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.8.1 Deriving distance-based weight matrix",
    "text": "TH2.8.1 Deriving distance-based weight matrix"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.8.1-deriving-distance-based-weight-matrices",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.8.1-deriving-distance-based-weight-matrices",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.8.1 Deriving distance-based weight matrices",
    "text": "TH2.8.1 Deriving distance-based weight matrices\nFirst, we define an adaptive distance-based weight matrix. We will do this by creating centroids - points associated with each polygon - by extracting longitudes and latitudes. This is done by mapping the st_centroid() function to each polygon in our dataset.\n\n# drug_use data\nlongitude &lt;- map_dbl(thailand_2021_use$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(thailand_2021_use$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Determine cutoff distance\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  21.55   51.92   64.33   63.24   76.77  110.94 \n\n# Compute fixed-distance weight matrix\nwm_d62_use &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62_use\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.9-emerging-hotspot-analysis",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.9-emerging-hotspot-analysis",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.9 Emerging Hotspot Analysis",
    "text": "TH2.9 Emerging Hotspot Analysis\nSince we have spatial-temporal data, we are able to perform emerging hotspot analysis, which will help us evaluate how the hot and cold spots in both our datasets have changed over time. It combines the \\(G_i^*\\) statistic with the Man-Kendall test, which is used to assess the direction and statistical significance of a set of data values.\n\nTH2.9.1 Data wrangling for EHSA\nWe need to perform the following checks to ensure our data meets the prerequisites:\n\nThe data is not collected seasonally (it was collected yearly)\nOne point per time period (each time period contains the number of drug use cases and trafficking cases only)\nData does not have covariates (as Matthew (Ho, 2024) rightly points out, while factors such as human population and unemployment rate can affect the number of drug offence cases, we have to work within our limitations in many data science tasks including this one).\n\nOur data fulfills all three requirements, so we can proceed to create a new summary table containing the total number of drug use and trafficking cases each year for each province.\n\nthailand_esa_drug &lt;- thailand_drug %&gt;%\n  filter(types_of_drug_offenses %in% c(\"drug_use_cases\", \"trafficking_cases\")) %&gt;%\n  group_by(province_en, fiscal_year) %&gt;%\n  summarise(total_use_cases = sum(no_cases[types_of_drug_offenses == \"drug_use_cases\"]),\n            total_trafficking_cases = sum(no_cases[types_of_drug_offenses == \"trafficking_cases\"])) %&gt;%\n  ungroup() %&gt;%\n  rename('ADM1_EN' = 'province_en')\n\n`summarise()` has grouped output by 'province_en'. You can override using the\n`.groups` argument.\n\nthailand_esa_drug\n\n# A tibble: 462 × 4\n   ADM1_EN       fiscal_year total_use_cases total_trafficking_cases\n   &lt;chr&gt;               &lt;dbl&gt;           &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Amnat Charoen        2017            1734                     211\n 2 Amnat Charoen        2018            2038                     143\n 3 Amnat Charoen        2019            2642                     212\n 4 Amnat Charoen        2020             843                     165\n 5 Amnat Charoen        2021            3012                     164\n 6 Amnat Charoen        2022            1426                      75\n 7 Ang Thong            2017             208                      51\n 8 Ang Thong            2018             660                      61\n 9 Ang Thong            2019             657                      56\n10 Ang Thong            2020             423                      46\n# ℹ 452 more rows\n\n\nWith our data prepared, we can create a spacetime object using the spacetime() function from the sfdep package, with the following as input:\n\nData: thailand_esa_drug\nGeometry: thailand\nLocation identifier: ADM1_EN (from both thailand_esa_drug and thailand)\nTime column: fiscal_year\n\n\nthailand_drug_spt &lt;- spacetime(thailand_esa_drug, thailand, .loc_col = \"ADM1_EN\", .time_col = \"fiscal_year\", active = \"data\")\nis_spacetime_cube(thailand_drug_spt)\n\n[1] TRUE\n\n\n\n\nTH2.9.2 Performing EHSA\nWe can now perform EHSA analysis using emerging_hotspot_analysis() from the sfdep package. It takes a spacetime object and the name of the variable of interest (.var).\n\nthailand_ehsa_use &lt;- emerging_hotspot_analysis(x = thailand_drug_spt, .var = \"total_use_cases\", k = 1, nsim = 99)\nthailand_ehsa_tr &lt;- emerging_hotspot_analysis(x = thailand_drug_spt, .var = \"total_trafficking_cases\", k = 1, nsim = 99)\n\n\nthailand_ehsa_use &lt;- thailand %&gt;% left_join(thailand_ehsa_use, by = join_by(ADM1_EN == location))\nthailand_ehsa_tr &lt;- thailand %&gt;% left_join(thailand_ehsa_tr, by = join_by(ADM1_EN == location))\n\n\n\nTH2.9.3 Visualising Distribution of EHSA classes\nThe following bar chart reveals the distribution of different EHSA classes per province for both classes of drug offence.\n\nggplot(data = thailand_ehsa_use, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_use\")\n\n\n\n\n\n\n\nggplot(data = thailand_ehsa_tr, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_trafficking\")\n\n\n\n\n\n\n\n\nBased on the plots, thre are a total of 6 distinct hotspot and coldspot classes across both classes of drug offence. However, only the drug_use statistics returned at least one oscilating hotspot, which suggests periodic fluctuations in drug use statistics.\nJust as we discovered in the spatial autocorrelation findings from earlier, EHSA on our drug_use statistics returned 20 instances of sporadic coldspots - the highest among provinces where patterns were detected. However, in both instances, more than half of the provinces of Thailand did not feature any pattern.\nTo check how the findings change when only statistically significant cases are included, we need to isolate only those EHSA classes with p &lt; 0.05 for a 95% confidence interval:\n\nthailand_ehsa_use_sig &lt;- thailand_ehsa_use %&gt;% filter(p_value &lt; 0.05)\nthailand_ehsa_tr_sig &lt;- thailand_ehsa_tr %&gt;% filter(p_value &lt; 0.05)\n\nggplot(data = thailand_ehsa_use_sig, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_use with p &lt; 0.05\")\n\n\n\n\n\n\n\nggplot(data = thailand_ehsa_tr_sig, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_trafficking with p &lt; 0.05\")\n\n\n\n\n\n\n\n\nNo statistically significant drug_use EHSA classifications were returned, while there were no new statistically significant hotspots from our drug_trafficking EHSA classifications.\nWe can try a 90% confidence interval instead for our drug_use EHSA classifications:\n\nthailand_ehsa_use_sig &lt;- thailand_ehsa_use %&gt;% filter(p_value &lt; 0.1)\nggplot(data = thailand_ehsa_use_sig, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_use with p &lt; 0.1\")\n\n\n\n\n\n\n\n\nIf we increased our threshold to 0.1 from 0.05, we are able to detect 1 statistically significant oscilating hotspot.\n\n\nTH2.9.4 Visualising EHSA Maps\nFor this section, we will assume a 95% confidence interval for our drug_trafficking statistics, and ignore statistical significance for our drug_use statistics.\nThe relevant filter() and tmap functions can be used to create maps that will help us identify the geographic distribution of hotspots and coldspots in our study area.\n\nthailand_ehsa_use_hot &lt;- thailand_ehsa_use %&gt;% filter(classification %in% c(\"consecutive hotspot\",\"new hotspot\",\"oscilating hotspot\",\"sporadic hotspot\"))\nthailand_ehsa_use_cold &lt;- thailand_ehsa_use %&gt;% filter(classification %in% c(\"consecutive coldspot\",\"oscilating coldspot\",\"sporadic coldspot\",\"new coldspot\"))\n\nthailand_ehsa_tr_sig_hot &lt;- thailand_ehsa_tr_sig %&gt;% filter(classification %in% c(\"consecutive hotspot\",\"new hotspot\",\"oscilating hotspot\",\"sporadic hotspot\"))\nthailand_ehsa_tr_sig_cold &lt;- thailand_ehsa_tr_sig %&gt;% filter(classification %in% c(\"consecutive coldspot\",\"oscilating coldspot\",\"sporadic coldspot\",\"new coldspot\"))\n\n\nhot_map &lt;- tm_shape(thailand_ehsa_use)+\n  tm_polygons()+\n  tm_borders(alpha = 0.6)+\ntm_shape(thailand_ehsa_use_hot)+\n  tm_fill(\"classification\", \n          palette = c(\"#de573e\",\"#f67774\",\"#f8b675\",\"#f8d673\"),\n          title = \"classification\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.6)+\n  tm_layout(main.title = \"drug_use hotspots in Thailand\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)\n\ncold_map &lt;- tm_shape(thailand_ehsa_use)+\n  tm_polygons()+\n  tm_borders(alpha = 0.6)+\ntm_shape(thailand_ehsa_use_cold)+\n  tm_fill(\"classification\", \n          palette = c(\"#57bfc0\",\"#b977cb\",\"#7977f3\"),\n          title = \"classification\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.6)+\n  tm_layout(main.title = \"drug_use coldspots in Thailand\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.title.size = 1.8,\n            legend.text.size = 1.3,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)\n\n\ntmap_arrange(hot_map, cold_map, asp = 1, ncol = 2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nLegend labels were too wide. The labels have been resized to 0.80, 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\n\nhot_map &lt;- tm_shape(thailand_ehsa_tr)+\n  tm_polygons()+\n  tm_borders(alpha = 0.6)+\ntm_shape(thailand_ehsa_tr_sig_hot)+\n  tm_fill(\"classification\", \n          palette = c(\"#de573e\",\"#f67774\",\"#f8b675\",\"#f8d673\"),\n          title = \"classification\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.6)+\n  tm_layout(main.title = \"drug_trafficking hotspots in Thailand\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.title.size = 1.8,\n            legend.text.size = 1.3,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)\n\ncold_map &lt;- tm_shape(thailand_ehsa_tr)+\n  tm_polygons()+\n  tm_borders(alpha = 0.6)+\ntm_shape(thailand_ehsa_tr_sig_cold)+\n  tm_fill(\"classification\", \n          palette = c(\"#57bfc0\",\"#b977cb\",\"#7977f3\"),\n          title = \"classification\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.6)+\n  tm_layout(main.title = \"drug_trafficking coldspots in Thailand\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.title.size = 1.8,\n            legend.text.size = 1.3,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)\n\n\ntmap_arrange(hot_map, cold_map, asp = 1, ncol = 2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nLegend labels were too wide. The labels have been resized to 0.54, 0.64. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nLegend labels were too wide. The labels have been resized to 0.51, 0.80. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.10-local-gi-and-mann-kendall-tests",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.10-local-gi-and-mann-kendall-tests",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.10 Local Gi* and Mann-Kendall Tests",
    "text": "TH2.10 Local Gi* and Mann-Kendall Tests\nEmerging hotspot analysis combines local Gi* statistics with the Mann-Kendall test.\nTo calculate spatial-temporal local Gi*, we can use the original spacetime cube we created and the following code chunks.\n\nthailand_drug_nb &lt;- thailand_drug_spt %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(st_contiguity(geometry)),\n         wt = st_inverse_distance(nb, geometry,\n                                  scale = 1,\n                                  alpha = 1),\n         .before = 1) %&gt;%\n    set_nbs(\"nb\") %&gt;%\n    set_wts(\"wt\")\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wt = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\nhead(thailand_drug_nb)\n\nspacetime ────\n\n\nContext:`data`\n\n\n77 locations `ADM1_EN`\n\n\n6 time periods `fiscal_year`\n\n\n── data context ────────────────────────────────────────────────────────────────\n\n\n# A tibble: 6 × 6\n  ADM1_EN         fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt   \n  &lt;chr&gt;                 &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;\n1 Bangkok                2017           11871                    950 &lt;int&gt; &lt;dbl&gt;\n2 Samut Prakan           2017             820                    201 &lt;int&gt; &lt;dbl&gt;\n3 Nonthaburi             2017             553                    118 &lt;int&gt; &lt;dbl&gt;\n4 Pathum Thani           2017             450                     83 &lt;int&gt; &lt;dbl&gt;\n5 Phra Nakhon Si…        2017             378                    164 &lt;int&gt; &lt;dbl&gt;\n6 Ang Thong              2017             208                     51 &lt;int&gt; &lt;dbl&gt;\n# ℹ abbreviated name: ¹​total_trafficking_cases"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.11-conclusion",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.11-conclusion",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.11 Conclusion",
    "text": "TH2.11 Conclusion"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.8-using-local-g_i-statistics-to-perform-hot-and-cold-spot-analysis",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.8-using-local-g_i-statistics-to-perform-hot-and-cold-spot-analysis",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.8 Using Local \\(G_i^*\\) statistics to perform hot and cold spot analysis",
    "text": "TH2.8 Using Local \\(G_i^*\\) statistics to perform hot and cold spot analysis\nWe need more local indicators to determine the extent of clustering in our drug crime data. Another method we can use is creating Gertis and Ord’s G-statistics, or \\(G_i^*\\). One of the earliest LISAs (Khant, 2024), they seek to determine the locations of clusters of high and low values - in our case, clusters of provinces with high incidences of drug trafficking, and clusters of those with low incidences of such. These scores are typically reported as z-scores, where positive values indicate a high-high cluster, and negative values indicate a low-low cluster.\nThe analysis consists of three steps:\n\nDeriving the spatial weight matrix,\nComputing the \\(G_i^*\\) statistics\nMapping the \\(G_i^*\\) statistics\n\n\nTH2.8.1 drug_use dataset\n\nTH2.8.1.1 Deriving distance-based weight matrices\nFirst, we define an adaptive distance-based weight matrix. We will do this by creating centroids - points associated with each polygon - by extracting longitudes and latitudes. This is done by mapping the st_centroid() function to each polygon in our dataset.\n\n# drug_use data\nlongitude &lt;- map_dbl(thailand_2021_use$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(thailand_2021_use$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Determine cutoff distance\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  21.55   51.92   64.33   63.24   76.77  110.94 \n\n# Compute fixed-distance weight matrix\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B', zero.policy = TRUE)\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6 \n42 16  6  5  4  3  1 \n16 least connected regions:\n7 12 26 30 32 34 41 43 56 62 69 70 73 74 75 77 with 1 link\n1 most connected region:\n3 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn S0  S1   S2\nB 35 1225 80 160 1040\n\n\n\n\nTH2.8.1.2 Computing adaptive distance weight matrix\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 616 \nPercentage nonzero weights: 10.38961 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n77 \n77 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n77 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 77 5929 616 1088 20466\n\n\n\n\nTH2.8.1.3 Computing \\(G_i^*\\) statistics\n\ngi &lt;- localG(thailand_2021_use$total_use_cases, knn_lw)\nthailand_2021_use.gi &lt;- cbind(thailand_2021_use, as.matrix(gi)) %&gt;% rename(gstat_adaptive = as.matrix.gi.)\n\n\n\nTH2.8.1.4 Plotting drug_use \\(G_i^*\\) statistics on map\n\ngi_map &lt;- tm_shape(thailand_2021_use.gi) + tm_fill(col = \"gstat_adaptive\", breaks=c(-3, -2, -1.96, -1.65, -1, 0, 1, 1.65, 1.96, 2, 3), palette = \"-RdBu\", title = \"drug_use local Gi\") + tm_borders(alpha = 0.5)\ntmap_arrange(use_map, gi_map)\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThere is one large cold spot to the northwest of the map towards the border with Myanmar, but as far as hot spots are concerned, the best candidate for that is located in the east, towards the border with Cambodia and Laos, and appears lukewarm. Most of that area is only suggestive of a hotspot at a 90% confidence interval, with only 3 provinces - Maha-Sarakham, Amnat-Charoen and Surin - showing strong evidence of a hotspot at a 95% confidence interval.\n\n\n\nTH2.8.2 drug_trafficking dataset\nWe can repeat the entire process again with our drug_trafficking dataset.\n\nTH2.8.2.1 Deriving distance-based weight matrices\n\n# drug_trafficking data\nlongitude &lt;- map_dbl(thailand_2021_trafficking$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(thailand_2021_trafficking$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Determine cutoff distance\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  21.55   51.92   64.33   63.24   76.77  110.94 \n\n# Compute fixed-distance weight matrix\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B', zero.policy = TRUE)\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6 \n42 16  6  5  4  3  1 \n16 least connected regions:\n7 12 26 30 32 34 41 43 56 62 69 70 73 74 75 77 with 1 link\n1 most connected region:\n3 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn S0  S1   S2\nB 35 1225 80 160 1040\n\n\n\n\nTH2.8.2.2 Computing adaptive distance weight matrix\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 616 \nPercentage nonzero weights: 10.38961 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n77 \n77 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n77 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 77 5929 616 1088 20466\n\n\n\n\nTH2.8.2.3 Computing \\(G_i^*\\) statistics\n\ngi &lt;- localG(thailand_2021_trafficking$total_trafficking_cases, knn_lw)\nthailand_2021_trafficking.gi &lt;- cbind(thailand_2021_trafficking, as.matrix(gi)) %&gt;% rename(gstat_adaptive = as.matrix.gi.)\n\n\n\nTH2.8.2.4 Plotting drug_use \\(G_i^*\\) statistics on map\n\ngi_map &lt;- tm_shape(thailand_2021_trafficking.gi) + tm_fill(col = \"gstat_adaptive\", breaks=c(-3, -2, -1.96, -1.65, -1, 0, 1, 1.65, 1.96, 2, 3), palette = \"-RdBu\", title = \"drug_trafficking local Gi\") + tm_borders(alpha = 0.5)\ntmap_arrange(trafficking_map, gi_map)\n\nWarning: Values have found that are higher than the highest break\n\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\nWarning: Values have found that are higher than the highest break\n\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThere are no visible cold spots for our drug trafficking data, but there is one suggestive hot spot around Chiang Mai and Chiang Rai to the north (with only Chiang Rai showing a strong possibility), and three statistically significant clusters to the east."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.10-local-g_i-and-mann-kendall-tests",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.10-local-g_i-and-mann-kendall-tests",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.10 Local \\(G_i^*\\) and Mann-Kendall Tests",
    "text": "TH2.10 Local \\(G_i^*\\) and Mann-Kendall Tests\nEmerging hotspot analysis combines local \\(G_i^*\\) statistics with the Mann-Kendall test.\nA non-parametric test, the Man-Kendall trend test is used to assess the direction (increasing/decreasing) of a set of data values over time, and whether the trend in either direction is statistically significant. It returns two values: Kendall’s Score s, and Kendall’s Tau tau, which is a correlation coefficient that is positive (\\(tau\\) &gt; 0) if a correlation is present, and zero (\\(tau\\) = 0) otherwise (Khant, 2024) (Gilbert, 1987).\nAs for Kendall’s Score (Khant, 2024) (Khambhammettu, 2005) S, the value of S starts at 0 (i.e. no trend), and is incremented and decremented depending on the magnitude of later data points relative to the beginning. The final value of S indicates the overall trend. If S is positive, it suggests an upward trend, whereas if S is negative, it indicates a downward trend. Similarly to everything else we’ve been doing here, we also need to extract the associated p-value to determine its statistical significance.\n\nTH2.10.1 Calculating Local \\(G_i^*\\) Statistics\nTo calculate spatial-temporal local \\(G_i^*\\), we can use the original spacetime cube we created and the following code chunks.\n\nthailand_drug_nb &lt;- thailand_drug_spt %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(st_contiguity(geometry)),\n         wt = st_inverse_distance(nb, geometry,\n                                  scale = 1,\n                                  alpha = 1),\n         .before = 1) %&gt;%\n    set_nbs(\"nb\") %&gt;%\n    set_wts(\"wt\")\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wt = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\nhead(thailand_drug_nb)\n\nspacetime ────\n\n\nContext:`data`\n\n\n77 locations `ADM1_EN`\n\n\n6 time periods `fiscal_year`\n\n\n── data context ────────────────────────────────────────────────────────────────\n\n\n# A tibble: 6 × 6\n  ADM1_EN         fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt   \n  &lt;chr&gt;                 &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;\n1 Bangkok                2017           11871                    950 &lt;int&gt; &lt;dbl&gt;\n2 Samut Prakan           2017             820                    201 &lt;int&gt; &lt;dbl&gt;\n3 Nonthaburi             2017             553                    118 &lt;int&gt; &lt;dbl&gt;\n4 Pathum Thani           2017             450                     83 &lt;int&gt; &lt;dbl&gt;\n5 Phra Nakhon Si…        2017             378                    164 &lt;int&gt; &lt;dbl&gt;\n6 Ang Thong              2017             208                     51 &lt;int&gt; &lt;dbl&gt;\n# ℹ abbreviated name: ¹​total_trafficking_cases\n\n\nWe are interested in understanding the spatio-temporal dynamics of drug offence cases by year. Therefore, we need to use the following code chunk to perform \\(G_i^*\\) calculation for each year.\n\nthailand_gi_stars_per_year_use &lt;- thailand_drug_nb %&gt;%\n  group_by(fiscal_year) %&gt;%\n  mutate(gi_star_use = local_gstar_perm(total_use_cases, nb, wt)) %&gt;%\n  unnest(gi_star_use) %&gt;%\n  ungroup()\n\nthailand_gi_stars_per_year_tr &lt;- thailand_drug_nb %&gt;%\n  group_by(fiscal_year) %&gt;%\n  mutate(gi_star_tr = local_gstar_perm(total_trafficking_cases, nb, wt)) %&gt;%\n  unnest(gi_star_tr) %&gt;%\n  ungroup()\nhead(thailand_gi_stars_per_year_use)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Bangkok        2017           11871                    950 &lt;int&gt; &lt;dbl&gt;    4.96\n2 Samut …        2017             820                    201 &lt;int&gt; &lt;dbl&gt;    3.73\n3 Nontha…        2017             553                    118 &lt;int&gt; &lt;dbl&gt;    2.33\n4 Pathum…        2017             450                     83 &lt;int&gt; &lt;dbl&gt;    1.94\n5 Phra N…        2017             378                    164 &lt;int&gt; &lt;dbl&gt;   -1.17\n6 Ang Th…        2017             208                     51 &lt;int&gt; &lt;dbl&gt;   -1.24\n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\n\n\n\nTH2.10.2 Extracting local \\(G_i^*\\) in hot and cold spots\nEarlier, we identified some hot and cold spots in section 2.8, and we now want to find out how the drug crime activity in these locations has changed over time. Hence, we will now choose some of these hot and cold spots, and filter them from our spatial-temporal \\(G_i^*\\) statistics. For simplicity, we will choose Surin province as our hot spot subject and Kanchanaburi province as our cold spot subject for further study - the former is considered a hot spot for both drug use and drug trafficking, and while the latter is a suggestive cold spot in terms of drug trafficking, it is considered a statistically significant cold spot in terms of drug use.\nFirst, we will filter our our \\(G_i^*\\) statistics for both areas.\n\n# Surin province\ncbg_surin_use &lt;- thailand_gi_stars_per_year_use %&gt;%\n  filter(ADM1_EN == \"Surin\")\n  # select(ADM1_EN, fiscal_year, gi_star_use)\n\ncbg_surin_tr &lt;- thailand_gi_stars_per_year_tr %&gt;%\n  filter(ADM1_EN == \"Surin\")\n  # select(ADM1_EN, fiscal_year, gi_star_use)\n\nhead(cbg_surin_use)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Surin          2017            1309                    287 &lt;int&gt; &lt;dbl&gt;   0.142\n2 Surin          2018            3170                    308 &lt;int&gt; &lt;dbl&gt;   0.567\n3 Surin          2019            4155                    450 &lt;int&gt; &lt;dbl&gt;   1.00 \n4 Surin          2020             899                    438 &lt;int&gt; &lt;dbl&gt;  -0.915\n5 Surin          2021            2697                    429 &lt;int&gt; &lt;dbl&gt;   1.02 \n6 Surin          2022            1170                    434 &lt;int&gt; &lt;dbl&gt;   1.08 \n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\nhead(cbg_surin_tr)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Surin          2017            1309                    287 &lt;int&gt; &lt;dbl&gt;   0.570\n2 Surin          2018            3170                    308 &lt;int&gt; &lt;dbl&gt;   0.753\n3 Surin          2019            4155                    450 &lt;int&gt; &lt;dbl&gt;   2.19 \n4 Surin          2020             899                    438 &lt;int&gt; &lt;dbl&gt;   2.32 \n5 Surin          2021            2697                    429 &lt;int&gt; &lt;dbl&gt;   2.25 \n6 Surin          2022            1170                    434 &lt;int&gt; &lt;dbl&gt;   4.34 \n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\n# Kanchanaburi province\ncbg_kanchanaburi_use &lt;- thailand_gi_stars_per_year_use %&gt;%\n  filter(ADM1_EN == \"Kanchanaburi\")\n\ncbg_kanchanaburi_tr &lt;- thailand_gi_stars_per_year_tr %&gt;%\n  filter(ADM1_EN == \"Kanchanaburi\")\n\nhead(cbg_kanchanaburi_use)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Kancha…        2017            1370                    239 &lt;int&gt; &lt;dbl&gt;   0.141\n2 Kancha…        2018            2203                    264 &lt;int&gt; &lt;dbl&gt;   0.274\n3 Kancha…        2019            2082                    235 &lt;int&gt; &lt;dbl&gt;  -0.118\n4 Kancha…        2020            1311                    216 &lt;int&gt; &lt;dbl&gt;  -0.678\n5 Kancha…        2021            1226                     90 &lt;int&gt; &lt;dbl&gt;  -2.17 \n6 Kancha…        2022            1476                    135 &lt;int&gt; &lt;dbl&gt;  -0.769\n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\nhead(cbg_kanchanaburi_tr)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Kancha…        2017            1370                    239 &lt;int&gt; &lt;dbl&gt;  0.434 \n2 Kancha…        2018            2203                    264 &lt;int&gt; &lt;dbl&gt;  0.428 \n3 Kancha…        2019            2082                    235 &lt;int&gt; &lt;dbl&gt; -0.0700\n4 Kancha…        2020            1311                    216 &lt;int&gt; &lt;dbl&gt; -0.389 \n5 Kancha…        2021            1226                     90 &lt;int&gt; &lt;dbl&gt; -1.17  \n6 Kancha…        2022            1476                    135 &lt;int&gt; &lt;dbl&gt; -0.786 \n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\n\n\n\nTH2.10.3 Plotting \\(G_i^*\\) values and conducting Mann-Kendall trend test\nThen, we will plot the \\(G_i^*\\) values to visualise their trends between 2017 and 2022. Finally, we will use the Man-Kendall trend test to confirm the direction of the trends and their statistical significance.\n\nTH2.10.3.1 Surin Province (selected hot spot)\n\nggplot() + geom_line(\n  data = cbg_surin_use,\n  mapping = aes(x = fiscal_year, y = gi_star, color = \"Drug Use in Surin Province\")\n) + \n  geom_line(\n    data = cbg_surin_tr,\n    mapping = aes(x = fiscal_year, y = gi_star, color = \"Drug Trafficking in Surin Province\")\n) +\n  labs(x = \"Fiscal year\", y = \"Gi* Value\", title = \"Gi* for Surin Province between 2017 and 2022\", color = \"Village\")\n\n\n\n\n\n\n\n\nIt turns out the Surin province has always been a hotspot for drug trafficking, with the only difference being its intensity. Based on \\(G_i^*\\) statistics, the province starts off as a suggestive hotspot at 0.5, and would emerge into a statistically significant hotspot by 2022 with a value of around 4.25.\nAs for drug use, Surin province briefly became a suggestive cold spot in the year 2020, when its \\(G_i^*\\) statistic fell to about 0.8 in 2020.\n\ncbg_surin_use %&gt;% summarise(\n  mann_kendall = list(unclass(Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mann_kendall)\n\n# A tibble: 1 × 5\n    tau    sl     S     D  varS\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.600 0.133     9  15.0  28.3\n\ncbg_surin_tr %&gt;% summarise(\n  mann_kendall = list(unclass(Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mann_kendall)\n\n# A tibble: 1 × 5\n    tau     sl     S     D  varS\n  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.867 0.0242    13  15.0  28.3\n\n\nFor Surin province, Kendall’s \\(tau\\) is 0.6 &gt; 0 for drug_use 0.867 &gt; 0 for drug_trafficking, indicating a positive association over time. This suggests that as time progresses, the spatial clustering of both drug use and trafficking cases in the province tends to increase. Kendall’s S is also 9 and 13 respectively, supporting this conclusion. However, since the p-values sl are 0.133 and 0.0242 respectively, only the results for drug_trafficking are statistically significant at a 95% confidence interval.\n\n\nTH2.10.3.2 Kanchanaburi Province (selected cold spot)\n\nggplot() + geom_line(\n  data = cbg_kanchanaburi_use,\n  mapping = aes(x = fiscal_year, y = gi_star, color = \"Drug Use in Kanchanaburi Province\")\n) + \n  geom_line(\n    data = cbg_kanchanaburi_tr,\n    mapping = aes(x = fiscal_year, y = gi_star, color = \"Drug Trafficking in Kanchanaburi Province\")\n) +\n  labs(x = \"Fiscal year\", y = \"Gi* Value\", title = \"Gi* for Kanchanaburi Province between 2017 and 2022\", color = \"Village\")\n\n\n\n\n\n\n\n\nKanchanaburi province, on the other hand, has been largely a cold spot of both drug use and trafficking since late-2018, with their \\(G_i^*\\) statistics hitting their minimum in 2021.\n\ncbg_kanchanaburi_use %&gt;% summarise(\n  mann_kendall = list(unclass(Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mann_kendall)\n\n# A tibble: 1 × 5\n     tau     sl     S     D  varS\n   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 -0.733 0.0603   -11  15.0  28.3\n\ncbg_kanchanaburi_tr %&gt;% summarise(\n  mann_kendall = list(unclass(Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mann_kendall)\n\n# A tibble: 1 × 5\n     tau     sl     S     D  varS\n   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 -0.867 0.0242   -13  15.0  28.3\n\n\nFor Kanchanaburi province, Kendall’s \\(tau\\) is -0.733 &lt; 0 for drug_use -0.867 &gt; 0 for drug_trafficking, indicating a strong negative association over time. This suggests that as time progresses, the spatial clustering of both drug use and trafficking cases in the province tends to increase. Kendall’s S is also -11 and -13 respectively, supporting this conclusion. The p-values sl are 0.060 and 0.0242 respectively. While the results for drug_trafficking are statistically significant at a 95% confidence interval, the results for drug_use would only be considered statistically significant if we assume a 90% confidence interval."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.11-conclusion-limitations-and-extensibility",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.11-conclusion-limitations-and-extensibility",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.11 Conclusion, Limitations and Extensibility",
    "text": "TH2.11 Conclusion, Limitations and Extensibility\nIn conclusion, given a dataset of drug offence statistics, we used the results of preliminary exploratory data analysis to identify a time bracket - the year 2021 given its occurrence towards the middle of the COVID-19 pandemic - to derive global and local measures of spatial autocorrelation on confirmed drug use and drug trafficking statistics. Our global Moran’s I and Geary’s C statistics showed moderate positive spatial autocorrelation for both classes of drug offence, with the drug trafficking data’s figure showing stronger correlation than that for drug use. This was, to an extent, backed up by the local Moran’s I figures, which returned p-values of 0.1 or more for many provinces, only returning statistically significant observations towards the northwest and east of the country in the case of drug_trafficking, and sporadically so in the case of drug_use. Despite the lack of statistical significance, the local Moran’s I scatterplot identified the provinces of Chiang Mai, Bangkok and Phuket to be high outliers among low neighbours in drug use, and Mae Hong Song as a notable low outlier among high neighbours in the case of drug trafficking. We identified drug use cold spots and drug trafficking hot spots, and performed emerging hotspot analysis to identify which among them were sporadic, new or consecutive - and found that we were unable to assign a pattern to most cases. Finally, on the hot spot of Surin and cold spot of Kanchanaburi, we extracted local \\(G_i^*\\) statistics and, through the Mann-Kendall test, confirmed that Surin province was indeed a rising hotbed for drug trafficking, and that drug activity in Kanchanaburi province was on the decline.\nThe year 2021 was chosen for spatial autocorrelational analysis based on the EDA because it had the highest number of drug use cases, so it follows that not only would there be a higher demand for drugs, and therefore more instances of drug trafficking, but this should also return a higher sample size to return a statistically significant result. This was not the case, and there are several possible reasons why. It could be that the given data is not further classified by other demographic factors such as age group or yearly income. Indeed, among all people who use cannabis globally, 42% are youths aged 17-24 (The Lancet Regional Health – Southeast Asia, 2023), and the drug Yaba is popular among Thai youth who use it to, among other things, “improve academic performance”. It could also be that this dataset is still too small to be able to draw strong conclusions. Or, it could simply be that statistics alone are unable to account for the socio-economic factors behind drug use. One key motivation for people to use drugs is the inability to manage stress. Two examples of this would be the COVID-19 pandemic increasing stress among retrenched people, or males having experienced childhood adversities being more susceptible to tobacco, alcohol or cannibis (The Lancet Regional Health – Southeast Asia, 2023).\nThe results are still somewhat adequate in identifying the locations of hot spots around the country, and have even successfully identified cold spots in drug use. In these cold spots, a greater focus can be placed on educating youth and the general public on the harms of drug use and why one should never even start, so that resources spent on rehabilitation and counselling can be freed and directed towards hot spots. Additionally, in identifying the locations of existing and emerging hot spots of drug trafficking, law enforcement will have a clearer understanding on where their efforts should be prioritised and where they can afford to scale back, leading to a more efficient allocation of scarce policing resources.\nHowever, the drug problem in Thailand, as can be reaffirmed from our efforts, is a complex one. If we are to truly eradicate the problem of drugs once and for all, more extensive research not just on the statistics, but on the factors that lead to drug use, will surely be needed. Further research can account for socio-economic factors, such as the HDI, median salary and highest educational qualitifications for each province, and explore the relationship between drug trafficking and drug use numbers within the country."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.7-gearys-c",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.7-gearys-c",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.7 Geary’s \\(C\\)",
    "text": "TH2.7 Geary’s \\(C\\)\nGeary’s \\(C\\) is another measure of global spatial autocorrelation that describes how features differ from their immediate neighbours. When \\(C &gt; 1\\), the points are dispersed, and when \\(C &lt; 1\\), the points are clustered. A \\(C\\) value of \\(1\\) indicates observations are randomly arranged in space. Geary’s \\(C\\) approaches \\(0\\) when similar values are clustered, and approaches \\(3\\) when dissimilar values are clustered. Geary’s \\(C\\) is inversely proportional to Moran’s I, so higher \\(C\\)s correspond to lower \\(I\\)s.\nJust as before, we will now perform Geary’s C on both our drug_use and drug_trafficking statistics.\n\nTH2.7.1 Geary’s \\(C\\) on drug_use statistics\n\ngeary.test(thailand_2021$total_use_cases, listw=rswm_q_use, zero.policy = TRUE, na.action = na.omit)\n\n\n    Geary C test under randomisation\n\ndata:  thailand_2021$total_use_cases \nweights: rswm_q_use  \nn reduced by no-neighbour observations \n\nGeary C statistic standard deviate = 1.8151, p-value = 0.03476\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n      0.843832653       1.000000000       0.007402704 \n\nset.seed(1234)\nbperm_use &lt;- geary.mc(thailand_2021$total_use_cases, \n                listw=rswm_q_use, \n                nsim=999,\n                zero.policy = TRUE,\n                na.action = na.omit)\nbperm_use\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  thailand_2021$total_use_cases \nweights: rswm_q_use  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.84383, observed rank = 61, p-value = 0.061\nalternative hypothesis: greater\n\nhist(bperm_use$res, main = \"Geary's C Simulation Results for drug_use\", xlab=\"Monte-Carlo Results\", ylab=\"Frequency\") \nabline(v = bperm_use$statistic, col = \"green4\")\n\n\n\n\n\n\n\n\nFrom the output above:\n\nThe Geary’s C statistic is approximately 0.84, which is lower than the expected value of 1.0. Just as a high Moran’s I indicates positive spatial correlation, our Geary’s C statistic, which is less than 1, indicates likewise. Similarly to the conclusion of our Moran’s I investigation, the Geary’s C statistic only indicates moderate positive spatial correlation.\nWith a standard deviation of 3.24 and p-value of0.035 &lt; 0.05`, the test result is statistically significant. If we were to only run the test once, we should be able to reject the null hypothesis of a lack of spatial autocorrelation.\nHowever, while running 1000 permutations yielded a similar Geary’s C observation of 0.84383, this time, our p-value of 0.061 is greater than our threshold of 0.05 at the 95% confidence level. Had we only used Geary’s C, we would not have strong statistical evidence to reject our null hypothesis.\n\nHence, the Geary’s C statistic on drug use cases in 2021 yielded inconclusive results.\n\n\nTH2.7.2 Geary’s \\(C\\) on drug_trafficking statistics\n\ngeary.test(thailand_2021$total_trafficking_cases, listw=rswm_q_tr, zero.policy = TRUE, na.action = na.omit)\n\n\n    Geary C test under randomisation\n\ndata:  thailand_2021$total_trafficking_cases \nweights: rswm_q_tr  \nn reduced by no-neighbour observations \n\nGeary C statistic standard deviate = 2.3998, p-value = 0.008202\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n       0.73939266        1.00000000        0.01179295 \n\nset.seed(1234)\nbperm_tr &lt;- geary.mc(thailand_2021$total_trafficking_cases, \n                listw=rswm_q_tr, \n                nsim=999, zero.policy = TRUE, na.action = na.omit)\nbperm_tr\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  thailand_2021$total_trafficking_cases \nweights: rswm_q_tr  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.73939, observed rank = 20, p-value = 0.02\nalternative hypothesis: greater\n\nhist(bperm_use$res, main = \"Global Geary's C Simulation Results for drug_trafficking\", xlab=\"Monte-Carlo Results\", ylab=\"Frequency\") \nabline(v = bperm_tr$statistic, col = \"purple4\")\n\n\n\n\n\n\n\n\nWhen Geary’s C is run on the drug_trafficking statistics:\n\nThe result yielded is approximately 0.74, which is lower than the expected value of 1.0. It is also lower than the Geary’s C for the drug use data, which indicates that the clustering of drug trafficking hotspots is stronger than that for drug use.\nWith a standard deviation of 2.40 and p-value of 0.008 &lt; 0.05 for a 95% confidence level, the test result is statistically significant. If we were to only run the test once, we should be able to reject the null hypothesis of a lack of spatial autocorrelation.\nNow, running 1000 permutations yielded a similar Geary’s C observation of 0.73939 and a p-value of 0.02 &lt; 0.05 at the 95% confidence level. Even though the p-value is uncomfortably close to the threshold, we can still conclude that our derived Geary’s C for our drug trafficking data is statistically significant.\n\nHence, the Geary’s C measure on drug trafficking cases in 2021 indicates mild positive spatial autocorrelation, albeit stronger than that observed on our drug use statistics."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.8-deriving-local-measures-of-spatial-autocorrelation",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.8-deriving-local-measures-of-spatial-autocorrelation",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.8 Deriving Local Measures of Spatial Autocorrelation",
    "text": "TH2.8 Deriving Local Measures of Spatial Autocorrelation\nBoth Global Moran’s I and Geary’s C only return a surface observation on how Thailand’s drug crime is distributed by province. To identify where the clusters are located, we need to use local indicators of spatial association (LISA), which indicate the extent of spatial clustering around each observation (Anselin, 1995) (Khant, 2024).\nAn example of a LISA is local Moran’s I, which is essentially Moran’s I calculated for each geographical subdivision, in this case the provinces of Thailand. However, with these localised measures, we are able to visualise our findings on a choropleth map, and from there, identify the locations of noteworthy clusters.\nAs before, we will derive the local Moran’s I statistics for both our drug trafficking and drug use data. The localmoran() function use here returns a matrix whose columns mean the following (Kam, 2022):\n\nIi: the local Moran’s I statistics\nE.Ii: the expectation of the local Moran’s I statistics under the randomisation hypothesis\nVar.Ii: the variance of the local Moran’s I statistics under the randomisation hypothesis\nZ.Ii:the standard deviation, and\nPr(): the p-value.\n\n\nlocal_MI_use &lt;- localmoran(thailand_2021$total_use_cases, rswm_q_use)\nlocal_MI_trafficking &lt;- localmoran(thailand_2021$total_trafficking_cases, rswm_q_tr)\n\n# Bind local Moran's I to the Thailand dataset\nthailand_2021_use.localMI &lt;- cbind(thailand_2021, local_MI_use) %&gt;% rename(Pr.Ii = Pr.z....E.Ii..)\nthailand_2021_trafficking.localMI &lt;- cbind(thailand_2021, local_MI_trafficking) %&gt;% rename(Pr.Ii = Pr.z....E.Ii..)\n\nWe can then proceed to map the local Moran’s I statistics and p-values. The colour palette used for mapping local Moran’s I p-values (Khant, 2024) helps us easily identify statistically significant results, once again for a 95% confidence interval.\n\nTH2.8.1 Mapping Local Moran’s I statistics for drug_use cases\n\nuse.localMI.map &lt;- tm_shape(thailand_2021_use.localMI) + tm_fill(col = \"Ii\", style = \"pretty\", title = \"drug_use local Moran\") + tm_borders(alpha = 0.5)\nuse.pv.map &lt;- tm_shape(thailand_2021_use.localMI) + tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=c(\"#b7dce9\",\"#c9e3d2\",\"#f5f3a6\",\"#ec9a64\",\"#d21b1c\"), \n          title = \"drug_use p-values\") +\n  tm_borders(alpha = 0.5)\ntmap_arrange(use.localMI.map, use.pv.map, asp = 1, ncol = 2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThere are statistcally significant instances of dissimilar clustering toward the south in Krabi and Phattalung provinces, and a handful towards the central and north. With p-values of 0.1 or more, the local Moran’s I values for the rest of the country cannot be considered to be statistically significant. This is a surprising result for our drug_use data.\n\n\nTH2.8.2 Mapping Local Moran’s I statistics for drug_trafficking cases\n\ntr.localMI.map &lt;- tm_shape(thailand_2021_trafficking.localMI) + tm_fill(col = \"Ii\", style = \"pretty\", title = \"drug_trafficking local Moran\") + tm_borders(alpha = 0.5)\ntr.pv.map &lt;- tm_shape(thailand_2021_trafficking.localMI) + tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=c(\"#b7dce9\",\"#c9e3d2\",\"#f5f3a6\",\"#ec9a64\",\"#d21b1c\"), \n          title = \"drug_trafficking p-values\") +\n  tm_borders(alpha = 0.5)\ntmap_arrange(tr.localMI.map, tr.pv.map, asp = 1, ncol = 2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nAnd likewise for our drug_trafficking statistics. The only statistically significant observation that confirms the hypothesis is Chiang Rai province up north, and Si Sa Ket, the western neighbour of Ubon Ratchathani province, to the east.\n\n\nTH2.8.3 Performing Local Moran’s I Monte Carlo test for drug_use cases\nJust like with global Moran’s I, we can also perform a Monte Carlo permutation test for local Moran’s I, and hopefully return a more realistic result.\n\nlocal_MI_use &lt;- localmoran_perm(thailand_2021$total_use_cases, rswm_q_use, nsim = 999)\nlocal_MI_trafficking &lt;- localmoran_perm(thailand_2021$total_trafficking_cases, rswm_q_tr, nsim = 999)\n\n# Bind local Moran's I permutation to the Thailand dataset\nthailand_2021_use.localMI &lt;- cbind(thailand_2021, local_MI_use) %&gt;% rename(Pr.Ii = Pr.z....E.Ii..)\nthailand_2021_trafficking.localMI &lt;- cbind(thailand_2021, local_MI_trafficking) %&gt;% rename(Pr.Ii = Pr.z....E.Ii..)\n\n\nuse.localMI.map &lt;- tm_shape(thailand_2021_use.localMI) + tm_fill(col = \"Ii\", style = \"pretty\", title = \"drug_use local Moran\") + tm_borders(alpha = 0.5)\nuse.pv.map &lt;- tm_shape(thailand_2021_use.localMI) + tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=c(\"#b7dce9\",\"#c9e3d2\",\"#f5f3a6\",\"#ec9a64\",\"#d21b1c\"), \n          title = \"drug_use p-values\") +\n  tm_borders(alpha = 0.5)\ntmap_arrange(use.localMI.map, use.pv.map, asp = 1, ncol = 2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\nTH2.8.4 Performing Local Moran’s I Monte Carlo test for drug_trafficking cases\n\ntr.localMI.map &lt;- tm_shape(thailand_2021_trafficking.localMI) + tm_fill(col = \"Ii\", style = \"pretty\", title = \"drug_trafficking local Moran\") + tm_borders(alpha = 0.5)\ntr.pv.map &lt;- tm_shape(thailand_2021_trafficking.localMI) + tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=c(\"#b7dce9\",\"#c9e3d2\",\"#f5f3a6\",\"#ec9a64\",\"#d21b1c\"), \n          title = \"drug_trafficking p-values\") +\n  tm_borders(alpha = 0.5)\ntmap_arrange(tr.localMI.map, tr.pv.map, asp = 1, ncol = 2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nJust like last time, the only statistically significant areas to confirm the hypothesis are Chiang Rai and Si Sa Ket.\nEven after 999 simulations, we get results with p-values exceeding 0.05 for a 95% confidence interval, rendering the local Moran’s I values generated to be inconclusive. Nonetheless, by plotting these values on a map anyway, we can still paint a sufficiently high-level picture of the drug situation in the area.\n\n\nTH2.8.5 Drawing local Moran’s I scatterplots\nThe local Moran’s I scatterplot illustrates the relationship between the drug use and trafficking statistics at each location, and the average values at neighbouring locations. It returns a plot with four quardrants as shown in the image below (Kam, 2022).\n\n\n\nInterpretation of Local Moran’s I scatterplot\n\n\n\nnci_use &lt;- moran.plot(thailand_2021_use$total_use_cases, rswm_q_use, labels = thailand_2021_use$ADM1_EN, xlab = \"total_use_cases\", ylab = \"Spatially lagged total_use_cases\")\n\n\n\n\n\n\n\nnci_tr &lt;- moran.plot(thailand_2021_trafficking$total_trafficking_cases, rswm_q_tr, labels = thailand_2021_trafficking$ADM1_EN, xlab = \"total_trafficking_cases\", ylab = \"Spatially lagged total_trafficking_cases\")\n\n\n\n\n\n\n\n\nIn terms of drug usage, notable high outliers among low neighbours are Chiang Mai, Bangkok and Phuket, whereas a notable low outlier among high neighbours is Samut Prakan, which is Bangkok’s southeastern neighbour.\nIn terms of drug trafficking, a notable low outlier among high neighbours is Mae Hong Song, on the eastern border with Myanmar and within the Golden Triangle. Major provinces within the Triangle - namely Chiang Rai and Chiang Mai - are considered to be clustered with neighbours also seeing high trafficking.\n\n\nTH2.8.6 Creating LISA cluster map\nThe above information can also be plotted onto a map colourcoded by the type of spatial autocorrelation. The code chunks below create our LISA maps from our local Moran’s I statistics, and plots the resulting quadrant map along with their corresponding quantile-classified basemaps.\n\nTH2.8.6.1 LISA cluster map for drug use data\n\nquadrant &lt;- vector(mode = \"numeric\", length = nrow(local_MI_use))\nthailand_2021_use$lag_total_use &lt;- lag.listw(rswm_q_use, thailand_2021_use$total_use_cases)\nDV &lt;- thailand_2021_use$lag_total_use - mean(thailand_2021_use$lag_total_use)\nLM_I &lt;- local_MI_use[,1] - mean(local_MI_use[,1])\nsignif &lt;- 0.05\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4    \nquadrant[local_MI_use[,5]&gt;signif] &lt;- 0\nthailand_2021_use.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\n\nuse_LISA &lt;- tm_shape(thailand_2021_use.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\ntmap_arrange(use_LISA, use_map)\n\n\n\n\n\n\n\n\n\n\nTH2.8.6.2 LISA cluster map for drug trafficking data\n\nquadrant &lt;- vector(mode = \"numeric\", length = nrow(local_MI_trafficking))\nthailand_2021_trafficking$lag_total_trafficking &lt;- lag.listw(rswm_q_use, thailand_2021_trafficking$total_trafficking_cases)\nDV &lt;- thailand_2021_trafficking$lag_total_trafficking - mean(thailand_2021_trafficking$lag_total_trafficking)\nLM_I &lt;- local_MI_trafficking[,1] - mean(local_MI_trafficking[,1])\nsignif &lt;- 0.05\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4    \nquadrant[local_MI_trafficking[,5]&gt;signif] &lt;- 0\nthailand_2021_trafficking.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\n\ntr_LISA &lt;- tm_shape(thailand_2021_trafficking.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\ntmap_arrange(tr_LISA, trafficking_map)"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.8.5-drawing-local-morans-i-scatterplots",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.8.5-drawing-local-morans-i-scatterplots",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.8.5 Drawing local Moran’s I scatterplots",
    "text": "TH2.8.5 Drawing local Moran’s I scatterplots\nThe local Moran’s I scatterplot illustrates the relationship between the drug use and trafficking statistics at each location, and the average values at neighbouring locations. It returns a plot with four quardrants as shown in the image below (Kam, 2022).\nInterpretation of Local Moran’s I scatterplot\n\nnci_use &lt;- moran.plot(thailand_2021_use$total_use_cases, rswm_q_use, labels = thailand_2021_use$ADM1_EN, xlab = \"total_use_cases\", ylab = \"Spatially lagged total_use_cases\")\n\n\n\n\n\n\n\nnci_tr &lt;- moran.plot(thailand_2021_trafficking$total_trafficking_cases, rswm_q_tr, labels = thailand_2021_trafficking$ADM1_EN, xlab = \"total_trafficking_cases\", ylab = \"Spatially lagged total_trafficking_cases\")\n\n\n\n\n\n\n\n\nIn terms of drug usage, notable high outliers among low neighbours are Chiang Mai, Bangkok and Phuket, whereas a notable low outlier among high neighbours is Samut Prakan, which is Bangkok’s southeastern neighbour.\nIn terms of drug trafficking, a notable low outlier among high neighbours is Mae Hong Song, on the eastern border with Myanmar and within the Golden Triangle. Major provinces within the Triangle - namely Chiang Rai and Chiang Mai - are considered to be clustered with neighbours also seeing high trafficking.\n\nTH2.8.6 Creating LISA cluster map\nThe above information can also be plotted onto a map colourcoded by the type of spatial autocorrelation. The code chunks below create our LISA maps from our local Moran’s I statistics, and plots the resulting quadrant map along with their corresponding quantile-classified basemaps.\n\nTH2.8.6.1 LISA cluster map for drug use data\n\nquadrant &lt;- vector(mode = \"numeric\", length = nrow(local_MI_use))\nthailand_2021_use$lag_total_use &lt;- lag.listw(rswm_q_use, thailand_2021_use$total_use_cases)\nDV &lt;- thailand_2021_use$lag_total_use - mean(thailand_2021_use$lag_total_use)\nLM_I &lt;- local_MI_use[,1] - mean(local_MI_use[,1])\nsignif &lt;- 0.05\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4    \nquadrant[local_MI_use[,5]&gt;signif] &lt;- 0\nthailand_2021_use.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\n\nuse_LISA &lt;- tm_shape(thailand_2021_use.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\ntmap_arrange(use_LISA, use_map)\n\n\n\n\n\n\n\n\n\n\nTH2.8.6.2 LISA cluster map for drug trafficking data\n\nquadrant &lt;- vector(mode = \"numeric\", length = nrow(local_MI_trafficking))\nthailand_2021_trafficking$lag_total_trafficking &lt;- lag.listw(rswm_q_use, thailand_2021_trafficking$total_trafficking_cases)\nDV &lt;- thailand_2021_trafficking$lag_total_trafficking - mean(thailand_2021_trafficking$lag_total_trafficking)\nLM_I &lt;- local_MI_trafficking[,1] - mean(local_MI_trafficking[,1])\nsignif &lt;- 0.05\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4    \nquadrant[local_MI_trafficking[,5]&gt;signif] &lt;- 0\nthailand_2021_trafficking.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\n\ntr_LISA &lt;- tm_shape(thailand_2021_trafficking.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\ntmap_arrange(tr_LISA, trafficking_map)"
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.9-using-local-g_i-statistics-to-perform-hot-and-cold-spot-analysis",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.9-using-local-g_i-statistics-to-perform-hot-and-cold-spot-analysis",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.9 Using Local \\(G_i^*\\) statistics to perform hot and cold spot analysis",
    "text": "TH2.9 Using Local \\(G_i^*\\) statistics to perform hot and cold spot analysis\nWe need more local indicators to determine the extent of clustering in our drug crime data. Another method we can use is creating Gertis and Ord’s G-statistics, or \\(G_i^*\\). One of the earliest LISAs (Khant, 2024), they seek to determine the locations of clusters of high and low values - in our case, clusters of provinces with high incidences of drug trafficking, and clusters of those with low incidences of such. These scores are typically reported as z-scores, where positive values indicate a high-high cluster, and negative values indicate a low-low cluster.\nThe analysis consists of three steps:\n\nDeriving the spatial weight matrix,\nComputing the \\(G_i^*\\) statistics\nMapping the \\(G_i^*\\) statistics\n\n\nTH2.9.1 drug_use dataset\n\nTH2.9.1.1 Deriving distance-based weight matrices\nFirst, we define an adaptive distance-based weight matrix. We will do this by creating centroids - points associated with each polygon - by extracting longitudes and latitudes. This is done by mapping the st_centroid() function to each polygon in our dataset.\n\n# drug_use data\nlongitude &lt;- map_dbl(thailand_2021_use$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(thailand_2021_use$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Determine cutoff distance\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  21.55   51.92   64.33   63.24   76.77  110.94 \n\n# Compute fixed-distance weight matrix\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B', zero.policy = TRUE)\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6 \n42 16  6  5  4  3  1 \n16 least connected regions:\n7 12 26 30 32 34 41 43 56 62 69 70 73 74 75 77 with 1 link\n1 most connected region:\n3 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn S0  S1   S2\nB 35 1225 80 160 1040\n\n\n\n\nTH2.9.1.2 Computing adaptive distance weight matrix\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 616 \nPercentage nonzero weights: 10.38961 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n77 \n77 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n77 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 77 5929 616 1088 20466\n\n\n\n\nTH2.9.1.3 Computing \\(G_i^*\\) statistics\n\ngi &lt;- localG(thailand_2021_use$total_use_cases, knn_lw)\nthailand_2021_use.gi &lt;- cbind(thailand_2021_use, as.matrix(gi)) %&gt;% rename(gstat_adaptive = as.matrix.gi.)\n\n\n\nTH2.9.1.4 Plotting drug_use \\(G_i^*\\) statistics on map\n\ngi_map &lt;- tm_shape(thailand_2021_use.gi) + tm_fill(col = \"gstat_adaptive\", breaks=c(-3, -2, -1.96, -1.65, -1, 0, 1, 1.65, 1.96, 2, 3), palette = \"-RdBu\", title = \"drug_use local Gi\") + tm_borders(alpha = 0.5)\ntmap_arrange(use_map, gi_map)\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThere is one large cold spot to the northwest of the map towards the border with Myanmar, but as far as hot spots are concerned, the best candidate for that is located in the east, towards the border with Cambodia and Laos, and appears lukewarm. Most of that area is only suggestive of a hotspot at a 90% confidence interval, with only 3 provinces - Maha-Sarakham, Amnat-Charoen and Surin - showing strong evidence of a hotspot at a 95% confidence interval.\n\n\n\nTH2.9.2 drug_trafficking dataset\nWe can repeat the entire process again with our drug_trafficking dataset.\n\nTH2.9.2.1 Deriving distance-based weight matrices\n\n# drug_trafficking data\nlongitude &lt;- map_dbl(thailand_2021_trafficking$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(thailand_2021_trafficking$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Determine cutoff distance\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  21.55   51.92   64.33   63.24   76.77  110.94 \n\n# Compute fixed-distance weight matrix\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B', zero.policy = TRUE)\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 80 \nPercentage nonzero weights: 1.3493 \nAverage number of links: 1.038961 \n42 regions with no links:\n13 14 18 19 20 21 22 23 25 27 28 29 31 33 35 36 37 38 39 40 42 44 45 46\n47 48 49 50 51 52 53 54 55 57 63 64 65 66 67 68 71 72\n49 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6 \n42 16  6  5  4  3  1 \n16 least connected regions:\n7 12 26 30 32 34 41 43 56 62 69 70 73 74 75 77 with 1 link\n1 most connected region:\n3 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn S0  S1   S2\nB 35 1225 80 160 1040\n\n\n\n\nTH2.9.2.2 Computing adaptive distance weight matrix\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 616 \nPercentage nonzero weights: 10.38961 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n77 \n77 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n77 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 77 5929 616 1088 20466\n\n\n\n\nTH2.9.2.3 Computing \\(G_i^*\\) statistics\n\ngi &lt;- localG(thailand_2021_trafficking$total_trafficking_cases, knn_lw)\nthailand_2021_trafficking.gi &lt;- cbind(thailand_2021_trafficking, as.matrix(gi)) %&gt;% rename(gstat_adaptive = as.matrix.gi.)\n\n\n\nTH2.9.2.4 Plotting drug_use \\(G_i^*\\) statistics on map\n\ngi_map &lt;- tm_shape(thailand_2021_trafficking.gi) + tm_fill(col = \"gstat_adaptive\", breaks=c(-3, -2, -1.96, -1.65, -1, 0, 1, 1.65, 1.96, 2, 3), palette = \"-RdBu\", title = \"drug_trafficking local Gi\") + tm_borders(alpha = 0.5)\ntmap_arrange(trafficking_map, gi_map)\n\nWarning: Values have found that are higher than the highest break\n\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\nWarning: Values have found that are higher than the highest break\n\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nThere are no visible cold spots for our drug trafficking data, but there is one suggestive hot spot around Chiang Mai and Chiang Rai to the north (with only Chiang Rai showing a strong possibility), and three statistically significant clusters to the east."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.10-emerging-hotspot-analysis",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.10-emerging-hotspot-analysis",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.10 Emerging Hotspot Analysis",
    "text": "TH2.10 Emerging Hotspot Analysis\nSince we have spatial-temporal data, we are able to perform emerging hotspot analysis, which will help us evaluate how the hot and cold spots in both our datasets have changed over time. It combines the \\(G_i^*\\) statistic with the Man-Kendall test, which is used to assess the direction and statistical significance of a set of data values.\n\nTH2.10.1 Data wrangling for EHSA\nWe need to perform the following checks to ensure our data meets the prerequisites:\n\nThe data is not collected seasonally (it was collected yearly)\nOne point per time period (each time period contains the number of drug use cases and trafficking cases only)\nData does not have covariates (as Matthew (Ho, 2024) rightly points out, while factors such as human population and unemployment rate can affect the number of drug offence cases, we have to work within our limitations in many data science tasks including this one).\n\nOur data fulfills all three requirements, so we can proceed to create a new summary table containing the total number of drug use and trafficking cases each year for each province.\n\nthailand_esa_drug &lt;- thailand_drug %&gt;%\n  filter(types_of_drug_offenses %in% c(\"drug_use_cases\", \"trafficking_cases\")) %&gt;%\n  group_by(province_en, fiscal_year) %&gt;%\n  summarise(total_use_cases = sum(no_cases[types_of_drug_offenses == \"drug_use_cases\"]),\n            total_trafficking_cases = sum(no_cases[types_of_drug_offenses == \"trafficking_cases\"])) %&gt;%\n  ungroup() %&gt;%\n  rename('ADM1_EN' = 'province_en')\n\n`summarise()` has grouped output by 'province_en'. You can override using the\n`.groups` argument.\n\nthailand_esa_drug\n\n# A tibble: 462 × 4\n   ADM1_EN       fiscal_year total_use_cases total_trafficking_cases\n   &lt;chr&gt;               &lt;dbl&gt;           &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Amnat Charoen        2017            1734                     211\n 2 Amnat Charoen        2018            2038                     143\n 3 Amnat Charoen        2019            2642                     212\n 4 Amnat Charoen        2020             843                     165\n 5 Amnat Charoen        2021            3012                     164\n 6 Amnat Charoen        2022            1426                      75\n 7 Ang Thong            2017             208                      51\n 8 Ang Thong            2018             660                      61\n 9 Ang Thong            2019             657                      56\n10 Ang Thong            2020             423                      46\n# ℹ 452 more rows\n\n\nWith our data prepared, we can create a spacetime object using the spacetime() function from the sfdep package, with the following as input:\n\nData: thailand_esa_drug\nGeometry: thailand\nLocation identifier: ADM1_EN (from both thailand_esa_drug and thailand)\nTime column: fiscal_year\n\n\nthailand_drug_spt &lt;- spacetime(thailand_esa_drug, thailand, .loc_col = \"ADM1_EN\", .time_col = \"fiscal_year\", active = \"data\")\nis_spacetime_cube(thailand_drug_spt)\n\n[1] TRUE\n\n\n\n\nTH2.10.2 Performing EHSA\nWe can now perform EHSA analysis using emerging_hotspot_analysis() from the sfdep package. It takes a spacetime object and the name of the variable of interest (.var).\n\nthailand_ehsa_use &lt;- emerging_hotspot_analysis(x = thailand_drug_spt, .var = \"total_use_cases\", k = 1, nsim = 99)\nthailand_ehsa_tr &lt;- emerging_hotspot_analysis(x = thailand_drug_spt, .var = \"total_trafficking_cases\", k = 1, nsim = 99)\n\n\nthailand_ehsa_use &lt;- thailand %&gt;% left_join(thailand_ehsa_use, by = join_by(ADM1_EN == location))\nthailand_ehsa_tr &lt;- thailand %&gt;% left_join(thailand_ehsa_tr, by = join_by(ADM1_EN == location))\n\n\n\nTH2.10.3 Visualising Distribution of EHSA classes\nThe following bar chart reveals the distribution of different EHSA classes per province for both classes of drug offence.\n\nggplot(data = thailand_ehsa_use, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_use\")\n\n\n\n\n\n\n\nggplot(data = thailand_ehsa_tr, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_trafficking\")\n\n\n\n\n\n\n\n\nBased on the plots, thre are a total of 6 distinct hotspot and coldspot classes across both classes of drug offence. However, only the drug_use statistics returned at least one oscilating hotspot, which suggests periodic fluctuations in drug use statistics.\nJust as we discovered in the spatial autocorrelation findings from earlier, EHSA on our drug_use statistics returned 20 instances of sporadic coldspots - the highest among provinces where patterns were detected. However, in both instances, more than half of the provinces of Thailand did not feature any pattern.\nTo check how the findings change when only statistically significant cases are included, we need to isolate only those EHSA classes with p &lt; 0.05 for a 95% confidence interval:\n\nthailand_ehsa_use_sig &lt;- thailand_ehsa_use %&gt;% filter(p_value &lt; 0.05)\nthailand_ehsa_tr_sig &lt;- thailand_ehsa_tr %&gt;% filter(p_value &lt; 0.05)\n\nggplot(data = thailand_ehsa_use_sig, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_use with p &lt; 0.05\")\n\n\n\n\n\n\n\nggplot(data = thailand_ehsa_tr_sig, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_trafficking with p &lt; 0.05\")\n\n\n\n\n\n\n\n\nNo statistically significant drug_use EHSA classifications were returned, while there were no new statistically significant hotspots from our drug_trafficking EHSA classifications.\nWe can try a 90% confidence interval instead for our drug_use EHSA classifications:\n\nthailand_ehsa_use_sig &lt;- thailand_ehsa_use %&gt;% filter(p_value &lt; 0.1)\nggplot(data = thailand_ehsa_use_sig, aes(y = classification, fill = classification)) + geom_bar(show.legend = FALSE) + labs(title = \"EHSA for drug_use with p &lt; 0.1\")\n\n\n\n\n\n\n\n\nIf we increased our threshold to 0.1 from 0.05, we are able to detect 1 statistically significant oscilating hotspot.\n\n\nTH2.10.4 Visualising EHSA Maps\nFor this section, we will assume a 95% confidence interval for our drug_trafficking statistics, and ignore statistical significance for our drug_use statistics.\nThe relevant filter() and tmap functions can be used to create maps that will help us identify the geographic distribution of hotspots and coldspots in our study area.\n\nthailand_ehsa_use_hot &lt;- thailand_ehsa_use %&gt;% filter(classification %in% c(\"consecutive hotspot\",\"new hotspot\",\"oscilating hotspot\",\"sporadic hotspot\"))\nthailand_ehsa_use_cold &lt;- thailand_ehsa_use %&gt;% filter(classification %in% c(\"consecutive coldspot\",\"oscilating coldspot\",\"sporadic coldspot\",\"new coldspot\"))\n\nthailand_ehsa_tr_sig_hot &lt;- thailand_ehsa_tr_sig %&gt;% filter(classification %in% c(\"consecutive hotspot\",\"new hotspot\",\"oscilating hotspot\",\"sporadic hotspot\"))\nthailand_ehsa_tr_sig_cold &lt;- thailand_ehsa_tr_sig %&gt;% filter(classification %in% c(\"consecutive coldspot\",\"oscilating coldspot\",\"sporadic coldspot\",\"new coldspot\"))\n\n\nhot_map &lt;- tm_shape(thailand_ehsa_use)+\n  tm_polygons()+\n  tm_borders(alpha = 0.6)+\ntm_shape(thailand_ehsa_use_hot)+\n  tm_fill(\"classification\", \n          palette = c(\"#de573e\",\"#f67774\",\"#f8b675\",\"#f8d673\"),\n          title = \"classification\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.6)+\n  tm_layout(main.title = \"drug_use hotspots in Thailand\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)\n\ncold_map &lt;- tm_shape(thailand_ehsa_use)+\n  tm_polygons()+\n  tm_borders(alpha = 0.6)+\ntm_shape(thailand_ehsa_use_cold)+\n  tm_fill(\"classification\", \n          palette = c(\"#57bfc0\",\"#b977cb\",\"#7977f3\"),\n          title = \"classification\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.6)+\n  tm_layout(main.title = \"drug_use coldspots in Thailand\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.title.size = 1.8,\n            legend.text.size = 1.3,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)\n\n\ntmap_arrange(hot_map, cold_map, asp = 1, ncol = 2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nLegend labels were too wide. The labels have been resized to 0.80, 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\n\nhot_map &lt;- tm_shape(thailand_ehsa_tr)+\n  tm_polygons()+\n  tm_borders(alpha = 0.6)+\ntm_shape(thailand_ehsa_tr_sig_hot)+\n  tm_fill(\"classification\", \n          palette = c(\"#de573e\",\"#f67774\",\"#f8b675\",\"#f8d673\"),\n          title = \"classification\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.6)+\n  tm_layout(main.title = \"drug_trafficking hotspots in Thailand\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.title.size = 1.8,\n            legend.text.size = 1.3,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)\n\ncold_map &lt;- tm_shape(thailand_ehsa_tr)+\n  tm_polygons()+\n  tm_borders(alpha = 0.6)+\ntm_shape(thailand_ehsa_tr_sig_cold)+\n  tm_fill(\"classification\", \n          palette = c(\"#57bfc0\",\"#b977cb\",\"#7977f3\"),\n          title = \"classification\",\n          midpoint = 0) +\n  tm_borders(alpha = 0.6)+\n  tm_layout(main.title = \"drug_trafficking coldspots in Thailand\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.title.size = 1.8,\n            legend.text.size = 1.3,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)\n\n\ntmap_arrange(hot_map, cold_map, asp = 1, ncol = 2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nLegend labels were too wide. The labels have been resized to 0.54, 0.64. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nLegend labels were too wide. The labels have been resized to 0.51, 0.80. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.11-local-g_i-and-mann-kendall-tests",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.11-local-g_i-and-mann-kendall-tests",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.11 Local \\(G_i^*\\) and Mann-Kendall Tests",
    "text": "TH2.11 Local \\(G_i^*\\) and Mann-Kendall Tests\nEmerging hotspot analysis combines local \\(G_i^*\\) statistics with the Mann-Kendall test.\nA non-parametric test, the Man-Kendall trend test is used to assess the direction (increasing/decreasing) of a set of data values over time, and whether the trend in either direction is statistically significant. It returns two values: Kendall’s Score s, and Kendall’s Tau tau, which is a correlation coefficient that is positive (\\(tau\\) &gt; 0) if a correlation is present, and zero (\\(tau\\) = 0) otherwise (Khant, 2024) (Gilbert, 1987).\nAs for Kendall’s Score (Khant, 2024) (Khambhammettu, 2005) S, the value of S starts at 0 (i.e. no trend), and is incremented and decremented depending on the magnitude of later data points relative to the beginning. The final value of S indicates the overall trend. If S is positive, it suggests an upward trend, whereas if S is negative, it indicates a downward trend. Similarly to everything else we’ve been doing here, we also need to extract the associated p-value to determine its statistical significance.\n\nTH2.11.1 Calculating Local \\(G_i^*\\) Statistics\nTo calculate spatial-temporal local \\(G_i^*\\), we can use the original spacetime cube we created and the following code chunks.\n\nthailand_drug_nb &lt;- thailand_drug_spt %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(st_contiguity(geometry)),\n         wt = st_inverse_distance(nb, geometry,\n                                  scale = 1,\n                                  alpha = 1),\n         .before = 1) %&gt;%\n    set_nbs(\"nb\") %&gt;%\n    set_wts(\"wt\")\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wt = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\nhead(thailand_drug_nb)\n\nspacetime ────\n\n\nContext:`data`\n\n\n77 locations `ADM1_EN`\n\n\n6 time periods `fiscal_year`\n\n\n── data context ────────────────────────────────────────────────────────────────\n\n\n# A tibble: 6 × 6\n  ADM1_EN         fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt   \n  &lt;chr&gt;                 &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;\n1 Bangkok                2017           11871                    950 &lt;int&gt; &lt;dbl&gt;\n2 Samut Prakan           2017             820                    201 &lt;int&gt; &lt;dbl&gt;\n3 Nonthaburi             2017             553                    118 &lt;int&gt; &lt;dbl&gt;\n4 Pathum Thani           2017             450                     83 &lt;int&gt; &lt;dbl&gt;\n5 Phra Nakhon Si…        2017             378                    164 &lt;int&gt; &lt;dbl&gt;\n6 Ang Thong              2017             208                     51 &lt;int&gt; &lt;dbl&gt;\n# ℹ abbreviated name: ¹​total_trafficking_cases\n\n\nWe are interested in understanding the spatio-temporal dynamics of drug offence cases by year. Therefore, we need to use the following code chunk to perform \\(G_i^*\\) calculation for each year.\n\nthailand_gi_stars_per_year_use &lt;- thailand_drug_nb %&gt;%\n  group_by(fiscal_year) %&gt;%\n  mutate(gi_star_use = local_gstar_perm(total_use_cases, nb, wt)) %&gt;%\n  unnest(gi_star_use) %&gt;%\n  ungroup()\n\nthailand_gi_stars_per_year_tr &lt;- thailand_drug_nb %&gt;%\n  group_by(fiscal_year) %&gt;%\n  mutate(gi_star_tr = local_gstar_perm(total_trafficking_cases, nb, wt)) %&gt;%\n  unnest(gi_star_tr) %&gt;%\n  ungroup()\nhead(thailand_gi_stars_per_year_use)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Bangkok        2017           11871                    950 &lt;int&gt; &lt;dbl&gt;    4.96\n2 Samut …        2017             820                    201 &lt;int&gt; &lt;dbl&gt;    3.73\n3 Nontha…        2017             553                    118 &lt;int&gt; &lt;dbl&gt;    2.33\n4 Pathum…        2017             450                     83 &lt;int&gt; &lt;dbl&gt;    1.94\n5 Phra N…        2017             378                    164 &lt;int&gt; &lt;dbl&gt;   -1.17\n6 Ang Th…        2017             208                     51 &lt;int&gt; &lt;dbl&gt;   -1.24\n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\n\n\n\nTH2.11.2 Extracting local \\(G_i^*\\) in hot and cold spots\nEarlier, we identified some hot and cold spots in section 2.8, and we now want to find out how the drug crime activity in these locations has changed over time. Hence, we will now choose some of these hot and cold spots, and filter them from our spatial-temporal \\(G_i^*\\) statistics. For simplicity, we will choose Surin province as our hot spot subject and Kanchanaburi province as our cold spot subject for further study - the former is considered a hot spot for both drug use and drug trafficking, and while the latter is a suggestive cold spot in terms of drug trafficking, it is considered a statistically significant cold spot in terms of drug use.\nFirst, we will filter our our \\(G_i^*\\) statistics for both areas.\n\n# Surin province\ncbg_surin_use &lt;- thailand_gi_stars_per_year_use %&gt;%\n  filter(ADM1_EN == \"Surin\")\n  # select(ADM1_EN, fiscal_year, gi_star_use)\n\ncbg_surin_tr &lt;- thailand_gi_stars_per_year_tr %&gt;%\n  filter(ADM1_EN == \"Surin\")\n  # select(ADM1_EN, fiscal_year, gi_star_use)\n\nhead(cbg_surin_use)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Surin          2017            1309                    287 &lt;int&gt; &lt;dbl&gt;   0.142\n2 Surin          2018            3170                    308 &lt;int&gt; &lt;dbl&gt;   0.567\n3 Surin          2019            4155                    450 &lt;int&gt; &lt;dbl&gt;   1.00 \n4 Surin          2020             899                    438 &lt;int&gt; &lt;dbl&gt;  -0.915\n5 Surin          2021            2697                    429 &lt;int&gt; &lt;dbl&gt;   1.02 \n6 Surin          2022            1170                    434 &lt;int&gt; &lt;dbl&gt;   1.08 \n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\nhead(cbg_surin_tr)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Surin          2017            1309                    287 &lt;int&gt; &lt;dbl&gt;   0.570\n2 Surin          2018            3170                    308 &lt;int&gt; &lt;dbl&gt;   0.753\n3 Surin          2019            4155                    450 &lt;int&gt; &lt;dbl&gt;   2.19 \n4 Surin          2020             899                    438 &lt;int&gt; &lt;dbl&gt;   2.32 \n5 Surin          2021            2697                    429 &lt;int&gt; &lt;dbl&gt;   2.25 \n6 Surin          2022            1170                    434 &lt;int&gt; &lt;dbl&gt;   4.34 \n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\n# Kanchanaburi province\ncbg_kanchanaburi_use &lt;- thailand_gi_stars_per_year_use %&gt;%\n  filter(ADM1_EN == \"Kanchanaburi\")\n\ncbg_kanchanaburi_tr &lt;- thailand_gi_stars_per_year_tr %&gt;%\n  filter(ADM1_EN == \"Kanchanaburi\")\n\nhead(cbg_kanchanaburi_use)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Kancha…        2017            1370                    239 &lt;int&gt; &lt;dbl&gt;   0.141\n2 Kancha…        2018            2203                    264 &lt;int&gt; &lt;dbl&gt;   0.274\n3 Kancha…        2019            2082                    235 &lt;int&gt; &lt;dbl&gt;  -0.118\n4 Kancha…        2020            1311                    216 &lt;int&gt; &lt;dbl&gt;  -0.678\n5 Kancha…        2021            1226                     90 &lt;int&gt; &lt;dbl&gt;  -2.17 \n6 Kancha…        2022            1476                    135 &lt;int&gt; &lt;dbl&gt;  -0.769\n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\nhead(cbg_kanchanaburi_tr)\n\n# A tibble: 6 × 16\n  ADM1_EN fiscal_year total_use_cases total_trafficking_ca…¹ nb    wt    gi_star\n  &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;                  &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n1 Kancha…        2017            1370                    239 &lt;int&gt; &lt;dbl&gt;  0.434 \n2 Kancha…        2018            2203                    264 &lt;int&gt; &lt;dbl&gt;  0.428 \n3 Kancha…        2019            2082                    235 &lt;int&gt; &lt;dbl&gt; -0.0700\n4 Kancha…        2020            1311                    216 &lt;int&gt; &lt;dbl&gt; -0.389 \n5 Kancha…        2021            1226                     90 &lt;int&gt; &lt;dbl&gt; -1.17  \n6 Kancha…        2022            1476                    135 &lt;int&gt; &lt;dbl&gt; -0.786 \n# ℹ abbreviated name: ¹​total_trafficking_cases\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\n\n\n\nTH2.11.3 Plotting \\(G_i^*\\) values and conducting Mann-Kendall trend test\nThen, we will plot the \\(G_i^*\\) values to visualise their trends between 2017 and 2022. Finally, we will use the Man-Kendall trend test to confirm the direction of the trends and their statistical significance.\n\nTH2.11.3.1 Surin Province (selected hot spot)\n\nggplot() + geom_line(\n  data = cbg_surin_use,\n  mapping = aes(x = fiscal_year, y = gi_star, color = \"Drug Use in Surin Province\")\n) + \n  geom_line(\n    data = cbg_surin_tr,\n    mapping = aes(x = fiscal_year, y = gi_star, color = \"Drug Trafficking in Surin Province\")\n) +\n  labs(x = \"Fiscal year\", y = \"Gi* Value\", title = \"Gi* for Surin Province between 2017 and 2022\", color = \"Village\")\n\n\n\n\n\n\n\n\nIt turns out the Surin province has always been a hotspot for drug trafficking, with the only difference being its intensity. Based on \\(G_i^*\\) statistics, the province starts off as a suggestive hotspot at 0.5, and would emerge into a statistically significant hotspot by 2022 with a value of around 4.25.\nAs for drug use, Surin province briefly became a suggestive cold spot in the year 2020, when its \\(G_i^*\\) statistic fell to about 0.8 in 2020.\n\ncbg_surin_use %&gt;% summarise(\n  mann_kendall = list(unclass(Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mann_kendall)\n\n# A tibble: 1 × 5\n    tau    sl     S     D  varS\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.600 0.133     9  15.0  28.3\n\ncbg_surin_tr %&gt;% summarise(\n  mann_kendall = list(unclass(Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mann_kendall)\n\n# A tibble: 1 × 5\n    tau     sl     S     D  varS\n  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.867 0.0242    13  15.0  28.3\n\n\nFor Surin province, Kendall’s \\(tau\\) is 0.6 &gt; 0 for drug_use 0.867 &gt; 0 for drug_trafficking, indicating a positive association over time. This suggests that as time progresses, the spatial clustering of both drug use and trafficking cases in the province tends to increase. Kendall’s S is also 9 and 13 respectively, supporting this conclusion. However, since the p-values sl are 0.133 and 0.0242 respectively, only the results for drug_trafficking are statistically significant at a 95% confidence interval.\n\n\nTH2.11.3.2 Kanchanaburi Province (selected cold spot)\n\nggplot() + geom_line(\n  data = cbg_kanchanaburi_use,\n  mapping = aes(x = fiscal_year, y = gi_star, color = \"Drug Use in Kanchanaburi Province\")\n) + \n  geom_line(\n    data = cbg_kanchanaburi_tr,\n    mapping = aes(x = fiscal_year, y = gi_star, color = \"Drug Trafficking in Kanchanaburi Province\")\n) +\n  labs(x = \"Fiscal year\", y = \"Gi* Value\", title = \"Gi* for Kanchanaburi Province between 2017 and 2022\", color = \"Village\")\n\n\n\n\n\n\n\n\nKanchanaburi province, on the other hand, has been largely a cold spot of both drug use and trafficking since late-2018, with their \\(G_i^*\\) statistics hitting their minimum in 2021.\n\ncbg_kanchanaburi_use %&gt;% summarise(\n  mann_kendall = list(unclass(Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mann_kendall)\n\n# A tibble: 1 × 5\n     tau     sl     S     D  varS\n   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 -0.733 0.0603   -11  15.0  28.3\n\ncbg_kanchanaburi_tr %&gt;% summarise(\n  mann_kendall = list(unclass(Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mann_kendall)\n\n# A tibble: 1 × 5\n     tau     sl     S     D  varS\n   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 -0.867 0.0242   -13  15.0  28.3\n\n\nFor Kanchanaburi province, Kendall’s \\(tau\\) is -0.733 &lt; 0 for drug_use -0.867 &gt; 0 for drug_trafficking, indicating a strong negative association over time. This suggests that as time progresses, the spatial clustering of both drug use and trafficking cases in the province tends to increase. Kendall’s S is also -11 and -13 respectively, supporting this conclusion. The p-values sl are 0.060 and 0.0242 respectively. While the results for drug_trafficking are statistically significant at a 95% confidence interval, the results for drug_use would only be considered statistically significant if we assume a 90% confidence interval."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.12-conclusion-limitations-and-extensibility",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.12-conclusion-limitations-and-extensibility",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.12 Conclusion, Limitations and Extensibility",
    "text": "TH2.12 Conclusion, Limitations and Extensibility\nIn conclusion, given a dataset of drug offence statistics, we used the results of preliminary exploratory data analysis to identify a time bracket - the year 2021 given its occurrence towards the middle of the COVID-19 pandemic - to derive global and local measures of spatial autocorrelation on confirmed drug use and drug trafficking statistics. Our global Moran’s I and Geary’s C statistics showed moderate positive spatial autocorrelation for both classes of drug offence, with the drug trafficking data’s figure showing stronger correlation than that for drug use. This was, to an extent, backed up by the local Moran’s I figures, which returned p-values of 0.1 or more for many provinces, only returning statistically significant observations towards the northwest and east of the country in the case of drug_trafficking, and sporadically so in the case of drug_use. Despite the lack of statistical significance, the local Moran’s I scatterplot identified the provinces of Chiang Mai, Bangkok and Phuket to be high outliers among low neighbours in drug use, and Mae Hong Song as a notable low outlier among high neighbours in the case of drug trafficking. We identified drug use cold spots and drug trafficking hot spots, and performed emerging hotspot analysis to identify which among them were sporadic, new or consecutive - and found that we were unable to assign a pattern to most cases. Finally, on the hot spot of Surin and cold spot of Kanchanaburi, we extracted local \\(G_i^*\\) statistics and, through the Mann-Kendall test, confirmed that Surin province was indeed a rising hotbed for drug trafficking, and that drug activity in Kanchanaburi province was on the decline.\nThe year 2021 was chosen for spatial autocorrelational analysis based on the EDA because it had the highest number of drug use cases, so it follows that not only would there be a higher demand for drugs, and therefore more instances of drug trafficking, but this should also return a higher sample size to return a statistically significant result. This was not the case, and there are several possible reasons why. It could be that the given data is not further classified by other demographic factors such as age group or yearly income. Indeed, among all people who use cannabis globally, 42% are youths aged 17-24 (The Lancet Regional Health – Southeast Asia, 2023), and the drug Yaba is popular among Thai youth who use it to, among other things, “improve academic performance”. It could also be that this dataset is still too small to be able to draw strong conclusions. Or, it could simply be that statistics alone are unable to account for the socio-economic factors behind drug use. One key motivation for people to use drugs is the inability to manage stress. Two examples of this would be the COVID-19 pandemic increasing stress among retrenched people, or males having experienced childhood adversities being more susceptible to tobacco, alcohol or cannibis (The Lancet Regional Health – Southeast Asia, 2023).\nThe results are still somewhat adequate in identifying the locations of hot spots around the country, and have even successfully identified cold spots in drug use. In these cold spots, a greater focus can be placed on educating youth and the general public on the harms of drug use and why one should never even start, so that resources spent on rehabilitation and counselling can be freed and directed towards hot spots. Additionally, in identifying the locations of existing and emerging hot spots of drug trafficking, law enforcement will have a clearer understanding on where their efforts should be prioritised and where they can afford to scale back, leading to a more efficient allocation of scarce policing resources.\nHowever, the drug problem in Thailand, as can be reaffirmed from our efforts, is a complex one. If we are to truly eradicate the problem of drugs once and for all, more extensive research not just on the statistics, but on the factors that lead to drug use, will surely be needed. Further research can account for socio-economic factors, such as the HDI, median salary and highest educational qualitifications for each province, and explore the relationship between drug trafficking and drug use numbers within the country."
  },
  {
    "objectID": "TakeHome/TakeHome2/take-home-2.html#th2.6-morans-i",
    "href": "TakeHome/TakeHome2/take-home-2.html#th2.6-morans-i",
    "title": "TH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level",
    "section": "TH2.6 Moran’s \\(I\\)",
    "text": "TH2.6 Moran’s \\(I\\)\nWith our matrices constructed, we can calculate our global spatial correlation statistics. Moran’s \\(I\\) describes how features differ from the values in the study area as a whole. It approaches \\(1\\) when similar values are clustered, and approaches \\(-1\\) when dissimilar values tend to cluster.\nThe code chunk below computes Moran’s \\(I\\) on our drug use dataset, subsequently performing a Monte Carlo test and plotting the result in a histogram. We can use the histogram to visualise the permutation results and compare them to the expected value under null hypothesis.\n\nTH2.6.1 Moran’s \\(I\\) on drug_use statistics\n\nmoran.test(thailand_2021$total_use_cases, listw=rswm_q_use, zero.policy = TRUE, na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thailand_2021$total_use_cases  \nweights: rswm_q_use  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = 2.862, p-value = 0.002105\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n       0.20376109       -0.01333333        0.00575372 \n\nset.seed(1234)\nbperm_use &lt;- moran.mc(thailand_2021$total_use_cases, \n                listw=rswm_q_use, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm_use\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  thailand_2021$total_use_cases \nweights: rswm_q_use  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.20376, observed rank = 993, p-value = 0.007\nalternative hypothesis: greater\n\nhist(bperm_use$res, main = \"Global Moran's I Simulation Results for drug_use\", xlab=\"Monte-Carlo Results\", ylab=\"Frequency\") \nabline(v = bperm_use$statistic, col = \"green4\")\n\n\n\n\n\n\n\n\nFrom the output above:\n\nThe Moran’s I statistic is approximately 0.20, which is significantly higher than the expected value of -0.014. This is a significant indicator of positive spatial autocorrelation, but only to a moderate degree.\nWith a standard deviation of 2.86 and p-value of 0.0021 &lt; 0.05 at a 95% confidence level, the test result is statistically significant. We can reject the null hypothesis of a lack of spatial autocorrelation.\nAfter 1000 permutations, we get a similar Moran’s I observation of 0.2038, with a p-value of 0.007. Therefore, our result is stable and statistically significant.\n\nThis shows that provinces with high drug use in Thailand can, to a limited extent, be near one another.\n\n\nTH2.6.2 Moran’s \\(I\\) on drug_trafficking statistics\n\nmoran.test(thailand_2021$total_trafficking_cases, listw=rswm_q_tr, zero.policy = TRUE, na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thailand_2021$total_trafficking_cases  \nweights: rswm_q_tr  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = 3.3324, p-value = 0.0004304\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n       0.22018889       -0.01333333        0.00491054 \n\nset.seed(1234)\nbperm_tr &lt;- moran.mc(thailand_2021$total_trafficking_cases, \n                listw=rswm_q_tr, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm_tr\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  thailand_2021$total_trafficking_cases \nweights: rswm_q_tr  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.22019, observed rank = 998, p-value = 0.002\nalternative hypothesis: greater\n\nhist(bperm_use$res, main = \"Global Moran's I Simulation Results for drug_trafficking\", xlab=\"Monte-Carlo Results\", ylab=\"Frequency\") \nabline(v = bperm_tr$statistic, col = \"purple4\")\n\n\n\n\n\n\n\n\nThe output for our drug_trafficking statistics is similar to that for our drug_use statistics, and can be interpreted as follows:\n\nThe Moran’s I statistic is approximately 0.22, which is significantly higher than the expected value of -0.014. This value is close to that obtained from our drug_use statistics, which indicates that both categories of drug crimes are similarly and moderately clustered.\nWith a standard deviation of 3.33 and p-value of 0.0004 &lt; 0.05 at a 95% confidence level, the test result is statistically significant. We can reject the null hypothesis of a lack of spatial autocorrelation.\nAfter 1000 permutations, we get a similar Moran’s I observation of 0.21947, with a p-value of 0.002. Therefore, our result is stable and statistically significant.\n\nLike drug use, using Moran’s I show that provinces with high drug trafficking in Thailand can, to a limited extent, be near one another."
  },
  {
    "objectID": "HandsOn/hands-on-7.html",
    "href": "HandsOn/hands-on-7.html",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "",
    "text": "This hands-on exercise is on delineating a homogeneous region using geographically-referenced multivariate data. Today, we return to Myanmar to divide the state of Shan into homogeneous regions using a key statistic: whether the population uses info-communication technologies like mobile phones and computers at home."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.1-overview-and-analytical-question",
    "href": "HandsOn/hands-on-7.html#hx7.1-overview-and-analytical-question",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "",
    "text": "This hands-on exercise is on delineating a homogeneous region using geographically-referenced multivariate data. Today, we return to Myanmar to divide the state of Shan into homogeneous regions using a key statistic: whether the population uses info-communication technologies like mobile phones and computers at home."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.2-installing-and-loading-r-packages-and-data",
    "href": "HandsOn/hands-on-7.html#hx7.2-installing-and-loading-r-packages-and-data",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.2 Installing and loading R packages and Data",
    "text": "HX7.2 Installing and loading R packages and Data\nToday’s R packages to be used are:\n\nSpatial data handling\n\nsf, rgdal and spdep\n\nAttribute data handling\n\ntidyverse, especially readr, ggplot2 and dplyr\n\nChoropleth mapping\n\ntmap\n\nMultivariate data visualisation and analysis\n\ncoorplot, ggpubr, and heatmaply\n\nCluster analysis\n\ncluster\n\nClustGeo\n\nToday’s dataset will be Shan-ICT.csv, an extract from the 2014 Myanmar Population and Housing Census containing, as its name suggests, data on ICT use. We will superimpose this against township boundary data (admin 3) in Myanmar.\n\npacman::p_load(spdep, tmap, sf, ClustGeo, \n               ggpubr, cluster, factoextra, NbClust,\n               heatmaply, corrplot, psych, tidyverse, GGally)\nshan_sf &lt;- st_read(dsn = \"data/geospatial\", \n                   layer = \"myanmar_township_boundaries\") %&gt;%\n  # Filter only boundaries of Shan state\n  filter(ST %in% c(\"Shan (East)\", \"Shan (North)\", \"Shan (South)\")) %&gt;%\n  select(c(2:7))\n\nReading layer `myanmar_township_boundaries' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 330 features and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.17275 ymin: 9.671252 xmax: 101.1699 ymax: 28.54554\nGeodetic CRS:  WGS 84\n\nict &lt;- read_csv (\"data/aspatial/Shan-ICT.csv\")\n\nRows: 55 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): District Pcode, District Name, Township Pcode, Township Name\ndbl (7): Total households, Radio, Television, Land line phone, Mobile phone,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nsummary(ict)\n\n District Pcode     District Name      Township Pcode     Township Name     \n Length:55          Length:55          Length:55          Length:55         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n Total households     Radio         Television    Land line phone \n Min.   : 3318    Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711    1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685    Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369    Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471    3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604    Max.   :30176   Max.   :62388   Max.   :6736.0  \n  Mobile phone      Computer      Internet at home\n Min.   :  150   Min.   :  20.0   Min.   :   8.0  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0  \n Median : 3559   Median : 244.0   Median : 316.0  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0"
  },
  {
    "objectID": "index.html#latest-exercise",
    "href": "index.html#latest-exercise",
    "title": "IS415: Geospatial Analytics and Applications",
    "section": "Latest Exercise",
    "text": "Latest Exercise"
  },
  {
    "objectID": "index.html#featured-take-home-exercises",
    "href": "index.html#featured-take-home-exercises",
    "title": "IS415: Geospatial Analytics and Applications",
    "section": "Featured Take-Home Exercises",
    "text": "Featured Take-Home Exercises\n\n\n\n\n\n\n\n\n\n\nTH1: Geospatial Analytics for Social Good\n\n\n\n\n\n\nKendrick Teo\n\n\nSep 7, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nTH2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level\n\n\n\n\n\n\nKendrick Teo\n\n\nSep 23, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nTH3: Prototyping Modules for Geospatial Analytics Shiny Application\n\n\n\n\n\n\nKendrick Teo\n\n\nOct 14, 2024\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#featured-hands-on-exercises",
    "href": "index.html#featured-hands-on-exercises",
    "title": "IS415: Geospatial Analytics and Applications",
    "section": "Featured Hands-On Exercises",
    "text": "Featured Hands-On Exercises\n\n\n\n\n\n\n\n\nCE4/H4: Spatial-Temporal Point Patterns Analysis\n\n\n\n\n\n\nKendrick Teo\n\n\nSep 1, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nH1: Geospatial Data Wrangling with R\n\n\n\n\n\n\nKendrick Teo\n\n\nAug 15, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nH3: Spatial Point Patterns Analysis\n\n\n\n\n\n\nKendrick Teo\n\n\nAug 29, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nHX11: Geographically Weighted Predictive Models\n\n\n\n\n\n\nKendrick Teo\n\n\nNov 9, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nHX7: Geographical Segmentation with Spatially Constrained Clustering Techniques\n\n\n\n\n\n\nKendrick Teo\n\n\nOct 10, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nHX8: Spatially Constrained Clustering Analysis\n\n\n\n\n\n\nKendrick Teo\n\n\nOct 10, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nHX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model\n\n\n\n\n\n\nKendrick Teo\n\n\nOct 20, 2024\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#latest-exercises",
    "href": "index.html#latest-exercises",
    "title": "IS415: Geospatial Analytics and Applications",
    "section": "Latest Exercises",
    "text": "Latest Exercises\n\n\n\n\n\n\n\n\n\n\nHX11: Geographically Weighted Predictive Models\n\n\nHands-On Exercise 11\n\n\n\n\n\n\n\n\nNov 9, 2024\n\n\nKendrick Teo\n\n\n\n\n\n\n\n\n\n\n\n\nTH3: Prototyping Modules for Geospatial Analytics Shiny Application\n\n\nTake Home Exercise 3\n\n\n\n\n\n\n\n\nOct 14, 2024\n\n\nKendrick Teo\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.3-data-preparation",
    "href": "HandsOn/hands-on-7.html#hx7.3-data-preparation",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.3 Data Preparation",
    "text": "HX7.3 Data Preparation\nIf we directly use the measurement of the number of households, we may lead to biased data. In general, townships with relatively higher total numbers of households will also lead to higher number of households owning ICT devices. To overcome this problem, we will need to derive the penetration rate of each ICT variable as below.\n\nict_derived &lt;- ict %&gt;%\n  mutate(`RADIO_PR` = `Radio`/`Total households`*100) %&gt;%\n  mutate(`TV_PR` = `Television`/`Total households`*100) %&gt;%\n  mutate(`LLPHONE_PR` = `Land line phone`/`Total households`*100) %&gt;%\n  mutate(`MPHONE_PR` = `Mobile phone`/`Total households`*100) %&gt;%\n  mutate(`COMPUTER_PR` = `Computer`/`Total households`*100) %&gt;%\n  mutate(`INTERNET_PR` = `Internet at home`/`Total households`*100) %&gt;%\n  rename(`DT_PCODE` =`District Pcode`,`DT`=`District Name`,\n         `TS_PCODE`=`Township Pcode`, `TS`=`Township Name`,\n         `TT_HOUSEHOLDS`=`Total households`,\n         `RADIO`=`Radio`, `TV`=`Television`, \n         `LLPHONE`=`Land line phone`, `MPHONE`=`Mobile phone`,\n         `COMPUTER`=`Computer`, `INTERNET`=`Internet at home`)\nsummary(ict_derived)\n\n   DT_PCODE              DT              TS_PCODE              TS           \n Length:55          Length:55          Length:55          Length:55         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n TT_HOUSEHOLDS       RADIO             TV           LLPHONE      \n Min.   : 3318   Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711   1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685   Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369   Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471   3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604   Max.   :30176   Max.   :62388   Max.   :6736.0  \n     MPHONE         COMPUTER         INTERNET         RADIO_PR     \n Min.   :  150   Min.   :  20.0   Min.   :   8.0   Min.   : 2.105  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0   1st Qu.:13.895  \n Median : 3559   Median : 244.0   Median : 316.0   Median :21.095  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2   Mean   :21.568  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5   3rd Qu.:26.807  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0   Max.   :48.452  \n     TV_PR         LLPHONE_PR       MPHONE_PR       COMPUTER_PR    \n Min.   :11.60   Min.   : 0.278   Min.   : 3.642   Min.   :0.3278  \n 1st Qu.:45.02   1st Qu.: 2.284   1st Qu.:19.014   1st Qu.:1.1832  \n Median :51.72   Median : 3.759   Median :30.527   Median :1.8970  \n Mean   :50.95   Mean   : 5.109   Mean   :31.405   Mean   :2.4393  \n 3rd Qu.:60.64   3rd Qu.: 6.972   3rd Qu.:42.843   3rd Qu.:2.9897  \n Max.   :84.25   Max.   :18.149   Max.   :73.543   Max.   :9.2402  \n  INTERNET_PR     \n Min.   : 0.1041  \n 1st Qu.: 0.8617  \n Median : 2.2829  \n Mean   : 3.0644  \n 3rd Qu.: 4.1281  \n Max.   :11.7985"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.4-exploratory-data-analysis",
    "href": "HandsOn/hands-on-7.html#hx7.4-exploratory-data-analysis",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.4 Exploratory Data Analysis",
    "text": "HX7.4 Exploratory Data Analysis\n\nHX7.4.1 Graphical\nThe following code chunk plots the distribution of the ownership of various ICT devices in the state. A histogram is useful to identify the overall distribution of data, while a boxplot helps us detect outliers.\n\nggplot(data=ict_derived, \n       aes(x=`RADIO`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"lightgreen\")\n\n\n\n\n\n\n\nggplot(data=ict_derived, \n       aes(x=`RADIO`)) +\n  geom_boxplot(color=\"black\", \n               fill=\"light blue\")\n\n\n\n\n\n\n\n\nAs we can expect from a not-so-developed country like Myanmar, the ownership of radios is skewed left, i.e. not a lot of the population owns a radio.\nWe can also plot the distribution of our derived variables, i.e. the penetration rate.\n\nggplot(data=ict_derived, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\n\n\n\n\n\n\nggplot(data=ict_derived, \n       aes(x=`RADIO_PR`)) +\n  geom_boxplot(color=\"black\", \n               fill=\"light blue\")\n\n\n\n\n\n\n\n\nWhen penetration rate, rather than absolute numbers, is plotted, we can see a much more normalised distribution. The average radio penetration rate in Shan state would lie somewhere around 230-240.\nWe can do the same for multiple variables and create multiple plots side by side.\n\nradio &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ntv &lt;- ggplot(data=ict_derived, \n             aes(x= `TV_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\nllphone &lt;- ggplot(data=ict_derived, \n             aes(x= `LLPHONE_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\nmphone &lt;- ggplot(data=ict_derived, \n             aes(x= `MPHONE_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ncomputer &lt;- ggplot(data=ict_derived, \n             aes(x= `COMPUTER_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ninternet &lt;- ggplot(data=ict_derived, \n             aes(x= `INTERNET_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\nggarrange(radio, tv, llphone, mphone, computer, internet, \n          ncol = 3, \n          nrow = 2)\n\n\n\n\n\n\n\n\n\n\nHX7.4.2 Using choropleth maps\nEDA can also be performed by drawing choropleth maps. To start, as always, we perform a left join between the geospatial data object and the ict_derived dataframe using the unique identifier TS_PCODE.\n\nshan_sf &lt;- left_join(shan_sf, ict_derived, by = c(\"TS_PCODE\"=\"TS_PCODE\"))\n\n\n#|echo: false\n# Write to disk so that we can retrieve it later\n# write_rds(shan_sf, 'data/rds/shan_sf.rds')\n\nWe can now create our choropleth map using the combined dataset. By plotting the total number of households in one map and the total absolute number of households owning radios, we are able to showcase the inherent bias we encounter by using only absolute numbers.\n\nTT_HOUSEHOLDS.map &lt;- tm_shape(shan_sf) + \n  tm_fill(col = \"TT_HOUSEHOLDS\",\n          n = 5,\n          style = \"jenks\", \n          title = \"Total households\") + \n  tm_borders(alpha = 0.5) \n\nRADIO.map &lt;- tm_shape(shan_sf) + \n  tm_fill(col = \"RADIO\",\n          n = 5,\n          style = \"jenks\",\n          title = \"Number Radio \") + \n  tm_borders(alpha = 0.5) \n\ntmap_arrange(TT_HOUSEHOLDS.map, RADIO.map,\n             asp=NA, ncol=2)\n\n\n\n\n\n\n\n\nIn comparison…\n\ntm_shape(shan_sf) +\n    tm_polygons(c(\"TT_HOUSEHOLDS\", \"RADIO_PR\"),\n                style=\"jenks\") +\n    tm_facets(sync = TRUE, ncol = 2) +\n  tm_legend(legend.position = c(\"right\", \"bottom\"))+\n  tm_layout(outer.margins=0, asp=0)"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.5-correlation-analysis",
    "href": "HandsOn/hands-on-7.html#hx7.5-correlation-analysis",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.5 Correlation analysis",
    "text": "HX7.5 Correlation analysis\nA key part of data analytics is correlation analysis. When performing machine learning tasks, for example, we avoid incorporating too many correlated features lest it impacts the performance of our model.\ncorrplot.mixed() visualises the correlation coefficients between each of our input variables, similarly to how we can use seaborn to draw a correlation heatmap in Python.\n\ncluster_vars.cor = cor(ict_derived[,12:17])\ncorrplot.mixed(cluster_vars.cor,\n         lower = \"ellipse\", \n               upper = \"number\",\n               tl.pos = \"lt\",\n               diag = \"l\",\n               tl.col = \"black\")\n\n\n\n\n\n\n\n\nThe correlation matrix above shows a high degree of correlation between COMPUTER_PR and INTERNET_PR. This indicates that we should only use one, and not both, in our cluster analysis later."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.6-extracting-clustering-variables",
    "href": "HandsOn/hands-on-7.html#hx7.6-extracting-clustering-variables",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.6 Extracting clustering variables",
    "text": "HX7.6 Extracting clustering variables\nAnd now for the fun part: hierarchy cluster analysis. First, we extract the clustering variables needed from the shan_sf data frame. We will not extract INTERNET_PR since, as we know, it is highly correlated with COMPUTER_PR.\n\ncluster_vars &lt;- shan_sf %&gt;%\n  st_set_geometry(NULL) %&gt;%\n  select(\"TS.x\", \"RADIO_PR\", \"TV_PR\", \"LLPHONE_PR\", \"MPHONE_PR\", \"COMPUTER_PR\")\nhead(cluster_vars,10)\n\n        TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\n1    Mongmit 28.61852 55.41313   3.530618  26.06944    1.215939\n2    Pindaya 41.74647 50.51300   1.983584  16.23917    1.288190\n3    Ywangan 48.45215 26.05734   1.193591  12.02856    0.441465\n4   Pinlaung 23.16499 54.17189   2.854454  24.94903    1.376255\n5     Mabein 44.94903 70.86423   7.275255  39.26089    1.645042\n6      Kalaw 28.07624 61.16204   4.206478  40.87951    2.963160\n7      Pekon 31.86118 53.58494   3.983270  21.48476    1.897032\n8   Lawksawk 38.71017 63.00035   3.151366  32.05686    2.176677\n9  Nawnghkio 34.93359 54.79456   3.844960  32.30201    1.576465\n10   Kyaukme 21.09548 60.11773   3.958267  37.24930    3.094709\n\n\nNext, we change the unique identifier of each row to reference township name instead of row number.\n\nrow.names(cluster_vars) &lt;- cluster_vars$\"TS.x\"\nhead(cluster_vars,10)\n\n               TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\nMongmit     Mongmit 28.61852 55.41313   3.530618  26.06944    1.215939\nPindaya     Pindaya 41.74647 50.51300   1.983584  16.23917    1.288190\nYwangan     Ywangan 48.45215 26.05734   1.193591  12.02856    0.441465\nPinlaung   Pinlaung 23.16499 54.17189   2.854454  24.94903    1.376255\nMabein       Mabein 44.94903 70.86423   7.275255  39.26089    1.645042\nKalaw         Kalaw 28.07624 61.16204   4.206478  40.87951    2.963160\nPekon         Pekon 31.86118 53.58494   3.983270  21.48476    1.897032\nLawksawk   Lawksawk 38.71017 63.00035   3.151366  32.05686    2.176677\nNawnghkio Nawnghkio 34.93359 54.79456   3.844960  32.30201    1.576465\nKyaukme     Kyaukme 21.09548 60.11773   3.958267  37.24930    3.094709\n\n\nThen, we delete the original TS.x field we referred to a few moments ago.\n\nshan_ict &lt;- select(cluster_vars, c(2:6))\nhead(shan_ict, 10)\n\n          RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\nMongmit   28.61852 55.41313   3.530618  26.06944    1.215939\nPindaya   41.74647 50.51300   1.983584  16.23917    1.288190\nYwangan   48.45215 26.05734   1.193591  12.02856    0.441465\nPinlaung  23.16499 54.17189   2.854454  24.94903    1.376255\nMabein    44.94903 70.86423   7.275255  39.26089    1.645042\nKalaw     28.07624 61.16204   4.206478  40.87951    2.963160\nPekon     31.86118 53.58494   3.983270  21.48476    1.897032\nLawksawk  38.71017 63.00035   3.151366  32.05686    2.176677\nNawnghkio 34.93359 54.79456   3.844960  32.30201    1.576465\nKyaukme   21.09548 60.11773   3.958267  37.24930    3.094709"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.7-data-standardisation",
    "href": "HandsOn/hands-on-7.html#hx7.7-data-standardisation",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.7 Data Standardisation",
    "text": "HX7.7 Data Standardisation\nMultiple values with widely varying ranges will be used in cluster analysis. It would thus be imperative to standardise the input values first. There are many ways to do this, two of which -min-max and Z-score standardisation will be performed today.\n\nHX7.7.1 Min-max standardisation\nIn the code chunk below, normalize() of the heatmaply package is used to standardisze the clustering variables by using Min-Max method.\n\nshan_ict.std &lt;- normalize(shan_ict)\nsummary(shan_ict.std)\n\n    RADIO_PR          TV_PR          LLPHONE_PR       MPHONE_PR     \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.2544   1st Qu.:0.4600   1st Qu.:0.1123   1st Qu.:0.2199  \n Median :0.4097   Median :0.5523   Median :0.1948   Median :0.3846  \n Mean   :0.4199   Mean   :0.5416   Mean   :0.2703   Mean   :0.3972  \n 3rd Qu.:0.5330   3rd Qu.:0.6750   3rd Qu.:0.3746   3rd Qu.:0.5608  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n  COMPUTER_PR     \n Min.   :0.00000  \n 1st Qu.:0.09598  \n Median :0.17607  \n Mean   :0.23692  \n 3rd Qu.:0.29868  \n Max.   :1.00000  \n\n\n\n\nHX7.7.2 Z-score standardisation\nZ-score standardisation can be performed easily by using scale() of Base R. It should only be used if we can safely assume normal distribution.\n\nshan_ict.z &lt;- scale(shan_ict)\ndescribe(shan_ict.z)\n\n            vars  n mean sd median trimmed  mad   min  max range  skew kurtosis\nRADIO_PR       1 55    0  1  -0.04   -0.06 0.94 -1.85 2.55  4.40  0.48    -0.27\nTV_PR          2 55    0  1   0.05    0.04 0.78 -2.47 2.09  4.56 -0.38    -0.23\nLLPHONE_PR     3 55    0  1  -0.33   -0.15 0.68 -1.19 3.20  4.39  1.37     1.49\nMPHONE_PR      4 55    0  1  -0.05   -0.06 1.01 -1.58 2.40  3.98  0.48    -0.34\nCOMPUTER_PR    5 55    0  1  -0.26   -0.18 0.64 -1.03 3.31  4.34  1.80     2.96\n              se\nRADIO_PR    0.13\nTV_PR       0.13\nLLPHONE_PR  0.13\nMPHONE_PR   0.13\nCOMPUTER_PR 0.13\n\n\nNotice that describe() from the psych package is used here instead of summary() since it provides us the standard deviation.\n\n\nHX7.7.3 Visualising standardised clustering variables\n\nr &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Raw values without standardisation\")\n\nshan_ict_s_df &lt;- as.data.frame(shan_ict.std)\ns &lt;- ggplot(data=shan_ict_s_df, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Min-Max Standardisation\")\n\nshan_ict_z_df &lt;- as.data.frame(shan_ict.z)\nz &lt;- ggplot(data=shan_ict_z_df, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Z-score Standardisation\")\n\nggarrange(r, s, z,\n          ncol = 3,\n          nrow = 1)\n\n\n\n\n\n\n\n\nStandardisation gives us data distributions more closely resembling a normal distribution. The same effect can also be seen if we draw a line plot as below.\n\nr &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"#ff7d04\") +\n  ggtitle(\"Raw values without standardisation\")\n\nshan_ict_s_df &lt;- as.data.frame(shan_ict.std)\ns &lt;- ggplot(data=shan_ict_s_df, \n       aes(x=`RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"#ff7d04\") +\n  ggtitle(\"Min-Max Standardisation\")\n\nshan_ict_z_df &lt;- as.data.frame(shan_ict.z)\nz &lt;- ggplot(data=shan_ict_z_df, \n       aes(x=`RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"#ff7d04\") +\n  ggtitle(\"Z-score Standardisation\")\n\nggarrange(r, s, z,\n          ncol = 3,\n          nrow = 1)\n\n\n\n\n\n\n\n\n\n\nHX7.7.4 Computing proximity matrix\nWe need a proximity matrix to pass into our hierarchical clustering computation function later. Today, we will use dist(method = 'euclidean') from base R to compute a simple euclidean proximity matrix. There are five other options available: maximum, manhattan, canberra, binary and minkowski.\n\nproxmat &lt;- dist(shan_ict, method = 'euclidean')\nproxmat\n\n             Mongmit   Pindaya   Ywangan  Pinlaung    Mabein     Kalaw\nPindaya    17.186828                                                  \nYwangan    38.188259 25.731610                                        \nPinlaung    5.746286 20.863519 40.005492                              \nMabein     26.337099 31.345776 52.914689 31.266966                    \nKalaw      16.005997 30.251785 49.953297 18.196406 19.814085          \nPekon       5.961977 11.791580 33.650410  9.461225 28.226877 21.191531\nLawksawk   14.011550 20.432952 43.216535 19.257320 13.036525 14.001101\nNawnghkio   8.907103 18.064047 37.787702 13.927495 20.463154 12.774787\nKyaukme    14.402475 31.101487 50.589191 13.967966 26.488283  7.942225\nMuse       56.301629 70.411252 89.944137 57.158335 45.327410 41.246033\nLaihka     14.187227 29.861288 49.183321 10.110150 34.500222 19.734633\nMongnai    11.586190 25.849346 42.271934  6.452387 35.886053 20.034668\nMawkmai    43.492968 43.799577 39.703752 39.811227 69.324602 56.259200\nKutkai      9.761092 21.281775 36.011861  7.807733 34.055064 20.493018\nMongton    19.267961 28.335574 36.123257 16.342143 42.516902 26.787522\nMongyai    25.672744 28.741816 33.312853 22.056339 51.640426 38.674701\nMongkaing  50.361965 48.171125 36.498429 47.629056 74.717454 62.524500\nLashio     25.129457 39.898167 60.217475 26.251735 23.128227 10.669059\nMongpan    19.332063 33.572896 48.368125 19.278316 30.152942 11.469105\nMatman     40.125041 35.439039 25.522031 38.240610 63.753975 53.763884\nTachileik  52.963213 63.551774 80.744220 55.501039 36.532538 37.364459\nNarphan    40.615714 47.450209 45.295769 37.126895 63.034312 46.353759\nMongkhet   34.945980 39.174783 40.897731 30.586058 61.030557 46.552013\nHsipaw     11.818050 24.598884 38.863147  7.655260 36.642787 21.236711\nMonghsat   21.420854 31.471506 43.298028 16.044703 47.048135 31.796188\nMongmao    24.254541 40.221719 54.285957 21.758854 38.491867 19.518913\nNansang    10.491839 27.544246 47.277637  8.549572 28.792364 12.430500\nLaukkaing  56.827732 72.685355 90.882520 56.381750 52.067373 42.777791\nPangsang   27.267383 42.824958 55.682263 24.447146 41.854016 22.403998\nNamtu      17.962251 22.540822 44.466868 17.004533 36.616094 30.727427\nMonghpyak  17.776325 22.130579 36.744835 22.220020 21.269450 16.708436\nKonkyan    40.339082 50.086933 52.812533 36.544693 61.351206 44.475859\nMongping   26.512574 31.064850 33.794020 22.975261 51.816310 37.564739\nHopong     13.693111 22.306050 35.285844  9.814855 39.800917 26.416294\nNyaungshwe  9.938590 21.652463 40.711649 13.812050 21.021337  9.566782\nHsihseng   13.149728 17.200796 34.291035 11.161846 38.120187 28.711074\nMongla     38.430076 54.942389 72.816301 37.259678 40.609124 26.026411\nHseni      18.937188 33.798982 53.444679 20.447572 21.361240  3.852842\nKunlong    22.412169 35.547066 53.163089 19.476257 39.661508 27.301375\nHopang     28.105362 44.326362 59.619312 26.596924 36.855167 18.514704\nNamhkan    38.602794 54.381859 71.443173 38.278835 37.956035 24.639577\nKengtung   24.645691 38.568322 57.323173 26.348638 21.947071  8.829335\nLangkho    16.426299 32.328133 50.778892 16.844228 25.384371  6.719580\nMonghsu    10.915790 19.835391 34.042789  8.086834 36.719820 23.734578\nTaunggyi   39.984278 50.375471 69.798323 42.954386 22.624011 25.226066\nPangwaun   38.151246 51.213162 58.013146 35.637963 52.344632 33.835194\nKyethi     20.292551 17.554012 28.729358 18.947065 44.207679 36.017247\nLoilen     14.548666 29.361143 46.951621  9.156527 37.506406 21.719877\nManton     43.064070 40.242888 30.616379 40.583081 67.401120 56.016577\nMongyang   30.951302 47.593982 63.071590 28.603834 41.188352 23.356349\nKunhing    17.350424 31.823811 44.967218 14.158836 37.582140 19.763683\nMongyawng  21.421738 33.292193 57.056521 23.555497 19.349994 17.343078\nTangyan    19.592520 20.843740 32.477002 16.950567 44.859948 34.806617\nNamhsan    23.778494 22.841073 28.616305 21.433352 48.833873 38.588676\n               Pekon  Lawksawk Nawnghkio   Kyaukme      Muse    Laihka\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk   15.751129                                                  \nNawnghkio  11.315370  9.082891                                        \nKyaukme    20.212206 18.629066 15.704230                              \nMuse       61.456144 51.013288 53.368806 43.475768                    \nLaihka     18.223667 24.674469 21.188187 12.824979 52.665211          \nMongnai    15.160031 24.171260 18.221245 14.245669 57.197975 10.053457\nMawkmai    41.600669 56.752693 49.515047 51.202846 92.693007 42.996554\nKutkai     11.498048 22.464646 14.744053 17.093318 59.290743 14.467198\nMongton    20.814888 31.107742 22.581118 22.928509 63.471074 21.207320\nMongyai    24.252301 39.126989 31.957938 33.927780 76.391399 26.413364\nMongkaing  48.023965 62.518712 54.669447 58.605094 99.566496 52.296309\nLashio     30.380011 22.075270 23.055346 12.995255 31.315288 23.864533\nMongpan    24.330037 22.854223 17.284425 11.037831 44.749969 21.076951\nMatman     36.825761 51.539711 44.405061 50.552285 92.911283 44.325453\nTachileik  57.339528 44.182621 47.045533 42.915493 22.119950 54.908985\nNarphan    41.684901 52.369580 43.559661 42.030003 77.040234 39.232592\nMongkhet   34.208722 48.741102 41.410280 40.903553 81.644931 32.497428\nHsipaw     14.537542 24.935081 17.609570 16.395741 59.103355 12.842987\nMonghsat   22.564279 35.231496 28.983220 25.325370 66.376026 15.893517\nMongmao    29.370625 31.464777 25.776465 14.609228 45.182530 18.599082\nNansang    16.037607 18.878869 15.113185  6.032773 48.935308  7.878999\nLaukkaing  62.482399 54.883928 55.265554 42.874978 14.926996 50.739700\nPangsang   32.181214 34.591486 28.710769 17.535273 46.024292 21.419291\nNamtu      16.502707 26.095300 25.752713 27.087277 65.916927 18.586794\nMonghpyak  19.093173 14.231691  9.303711 21.764419 53.943485 29.322640\nKonkyan    42.148797 52.031264 43.934272 39.379911 70.486973 35.175354\nMongping   25.968288 39.647081 31.614719 33.028984 74.444948 27.282761\nHopong     13.886577 27.491604 20.488286 21.884211 64.868011 15.748857\nNyaungshwe 13.931874 10.417830  4.326545 12.650414 50.588581 20.171653\nHsihseng   10.530573 25.711202 20.988026 25.027059 67.766886 17.589761\nMongla     44.120998 39.318472 38.140808 24.158966 25.680556 31.593218\nHseni      24.398001 17.150398 16.405304  8.120593 38.130567 20.449010\nKunlong    24.936301 31.830406 28.504608 21.563037 54.724297 12.268682\nHopang     33.638582 32.116462 27.984188 15.491633 37.744407 23.078652\nNamhkan    44.277120 37.941126 36.733575 24.781990 23.867060 34.243665\nKengtung   29.767761 20.938215 20.829647 13.623356 33.008211 25.823950\nLangkho    21.921623 19.030257 15.651662  5.167279 41.364173 16.094435\nMonghsu    11.384636 24.204063 17.009168 20.077712 63.321624 16.328926\nTaunggyi   44.066133 30.496838 34.479200 31.260547 25.081471 42.536916\nPangwaun   42.381347 45.302765 38.167478 30.831407 54.197887 35.178203\nKyethi     16.243575 31.774604 26.721607 32.814177 75.716745 25.583275\nLoilen     18.194596 26.529318 21.926405 14.692675 56.043400  5.969478\nManton     40.382131 55.113000 47.577296 52.286003 94.149778 45.830232\nMongyang   36.358788 36.337684 32.332123 18.859489 38.959919 22.971502\nKunhing    21.346379 27.868953 20.615773 14.500266 53.300162 14.203682\nMongyawng  24.843910 17.907229 22.061209 18.155295 42.237358 21.199976\nTangyan    16.779937 32.314701 26.907880 30.678359 73.693741 22.429176\nNamhsan    20.716559 36.284062 29.974967 34.785944 77.852971 27.379672\n             Mongnai   Mawkmai    Kutkai   Mongton   Mongyai Mongkaing\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai    37.450873                                                  \nKutkai      9.115307 36.495519                                        \nMongton    13.167061 31.335220 10.706341                              \nMongyai    20.323607 17.870499 18.894166 15.979790                    \nMongkaing  45.600842 13.329995 42.896133 36.550032 26.284016          \nLashio     27.086983 63.860773 28.982513 34.711584 46.636472 70.865819\nMongpan    17.809554 50.999632 18.518173 20.031803 34.639710 56.356780\nMatman     37.633870 14.783545 34.086349 30.304574 18.695158 13.551424\nTachileik  56.395232 91.938755 56.899109 60.876740 75.029555 96.714087\nNarphan    32.931700 27.375350 31.427683 21.597925 24.882845 28.565085\nMongkhet   27.576855 11.558388 27.391673 22.322828 10.498924 22.260577\nHsipaw      5.268195 35.134601  5.146282  9.069766 17.733790 42.377868\nMonghsat   12.525968 27.509705 15.432012 15.098053 12.735225 37.560376\nMongmao    18.829603 48.552853 20.469232 20.657001 33.561300 55.231959\nNansang     9.279567 46.241938 13.004549 19.958124 28.855962 54.216609\nLaukkaing  55.156800 88.251110 58.038112 60.466190 73.268347 95.411795\nPangsang   20.425746 48.414757 22.833583 21.077938 34.330638 54.840662\nNamtu      20.935473 42.795451 22.528268 30.871751 27.802761 52.504057\nMonghpyak  25.326470 53.671695 20.661627 25.804282 37.001575 56.821089\nKonkyan    32.882831 33.901411 31.060810 24.825265 28.787384 38.092091\nMongping   20.299615 19.431049 18.275266 11.986993  6.538727 25.718572\nHopong      9.153795 30.284362  7.345899 10.621031 12.462791 37.937916\nNyaungshwe 16.963695 50.299026 15.215482 21.972196 32.713541 55.732112\nHsihseng   14.236728 32.929477 12.821054 19.464317 16.227126 41.159788\nMongla     35.410985 68.688950 38.840984 41.106668 53.528615 76.148327\nHseni      21.681639 58.253670 22.937894 28.675945 40.823212 64.804408\nKunlong    20.292529 44.653763 20.454010 27.002165 29.936066 53.991284\nHopang     24.300945 56.124281 26.331986 27.350305 40.873288 62.617673\nNamhkan    37.005669 70.647792 39.248568 41.453594 55.062819 77.139688\nKengtung   27.228711 63.254638 27.919573 32.938387 46.039706 69.274693\nLangkho    17.467678 53.108019 18.051419 23.670878 35.895672 59.742714\nMonghsu     8.411238 33.207962  6.260859 10.704894 15.486049 40.071816\nTaunggyi   44.855282 81.074692 45.033382 50.840925 63.594105 86.621117\nPangwaun   31.213429 50.068857 32.180465 25.750434 39.407696 53.695736\nKyethi     21.050453 27.885535 18.423422 22.252947 13.779420 35.206533\nLoilen      5.841263 38.873386 13.156529 17.616001 22.479239 48.218190\nManton     39.154062 10.908779 36.182684 31.020581 19.559882  8.175337\nMongyang   26.039387 55.883162 28.533223 29.560023 41.431237 63.191325\nKunhing    11.055197 39.843973 10.884990 11.403609 23.899570 46.503971\nMongyawng  27.577546 62.004321 28.103383 37.522688 44.578964 70.098284\nTangyan    18.037471 26.266006 16.661820 19.888460 10.908506 34.856123\nNamhsan    21.810003 21.519289 19.132762 19.676188  7.735900 28.866231\n              Lashio   Mongpan    Matman Tachileik   Narphan  Mongkhet\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan    17.233279                                                  \nMatman     62.811049 49.481014                                        \nTachileik  31.195286 41.103849 89.012935                              \nNarphan    52.563854 37.113393 31.205193 76.029566                    \nMongkhet   53.444463 41.217123 20.302855 82.050164 21.728718          \nHsipaw     29.086435 17.952054 34.445451 57.618780 29.540170 25.380950\nMonghsat   37.786793 28.330992 31.359911 67.709508 27.821548 16.798445\nMongmao    21.423677 13.159966 50.159903 47.295568 33.142618 37.535820\nNansang    18.447950 14.477393 45.806573 48.677266 39.813308 36.099219\nLaukkaing  33.465738 43.558047 90.372094 32.506329 70.882887 76.906406\nPangsang   23.672516 14.023910 50.629940 48.131907 31.630314 37.558139\nNamtu      36.588437 35.291394 41.665397 65.956458 49.436143 35.599713\nMonghpyak  26.209281 18.785699 47.046845 44.404411 44.840651 46.263265\nKonkyan    48.551312 36.587588 39.240306 73.092980 15.882353 25.424424\nMongping   45.452548 31.847482 20.165224 72.708969 18.864567 11.380917\nHopong     34.531042 23.943845 29.184351 63.245718 29.440441 21.299485\nNyaungshwe 20.158191 13.729734 46.091883 44.581335 42.794086 41.708639\nHsihseng   36.900833 29.587811 30.402806 65.887060 37.752977 25.670338\nMongla     17.995877 25.320001 70.817595 34.733155 53.146949 57.440292\nHseni       7.941836 12.066550 56.464051 35.490063 47.412297 48.188406\nKunlong    29.523103 28.803320 46.827436 59.570536 41.307823 34.168641\nHopang     17.063913 13.562913 57.355355 40.382035 39.785908 45.151070\nNamhkan    17.327153 24.034131 71.542102 29.591660 53.685519 59.619944\nKengtung    5.985893 14.221554 61.301033 29.590429 50.540025 53.135998\nLangkho    11.518145  9.498486 51.886151 40.233622 42.065204 42.808061\nMonghsu    32.571557 21.625326 30.813805 60.502113 31.192379 24.773318\nTaunggyi   19.514541 31.981385 77.845810 15.084117 68.420905 71.280752\nPangwaun   36.245608 23.252209 52.343600 54.060474 26.464997 40.702947\nKyethi     44.710266 35.889620 23.383079 72.887329 37.490376 23.325039\nLoilen     26.892310 20.725000 40.656282 57.375476 35.479137 28.476895\nManton     64.666493 50.796808  5.952318 91.023039 28.026395 18.133894\nMongyang   20.933700 19.493467 58.561776 44.879027 40.139475 44.540621\nKunhing    25.510832 13.785278 40.366587 53.226397 28.162645 29.249814\nMongyawng  17.270139 27.515989 60.180824 43.210118 57.276394 52.291815\nTangyan    42.984475 34.039128 24.278233 71.984066 34.884991 20.149393\nNamhsan    47.204024 36.477086 18.009747 75.403913 31.654695 17.090848\n              Hsipaw  Monghsat   Mongmao   Nansang Laukkaing  Pangsang\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat   12.178922                                                  \nMongmao    18.599483 24.717708                                        \nNansang    12.024428 20.192690 16.499494                              \nLaukkaing  56.906099 62.644910 40.400848 48.060074                    \nPangsang   20.504337 25.637933  5.760801 19.336162 40.804016          \nNamtu      22.944658 23.178673 36.503882 21.761884 66.406286 39.297391\nMonghpyak  23.767919 35.684917 29.188846 22.752638 56.584279 31.511651\nKonkyan    29.674316 26.825060 28.187425 37.470456 63.592043 27.481900\nMongping   16.892101 14.095392 30.557166 28.736626 70.813447 30.833123\nHopong      6.286179 10.045714 24.416253 16.766291 62.848557 26.151075\nNyaungshwe 16.992664 28.637238 23.045003 13.118943 52.024345 25.777823\nHsihseng   13.654610 15.349551 31.198001 19.353779 67.074564 33.552974\nMongla     37.347509 42.900536 21.624705 28.945119 20.255831 21.788123\nHseni      23.148538 33.122632 18.467099 13.645492 39.174585 21.466375\nKunlong    20.510051 20.231862 22.443391 18.301388 52.188657 25.849342\nHopang     24.872536 31.764824  7.829342 19.647091 33.167199  9.257672\nNamhkan    38.279302 45.510875 22.332205 30.289487 19.646063 23.138484\nKengtung   28.408582 38.372138 20.758055 19.367980 35.148520 22.985484\nLangkho    18.305109 27.952329 13.450170  9.939859 41.041270 16.765920\nMonghsu     5.855724 13.724737 24.243599 15.359962 61.901766 26.052971\nTaunggyi   46.231183 56.288102 38.733906 36.504897 34.598041 40.559730\nPangwaun   29.812447 34.353898 18.740057 32.612960 47.063605 15.748757\nKyethi     19.517677 19.050609 37.789657 27.302385 74.999415 39.689963\nLoilen      9.804789 11.865144 19.026490  9.423028 53.557527 20.794433\nManton     35.960008 31.715603 50.379786 47.655544 90.738406 50.475214\nMongyang   26.710497 31.264797  9.106281 21.849285 32.619219 10.837735\nKunhing     9.077517 16.538834 10.391040 12.820940 50.041640 12.318870\nMongyawng  29.470967 36.440429 29.640789 19.111990 45.480044 33.616703\nTangyan    16.769794 14.459626 34.714183 24.970235 72.240954 36.476893\nNamhsan    19.447928 16.956962 37.171448 29.416284 76.045960 38.565526\n               Namtu Monghpyak   Konkyan  Mongping    Hopong Nyaungshwe\nPindaya                                                                \nYwangan                                                                \nPinlaung                                                               \nMabein                                                                 \nKalaw                                                                  \nPekon                                                                  \nLawksawk                                                               \nNawnghkio                                                              \nKyaukme                                                                \nMuse                                                                   \nLaihka                                                                 \nMongnai                                                                \nMawkmai                                                                \nKutkai                                                                 \nMongton                                                                \nMongyai                                                                \nMongkaing                                                              \nLashio                                                                 \nMongpan                                                                \nMatman                                                                 \nTachileik                                                              \nNarphan                                                                \nMongkhet                                                               \nHsipaw                                                                 \nMonghsat                                                               \nMongmao                                                                \nNansang                                                                \nLaukkaing                                                              \nPangsang                                                               \nNamtu                                                                  \nMonghpyak  34.657799                                                   \nKonkyan    47.837690 46.339594                                         \nMongping   32.166441 35.476537 24.202901                               \nHopong     20.682668 26.795563 30.449287 13.400139                     \nNyaungshwe 27.141464 10.397300 43.235040 31.932583 20.932532           \nHsihseng   13.189940 28.537627 38.349700 19.964389  9.165458  22.580242\nMongla     48.349434 40.803397 46.809747 51.261580 43.231105  34.760273\nHseni      32.741448 20.026876 44.884563 39.558453 28.641193  13.086310\nKunlong    23.360474 35.744661 32.911433 30.905385 21.906817  28.513095\nHopang     40.824516 30.426577 34.818522 37.927212 30.977356  24.719891\nNamhkan    50.632466 37.950202 48.159596 52.374815 44.413246  33.332428\nKengtung   38.533554 22.147613 47.482621 44.280821 34.047382  17.775714\nLangkho    30.503473 20.027496 38.695022 34.396455 23.963685  12.826577\nMonghsu    20.964684 23.217823 33.172187 15.890478  4.340665  17.382799\nTaunggyi   51.872748 33.417439 65.056905 62.153039 51.376415  32.509619\nPangwaun   51.703554 38.195144 26.397576 34.037881 34.600673  35.292324\nKyethi     18.690932 32.816234 40.010989 18.743974 13.649038  28.806872\nLoilen     19.424075 29.699681 33.419820 23.199959 12.474445  20.640432\nManton     44.858230 50.220840 36.666876 20.048082 31.058885  48.879874\nMongyang   41.326052 35.817599 32.939338 38.780686 32.335704  29.429500\nKunhing    29.643996 25.074435 25.374202 21.259619 14.515617  18.997131\nMongyawng  26.224331 28.556475 52.238580 45.559190 32.659925  21.812104\nTangyan    17.869483 33.526416 36.746064 16.167411 10.682328  28.414692\nNamhsan    24.095555 35.270492 35.220115 13.023777 13.270541  31.591750\n            Hsihseng    Mongla     Hseni   Kunlong    Hopang   Namhkan\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla     47.866210                                                  \nHseni      31.274375 22.682048                                        \nKunlong    23.185967 34.646200 27.619175                              \nHopang     37.001334 14.702444 16.280878 27.134451                    \nNamhkan    49.209476  7.721355 21.211323 37.573885 14.618632          \nKengtung   37.072441 20.245004  6.612817 31.714187 16.429921 17.563015\nLangkho    27.627441 22.901675  6.666133 22.452741 13.424847 22.440029\nMonghsu     9.782470 42.451868 26.228462 23.989665 30.184458 43.132637\nTaunggyi   52.814240 29.709863 23.819389 47.129032 32.995252 25.729147\nPangwaun   43.306326 31.918643 33.070182 39.245403 20.698364 31.044067\nKyethi      8.404049 55.602500 38.833498 29.855859 44.048114 56.786202\nLoilen     15.884853 33.867408 22.710984 16.653599 24.289326 36.490647\nManton     33.487758 71.251416 58.463341 47.976855 57.752046 72.186149\nMongyang   38.259743 14.666661 21.019929 24.722785  6.925859 16.772448\nKunhing    22.015490 30.647566 20.647448 19.377551 17.296164 31.492119\nMongyawng  30.951462 31.557550 17.386004 24.039800 29.051360 32.121112\nTangyan     7.027241 52.680849 37.307575 26.807983 41.222167 54.264078\nNamhsan    12.574240 56.402740 41.196125 31.040560 44.051555 57.642717\n            Kengtung   Langkho   Monghsu  Taunggyi  Pangwaun    Kyethi\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla                                                                \nHseni                                                                 \nKunlong                                                               \nHopang                                                                \nNamhkan                                                               \nKengtung                                                              \nLangkho    10.716213                                                  \nMonghsu    31.691914 22.184918                                        \nTaunggyi   18.628225 28.827478 48.691951                              \nPangwaun   33.748335 29.538434 34.338498 49.761245                    \nKyethi     44.426274 35.091512 14.661572 59.957407 47.662610          \nLoilen     28.222935 18.410672 13.155208 45.591617 33.169981 23.232965\nManton     63.199123 53.595620 33.076503 80.308034 51.079265 27.203299\nMongyang   21.708047 17.535413 32.395988 37.458247 22.525026 45.386726\nKunhing    24.595083 14.638284 14.678891 42.998509 22.909986 27.895182\nMongyawng  20.387199 18.611584 31.285089 28.773864 47.533116 38.771518\nTangyan    42.995076 33.202048 12.742203 59.265262 44.705580  4.779331\nNamhsan    46.620497 36.820978 15.322576 63.149232 44.858030  6.867929\n              Loilen    Manton  Mongyang   Kunhing Mongyawng   Tangyan\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla                                                                \nHseni                                                                 \nKunlong                                                               \nHopang                                                                \nNamhkan                                                               \nKengtung                                                              \nLangkho                                                               \nMonghsu                                                               \nTaunggyi                                                              \nPangwaun                                                              \nKyethi                                                                \nLoilen                                                                \nManton     41.906087                                                  \nMongyang   24.676592 58.570558                                        \nKunhing    13.039336 41.049230 18.889405                              \nMongyawng  26.175211 62.943339 30.421734 29.535984                    \nTangyan    19.660826 27.182672 42.106366 24.974161 37.752279          \nNamhsan    24.215271 21.048485 45.097869 27.079121 43.002019  6.367613"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.4-computing-proximity-matrix",
    "href": "HandsOn/hands-on-7.html#hx7.4-computing-proximity-matrix",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.4 Computing proximity matrix",
    "text": "HX7.4 Computing proximity matrix\nWe need a proximity matrix to pass into our hierarchical clustering computation function later. Today, we will use dist(method = 'euclidean') from base R to compute a simple euclidean proximity matrix. There are five other options available: maximum, manhattan, canberra, binary and minkowski.\n\nproxmat &lt;- dist(shan_ict, method = 'euclidean')\nproxmat\n\n             Mongmit   Pindaya   Ywangan  Pinlaung    Mabein     Kalaw\nPindaya    17.186828                                                  \nYwangan    38.188259 25.731610                                        \nPinlaung    5.746286 20.863519 40.005492                              \nMabein     26.337099 31.345776 52.914689 31.266966                    \nKalaw      16.005997 30.251785 49.953297 18.196406 19.814085          \nPekon       5.961977 11.791580 33.650410  9.461225 28.226877 21.191531\nLawksawk   14.011550 20.432952 43.216535 19.257320 13.036525 14.001101\nNawnghkio   8.907103 18.064047 37.787702 13.927495 20.463154 12.774787\nKyaukme    14.402475 31.101487 50.589191 13.967966 26.488283  7.942225\nMuse       56.301629 70.411252 89.944137 57.158335 45.327410 41.246033\nLaihka     14.187227 29.861288 49.183321 10.110150 34.500222 19.734633\nMongnai    11.586190 25.849346 42.271934  6.452387 35.886053 20.034668\nMawkmai    43.492968 43.799577 39.703752 39.811227 69.324602 56.259200\nKutkai      9.761092 21.281775 36.011861  7.807733 34.055064 20.493018\nMongton    19.267961 28.335574 36.123257 16.342143 42.516902 26.787522\nMongyai    25.672744 28.741816 33.312853 22.056339 51.640426 38.674701\nMongkaing  50.361965 48.171125 36.498429 47.629056 74.717454 62.524500\nLashio     25.129457 39.898167 60.217475 26.251735 23.128227 10.669059\nMongpan    19.332063 33.572896 48.368125 19.278316 30.152942 11.469105\nMatman     40.125041 35.439039 25.522031 38.240610 63.753975 53.763884\nTachileik  52.963213 63.551774 80.744220 55.501039 36.532538 37.364459\nNarphan    40.615714 47.450209 45.295769 37.126895 63.034312 46.353759\nMongkhet   34.945980 39.174783 40.897731 30.586058 61.030557 46.552013\nHsipaw     11.818050 24.598884 38.863147  7.655260 36.642787 21.236711\nMonghsat   21.420854 31.471506 43.298028 16.044703 47.048135 31.796188\nMongmao    24.254541 40.221719 54.285957 21.758854 38.491867 19.518913\nNansang    10.491839 27.544246 47.277637  8.549572 28.792364 12.430500\nLaukkaing  56.827732 72.685355 90.882520 56.381750 52.067373 42.777791\nPangsang   27.267383 42.824958 55.682263 24.447146 41.854016 22.403998\nNamtu      17.962251 22.540822 44.466868 17.004533 36.616094 30.727427\nMonghpyak  17.776325 22.130579 36.744835 22.220020 21.269450 16.708436\nKonkyan    40.339082 50.086933 52.812533 36.544693 61.351206 44.475859\nMongping   26.512574 31.064850 33.794020 22.975261 51.816310 37.564739\nHopong     13.693111 22.306050 35.285844  9.814855 39.800917 26.416294\nNyaungshwe  9.938590 21.652463 40.711649 13.812050 21.021337  9.566782\nHsihseng   13.149728 17.200796 34.291035 11.161846 38.120187 28.711074\nMongla     38.430076 54.942389 72.816301 37.259678 40.609124 26.026411\nHseni      18.937188 33.798982 53.444679 20.447572 21.361240  3.852842\nKunlong    22.412169 35.547066 53.163089 19.476257 39.661508 27.301375\nHopang     28.105362 44.326362 59.619312 26.596924 36.855167 18.514704\nNamhkan    38.602794 54.381859 71.443173 38.278835 37.956035 24.639577\nKengtung   24.645691 38.568322 57.323173 26.348638 21.947071  8.829335\nLangkho    16.426299 32.328133 50.778892 16.844228 25.384371  6.719580\nMonghsu    10.915790 19.835391 34.042789  8.086834 36.719820 23.734578\nTaunggyi   39.984278 50.375471 69.798323 42.954386 22.624011 25.226066\nPangwaun   38.151246 51.213162 58.013146 35.637963 52.344632 33.835194\nKyethi     20.292551 17.554012 28.729358 18.947065 44.207679 36.017247\nLoilen     14.548666 29.361143 46.951621  9.156527 37.506406 21.719877\nManton     43.064070 40.242888 30.616379 40.583081 67.401120 56.016577\nMongyang   30.951302 47.593982 63.071590 28.603834 41.188352 23.356349\nKunhing    17.350424 31.823811 44.967218 14.158836 37.582140 19.763683\nMongyawng  21.421738 33.292193 57.056521 23.555497 19.349994 17.343078\nTangyan    19.592520 20.843740 32.477002 16.950567 44.859948 34.806617\nNamhsan    23.778494 22.841073 28.616305 21.433352 48.833873 38.588676\n               Pekon  Lawksawk Nawnghkio   Kyaukme      Muse    Laihka\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk   15.751129                                                  \nNawnghkio  11.315370  9.082891                                        \nKyaukme    20.212206 18.629066 15.704230                              \nMuse       61.456144 51.013288 53.368806 43.475768                    \nLaihka     18.223667 24.674469 21.188187 12.824979 52.665211          \nMongnai    15.160031 24.171260 18.221245 14.245669 57.197975 10.053457\nMawkmai    41.600669 56.752693 49.515047 51.202846 92.693007 42.996554\nKutkai     11.498048 22.464646 14.744053 17.093318 59.290743 14.467198\nMongton    20.814888 31.107742 22.581118 22.928509 63.471074 21.207320\nMongyai    24.252301 39.126989 31.957938 33.927780 76.391399 26.413364\nMongkaing  48.023965 62.518712 54.669447 58.605094 99.566496 52.296309\nLashio     30.380011 22.075270 23.055346 12.995255 31.315288 23.864533\nMongpan    24.330037 22.854223 17.284425 11.037831 44.749969 21.076951\nMatman     36.825761 51.539711 44.405061 50.552285 92.911283 44.325453\nTachileik  57.339528 44.182621 47.045533 42.915493 22.119950 54.908985\nNarphan    41.684901 52.369580 43.559661 42.030003 77.040234 39.232592\nMongkhet   34.208722 48.741102 41.410280 40.903553 81.644931 32.497428\nHsipaw     14.537542 24.935081 17.609570 16.395741 59.103355 12.842987\nMonghsat   22.564279 35.231496 28.983220 25.325370 66.376026 15.893517\nMongmao    29.370625 31.464777 25.776465 14.609228 45.182530 18.599082\nNansang    16.037607 18.878869 15.113185  6.032773 48.935308  7.878999\nLaukkaing  62.482399 54.883928 55.265554 42.874978 14.926996 50.739700\nPangsang   32.181214 34.591486 28.710769 17.535273 46.024292 21.419291\nNamtu      16.502707 26.095300 25.752713 27.087277 65.916927 18.586794\nMonghpyak  19.093173 14.231691  9.303711 21.764419 53.943485 29.322640\nKonkyan    42.148797 52.031264 43.934272 39.379911 70.486973 35.175354\nMongping   25.968288 39.647081 31.614719 33.028984 74.444948 27.282761\nHopong     13.886577 27.491604 20.488286 21.884211 64.868011 15.748857\nNyaungshwe 13.931874 10.417830  4.326545 12.650414 50.588581 20.171653\nHsihseng   10.530573 25.711202 20.988026 25.027059 67.766886 17.589761\nMongla     44.120998 39.318472 38.140808 24.158966 25.680556 31.593218\nHseni      24.398001 17.150398 16.405304  8.120593 38.130567 20.449010\nKunlong    24.936301 31.830406 28.504608 21.563037 54.724297 12.268682\nHopang     33.638582 32.116462 27.984188 15.491633 37.744407 23.078652\nNamhkan    44.277120 37.941126 36.733575 24.781990 23.867060 34.243665\nKengtung   29.767761 20.938215 20.829647 13.623356 33.008211 25.823950\nLangkho    21.921623 19.030257 15.651662  5.167279 41.364173 16.094435\nMonghsu    11.384636 24.204063 17.009168 20.077712 63.321624 16.328926\nTaunggyi   44.066133 30.496838 34.479200 31.260547 25.081471 42.536916\nPangwaun   42.381347 45.302765 38.167478 30.831407 54.197887 35.178203\nKyethi     16.243575 31.774604 26.721607 32.814177 75.716745 25.583275\nLoilen     18.194596 26.529318 21.926405 14.692675 56.043400  5.969478\nManton     40.382131 55.113000 47.577296 52.286003 94.149778 45.830232\nMongyang   36.358788 36.337684 32.332123 18.859489 38.959919 22.971502\nKunhing    21.346379 27.868953 20.615773 14.500266 53.300162 14.203682\nMongyawng  24.843910 17.907229 22.061209 18.155295 42.237358 21.199976\nTangyan    16.779937 32.314701 26.907880 30.678359 73.693741 22.429176\nNamhsan    20.716559 36.284062 29.974967 34.785944 77.852971 27.379672\n             Mongnai   Mawkmai    Kutkai   Mongton   Mongyai Mongkaing\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai    37.450873                                                  \nKutkai      9.115307 36.495519                                        \nMongton    13.167061 31.335220 10.706341                              \nMongyai    20.323607 17.870499 18.894166 15.979790                    \nMongkaing  45.600842 13.329995 42.896133 36.550032 26.284016          \nLashio     27.086983 63.860773 28.982513 34.711584 46.636472 70.865819\nMongpan    17.809554 50.999632 18.518173 20.031803 34.639710 56.356780\nMatman     37.633870 14.783545 34.086349 30.304574 18.695158 13.551424\nTachileik  56.395232 91.938755 56.899109 60.876740 75.029555 96.714087\nNarphan    32.931700 27.375350 31.427683 21.597925 24.882845 28.565085\nMongkhet   27.576855 11.558388 27.391673 22.322828 10.498924 22.260577\nHsipaw      5.268195 35.134601  5.146282  9.069766 17.733790 42.377868\nMonghsat   12.525968 27.509705 15.432012 15.098053 12.735225 37.560376\nMongmao    18.829603 48.552853 20.469232 20.657001 33.561300 55.231959\nNansang     9.279567 46.241938 13.004549 19.958124 28.855962 54.216609\nLaukkaing  55.156800 88.251110 58.038112 60.466190 73.268347 95.411795\nPangsang   20.425746 48.414757 22.833583 21.077938 34.330638 54.840662\nNamtu      20.935473 42.795451 22.528268 30.871751 27.802761 52.504057\nMonghpyak  25.326470 53.671695 20.661627 25.804282 37.001575 56.821089\nKonkyan    32.882831 33.901411 31.060810 24.825265 28.787384 38.092091\nMongping   20.299615 19.431049 18.275266 11.986993  6.538727 25.718572\nHopong      9.153795 30.284362  7.345899 10.621031 12.462791 37.937916\nNyaungshwe 16.963695 50.299026 15.215482 21.972196 32.713541 55.732112\nHsihseng   14.236728 32.929477 12.821054 19.464317 16.227126 41.159788\nMongla     35.410985 68.688950 38.840984 41.106668 53.528615 76.148327\nHseni      21.681639 58.253670 22.937894 28.675945 40.823212 64.804408\nKunlong    20.292529 44.653763 20.454010 27.002165 29.936066 53.991284\nHopang     24.300945 56.124281 26.331986 27.350305 40.873288 62.617673\nNamhkan    37.005669 70.647792 39.248568 41.453594 55.062819 77.139688\nKengtung   27.228711 63.254638 27.919573 32.938387 46.039706 69.274693\nLangkho    17.467678 53.108019 18.051419 23.670878 35.895672 59.742714\nMonghsu     8.411238 33.207962  6.260859 10.704894 15.486049 40.071816\nTaunggyi   44.855282 81.074692 45.033382 50.840925 63.594105 86.621117\nPangwaun   31.213429 50.068857 32.180465 25.750434 39.407696 53.695736\nKyethi     21.050453 27.885535 18.423422 22.252947 13.779420 35.206533\nLoilen      5.841263 38.873386 13.156529 17.616001 22.479239 48.218190\nManton     39.154062 10.908779 36.182684 31.020581 19.559882  8.175337\nMongyang   26.039387 55.883162 28.533223 29.560023 41.431237 63.191325\nKunhing    11.055197 39.843973 10.884990 11.403609 23.899570 46.503971\nMongyawng  27.577546 62.004321 28.103383 37.522688 44.578964 70.098284\nTangyan    18.037471 26.266006 16.661820 19.888460 10.908506 34.856123\nNamhsan    21.810003 21.519289 19.132762 19.676188  7.735900 28.866231\n              Lashio   Mongpan    Matman Tachileik   Narphan  Mongkhet\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan    17.233279                                                  \nMatman     62.811049 49.481014                                        \nTachileik  31.195286 41.103849 89.012935                              \nNarphan    52.563854 37.113393 31.205193 76.029566                    \nMongkhet   53.444463 41.217123 20.302855 82.050164 21.728718          \nHsipaw     29.086435 17.952054 34.445451 57.618780 29.540170 25.380950\nMonghsat   37.786793 28.330992 31.359911 67.709508 27.821548 16.798445\nMongmao    21.423677 13.159966 50.159903 47.295568 33.142618 37.535820\nNansang    18.447950 14.477393 45.806573 48.677266 39.813308 36.099219\nLaukkaing  33.465738 43.558047 90.372094 32.506329 70.882887 76.906406\nPangsang   23.672516 14.023910 50.629940 48.131907 31.630314 37.558139\nNamtu      36.588437 35.291394 41.665397 65.956458 49.436143 35.599713\nMonghpyak  26.209281 18.785699 47.046845 44.404411 44.840651 46.263265\nKonkyan    48.551312 36.587588 39.240306 73.092980 15.882353 25.424424\nMongping   45.452548 31.847482 20.165224 72.708969 18.864567 11.380917\nHopong     34.531042 23.943845 29.184351 63.245718 29.440441 21.299485\nNyaungshwe 20.158191 13.729734 46.091883 44.581335 42.794086 41.708639\nHsihseng   36.900833 29.587811 30.402806 65.887060 37.752977 25.670338\nMongla     17.995877 25.320001 70.817595 34.733155 53.146949 57.440292\nHseni       7.941836 12.066550 56.464051 35.490063 47.412297 48.188406\nKunlong    29.523103 28.803320 46.827436 59.570536 41.307823 34.168641\nHopang     17.063913 13.562913 57.355355 40.382035 39.785908 45.151070\nNamhkan    17.327153 24.034131 71.542102 29.591660 53.685519 59.619944\nKengtung    5.985893 14.221554 61.301033 29.590429 50.540025 53.135998\nLangkho    11.518145  9.498486 51.886151 40.233622 42.065204 42.808061\nMonghsu    32.571557 21.625326 30.813805 60.502113 31.192379 24.773318\nTaunggyi   19.514541 31.981385 77.845810 15.084117 68.420905 71.280752\nPangwaun   36.245608 23.252209 52.343600 54.060474 26.464997 40.702947\nKyethi     44.710266 35.889620 23.383079 72.887329 37.490376 23.325039\nLoilen     26.892310 20.725000 40.656282 57.375476 35.479137 28.476895\nManton     64.666493 50.796808  5.952318 91.023039 28.026395 18.133894\nMongyang   20.933700 19.493467 58.561776 44.879027 40.139475 44.540621\nKunhing    25.510832 13.785278 40.366587 53.226397 28.162645 29.249814\nMongyawng  17.270139 27.515989 60.180824 43.210118 57.276394 52.291815\nTangyan    42.984475 34.039128 24.278233 71.984066 34.884991 20.149393\nNamhsan    47.204024 36.477086 18.009747 75.403913 31.654695 17.090848\n              Hsipaw  Monghsat   Mongmao   Nansang Laukkaing  Pangsang\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat   12.178922                                                  \nMongmao    18.599483 24.717708                                        \nNansang    12.024428 20.192690 16.499494                              \nLaukkaing  56.906099 62.644910 40.400848 48.060074                    \nPangsang   20.504337 25.637933  5.760801 19.336162 40.804016          \nNamtu      22.944658 23.178673 36.503882 21.761884 66.406286 39.297391\nMonghpyak  23.767919 35.684917 29.188846 22.752638 56.584279 31.511651\nKonkyan    29.674316 26.825060 28.187425 37.470456 63.592043 27.481900\nMongping   16.892101 14.095392 30.557166 28.736626 70.813447 30.833123\nHopong      6.286179 10.045714 24.416253 16.766291 62.848557 26.151075\nNyaungshwe 16.992664 28.637238 23.045003 13.118943 52.024345 25.777823\nHsihseng   13.654610 15.349551 31.198001 19.353779 67.074564 33.552974\nMongla     37.347509 42.900536 21.624705 28.945119 20.255831 21.788123\nHseni      23.148538 33.122632 18.467099 13.645492 39.174585 21.466375\nKunlong    20.510051 20.231862 22.443391 18.301388 52.188657 25.849342\nHopang     24.872536 31.764824  7.829342 19.647091 33.167199  9.257672\nNamhkan    38.279302 45.510875 22.332205 30.289487 19.646063 23.138484\nKengtung   28.408582 38.372138 20.758055 19.367980 35.148520 22.985484\nLangkho    18.305109 27.952329 13.450170  9.939859 41.041270 16.765920\nMonghsu     5.855724 13.724737 24.243599 15.359962 61.901766 26.052971\nTaunggyi   46.231183 56.288102 38.733906 36.504897 34.598041 40.559730\nPangwaun   29.812447 34.353898 18.740057 32.612960 47.063605 15.748757\nKyethi     19.517677 19.050609 37.789657 27.302385 74.999415 39.689963\nLoilen      9.804789 11.865144 19.026490  9.423028 53.557527 20.794433\nManton     35.960008 31.715603 50.379786 47.655544 90.738406 50.475214\nMongyang   26.710497 31.264797  9.106281 21.849285 32.619219 10.837735\nKunhing     9.077517 16.538834 10.391040 12.820940 50.041640 12.318870\nMongyawng  29.470967 36.440429 29.640789 19.111990 45.480044 33.616703\nTangyan    16.769794 14.459626 34.714183 24.970235 72.240954 36.476893\nNamhsan    19.447928 16.956962 37.171448 29.416284 76.045960 38.565526\n               Namtu Monghpyak   Konkyan  Mongping    Hopong Nyaungshwe\nPindaya                                                                \nYwangan                                                                \nPinlaung                                                               \nMabein                                                                 \nKalaw                                                                  \nPekon                                                                  \nLawksawk                                                               \nNawnghkio                                                              \nKyaukme                                                                \nMuse                                                                   \nLaihka                                                                 \nMongnai                                                                \nMawkmai                                                                \nKutkai                                                                 \nMongton                                                                \nMongyai                                                                \nMongkaing                                                              \nLashio                                                                 \nMongpan                                                                \nMatman                                                                 \nTachileik                                                              \nNarphan                                                                \nMongkhet                                                               \nHsipaw                                                                 \nMonghsat                                                               \nMongmao                                                                \nNansang                                                                \nLaukkaing                                                              \nPangsang                                                               \nNamtu                                                                  \nMonghpyak  34.657799                                                   \nKonkyan    47.837690 46.339594                                         \nMongping   32.166441 35.476537 24.202901                               \nHopong     20.682668 26.795563 30.449287 13.400139                     \nNyaungshwe 27.141464 10.397300 43.235040 31.932583 20.932532           \nHsihseng   13.189940 28.537627 38.349700 19.964389  9.165458  22.580242\nMongla     48.349434 40.803397 46.809747 51.261580 43.231105  34.760273\nHseni      32.741448 20.026876 44.884563 39.558453 28.641193  13.086310\nKunlong    23.360474 35.744661 32.911433 30.905385 21.906817  28.513095\nHopang     40.824516 30.426577 34.818522 37.927212 30.977356  24.719891\nNamhkan    50.632466 37.950202 48.159596 52.374815 44.413246  33.332428\nKengtung   38.533554 22.147613 47.482621 44.280821 34.047382  17.775714\nLangkho    30.503473 20.027496 38.695022 34.396455 23.963685  12.826577\nMonghsu    20.964684 23.217823 33.172187 15.890478  4.340665  17.382799\nTaunggyi   51.872748 33.417439 65.056905 62.153039 51.376415  32.509619\nPangwaun   51.703554 38.195144 26.397576 34.037881 34.600673  35.292324\nKyethi     18.690932 32.816234 40.010989 18.743974 13.649038  28.806872\nLoilen     19.424075 29.699681 33.419820 23.199959 12.474445  20.640432\nManton     44.858230 50.220840 36.666876 20.048082 31.058885  48.879874\nMongyang   41.326052 35.817599 32.939338 38.780686 32.335704  29.429500\nKunhing    29.643996 25.074435 25.374202 21.259619 14.515617  18.997131\nMongyawng  26.224331 28.556475 52.238580 45.559190 32.659925  21.812104\nTangyan    17.869483 33.526416 36.746064 16.167411 10.682328  28.414692\nNamhsan    24.095555 35.270492 35.220115 13.023777 13.270541  31.591750\n            Hsihseng    Mongla     Hseni   Kunlong    Hopang   Namhkan\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla     47.866210                                                  \nHseni      31.274375 22.682048                                        \nKunlong    23.185967 34.646200 27.619175                              \nHopang     37.001334 14.702444 16.280878 27.134451                    \nNamhkan    49.209476  7.721355 21.211323 37.573885 14.618632          \nKengtung   37.072441 20.245004  6.612817 31.714187 16.429921 17.563015\nLangkho    27.627441 22.901675  6.666133 22.452741 13.424847 22.440029\nMonghsu     9.782470 42.451868 26.228462 23.989665 30.184458 43.132637\nTaunggyi   52.814240 29.709863 23.819389 47.129032 32.995252 25.729147\nPangwaun   43.306326 31.918643 33.070182 39.245403 20.698364 31.044067\nKyethi      8.404049 55.602500 38.833498 29.855859 44.048114 56.786202\nLoilen     15.884853 33.867408 22.710984 16.653599 24.289326 36.490647\nManton     33.487758 71.251416 58.463341 47.976855 57.752046 72.186149\nMongyang   38.259743 14.666661 21.019929 24.722785  6.925859 16.772448\nKunhing    22.015490 30.647566 20.647448 19.377551 17.296164 31.492119\nMongyawng  30.951462 31.557550 17.386004 24.039800 29.051360 32.121112\nTangyan     7.027241 52.680849 37.307575 26.807983 41.222167 54.264078\nNamhsan    12.574240 56.402740 41.196125 31.040560 44.051555 57.642717\n            Kengtung   Langkho   Monghsu  Taunggyi  Pangwaun    Kyethi\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla                                                                \nHseni                                                                 \nKunlong                                                               \nHopang                                                                \nNamhkan                                                               \nKengtung                                                              \nLangkho    10.716213                                                  \nMonghsu    31.691914 22.184918                                        \nTaunggyi   18.628225 28.827478 48.691951                              \nPangwaun   33.748335 29.538434 34.338498 49.761245                    \nKyethi     44.426274 35.091512 14.661572 59.957407 47.662610          \nLoilen     28.222935 18.410672 13.155208 45.591617 33.169981 23.232965\nManton     63.199123 53.595620 33.076503 80.308034 51.079265 27.203299\nMongyang   21.708047 17.535413 32.395988 37.458247 22.525026 45.386726\nKunhing    24.595083 14.638284 14.678891 42.998509 22.909986 27.895182\nMongyawng  20.387199 18.611584 31.285089 28.773864 47.533116 38.771518\nTangyan    42.995076 33.202048 12.742203 59.265262 44.705580  4.779331\nNamhsan    46.620497 36.820978 15.322576 63.149232 44.858030  6.867929\n              Loilen    Manton  Mongyang   Kunhing Mongyawng   Tangyan\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla                                                                \nHseni                                                                 \nKunlong                                                               \nHopang                                                                \nNamhkan                                                               \nKengtung                                                              \nLangkho                                                               \nMonghsu                                                               \nTaunggyi                                                              \nPangwaun                                                              \nKyethi                                                                \nLoilen                                                                \nManton     41.906087                                                  \nMongyang   24.676592 58.570558                                        \nKunhing    13.039336 41.049230 18.889405                              \nMongyawng  26.175211 62.943339 30.421734 29.535984                    \nTangyan    19.660826 27.182672 42.106366 24.974161 37.752279          \nNamhsan    24.215271 21.048485 45.097869 27.079121 43.002019  6.367613"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.5-computing-hierarchical-clustering",
    "href": "HandsOn/hands-on-7.html#hx7.5-computing-hierarchical-clustering",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.5 Computing hierarchical clustering",
    "text": "HX7.5 Computing hierarchical clustering\nSeveral packages exist in R to perform hierarchical clustering, but today, hclust() from R stats will be used. It employs an agglomeration method to compute clusters and supports the following eight clustering algorithms: ward.D, ward.D2, single, complete, average (UPGMA), mcquitty (WPGMA), median (WPGMC) and centroid (UPGMC).\nThe code chunk below performs hierarchical cluster analysis using ward.D method. The hierarchical clustering output is stored in an object of class hclust, which describes the tree produced by the clustering process. We will then plot the tree using plot() from R graphics.\n\nhclust_ward &lt;- hclust(proxmat, method = 'ward.D')\nplot(hclust_ward, cex = 0.6)"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.6-selecting-optimal-clustering-algorithm",
    "href": "HandsOn/hands-on-7.html#hx7.6-selecting-optimal-clustering-algorithm",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.6 Selecting optimal clustering algorithm",
    "text": "HX7.6 Selecting optimal clustering algorithm\nA key challenge in performing hierarchical clustering is in identifying stronger clustering structures. A function, agnes() from the cluster package, can be used to solve this issue - it functions like hclust(), but can also be used to return the agglomerative coefficient, which measures the extent to which clustering exists. As the coefficient approaches 1, the data suggests a stronger clustering structure.\n\nm &lt;- c( \"average\", \"single\", \"complete\", \"ward\")\nnames(m) &lt;- c( \"average\", \"single\", \"complete\", \"ward\")\n\nac &lt;- function(x) {\n  agnes(shan_ict, method = x)$ac\n}\n\nmap_dbl(m, ac)\n\n  average    single  complete      ward \n0.8131144 0.6628705 0.8950702 0.9427730 \n\n\nFrom the output above, Ward’s method provides the strongest clustering structure among the four methods assessed. Hence, we will use Ward’s method in subsequent analyses."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.7-determining-optimal-clusters",
    "href": "HandsOn/hands-on-7.html#hx7.7-determining-optimal-clusters",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.7 Determining optimal clusters",
    "text": "HX7.7 Determining optimal clusters\nThe next obstacle is in determining the optimal clusters to retain. Three commonly used methods are used to determine optimal clusters: the elbow method, the average silhouette method and the gap statistic method."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.7.1-gap-statistic-method",
    "href": "HandsOn/hands-on-7.html#hx7.7.1-gap-statistic-method",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.7.1 Gap statistic method",
    "text": "HX7.7.1 Gap statistic method\nThis method compares the total within intra-cluster variation for different numbers of clusters \\(k\\) with their expected values under null reference distribution of the data. The estimate of the optimal clusters will be value that maximises the gap statistic (i.e., that yields the largest gap statistic). This means that the clustering structure is far away from the random uniform distribution of points.\nclusGap() of the cluster package will be used to compute the gap statistic, and fviz_gap_stat() of the factoextra package will be used to plot the optimal numbers of clusters.\n\nset.seed(12345)\ngap_stat &lt;- clusGap(shan_ict, \n                    FUN = hcut, \n                    nstart = 25, \n                    K.max = 10, \n                    B = 50)\n# Print the result\nprint(gap_stat, method = \"firstmax\")\n\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)\nB=50 simulated reference sets, k = 1..10; spaceH0=\"scaledPCA\"\n --&gt; Number of clusters (method 'firstmax'): 1\n          logW   E.logW       gap     SE.sim\n [1,] 6.104544 6.378209 0.2736651 0.04460994\n [2,] 5.827444 6.048127 0.2206824 0.03880130\n [3,] 5.689680 5.899965 0.2102844 0.03362652\n [4,] 5.559639 5.778070 0.2184311 0.03784781\n [5,] 5.453876 5.675437 0.2215615 0.03897071\n [6,] 5.363009 5.585192 0.2221833 0.03973087\n [7,] 5.288334 5.503748 0.2154145 0.04054939\n [8,] 5.224095 5.429034 0.2049390 0.04198644\n [9,] 5.155439 5.358210 0.2027705 0.04421874\n[10,] 5.074827 5.291273 0.2164465 0.04540947\n\nfviz_gap_stat(gap_stat)\n\n\n\n\n\n\n\n\nWith the highest gap statistic of around 0.275, the recommended value of \\(k\\) is 1, i.e. we are apparently encouraged to retain only one cluster. However, this is illogical - instead, the next best value of \\(k\\), with the second highest gap statistic, is 6.\n\nHX7.7.2 Interpretation\nIn the dendrogram from HX7.5, each leaf corresponds to one observation. As we move up the tree, observations that are similar to each other are combined into branches, which are themselves fused at a higher height. The height of the fusion (which is provided on the y-axis) indicates the (dis)similarity between two observations. The higher the height, the less similar the observations are. We cannot use the proximity of two observations along the x-axis as a basis of comparision for their similarity.\nIt is also possible to draw the dendrogram with a border around the selected clusters by using rect.hclust() of R stats. The argument border is used to specify the border colors for the rectangles.\n\nplot(hclust_ward, cex = 0.6)\nrect.hclust(hclust_ward, \n            k = 6, \n            border = 2:5)"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.8-visually-driven-hierarchical-clustering-analysis",
    "href": "HandsOn/hands-on-7.html#hx7.8-visually-driven-hierarchical-clustering-analysis",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.8 Visually-driven hierarchical clustering analysis",
    "text": "HX7.8 Visually-driven hierarchical clustering analysis\nAnother type of clustering analysis is visually-driven hierarchical clustering analysis, which can be done using the heatmaply package. With this package, we can build both highly interactive cluster heatmaps or static cluster heatmaps.\n\nHX7.8.1 Transforming data frame into matrix\nThe data was loaded as a dataframe, but to create the heatmap we have to first convert it into a data matrix.\n\nshan_ict_mat &lt;- data.matrix(shan_ict)\n\n\n\nHX7.8.2 Interactive cluster heatmap\n\nheatmaply(normalize(shan_ict_mat),\n          Colv=NA,\n          dist_method = \"euclidean\",\n          hclust_method = \"ward.D\",\n          seriate = \"OLO\",\n          colors = Blues,\n          k_row = 6,\n          margins = c(NA,200,60,NA),\n          fontsize_row = 4,\n          fontsize_col = 5,\n          main=\"Geographic Segmentation of Shan State by ICT indicators\",\n          xlab = \"ICT Indicators\",\n          ylab = \"Townships of Shan State\"\n          )\n\n\n\n\n\nWhen we plot our interactive cluster heatmap with the code chunk above, the right part of the output is effectively the same dendrogram we get from earlier."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.9-mapping-the-clusters-formed",
    "href": "HandsOn/hands-on-7.html#hx7.9-mapping-the-clusters-formed",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.9 Mapping the clusters formed",
    "text": "HX7.9 Mapping the clusters formed\nIf we recall from earlier, we determined that the optimal number of clusters \\(k\\) to retain is 6. We will do just that in the code chunk below, using cutree() of base R.\n\ngroups &lt;- as.factor(cutree(hclust_ward, k=6))\n\nThe output is called groups. It is a list object.\nIn order to visualise the clusters, the groups object needs to be appended onto the shan_sf simple feature object. This is done in three steps:\n\nConvert groups into a matrix;\nUse cbind() to append groups matrix to shan_sf to produce an output simple feature object called shan_sf_cluster; and\nUse renamefrom the dplyr package to rename the as.matrix.groups field as CLUSTER.\nPlot the choropleth map showing the clusters formed.\n\n\nshan_sf_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER`=`as.matrix.groups.`)\nhierarchical_map &lt;- qtm(shan_sf_cluster, \"CLUSTER\")\nhierarchical_map\n\n\n\n\n\n\n\n\nThe choropleth map above reveals extensive fragmentation in the clusters. The is a major limitation when non-spatial clustering algorithms such as hierarchical cluster analysis method are used."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.10-saving-modified-sf-to-disk-as-rds",
    "href": "HandsOn/hands-on-7.html#hx7.10-saving-modified-sf-to-disk-as-rds",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.10 Saving modified sf to disk as RDS",
    "text": "HX7.10 Saving modified sf to disk as RDS\nThe process will continue in Hands-on exercise 8. Before we conclude, we need to save some objects from earlier to the disk so that we can refer to it again.\n\nwrite_rds(shan_sf, 'data/rds/shan_sf.rds')\nwrite_rds(shan_ict, 'data/rds/shan_ict.rds')\nwrite_rds(shan_sf_cluster, 'data/rds/shan_sf_cluster.rds')\nwrite_rds(hierarchical_map, 'data/rds/hmap.rds')\nwrite_rds(proxmat, 'data/rds/proxmat.rds')"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#references",
    "href": "HandsOn/hands-on-7.html#references",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "References",
    "text": "References\n\nKam, T. S. (2024). 12 Geographical Segmentation with Spatially Constrained Clustering Techniques. R for Geospatial Data Science and Analytics. https://r4gdsa.netlify.app/chap12#correlation-analysis"
  },
  {
    "objectID": "HandsOn/hands-on-8.html",
    "href": "HandsOn/hands-on-8.html",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "",
    "text": "This hands-on exercise is a continuation of Hands-on Exercise 7, where the focus now will be on spatially constrained clustering analysis."
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.1-overview",
    "href": "HandsOn/hands-on-8.html#hx8.1-overview",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "",
    "text": "This hands-on exercise is a continuation of Hands-on Exercise 7, where the focus now will be on spatially constrained clustering analysis."
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.2-loading-r-packages-and-preparing-data",
    "href": "HandsOn/hands-on-8.html#hx8.2-loading-r-packages-and-preparing-data",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.2 Loading R packages and preparing data",
    "text": "HX8.2 Loading R packages and preparing data\nIn this section, we will load the R packages and the data we need, which are the same as Hands-on Exercise 7. We will also replicate the steps from the earlier exercise to derive the penetration rate of various ICT device types.\n\npacman::p_load(spdep, tmap, sf, ClustGeo, \n               ggpubr, cluster, factoextra, NbClust,\n               heatmaply, corrplot, psych, tidyverse, GGally)\n# Retrieve joined DF as saved in exercise 7\nshan_sf &lt;- read_rds(\"data/rds/shan_sf.rds\")\nict &lt;- read_csv (\"data/aspatial/Shan-ICT.csv\")\n\nRows: 55 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): District Pcode, District Name, Township Pcode, Township Name\ndbl (7): Total households, Radio, Television, Land line phone, Mobile phone,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nict_derived &lt;- ict %&gt;%\n  mutate(`RADIO_PR` = `Radio`/`Total households`*100) %&gt;%\n  mutate(`TV_PR` = `Television`/`Total households`*100) %&gt;%\n  mutate(`LLPHONE_PR` = `Land line phone`/`Total households`*100) %&gt;%\n  mutate(`MPHONE_PR` = `Mobile phone`/`Total households`*100) %&gt;%\n  mutate(`COMPUTER_PR` = `Computer`/`Total households`*100) %&gt;%\n  mutate(`INTERNET_PR` = `Internet at home`/`Total households`*100) %&gt;%\n  rename(`DT_PCODE` =`District Pcode`,`DT`=`District Name`,\n         `TS_PCODE`=`Township Pcode`, `TS`=`Township Name`,\n         `TT_HOUSEHOLDS`=`Total households`,\n         `RADIO`=`Radio`, `TV`=`Television`, \n         `LLPHONE`=`Land line phone`, `MPHONE`=`Mobile phone`,\n         `COMPUTER`=`Computer`, `INTERNET`=`Internet at home`)\nsummary(ict_derived)\n\n   DT_PCODE              DT              TS_PCODE              TS           \n Length:55          Length:55          Length:55          Length:55         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n TT_HOUSEHOLDS       RADIO             TV           LLPHONE      \n Min.   : 3318   Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711   1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685   Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369   Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471   3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604   Max.   :30176   Max.   :62388   Max.   :6736.0  \n     MPHONE         COMPUTER         INTERNET         RADIO_PR     \n Min.   :  150   Min.   :  20.0   Min.   :   8.0   Min.   : 2.105  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0   1st Qu.:13.895  \n Median : 3559   Median : 244.0   Median : 316.0   Median :21.095  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2   Mean   :21.568  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5   3rd Qu.:26.807  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0   Max.   :48.452  \n     TV_PR         LLPHONE_PR       MPHONE_PR       COMPUTER_PR    \n Min.   :11.60   Min.   : 0.278   Min.   : 3.642   Min.   :0.3278  \n 1st Qu.:45.02   1st Qu.: 2.284   1st Qu.:19.014   1st Qu.:1.1832  \n Median :51.72   Median : 3.759   Median :30.527   Median :1.8970  \n Mean   :50.95   Mean   : 5.109   Mean   :31.405   Mean   :2.4393  \n 3rd Qu.:60.64   3rd Qu.: 6.972   3rd Qu.:42.843   3rd Qu.:2.9897  \n Max.   :84.25   Max.   :18.149   Max.   :73.543   Max.   :9.2402  \n  INTERNET_PR     \n Min.   : 0.1041  \n 1st Qu.: 0.8617  \n Median : 2.2829  \n Mean   : 3.0644  \n 3rd Qu.: 4.1281  \n Max.   :11.7985  \n\n\n\nHX8.2.1 Abridged EDA\nAs a recap, we will also draw the choropleth maps and correlation matrix from the last exercise.\n\ntm_shape(shan_sf) +\n    tm_polygons(c(\"TT_HOUSEHOLDS\", \"RADIO_PR\"),\n                style=\"jenks\") +\n    tm_facets(sync = TRUE, ncol = 2) +\n  tm_legend(legend.position = c(\"right\", \"bottom\"))+\n  tm_layout(outer.margins=0, asp=0)\n\n\n\n\n\n\n\n\n\ncluster_vars.cor = cor(ict_derived[,12:17])\ncorrplot.mixed(cluster_vars.cor,\n         lower = \"ellipse\", \n               upper = \"number\",\n               tl.pos = \"lt\",\n               diag = \"l\",\n               tl.col = \"black\")"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#references",
    "href": "HandsOn/hands-on-8.html#references",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "References",
    "text": "References\n\nKam, T. S. (2024). 12 Geographical Segmentation with Spatially Constrained Clustering Techniques. R for Geospatial Data Science and Analytics. https://r4gdsa.netlify.app/chap12#correlation-analysis"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.3-spatially-constrained-clustering-skater-approach",
    "href": "HandsOn/hands-on-8.html#hx8.3-spatially-constrained-clustering-skater-approach",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.3 Spatially Constrained Clustering: SKATER approach",
    "text": "HX8.3 Spatially Constrained Clustering: SKATER approach\nThis section serves to derive spatially constrained clusters using the skater() function from the spdep package. The SKATER (Spatial ’K’luster Analysis by Tree Edge Removal) method builds off a connectivity graph representing spatial relationships between neighbouring areas. In this graph, each area is represented by a node and each edge represents a connection between areas. The dissimilarity between neighbouring areas constitutes the edge costs, and we reduce the graph by pruning edges with higher dissimilarity, until we are left with a minimum spanning tree - that is, a tree with \\(n\\) nodes and \\(n - 1\\) edges. Any further pruning would create subgraphs, which become our cluster candidates.\n\nHX8.3.1 Converting to SpatialPolygonsDataFrame\nThe skater() function only supports sp objects, such as the SpatialPolygonsDataFrame. Hence, we need to convert shan_sf as needed first.\n\nshan_sp &lt;- as_Spatial(shan_sf)\n\n\n\nHX8.3.2 Computing Neighbour List\nNext, poly2nd() from the spdep package will be used to compute the neighbours list from the polygon list.\n\nshan.nb &lt;- poly2nb(shan_sp)\nsummary(shan.nb)\n\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\n\nWe can plot the neighbour list on shan_sp by using the code chunk below. Since we now can plot the community area boundaries as well, we plot this graph on top of the map.\nThe first plot command gives the boundaries. This is followed by the plot of the neighbor list object, with coordinates applied to the original SpatialPolygonDataFrame (Shan state township boundaries) to extract the centroids of the polygons. These are used as the nodes for the graph representation. We can also specify add=TRUE to plot the network on top of the boundaries.\n\ncoords &lt;- st_coordinates(\n  st_centroid(st_geometry(shan_sf)))\nplot(st_geometry(shan_sf), \n     border=grey(.5))\nplot(shan.nb,\n     coords, \n     col=\"red\", \n     add=TRUE)\n\n\n\n\n\n\n\n\n\nNote that if you plot the network first and then the boundaries, some areas will be clipped because the plotting area is determined by the characteristics of the first plot. In this example, because the boundary map extends further than the graph, we plot it first."
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.4-creating-connectivity-graph",
    "href": "HandsOn/hands-on-8.html#hx8.4-creating-connectivity-graph",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.4 Creating connectivity graph",
    "text": "HX8.4 Creating connectivity graph\n\nHX8.4.1 Calculating edge costs\nnbcosts() of spdep is used to compute the cost of each edge.\n\n# From exercise 7\nshan_ict &lt;- read_rds('data/rds/shan_ict.rds')\nlcosts &lt;- nbcosts(shan.nb, shan_ict)\n\nFor each observation, this gives the pairwise dissimilarity between its values on the five variables and the values for the neighbouring observation (from the neighbour list). Basically, this is the notion of a generalised weight for a spatial weights matrix.\nFollowing that, we will incorporate these costs into a weights object in the same way as we did in the calculation of inverse of distance weights. In other words, we convert the neighbour list to a list weights object by specifying the just computed lcosts as the weights. In order to achieve this, nb2listw() of spdep package is used as shown in the code chunk below. Note that we have to specify the style as B to make sure the cost values are not row-standardised.\n\nshan.w &lt;- nb2listw(shan.nb, \n                   lcosts, \n                   style=\"B\")\nsummary(shan.w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\nWeights style: B \nWeights constants summary:\n   n   nn       S0       S1      S2\nB 55 3025 7626.765 582607.8 5220160"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.5-computing-minimum-spanning-tree",
    "href": "HandsOn/hands-on-8.html#hx8.5-computing-minimum-spanning-tree",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.5 Computing minimum spanning tree",
    "text": "HX8.5 Computing minimum spanning tree\nIt is now time to create our minimum spanning tree. The tree is computed using the mstree() method of the spdep package.\n\nshan.mst &lt;- mstree(shan.w)\n# Check class of shan.mst\nclass(shan.mst)\n\n[1] \"mst\"    \"matrix\"\n\n# Check dimensions\ndim(shan.mst)\n\n[1] 54  3\n\n\nNote that the dimension is 54 and not 55. This is because the tree comprises \\(n-1\\) edges (links) in order to traverse all the nodes.\nWe can display the content of shan.mst by using head() as shown in the code chunk below.\n\nhead(shan.mst)\n\n     [,1] [,2]      [,3]\n[1,]   14   37 32.929477\n[2,]   37   35  9.165458\n[3,]   35   49 12.474445\n[4,]   49   12  5.969478\n[5,]   12   28  7.878999\n[6,]   28   13  9.279567\n\n\nWe can also plot our tree to show the observation numbers of each node in addition to the edge. As before, we plot this together with the township boundaries. We can see how the initial neighbour list is simplified to just one edge connecting each of the nodes, while passing through all the nodes.\n\nplot(st_geometry(shan_sf), \n                 border=gray(.5))\nplot.mst(shan.mst, \n         coords, \n         col=\"orange2\", \n         cex.lab=0.7, \n         cex.circles=0.005, \n         add=TRUE)"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.6-computing-spatially-constrained-clusters-using-skater-method",
    "href": "HandsOn/hands-on-8.html#hx8.6-computing-spatially-constrained-clusters-using-skater-method",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.6 Computing spatially constrained clusters using SKATER method",
    "text": "HX8.6 Computing spatially constrained clusters using SKATER method\nWe can now use the code chunk below to compute the spatially constrained clusters using skater() from spdep. skater() takes three mandatory arguments: the first two columns of the MST matrix (i.e. not the cost); the data matrix (to update the costs as units are being grouped), and; the number of cuts. The result of the skater() is an object of class skater, whose contents we can examine.\n\nNote: The number of cuts is set to one less than the number of clusters. So, the value specified is not the number of clusters, but the number of cuts in the graph, one less than the number of clusters.\n\n\nclust6 &lt;- spdep::skater(edges = shan.mst[,1:2], \n                 data = shan_ict, \n                 method = \"euclidean\", \n                 ncuts = 5)\nstr(clust6)\n\nList of 8\n $ groups      : num [1:55] 3 3 6 3 3 3 3 3 3 3 ...\n $ edges.groups:List of 6\n  ..$ :List of 3\n  .. ..$ node: num [1:22] 13 48 45 55 52 14 34 16 25 54 ...\n  .. ..$ edge: num [1:21, 1:3] 48 55 45 14 34 16 52 25 13 28 ...\n  .. ..$ ssw : num 342\n  ..$ :List of 3\n  .. ..$ node: num [1:18] 47 27 53 38 42 15 41 51 43 32 ...\n  .. ..$ edge: num [1:17, 1:3] 53 15 42 38 41 51 15 27 15 43 ...\n  .. ..$ ssw : num 376\n  ..$ :List of 3\n  .. ..$ node: num [1:11] 2 6 8 1 36 4 10 9 46 5 ...\n  .. ..$ edge: num [1:10, 1:3] 6 1 8 36 4 6 8 10 10 9 ...\n  .. ..$ ssw : num 146\n  ..$ :List of 3\n  .. ..$ node: num [1:2] 44 20\n  .. ..$ edge: num [1, 1:3] 44 20 9.5\n  .. ..$ ssw : num 9.5\n  ..$ :List of 3\n  .. ..$ node: num 23\n  .. ..$ edge: num[0 , 1:3] \n  .. ..$ ssw : num 0\n  ..$ :List of 3\n  .. ..$ node: num 3\n  .. ..$ edge: num[0 , 1:3] \n  .. ..$ ssw : num 0\n $ not.prune   : NULL\n $ candidates  : int [1:6] 1 2 3 4 5 6\n $ ssto        : num 1261\n $ ssw         : num [1:6] 1261 1098 996 954 912 ...\n $ crit        : num [1:2] 1 Inf\n $ vec.crit    : num [1:55] 1 1 1 1 1 1 1 1 1 1 ...\n - attr(*, \"class\")= chr \"skater\"\n\n\nThe most interesting component of this list structure is the groups vector containing the labels of the cluster to which each observation belongs (as before, the label itself is arbitrary). This is followed by a detailed summary for each of the clusters in the edges.groups list. The sum of squares measures are given as ssto for the total and ssw to show the effect of each of the cuts on the overall criterion.\nGiven our clusters, we can print the cluster assignment, or use the table() function to find out the number of observations in each cluster. Parenthetially, we can also interpret the latter as the dimension of each vector in the lists contained in edges.groups. For example, the first list has node with dimension 12, corresponding to the number of observations in the first cluster.\n\nccs6 &lt;- clust6$groups\nccs6\n\n [1] 3 3 6 3 3 3 3 3 3 3 2 1 1 1 2 1 1 1 2 4 1 2 5 1 1 1 2 1 2 2 1 2 2 1 1 3 1 2\n[39] 2 2 2 2 2 4 1 3 2 1 1 1 2 1 2 1 1\n\ntable(ccs6)\n\nccs6\n 1  2  3  4  5  6 \n22 18 11  2  1  1 \n\n\nLastly, we can also plot the pruned tree that shows the five clusters on top of the townshop area.\n\nplot(st_geometry(shan_sf), \n     border=gray(.5))\nplot(clust6, \n     coords, \n     cex.lab=.7,\n     groups.colors=c(\"red\",\"green\",\"blue\", \"yellow4\", \"purple\"),\n     cex.circles=0.005, \n     add=TRUE)\n\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.7-visualising-clusters-on-choropleth-map",
    "href": "HandsOn/hands-on-8.html#hx8.7-visualising-clusters-on-choropleth-map",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.7 Visualising clusters on choropleth map",
    "text": "HX8.7 Visualising clusters on choropleth map\nWe can now plot our newly derived clusters onto a map. For easy comparison, it will be better to place both the hierarchical clustering and spatially constrained hierarchical clustering maps next to each other.\n\ngroups_mat &lt;- as.matrix(clust6$groups)\n# From exercise 7\nshan_sf_cluster &lt;- read_rds('data/rds/shan_sf_cluster.rds')\nshan_sf_spatialcluster &lt;- cbind(shan_sf_cluster, as.factor(groups_mat)) %&gt;%\n  rename(`SP_CLUSTER`=`as.factor.groups_mat.`)\n\nshclust.map &lt;- qtm(shan_sf_spatialcluster, \"SP_CLUSTER\")\n# From exercise 7\nhclust.map &lt;- read_rds('data/rds/hmap.rds')\ntmap_arrange(hclust.map, shclust.map,\n             asp=NA, ncol=2)\n\n\n\n\n\n\n\n\nThere is significantly less fragmentation in our SKATER-derived clusters map, and one would notice how the clusters in the map correspond with the graph from earlier."
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.8-spatially-constrained-clustering-clustgeo-method",
    "href": "HandsOn/hands-on-8.html#hx8.8-spatially-constrained-clustering-clustgeo-method",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.8 Spatially Constrained Clustering: ClustGeo method",
    "text": "HX8.8 Spatially Constrained Clustering: ClustGeo method\n\nHX8.8.1 A short note about ClustGeo\nAs described in the course website (Kam, 2024):\n\nClustGeo package is an R package specially designed to support the need of performing spatially constrained cluster analysis. More specifically, it provides a Ward-like hierarchical clustering algorithm called hclustgeo() including spatial/geographical constraints.\n\n\nIn the nutshell, the algorithm uses two dissimilarity matrices D0 and D1 along with a mixing parameter alpha, whereby the value of alpha must be a real number between [0, 1]. D0 can be non-Euclidean and the weights of the observations can be non-uniform. It gives the dissimilarities in the attribute/clustering variable space. D1, on the other hand, gives the dissimilarities in the constraint space. The criterion minimised at each stage is a convex combination of the homogeneity criterion calculated with D0 and the homogeneity criterion calculated with D1.\n\n\nThe idea is then to determine a value of alpha which increases the spatial contiguity without deteriorating too much the quality of the solution based on the variables of interest. This need is supported by a function called choicealpha().\n\n\n\nHX8.8.2 Ward-like hierarchical clustering with ClustGeo\nThe ClustGeo package provides us with a function called hclustgeo() to perform Ward-like hierarchical clustering. To use this method to perform non-spatially-constrained hierarchical clustering, all we need to provide is a dissimilarity matrix - specifically, the one from Hands-on exercise 7.\n\n# From hands-on exercise 7\nproxmat &lt;- read_rds('data/rds/proxmat.rds')\nnongeo_cluster &lt;- hclustgeo(proxmat)\nplot(nongeo_cluster, cex = 0.5)\nrect.hclust(nongeo_cluster, \n            k = 6, \n            border = 2:5)\n\n\n\n\n\n\n\n\n\n\nHX8.8.3 Mapping the clusters formed\nThe ClustGeo clusters can also be plotted onto a map as follows.\n\ngroups &lt;- as.factor(cutree(nongeo_cluster, k=6))\nshan_sf_ngeo_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER` = `as.matrix.groups.`)\nqtm(shan_sf_ngeo_cluster, \"CLUSTER\")"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.8.2-ward-like-hierarchical-clustering-with-clustgeo",
    "href": "HandsOn/hands-on-8.html#hx8.8.2-ward-like-hierarchical-clustering-with-clustgeo",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.8.2 Ward-like hierarchical clustering with ClustGeo",
    "text": "HX8.8.2 Ward-like hierarchical clustering with ClustGeo\nThe ClustGeo package provides us with a function called hclustgeo() to perform Ward-like hierarchical clustering. To use this method to perform non-spatially-constrained hierarchical clustering, all we need to provide is a dissimilarity matrix - specifically, the one from Hands-on exercise 7.\n\n# From hands-on exercise 7\nproxmat &lt;- read_rds('data/rds/proxmat.rds')\nnongeo_cluster &lt;- hclustgeo(proxmat)\nplot(nongeo_cluster, cex = 0.5)\nrect.hclust(nongeo_cluster, \n            k = 6, \n            border = 2:5)"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.8.3.1-mapping-the-clusters-formed",
    "href": "HandsOn/hands-on-8.html#hx8.8.3.1-mapping-the-clusters-formed",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.8.3.1 Mapping the clusters formed",
    "text": "HX8.8.3.1 Mapping the clusters formed\nThe ClustGeo clusters can also be plotted onto a map as follows.\n\ngroups &lt;- as.factor(cutree(nongeo_cluster, k=6))\nshan_sf_ngeo_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER` = `as.matrix.groups.`)\nqtm(shan_sf_ngeo_cluster, \"CLUSTER\")"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.9-spatially-constrained-hierarchical-clustering",
    "href": "HandsOn/hands-on-8.html#hx8.9-spatially-constrained-hierarchical-clustering",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.9 Spatially-constrained hierarchical clustering",
    "text": "HX8.9 Spatially-constrained hierarchical clustering\nBefore performing spatially constrained hierarchical clustering, we need to first construct a spatial distance matrix using st_distance() from the sf package. Notice that as.dist() is used to convert the data frame into matrix.\n\ndist &lt;- st_distance(shan_sf, shan_sf)\ndistmat &lt;- as.dist(dist)\n\nNext, choicealpha() is used to determine a suitable value for the mixing parameter \\(\\alpha\\).\n\ncr &lt;- choicealpha(proxmat, distmat, range.alpha = seq(0, 1, 0.1), K=6, graph = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe will choose \\(\\alpha = 0.2\\) as per the graphs above.\n\nclustG &lt;- hclustgeo(proxmat, distmat, alpha = 0.2)\n\nNext, cutree() is used to derive the cluster object.\n\ngroups &lt;- as.factor(cutree(clustG, k=6))\n\nFinally, we cbind the group list back to shan_sf, so that we can plot our newly delineated spatially constrained clusters.\n\nshan_sf_Gcluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER` = `as.matrix.groups.`)\nqtm(shan_sf_Gcluster, \"CLUSTER\")"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.10-visual-interpretation-of-clusters",
    "href": "HandsOn/hands-on-8.html#hx8.10-visual-interpretation-of-clusters",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.10 Visual interpretation of clusters",
    "text": "HX8.10 Visual interpretation of clusters\n\nHX8.10.1 Visualising individual clustering variable\nWe can use ggplot to plot the distribution of any clustering variable by cluster in a boxplot. In this example, we will plot the distribution of RADIO_PR.\n\nggplot(data = shan_sf_ngeo_cluster,\n       aes(x = CLUSTER, y = RADIO_PR)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\nThe boxplot reveals cluster 3 displays the highest radio penetration rate on average, followed by clusters 2, 1, 4, 6 and 5.\n\n\nHX8.10.2 Multivariate visualisation\nWe can also choose to create multiple parallel coordinate plots, which have been shown to reveal clustering variables extremely effectively. In the below code chunk, parallel coordinate plots can be created by means of ggparcoord() from the GGally package.\n\nggparcoord(data = shan_sf_ngeo_cluster, \n           columns = c(17:21), \n           scale = \"globalminmax\",\n           alphaLines = 0.2,\n           boxplot = TRUE, \n           title = \"Multiple Parallel Coordinates Plots of ICT Variables by Cluster\") +\n  facet_grid(~ CLUSTER) + \n  theme(axis.text.x = element_text(angle = 30))\n\n\n\n\n\n\n\n\nThe parallel coordinate plot above reveals that households in Cluster 4 townships have a higher rate of ICT device ownership, while those in cluster 5 have the lowest.\nOn the possible scale arguments for ggparcoor(), the course website notes:\n\nNote that the scale argument of ggparcoor() provide several methods to scale the clustering variables. They are:\n\n\n\nstd: univariately, subtract mean and divide by standard deviation.\nrobust: univariately, subtract median and divide by median absolute deviation.\nuniminmax: univariately, scale so the minimum of the variable is zero, and the maximum is one.\nglobalminmax: no scaling is done; the range of the graphs is defined by the global minimum and the global maximum.\ncenter: use uniminmax to standardize vertical height, then center each variable at a value specified by the scaleSummary param.\ncenterObs: use uniminmax to standardize vertical height, then center each variable at the value of the observation specified by the centerObsID param\nThere is no one best scaling method to use. You should explore them and select the one that best meet your analysis need.\n\n\n\n\nHX8.10.3 Printing summary statistics\nThe following code chunk creates a summarised table for us to print summary statistics per cluster.\n\nshan_sf_ngeo_cluster %&gt;% \n  st_set_geometry(NULL) %&gt;%\n  group_by(CLUSTER) %&gt;%\n  summarise(mean_RADIO_PR = mean(RADIO_PR),\n            mean_TV_PR = mean(TV_PR),\n            mean_LLPHONE_PR = mean(LLPHONE_PR),\n            mean_MPHONE_PR = mean(MPHONE_PR),\n            mean_COMPUTER_PR = mean(COMPUTER_PR))\n\n# A tibble: 6 × 6\n  CLUSTER mean_RADIO_PR mean_TV_PR mean_LLPHONE_PR mean_MPHONE_PR\n  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;\n1 1               22.1        52.1            4.42           24.6\n2 2               23.7        40.2            2.39           13.4\n3 3               30.0        61.1            5.22           39.2\n4 4               19.6        74.4            9.90           65.1\n5 5               12.4        22.4            3.80           13.2\n6 6                9.86       49.9            7.45           46.8\n# ℹ 1 more variable: mean_COMPUTER_PR &lt;dbl&gt;"
  },
  {
    "objectID": "HandsOn/hands-on-8.html#hx8.10.2-multivariate-visualisation",
    "href": "HandsOn/hands-on-8.html#hx8.10.2-multivariate-visualisation",
    "title": "HX8: Spatially Constrained Clustering Analysis",
    "section": "HX8.10.2 Multivariate visualisation",
    "text": "HX8.10.2 Multivariate visualisation\nWe can also choose to create multiple parallel coordinate plots, which have been shown to reveal clustering variables extremely effectively. In the below code chunk, parallel coordinate plots can be created by means of ggparcoord() from the GGally package.\n\nggparcoord(data = shan_sf_ngeo_cluster, \n           columns = c(17:21), \n           scale = \"globalminmax\",\n           alphaLines = 0.2,\n           boxplot = TRUE, \n           title = \"Multiple Parallel Coordinates Plots of ICT Variables by Cluster\") +\n  facet_grid(~ CLUSTER) + \n  theme(axis.text.x = element_text(angle = 30))\n\n\n\n\n\n\n\n\nThe parallel coordinate plot above reveals that households in Cluster 4 townships have a higher rate of ICT device ownership, while those in cluster 5 have the lowest.\nOn the possible scale arguments for ggparcoor(), the course website notes:\n\nNote that the scale argument of ggparcoor() provide several methods to scale the clustering variables. They are:\n\n\n\nstd: univariately, subtract mean and divide by standard deviation.\nrobust: univariately, subtract median and divide by median absolute deviation.\nuniminmax: univariately, scale so the minimum of the variable is zero, and the maximum is one.\nglobalminmax: no scaling is done; the range of the graphs is defined by the global minimum and the global maximum.\ncenter: use uniminmax to standardize vertical height, then center each variable at a value specified by the scaleSummary param.\ncenterObs: use uniminmax to standardize vertical height, then center each variable at the value of the observation specified by the centerObsID param\nThere is no one best scaling method to use. You should explore them and select the one that best meet your analysis need.\n\n\n\nHX8.10.3 Printing summary statistics\nThe following code chunk creates a summarised table for us to print summary statistics per cluster.\n\nshan_sf_ngeo_cluster %&gt;% \n  st_set_geometry(NULL) %&gt;%\n  group_by(CLUSTER) %&gt;%\n  summarise(mean_RADIO_PR = mean(RADIO_PR),\n            mean_TV_PR = mean(TV_PR),\n            mean_LLPHONE_PR = mean(LLPHONE_PR),\n            mean_MPHONE_PR = mean(MPHONE_PR),\n            mean_COMPUTER_PR = mean(COMPUTER_PR))\n\n# A tibble: 6 × 6\n  CLUSTER mean_RADIO_PR mean_TV_PR mean_LLPHONE_PR mean_MPHONE_PR\n  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;\n1 1               22.1        52.1            4.42           24.6\n2 2               23.7        40.2            2.39           13.4\n3 3               30.0        61.1            5.22           39.2\n4 4               19.6        74.4            9.90           65.1\n5 5               12.4        22.4            3.80           13.2\n6 6                9.86       49.9            7.45           46.8\n# ℹ 1 more variable: mean_COMPUTER_PR &lt;dbl&gt;"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.8-computing-hierarchical-clustering",
    "href": "HandsOn/hands-on-7.html#hx7.8-computing-hierarchical-clustering",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.8 Computing hierarchical clustering",
    "text": "HX7.8 Computing hierarchical clustering\nSeveral packages exist in R to perform hierarchical clustering, but today, hclust() from R stats will be used. It employs an agglomeration method to compute clusters and supports the following eight clustering algorithms: ward.D, ward.D2, single, complete, average (UPGMA), mcquitty (WPGMA), median (WPGMC) and centroid (UPGMC).\nThe code chunk below performs hierarchical cluster analysis using ward.D method. The hierarchical clustering output is stored in an object of class hclust, which describes the tree produced by the clustering process. We will then plot the tree using plot() from R graphics.\n\nhclust_ward &lt;- hclust(proxmat, method = 'ward.D')\nplot(hclust_ward, cex = 0.6)"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.9-selecting-optimal-clustering-algorithm",
    "href": "HandsOn/hands-on-7.html#hx7.9-selecting-optimal-clustering-algorithm",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.9 Selecting optimal clustering algorithm",
    "text": "HX7.9 Selecting optimal clustering algorithm\nA key challenge in performing hierarchical clustering is in identifying stronger clustering structures. A function, agnes() from the cluster package, can be used to solve this issue - it functions like hclust(), but can also be used to return the agglomerative coefficient, which measures the extent to which clustering exists. As the coefficient approaches 1, the data suggests a stronger clustering structure.\n\nm &lt;- c( \"average\", \"single\", \"complete\", \"ward\")\nnames(m) &lt;- c( \"average\", \"single\", \"complete\", \"ward\")\n\nac &lt;- function(x) {\n  agnes(shan_ict, method = x)$ac\n}\n\nmap_dbl(m, ac)\n\n  average    single  complete      ward \n0.8131144 0.6628705 0.8950702 0.9427730 \n\n\nFrom the output above, Ward’s method provides the strongest clustering structure among the four methods assessed. Hence, we will use Ward’s method in subsequent analyses."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.10-determining-optimal-clusters",
    "href": "HandsOn/hands-on-7.html#hx7.10-determining-optimal-clusters",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.10 Determining optimal clusters",
    "text": "HX7.10 Determining optimal clusters\nThe next obstacle is in determining the optimal clusters to retain. Three commonly used methods are used to determine optimal clusters: the elbow method, the average silhouette method and the gap statistic method.\n\nHX7.10.1 Gap statistic method\nThis method compares the total within intra-cluster variation for different numbers of clusters \\(k\\) with their expected values under null reference distribution of the data. The estimate of the optimal clusters will be value that maximises the gap statistic (i.e., that yields the largest gap statistic). This means that the clustering structure is far away from the random uniform distribution of points.\nclusGap() of the cluster package will be used to compute the gap statistic, and fviz_gap_stat() of the factoextra package will be used to plot the optimal numbers of clusters.\n\nset.seed(12345)\ngap_stat &lt;- clusGap(shan_ict, \n                    FUN = hcut, \n                    nstart = 25, \n                    K.max = 10, \n                    B = 50)\n# Print the result\nprint(gap_stat, method = \"firstmax\")\n\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)\nB=50 simulated reference sets, k = 1..10; spaceH0=\"scaledPCA\"\n --&gt; Number of clusters (method 'firstmax'): 1\n          logW   E.logW       gap     SE.sim\n [1,] 6.104544 6.378209 0.2736651 0.04460994\n [2,] 5.827444 6.048127 0.2206824 0.03880130\n [3,] 5.689680 5.899965 0.2102844 0.03362652\n [4,] 5.559639 5.778070 0.2184311 0.03784781\n [5,] 5.453876 5.675437 0.2215615 0.03897071\n [6,] 5.363009 5.585192 0.2221833 0.03973087\n [7,] 5.288334 5.503748 0.2154145 0.04054939\n [8,] 5.224095 5.429034 0.2049390 0.04198644\n [9,] 5.155439 5.358210 0.2027705 0.04421874\n[10,] 5.074827 5.291273 0.2164465 0.04540947\n\nfviz_gap_stat(gap_stat)\n\n\n\n\n\n\n\n\nWith the highest gap statistic of around 0.275, the recommended value of \\(k\\) is 1, i.e. we are apparently encouraged to retain only one cluster. However, this is illogical - instead, the next best value of \\(k\\), with the second highest gap statistic, is 6.\n\n\nHX7.10.2 Interpretation\nIn the dendrogram from HX7.5, each leaf corresponds to one observation. As we move up the tree, observations that are similar to each other are combined into branches, which are themselves fused at a higher height. The height of the fusion (which is provided on the y-axis) indicates the (dis)similarity between two observations. The higher the height, the less similar the observations are. We cannot use the proximity of two observations along the x-axis as a basis of comparision for their similarity.\nIt is also possible to draw the dendrogram with a border around the selected clusters by using rect.hclust() of R stats. The argument border is used to specify the border colors for the rectangles.\n\nplot(hclust_ward, cex = 0.6)\nrect.hclust(hclust_ward, \n            k = 6, \n            border = 2:5)"
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.11-visually-driven-hierarchical-clustering-analysis",
    "href": "HandsOn/hands-on-7.html#hx7.11-visually-driven-hierarchical-clustering-analysis",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.11 Visually-driven hierarchical clustering analysis",
    "text": "HX7.11 Visually-driven hierarchical clustering analysis\nAnother type of clustering analysis is visually-driven hierarchical clustering analysis, which can be done using the heatmaply package. With this package, we can build both highly interactive cluster heatmaps or static cluster heatmaps.\n\nHX7.11.1 Transforming data frame into matrix\nThe data was loaded as a dataframe, but to create the heatmap we have to first convert it into a data matrix.\n\nshan_ict_mat &lt;- data.matrix(shan_ict)\n\n\n\nHX7.11.2 Interactive cluster heatmap\n\nheatmaply(normalize(shan_ict_mat),\n          Colv=NA,\n          dist_method = \"euclidean\",\n          hclust_method = \"ward.D\",\n          seriate = \"OLO\",\n          colors = Blues,\n          k_row = 6,\n          margins = c(NA,200,60,NA),\n          fontsize_row = 4,\n          fontsize_col = 5,\n          main=\"Geographic Segmentation of Shan State by ICT indicators\",\n          xlab = \"ICT Indicators\",\n          ylab = \"Townships of Shan State\"\n          )\n\n\n\n\n\nWhen we plot our interactive cluster heatmap with the code chunk above, the right part of the output is effectively the same dendrogram we get from earlier."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.12-mapping-the-clusters-formed",
    "href": "HandsOn/hands-on-7.html#hx7.12-mapping-the-clusters-formed",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.12 Mapping the clusters formed",
    "text": "HX7.12 Mapping the clusters formed\nIf we recall from earlier, we determined that the optimal number of clusters \\(k\\) to retain is 6. We will do just that in the code chunk below, using cutree() of base R.\n\ngroups &lt;- as.factor(cutree(hclust_ward, k=6))\n\nThe output is called groups. It is a list object.\nIn order to visualise the clusters, the groups object needs to be appended onto the shan_sf simple feature object. This is done in three steps:\n\nConvert groups into a matrix;\nUse cbind() to append groups matrix to shan_sf to produce an output simple feature object called shan_sf_cluster; and\nUse renamefrom the dplyr package to rename the as.matrix.groups field as CLUSTER.\nPlot the choropleth map showing the clusters formed.\n\n\nshan_sf_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER`=`as.matrix.groups.`)\nhierarchical_map &lt;- qtm(shan_sf_cluster, \"CLUSTER\")\nhierarchical_map\n\n\n\n\n\n\n\n\nThe choropleth map above reveals extensive fragmentation in the clusters. The is a major limitation when non-spatial clustering algorithms such as hierarchical cluster analysis method are used."
  },
  {
    "objectID": "HandsOn/hands-on-7.html#hx7.13-saving-modified-sf-to-disk-as-rds",
    "href": "HandsOn/hands-on-7.html#hx7.13-saving-modified-sf-to-disk-as-rds",
    "title": "HX7: Geographical Segmentation with Spatially Constrained Clustering Techniques",
    "section": "HX7.13 Saving modified sf to disk as RDS",
    "text": "HX7.13 Saving modified sf to disk as RDS\nThe process will continue in Hands-on exercise 8. Before we conclude, we need to save some objects from earlier to the disk so that we can refer to it again.\n\nwrite_rds(shan_sf, 'data/rds/shan_sf.rds')\nwrite_rds(shan_ict, 'data/rds/shan_ict.rds')\nwrite_rds(shan_sf_cluster, 'data/rds/shan_sf_cluster.rds')\nwrite_rds(hierarchical_map, 'data/rds/hmap.rds')\nwrite_rds(proxmat, 'data/rds/proxmat.rds')"
  },
  {
    "objectID": "index.html#about-me",
    "href": "index.html#about-me",
    "title": "IS415: Geospatial Analytics and Applications",
    "section": "About me",
    "text": "About me\n\n\n\n\n\n\n\n\n\n\nAbout me\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "HandsOn/hands-on-9.html",
    "href": "HandsOn/hands-on-9.html",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "",
    "text": "Regression is a statistical (and machine learning) technique that uses non-stationary variables to model the relationship between these independent variables and a numerical outcome of interest (dependent variable), the aim of which is to predict unseen values. Geographically weighted regression factors in location variables like climate and physical environment characteristics. In this exercise, we will build a hedonic pricing model to predict the resale prices of condominiums in Singapore in 2015.\nThe datasets to be used in this exercise are:\n\nURA Master Plan Subzone Boundary in Shapefile format (i.e. MP14_SUBZONE_WEB_PL), and\ncondo_resale_2015.csv.\n\nThe R packages to be used today are:\n\nolsrr for building OLS and performing diagnostic tests\nGWmodel, for building geographically weighted models\ncorrplot for data visualisation and analysis\nsf, tidyverse and tmap for data handling and choropleth mapping.\n\n\npacman::p_load(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary)\n\n\n\nThe GWmodel package provides a collection of localised spatial statistical methods, namely: GW summary statistics, GW principal components analysis, GW discriminant analysis and various forms of GW regression. Some of these are provided in basic and robust (outlier resistant) forms. Commonly, outputs or parameters of the GWmodel are mapped to provide a useful exploratory tool, which can often precede (and direct) a more traditional or sophisticated statistical analysis."
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx9.1-overview-data-and-r-packages",
    "href": "HandsOn/hands-on-9.html#hx9.1-overview-data-and-r-packages",
    "title": "HX9: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "",
    "text": "Regression is a statistical (and machine learning) technique that uses non-stationary variables to model the relationship between these independent variables and a numerical outcome of interest (dependent variable), the aim of which is to predict unseen values. Geographically weighted regression factors in location variables like climate and physical environment characteristics. In this exercise, we will build a hedonic pricing model to predict the resale prices of condominiums in Singapore in 2015.\nThe datasets to be used in this exercise are:\n\nURA Master Plan Subzone Boundary in Shapefile format (i.e. MP14_SUBZONE_WEB_PL), and\ncondo_resale_2015.csv.\n\nThe R packages to be used today are:\n\nolsrr for building OLS and performing diagnostic tests\nGWmodel, for building geographically weighted models\ncorrplot for data visualisation and analysis\nsf, tidyverse and tmap for data handling and choropleth mapping.\n\n\npacman::p_load(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary)\n\n\n\nThe GWmodel package provides a collection of localised spatial statistical methods, namely: GW summary statistics, GW principal components analysis, GW discriminant analysis and various forms of GW regression. Some of these are provided in basic and robust (outlier resistant) forms. Commonly, outputs or parameters of the GWmodel are mapped to provide a useful exploratory tool, which can often precede (and direct) a more traditional or sophisticated statistical analysis."
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx9.2-geospatial-data-wrangling",
    "href": "HandsOn/hands-on-9.html#hx9.2-geospatial-data-wrangling",
    "title": "HX9: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9.2 Geospatial Data Wrangling",
    "text": "HX9.2 Geospatial Data Wrangling\n\nHX9.2.1 Importing data\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\n\nHX9.2.2 Update CRS information\nThe coordinate system needs to be updated to Singapore’s: ESPG 3414, or SVY21.\n\nmpsz_svy21 &lt;- st_transform(mpsz, 3414)\nst_crs(mpsz_svy21)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\nst_bbox(mpsz_svy21) #view extent\n\n     xmin      ymin      xmax      ymax \n 2667.538 15748.721 56396.440 50256.334"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx9.3-aspatial-data-wrangling",
    "href": "HandsOn/hands-on-9.html#hx9.3-aspatial-data-wrangling",
    "title": "HX9: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9.3 Aspatial Data Wrangling",
    "text": "HX9.3 Aspatial Data Wrangling\n\nHX9.3.1 Importing data\n\ncondo_resale = read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n\n\n\nHX9.3.2 Converting aspatial dataframe to sf object\nAs the condo_resale dataframe is aspatial, we will now need to convert it to an sf object. Notice we need to perform another st_transform() to convert the coordinates from WGS84 to SVY21.\n\ncondo_resale.sf &lt;- st_as_sf(condo_resale, coords = c(\"LONGITUDE\", \"LATITUDE\"), crs=4326) %&gt;% st_transform(crs=3414)\nhead(condo_resale.sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_Of_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx9.4-exploratory-data-analysis",
    "href": "HandsOn/hands-on-9.html#hx9.4-exploratory-data-analysis",
    "title": "HX9: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9.4 Exploratory Data Analysis",
    "text": "HX9.4 Exploratory Data Analysis\nExploratory data analysis (EDA) is a crucial part of any data analytics task, and is especially critical for data preparation prior to machine learning. In this section, we will use ggplot2 to perform EDA.\n\nHX9.4.1 Using graphical methods\nThe distribution of SELLING_PRICE may be plotted using the following code chunk.\n\nggplot(data=condo_resale.sf, aes(x=`SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\n\n\n\n\n\n\n\nThe distribution of SELLING_PRICE is right skewed, meaning that more condominium units were transacted at lower prices.\nWe can normalise this data using log transformation. The code chunk below is used to derive a new variable called LOG_SELLING_PRICE by using a log transformation on the variable `SELLING_PRICE, using mutate() of dplyr package. The end result is a distribution that is less skewed.\n\ncondo_resale.sf &lt;- condo_resale.sf %&gt;%\n  mutate(`LOG_SELLING_PRICE` = log(SELLING_PRICE))\nggplot(data=condo_resale.sf, aes(x=`LOG_SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx9.4.2-multiple-histogram-plots",
    "href": "HandsOn/hands-on-9.html#hx9.4.2-multiple-histogram-plots",
    "title": "HX9: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9.4.2 Multiple histogram plots",
    "text": "HX9.4.2 Multiple histogram plots\nggarrange() of the ggpubr package may be used to draw multiple small histograms, achieving a similar capability found in matplotlib of Python. In the code chunk below, 12 histograms are created and then presented as a table of 3 columns and 4 rows.\n\nAREA_SQM &lt;- ggplot(data=condo_resale.sf, aes(x= `AREA_SQM`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nAGE &lt;- ggplot(data=condo_resale.sf, aes(x= `AGE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_CBD &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CBD`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_CHILDCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CHILDCARE`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_ELDERLYCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_ELDERLYCARE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_URA_GROWTH_AREA &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_URA_GROWTH_AREA`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_HAWKER_MARKET &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_HAWKER_MARKET`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_KINDERGARTEN &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_KINDERGARTEN`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_MRT &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_MRT`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_PARK &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PARK`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_TOP_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_TOP_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nggarrange(AREA_SQM, AGE, PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, \n          PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN, PROX_MRT,\n          PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH,  \n          ncol = 3, nrow = 4)"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx9.5-geospatial-eda",
    "href": "HandsOn/hands-on-9.html#hx9.5-geospatial-eda",
    "title": "HX9: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9.5 Geospatial EDA",
    "text": "HX9.5 Geospatial EDA\n\nHX9.5.1 Statistical point map\nFinally, we want to draw the geospatial distribution of condo resale prices in Singapore with the tmap package.\nFirst, we will turn on the interactive mapping mode with the code chunk below.\n\ntmap_options(check.and.fix = TRUE)\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\n\nNext, the code chunks below will draw us an interactive point symbol map.\n\ntm_shape(mpsz_svy21)+\n  tm_polygons() +\ntm_shape(condo_resale.sf) +  \n  tm_dots(col = \"SELLING_PRICE\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\nNotice that tm_dots() is used instead of tm_bubbles(). Also, the set.zoom.limits argument of tm_view() sets the minimum and maximum zoom level to 11 and 14 respectively.\nBefore moving on to the next section, it is a good practice to revert tmap back to plot mode.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx9.6-hedonic-price-modelling-in-r",
    "href": "HandsOn/hands-on-9.html#hx9.6-hedonic-price-modelling-in-r",
    "title": "HX9: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9.6 Hedonic Price Modelling in R",
    "text": "HX9.6 Hedonic Price Modelling in R\nAnd now for the fun part: building our hedonic pricing models. We can do this using the simple linear regression or multiple linear regression methods.\n\nHX9.6.1 Simple Linear Regression\nFor this model, we want to predict SELLING_PRICE (y) using the independent variable AREA_SQM (x). In other words, we want to create a best fit linear function measuring the effect of x on y.\n\ncondo.slr &lt;- lm(formula=SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\nThe functions summary() and anova() can be used to obtain and print a summary and analysis of variance table of the results. The generic accessor functions coefficients, effects, fitted.values and residuals extract various useful features of the value returned by lm. lm() returns an object of class lm, or a vector c(\"mlm\", \"lm\") for multiple responses.\n\nsummary(condo.slr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n\nThe function given to us is:\n\\(y=14719x_1 -258121.1\\)\nThe coefficient of determination \\(R^2\\) is \\(0.4518\\). This indicates the model is able to explain about \\(45%\\) of the resale prices. With a p-value of much smaller than 0.0001, we can reject the null hypothesis that the mean is a good esimator of SELLING_PRICE. This will allow us to infer that our simple linear regression model is a good estimator of SELLING_PRICE.\nWe can visualise our best fit on a scatterplot by incorporating lm() as a function in ggplot’s geometry as shown below.\n\nggplot(data=condo_resale.sf,  \n       aes(x=`AREA_SQM`, y=`SELLING_PRICE`)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nA few outliers with relatively higher selling prices can be seen in the plot."
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx9.6.2-multiple-linear-regression",
    "href": "HandsOn/hands-on-9.html#hx9.6.2-multiple-linear-regression",
    "title": "HX9: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9.6.2 Multiple Linear Regression",
    "text": "HX9.6.2 Multiple Linear Regression\nSo far, we have only been using a single independent variable to predict housing prices. We can also use multiple independent variables to do likewise.\nBefore building our model, we need to ensure that the independent variables used are not highly correlated with one another, or the quality of the model will be compromised. In statistics, this phenomenon is known as multicollinearity. The typical method of doing this is to use a correlation matrix drawn as a heatmap to easily visualise the correlation coefficients of any given pair of variables. In Python, we use pandas.DataFrame.corr() to create the matrix and seaborn.heatmap() to visualise it as a heatmap. In R, the corrplot package is used instead.\n\ncorrplot(cor(condo_resale[, 5:23]), diag = FALSE, order = \"AOE\",\n         tl.pos = \"td\", tl.cex = 0.5, method = \"number\", type = \"upper\")\n\n\n\n\n\n\n\n\nFrom the scatterplot matrix, it is clear that FREEHOLD is highly correlated to LEASE_99YEAR. This could be because the two are mutually exclusive - a 99-year leasehold property must be returned to the government after 99 years. In view of this, it is wiser to only include either one of them in the subsequent model building. We will therefore exclude LEASE_99YEAR in the subsequent model building."
  },
  {
    "objectID": "HandsOn/hands-on-9.html#references",
    "href": "HandsOn/hands-on-9.html#references",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "References",
    "text": "References\n\nKam, T. S. (2024). 13 Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method. R for Geospatial Data Science and Analytics. https://r4gdsa.netlify.app/chap13.html#hedonic-pricing-modelling-in-r"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.1-overview-data-and-r-packages",
    "href": "HandsOn/hands-on-9.html#hx910.1-overview-data-and-r-packages",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "",
    "text": "Regression is a statistical (and machine learning) technique that uses non-stationary variables to model the relationship between these independent variables and a numerical outcome of interest (dependent variable), the aim of which is to predict unseen values. Geographically weighted regression factors in location variables like climate and physical environment characteristics. In this exercise, we will build a hedonic pricing model to predict the resale prices of condominiums in Singapore in 2015.\nThe datasets to be used in this exercise are:\n\nURA Master Plan Subzone Boundary in Shapefile format (i.e. MP14_SUBZONE_WEB_PL), and\ncondo_resale_2015.csv.\n\nThe R packages to be used today are:\n\nolsrr for building OLS and performing diagnostic tests\nGWmodel, for building geographically weighted models\ncorrplot for data visualisation and analysis\nsf, tidyverse and tmap for data handling and choropleth mapping.\n\n\npacman::p_load(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary)\n\n\n\nThe GWmodel package provides a collection of localised spatial statistical methods, namely: GW summary statistics, GW principal components analysis, GW discriminant analysis and various forms of GW regression. Some of these are provided in basic and robust (outlier resistant) forms. Commonly, outputs or parameters of the GWmodel are mapped to provide a useful exploratory tool, which can often precede (and direct) a more traditional or sophisticated statistical analysis."
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.2-geospatial-data-wrangling",
    "href": "HandsOn/hands-on-9.html#hx910.2-geospatial-data-wrangling",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9/10.2 Geospatial Data Wrangling",
    "text": "HX9/10.2 Geospatial Data Wrangling\n\nHX9/10.2.1 Importing data\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/HandsOn/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\n\nHX9/10.2.2 Update CRS information\nThe coordinate system needs to be updated to Singapore’s: ESPG 3414, or SVY21.\n\nmpsz_svy21 &lt;- st_transform(mpsz, 3414)\nst_crs(mpsz_svy21)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\nst_bbox(mpsz_svy21) #view extent\n\n     xmin      ymin      xmax      ymax \n 2667.538 15748.721 56396.440 50256.334"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.3-aspatial-data-wrangling",
    "href": "HandsOn/hands-on-9.html#hx910.3-aspatial-data-wrangling",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9/10.3 Aspatial Data Wrangling",
    "text": "HX9/10.3 Aspatial Data Wrangling\n\nHX9/10.3.1 Importing data\n\ncondo_resale = read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n\n\n\nHX9/10.3.2 Converting aspatial dataframe to sf object\nAs the condo_resale dataframe is aspatial, we will now need to convert it to an sf object. Notice we need to perform another st_transform() to convert the coordinates from WGS84 to SVY21.\n\ncondo_resale.sf &lt;- st_as_sf(condo_resale, coords = c(\"LONGITUDE\", \"LATITUDE\"), crs=4326) %&gt;% st_transform(crs=3414)\nhead(condo_resale.sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_Of_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.4-exploratory-data-analysis",
    "href": "HandsOn/hands-on-9.html#hx910.4-exploratory-data-analysis",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9/10.4 Exploratory Data Analysis",
    "text": "HX9/10.4 Exploratory Data Analysis\nExploratory data analysis (EDA) is a crucial part of any data analytics task, and is especially critical for data preparation prior to machine learning. In this section, we will use ggplot2 to perform EDA.\n\nHX9/10.4.1 Using graphical methods\nThe distribution of SELLING_PRICE may be plotted using the following code chunk.\n\nggplot(data=condo_resale.sf, aes(x=`SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\n\n\n\n\n\n\n\nThe distribution of SELLING_PRICE is right skewed, meaning that more condominium units were transacted at lower prices.\nWe can normalise this data using log transformation. The code chunk below is used to derive a new variable called LOG_SELLING_PRICE by using a log transformation on the variable `SELLING_PRICE, using mutate() of dplyr package. The end result is a distribution that is less skewed.\n\ncondo_resale.sf &lt;- condo_resale.sf %&gt;%\n  mutate(`LOG_SELLING_PRICE` = log(SELLING_PRICE))\nggplot(data=condo_resale.sf, aes(x=`LOG_SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.4.2-multiple-histogram-plots",
    "href": "HandsOn/hands-on-9.html#hx910.4.2-multiple-histogram-plots",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9/10.4.2 Multiple histogram plots",
    "text": "HX9/10.4.2 Multiple histogram plots\nggarrange() of the ggpubr package may be used to draw multiple small histograms, achieving a similar capability found in matplotlib of Python. In the code chunk below, 12 histograms are created and then presented as a table of 3 columns and 4 rows.\n\nAREA_SQM &lt;- ggplot(data=condo_resale.sf, aes(x= `AREA_SQM`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nAGE &lt;- ggplot(data=condo_resale.sf, aes(x= `AGE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_CBD &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CBD`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_CHILDCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CHILDCARE`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_ELDERLYCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_ELDERLYCARE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_URA_GROWTH_AREA &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_URA_GROWTH_AREA`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_HAWKER_MARKET &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_HAWKER_MARKET`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_KINDERGARTEN &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_KINDERGARTEN`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_MRT &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_MRT`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_PARK &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PARK`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nPROX_TOP_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_TOP_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"green4\")\n\nggarrange(AREA_SQM, AGE, PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, \n          PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN, PROX_MRT,\n          PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH,  \n          ncol = 3, nrow = 4)"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.5-geospatial-eda",
    "href": "HandsOn/hands-on-9.html#hx910.5-geospatial-eda",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9/10.5 Geospatial EDA",
    "text": "HX9/10.5 Geospatial EDA\n\nHX9/10.5.1 Statistical point map\nFinally, we want to draw the geospatial distribution of condo resale prices in Singapore with the tmap package.\nFirst, we will turn on the interactive mapping mode with the code chunk below.\n\ntmap_options(check.and.fix = TRUE)\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\n\nNext, the code chunks below will draw us an interactive point symbol map.\n\ntm_shape(mpsz_svy21)+\n  tm_polygons() +\ntm_shape(condo_resale.sf) +  \n  tm_dots(col = \"SELLING_PRICE\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\nNotice that tm_dots() is used instead of tm_bubbles(). Also, the set.zoom.limits argument of tm_view() sets the minimum and maximum zoom level to 11 and 14 respectively.\nBefore moving on to the next section, it is a good practice to revert tmap back to plot mode.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.6-hedonic-price-modelling-in-r",
    "href": "HandsOn/hands-on-9.html#hx910.6-hedonic-price-modelling-in-r",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9/10.6 Hedonic Price Modelling in R",
    "text": "HX9/10.6 Hedonic Price Modelling in R\nAnd now for the fun part: building our hedonic pricing models. We can do this using the simple linear regression or multiple linear regression methods.\n\nHX9/10.6.1 Simple Linear Regression\nFor this model, we want to predict SELLING_PRICE (y) using the independent variable AREA_SQM (x). In other words, we want to create a best fit linear function measuring the effect of x on y.\n\ncondo.slr &lt;- lm(formula=SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\nThe functions summary() and anova() can be used to obtain and print a summary and analysis of variance table of the results. The generic accessor functions coefficients, effects, fitted.values and residuals extract various useful features of the value returned by lm. lm() returns an object of class lm, or a vector c(\"mlm\", \"lm\") for multiple responses.\n\nsummary(condo.slr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n\nThe function given to us is:\n\\(y=14719x_1 -258121.1\\)\nThe coefficient of determination \\(R^2\\) is \\(0.4518\\). This indicates the model is able to explain about \\(45%\\) of the resale prices. With a p-value of much smaller than 0.0001, we can reject the null hypothesis that the mean is a good esimator of SELLING_PRICE. This will allow us to infer that our simple linear regression model is a good estimator of SELLING_PRICE.\nWe can visualise our best fit on a scatterplot by incorporating lm() as a function in ggplot’s geometry as shown below.\n\nggplot(data=condo_resale.sf,  \n       aes(x=`AREA_SQM`, y=`SELLING_PRICE`)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nA few outliers with relatively higher selling prices can be seen in the plot.\n\n\nHX9/10.6.2 Multiple Linear Regression\n\nHX9/10.6.2.1 Additional EDA: Correlation heatmap\nSo far, we have only been using a single independent variable to predict housing prices. We can also use multiple independent variables to do likewise.\nBefore building our model, we need to ensure that the independent variables used are not highly correlated with one another, or the quality of the model will be compromised. In statistics, this phenomenon is known as multicolinearity. The typical method of doing this is to use a correlation matrix drawn as a heatmap to easily visualise the correlation coefficients of any given pair of variables. In Python, we use pandas.DataFrame.corr() to create the matrix and seaborn.heatmap() to visualise it as a heatmap. In R, the corrplot package is used instead.\n\ncorrplot(cor(condo_resale[, 5:23]), diag = FALSE, order = \"AOE\",\n         tl.pos = \"td\", tl.cex = 0.5, method = \"number\", type = \"upper\")\n\n\n\n\n\n\n\n\nWith a correlation coefficient of -0.84, FREEHOLD is highly correlated to LEASE_99YEAR. This could be because the two are mutually exclusive - a 99-year leasehold property must be returned to the government after 99 years. In view of this, it is wiser to only include either one of them in the subsequent model building. We will therefore exclude LEASE_99YEAR in the subsequent model building.\n\n\nHX9/10.6.2.2 Building hedonic pricing model using multiple linear regression\nlm() can also be used to calibrate a multiple linear regression model.\n\ncondo.mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE    + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + PROX_KINDERGARTEN + \n                  PROX_MRT  + PROX_PARK + PROX_PRIMARY_SCH + \n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n                  PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                data=condo_resale.sf)\nsummary(condo.mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3475964  -293923   -23069   241043 12260381 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           481728.40  121441.01   3.967 7.65e-05 ***\nAREA_SQM               12708.32     369.59  34.385  &lt; 2e-16 ***\nAGE                   -24440.82    2763.16  -8.845  &lt; 2e-16 ***\nPROX_CBD              -78669.78    6768.97 -11.622  &lt; 2e-16 ***\nPROX_CHILDCARE       -351617.91  109467.25  -3.212  0.00135 ** \nPROX_ELDERLYCARE      171029.42   42110.51   4.061 5.14e-05 ***\nPROX_URA_GROWTH_AREA   38474.53   12523.57   3.072  0.00217 ** \nPROX_HAWKER_MARKET     23746.10   29299.76   0.810  0.41782    \nPROX_KINDERGARTEN     147468.99   82668.87   1.784  0.07466 .  \nPROX_MRT             -314599.68   57947.44  -5.429 6.66e-08 ***\nPROX_PARK             563280.50   66551.68   8.464  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      180186.08   65237.95   2.762  0.00582 ** \nPROX_TOP_PRIMARY_SCH    2280.04   20410.43   0.112  0.91107    \nPROX_SHOPPING_MALL   -206604.06   42840.60  -4.823 1.57e-06 ***\nPROX_SUPERMARKET      -44991.80   77082.64  -0.584  0.55953    \nPROX_BUS_STOP         683121.35  138353.28   4.938 8.85e-07 ***\nNO_Of_UNITS             -231.18      89.03  -2.597  0.00951 ** \nFAMILY_FRIENDLY       140340.77   47020.55   2.985  0.00289 ** \nFREEHOLD              359913.01   49220.22   7.312 4.38e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1417 degrees of freedom\nMultiple R-squared:  0.6518,    Adjusted R-squared:  0.6474 \nF-statistic: 147.4 on 18 and 1417 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n\nHX9/10.6.3 Preparing Publication Quality Table\n\nHX9/10.6.3.1 olsrr method\nFrom the p-values in the report above, some variables, such as PROX_KINDERGARTEN and PROX_TOP_PRIMARY_SCH, are not considered statistically significant at a 95% confidence interval. We can revise the model by removing these values.\nNow, we are ready to calibrate the revised model with the code chunk below.\n\ncondo.mlr1 &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                   PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                   PROX_URA_GROWTH_AREA + PROX_MRT  + PROX_PARK + \n                   PROX_PRIMARY_SCH + PROX_SHOPPING_MALL    + PROX_BUS_STOP + \n                   NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD,\n                 data=condo_resale.sf)\nols_regress(condo.mlr1)\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.591 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.591                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n-----------------------------------------------------------------------------------------------------------------\n\n\n\n\nHX9/10.6.3.2 gtsummary method\nA more elegant and flexible way to draw a publication-ready summary table is using tbl_regression() from the gtsummary package.\n\ntbl_regression(condo.mlr1, intercept = TRUE)\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI1\np-value\n\n\n\n\n(Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n\n\nAREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n\n\nAGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n\n\nPROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n\n\nPROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n\n\nPROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n\n\nPROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n\n\nPROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n\n\nPROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n\n\nPROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n\n\nPROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n\n\nPROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n\n\nNO_Of_UNITS\n-245\n-418, -73\n0.005\n\n\nFAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n\n\nFREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n\n\n\n1 CI = Confidence Interval\n\n\n\n\n\n\n\n\nModel statistics may be included in the report either by appending them to the report table with add_glance_table() or by adding a source note with add_glance_source_note() as below.\n\ntbl_regression(condo.mlr1, \n               intercept = TRUE) %&gt;% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n\n\n\n  \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n    AREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n    AGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n    PROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n    PROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n    PROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n    PROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n    PROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n    PROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n    PROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n    PROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n    PROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n    NO_Of_UNITS\n-245\n-418, -73\n0.005\n    FAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n    FREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n  \n  \n    \n      R² = 0.651; Adjusted R² = 0.647; AIC = 42,967; Statistic = 189; p-value = &lt;0.001; σ = 755,957\n    \n  \n  \n    \n      1 CI = Confidence Interval"
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.7-ols-regression",
    "href": "HandsOn/hands-on-9.html#hx910.7-ols-regression",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9/10.7 OLS Regression",
    "text": "HX9/10.7 OLS Regression\nOLS regression can be performed with the oslrr package. It provides a collection of useful methods for building multiple linear regression models, such as:\n\ncomprehensive regression output\nresidual diagnostics\nmeasures of influence\nheteroskedasticity tests\ncollinearity diagnostics\nmodel fit assessment\nvariable contribution assessment\nvariable selection procedures\n\n\nHX9/10.7.1 Check for multicolinearity\nIn the code chunk below, ols_vif_tol() is used to test for multicolinearity.\n\nols_vif_tol(condo.mlr1)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8728554 1.145665\n2                   AGE 0.7071275 1.414172\n3              PROX_CBD 0.6356147 1.573280\n4        PROX_CHILDCARE 0.3066019 3.261559\n5      PROX_ELDERLYCARE 0.6598479 1.515501\n6  PROX_URA_GROWTH_AREA 0.7510311 1.331503\n7              PROX_MRT 0.5236090 1.909822\n8             PROX_PARK 0.8279261 1.207837\n9      PROX_PRIMARY_SCH 0.4524628 2.210126\n10   PROX_SHOPPING_MALL 0.6738795 1.483945\n11        PROX_BUS_STOP 0.3514118 2.845664\n12          NO_Of_UNITS 0.6901036 1.449058\n13      FAMILY_FRIENDLY 0.7244157 1.380423\n14             FREEHOLD 0.6931163 1.442759\n\n\nSince the VIFs of all our independent variables are less than 10, we can safely conclude that there is no sign of multicolinearity among our independent variables.\n\n\nHX9/10.7.2 Test for non-linearity\nIn multiple linear regression, it is important to test the assumption of linearity and additivity in the relationship between our dependent and independent variables. In the code chunk below, ols_plot_resid_fit() is used to perform the linearity assumption test.\n\nols_plot_resid_fit(condo.mlr1)\n\n\n\n\n\n\n\n\nSince most of our data points are scattered around the 0 line, we can conclude that there exists a linear relationship between the dependent variable and independent variables.\n\n\nHX9/10.7.3 Test for normality\nols_plot_resid_hist() is used to test for normality.\n\nols_plot_resid_hist(condo.mlr1)\n\n\n\n\n\n\n\n\nThe plot reveals that the residual of the multiple linear regression model (condo.mlr1) resembles normal distribution.\nAnother way to test for normality is with statistical tests, which can be called with ols_test_normality() below.\n\nols_test_normality(condo.mlr1)\n\nWarning in ks.test.default(y, \"pnorm\", mean(y), sd(y)): ties should not be\npresent for the one-sample Kolmogorov-Smirnov test\n\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n\nFrom the summary table above, assuming a 95% confidence interval, the low p-values means we can infer that there is statistical evidence that the residuals are not normally distributed.\n\n\nHX9/10.7.4 Test for spatial autocorrelation\nThe hedonic model we are trying to build uses geographically referenced attributes. Hence, it is also important to test the residuals of our hedonic pricing model for spatial autocorrelation. The first step in doing so is to bind our residuals to our original dataset for visualisation by means of tmap.\n\nmlr.output &lt;- as.data.frame(condo.mlr1$residuals)\ncondo_resale.res.sf &lt;- cbind(condo_resale.sf, condo.mlr1$residuals) %&gt;%\n  rename(`MLR_RES` = `condo.mlr1.residuals`)\ncondo_resale.sp &lt;- as_Spatial(condo_resale.res.sf)\ncondo_resale.sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 1436 \nextent      : 14940.85, 43352.45, 24765.67, 48382.81  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 23\nnames       : POSTCODE, SELLING_PRICE, AREA_SQM, AGE,    PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN,    PROX_MRT,   PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH, PROX_SHOPPING_MALL, ... \nmin values  :    18965,        540000,       34,   0, 0.386916393,    0.004927023,      0.054508623,          0.214539508,        0.051817113,       0.004927023, 0.052779424, 0.029064164,      0.077106132,          0.077106132,                  0, ... \nmax values  :   828833,       1.8e+07,      619,  37, 19.18042832,     3.46572633,      3.949157205,           9.15540001,        5.374348075,       2.229045366,  3.48037319,  2.16104919,      3.928989144,          6.748192062,        3.477433767, ... \n\n\n\n# Display with tmap\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(mpsz_svy21)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale.res.sf) +  \n  tm_dots(col = \"MLR_RES\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\nVariable(s) \"MLR_RES\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\nThe map above reveals there are signs of spatial autocorrelation. To verify that our observation is indeed true, we can perform the Moran’s I test.\n\n# Compute distance-based weight matrix\nnb &lt;- dnearneigh(coordinates(condo_resale.sp), 0, 1500, longlat = FALSE)\nsummary(nb)\n\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\n# Create spatial weights\nnb_lw &lt;- nb2listw(nb, style = 'W')\nsummary(nb_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\nWeights style: W \nWeights constants summary:\n     n      nn   S0       S1       S2\nW 1436 2062096 1436 94.81916 5798.341\n\n\nWe can use lm.morantest() from the spdep package to perform the Moran’s I test for residual spatial autocorrelation.\n\nlm.morantest(condo.mlr1, nb_lw)\n\n\n    Global Moran I for regression residuals\n\ndata:  \nmodel: lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD +\nPROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT +\nPROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP +\nNO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, data = condo_resale.sf)\nweights: nb_lw\n\nMoran I statistic standard deviate = 24.366, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nObserved Moran I      Expectation         Variance \n    1.438876e-01    -5.487594e-03     3.758259e-05 \n\n\nWith a p-value of 2.2e-16, we can reject the null hypothesis that the residuals are randomly distributed, for a 95% confidence interval. Since the observed Global Moran’s I is 0.142 &gt; 0, we can infer that the residuals resemble cluster distribution."
  },
  {
    "objectID": "HandsOn/hands-on-9.html#hx910.8-gwmodel-hedonic-pricing-model",
    "href": "HandsOn/hands-on-9.html#hx910.8-gwmodel-hedonic-pricing-model",
    "title": "HX9/10: Geographically Weighted Regression - Calibrating a Hedonic Pricing Model",
    "section": "HX9/10.8 GWmodel Hedonic Pricing Model",
    "text": "HX9/10.8 GWmodel Hedonic Pricing Model\n\nHX9/10.8.1 Computing fixed bandwidth\nbw.gr() from GWmodel is used to determine the optimal fixed bandwidth.\nadaptive = FALSE indicates we wish to compute fixed bandwidth. The approach argument determines whether we wish to use the CV cross-validation approach or the AIC corrected approach.\n\nbw.fixed &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                     PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                     PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                     PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                     FAMILY_FRIENDLY + FREEHOLD, \n                   data=condo_resale.sp, \n                   approach=\"CV\", \n                   kernel=\"gaussian\", \n                   adaptive=FALSE, \n                   longlat=FALSE)\n\nFixed bandwidth: 17660.96 CV score: 8.259118e+14 \nFixed bandwidth: 10917.26 CV score: 7.970454e+14 \nFixed bandwidth: 6749.419 CV score: 7.273273e+14 \nFixed bandwidth: 4173.553 CV score: 6.300006e+14 \nFixed bandwidth: 2581.58 CV score: 5.404958e+14 \nFixed bandwidth: 1597.687 CV score: 4.857515e+14 \nFixed bandwidth: 989.6077 CV score: 4.722431e+14 \nFixed bandwidth: 613.7939 CV score: 1.37828e+16 \nFixed bandwidth: 1221.873 CV score: 4.778717e+14 \nFixed bandwidth: 846.0596 CV score: 4.791629e+14 \nFixed bandwidth: 1078.325 CV score: 4.751406e+14 \nFixed bandwidth: 934.7772 CV score: 4.72518e+14 \nFixed bandwidth: 1023.495 CV score: 4.730305e+14 \nFixed bandwidth: 968.6643 CV score: 4.721317e+14 \nFixed bandwidth: 955.7206 CV score: 4.722072e+14 \nFixed bandwidth: 976.6639 CV score: 4.721387e+14 \nFixed bandwidth: 963.7202 CV score: 4.721484e+14 \nFixed bandwidth: 971.7199 CV score: 4.721293e+14 \nFixed bandwidth: 973.6083 CV score: 4.721309e+14 \nFixed bandwidth: 970.5527 CV score: 4.721295e+14 \nFixed bandwidth: 972.4412 CV score: 4.721296e+14 \nFixed bandwidth: 971.2741 CV score: 4.721292e+14 \nFixed bandwidth: 970.9985 CV score: 4.721293e+14 \nFixed bandwidth: 971.4443 CV score: 4.721292e+14 \nFixed bandwidth: 971.5496 CV score: 4.721293e+14 \nFixed bandwidth: 971.3793 CV score: 4.721292e+14 \nFixed bandwidth: 971.3391 CV score: 4.721292e+14 \nFixed bandwidth: 971.3143 CV score: 4.721292e+14 \nFixed bandwidth: 971.3545 CV score: 4.721292e+14 \nFixed bandwidth: 971.3296 CV score: 4.721292e+14 \nFixed bandwidth: 971.345 CV score: 4.721292e+14 \nFixed bandwidth: 971.3355 CV score: 4.721292e+14 \nFixed bandwidth: 971.3413 CV score: 4.721292e+14 \nFixed bandwidth: 971.3377 CV score: 4.721292e+14 \nFixed bandwidth: 971.34 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3408 CV score: 4.721292e+14 \nFixed bandwidth: 971.341 CV score: 4.721292e+14 \nFixed bandwidth: 971.3407 CV score: 4.721292e+14 \nFixed bandwidth: 971.3409 CV score: 4.721292e+14 \nFixed bandwidth: 971.3408 CV score: 4.721292e+14 \nFixed bandwidth: 971.3408 CV score: 4.721292e+14 \n\n\nThe recommended bandwidth is 971.3405 metres - a result of using the SWY21 coordinate model which uses metres - close to 1km.\n\n\nHX9/10.8.2 Building GWmodel with fixed bandwidth\nWe can now build our gwr model using fixed bandwidth and the gaussian kernel. The output is saved as a gwrm object.\n\ngwr.fixed &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                         PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                         PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                         PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                         FAMILY_FRIENDLY + FREEHOLD, \n                       data=condo_resale.sp, \n                       bw=bw.fixed, \n                       kernel = 'gaussian', \n                       longlat = FALSE)\ngwr.fixed\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-20 18:06:51.499234 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.fixed, kernel = \"gaussian\", \n    longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Fixed bandwidth: 971.3408 \n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5988e+07 -5.1998e+05  7.6780e+05  1.7412e+06\n   AREA_SQM              1.0003e+03  5.2758e+03  7.4740e+03  1.2301e+04\n   AGE                  -1.3475e+05 -2.0813e+04 -8.6260e+03 -3.7784e+03\n   PROX_CBD             -7.7047e+07 -2.3608e+05 -8.3600e+04  3.4645e+04\n   PROX_CHILDCARE       -6.0097e+06 -3.3667e+05 -9.7425e+04  2.9008e+05\n   PROX_ELDERLYCARE     -3.5000e+06 -1.5970e+05  3.1971e+04  1.9577e+05\n   PROX_URA_GROWTH_AREA -3.0170e+06 -8.2013e+04  7.0749e+04  2.2612e+05\n   PROX_MRT             -3.5282e+06 -6.5836e+05 -1.8833e+05  3.6922e+04\n   PROX_PARK            -1.2062e+06 -2.1732e+05  3.5383e+04  4.1335e+05\n   PROX_PRIMARY_SCH     -2.2695e+07 -1.7066e+05  4.8472e+04  5.1555e+05\n   PROX_SHOPPING_MALL   -7.2585e+06 -1.6684e+05 -1.0517e+04  1.5923e+05\n   PROX_BUS_STOP        -1.4676e+06 -4.5206e+04  3.7601e+05  1.1664e+06\n   NO_Of_UNITS          -1.3170e+03 -2.4822e+02 -3.0846e+01  2.5496e+02\n   FAMILY_FRIENDLY      -2.2749e+06 -1.1140e+05  7.6214e+03  1.6107e+05\n   FREEHOLD             -9.2067e+06  3.8073e+04  1.5169e+05  3.7528e+05\n                             Max.\n   Intercept            112793007\n   AREA_SQM                 21575\n   AGE                     434200\n   PROX_CBD               2704591\n   PROX_CHILDCARE         1654088\n   PROX_ELDERLYCARE      38867786\n   PROX_URA_GROWTH_AREA  78515685\n   PROX_MRT               3124310\n   PROX_PARK             18122416\n   PROX_PRIMARY_SCH       4637495\n   PROX_SHOPPING_MALL     1529951\n   PROX_BUS_STOP         11342166\n   NO_Of_UNITS              12907\n   FAMILY_FRIENDLY        1720744\n   FREEHOLD               6073633\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 438.3803 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 997.6197 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 42263.61 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41632.36 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42515.71 \n   Residual sum of squares: 2.534071e+14 \n   R-square value:  0.8909911 \n   Adjusted R-square value:  0.8430417 \n\n   ***********************************************************************\n   Program stops at: 2024-10-20 18:06:52.304633 \n\n\nThe AICc of the GWR is 42263.61, which is significantly smaller than the 42967.1 derived with global regression.\n\n\nHX9/10.8.3 Building GWmodel with adaptive bandwidth\nWe can also calibrate a gwr-based hedonic pricing model using the adaptive bandwidth approach. The steps are similar to that for the fixed bandwidth approach, except this time we change the adaptive argument to TRUE.\n\nbw.adaptive &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE  + \n                        PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE    + \n                        PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                        PROX_PRIMARY_SCH + PROX_SHOPPING_MALL   + PROX_BUS_STOP + \n                        NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                      data=condo_resale.sp, \n                      approach=\"CV\", \n                      kernel=\"gaussian\", \n                      adaptive=TRUE, \n                      longlat=FALSE)\n\nAdaptive bandwidth: 895 CV score: 7.952401e+14 \nAdaptive bandwidth: 561 CV score: 7.667364e+14 \nAdaptive bandwidth: 354 CV score: 6.953454e+14 \nAdaptive bandwidth: 226 CV score: 6.15223e+14 \nAdaptive bandwidth: 147 CV score: 5.674373e+14 \nAdaptive bandwidth: 98 CV score: 5.426745e+14 \nAdaptive bandwidth: 68 CV score: 5.168117e+14 \nAdaptive bandwidth: 49 CV score: 4.859631e+14 \nAdaptive bandwidth: 37 CV score: 4.646518e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \nAdaptive bandwidth: 25 CV score: 4.430816e+14 \nAdaptive bandwidth: 32 CV score: 4.505602e+14 \nAdaptive bandwidth: 27 CV score: 4.462172e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \n\ngwr.adaptive &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE + \n                            PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                            PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + \n                            NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                          data=condo_resale.sp, bw=bw.adaptive, \n                          kernel = 'gaussian', \n                          adaptive=TRUE, \n                          longlat = FALSE)\ngwr.adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-20 18:06:58.86677 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.adaptive, kernel = \"gaussian\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 30 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -1.3487e+08 -2.4669e+05  7.7928e+05  1.6194e+06\n   AREA_SQM              3.3188e+03  5.6285e+03  7.7825e+03  1.2738e+04\n   AGE                  -9.6746e+04 -2.9288e+04 -1.4043e+04 -5.6119e+03\n   PROX_CBD             -2.5330e+06 -1.6256e+05 -7.7242e+04  2.6624e+03\n   PROX_CHILDCARE       -1.2790e+06 -2.0175e+05  8.7158e+03  3.7778e+05\n   PROX_ELDERLYCARE     -1.6212e+06 -9.2050e+04  6.1029e+04  2.8184e+05\n   PROX_URA_GROWTH_AREA -7.2686e+06 -3.0350e+04  4.5869e+04  2.4613e+05\n   PROX_MRT             -4.3781e+07 -6.7282e+05 -2.2115e+05 -7.4593e+04\n   PROX_PARK            -2.9020e+06 -1.6782e+05  1.1601e+05  4.6572e+05\n   PROX_PRIMARY_SCH     -8.6418e+05 -1.6627e+05 -7.7853e+03  4.3222e+05\n   PROX_SHOPPING_MALL   -1.8272e+06 -1.3175e+05 -1.4049e+04  1.3799e+05\n   PROX_BUS_STOP        -2.0579e+06 -7.1461e+04  4.1104e+05  1.2071e+06\n   NO_Of_UNITS          -2.1993e+03 -2.3685e+02 -3.4699e+01  1.1657e+02\n   FAMILY_FRIENDLY      -5.9879e+05 -5.0927e+04  2.6173e+04  2.2481e+05\n   FREEHOLD             -1.6340e+05  4.0765e+04  1.9023e+05  3.7960e+05\n                            Max.\n   Intercept            18758355\n   AREA_SQM                23064\n   AGE                     13303\n   PROX_CBD             11346650\n   PROX_CHILDCARE        2892127\n   PROX_ELDERLYCARE      2465671\n   PROX_URA_GROWTH_AREA  7384059\n   PROX_MRT              1186242\n   PROX_PARK             2588497\n   PROX_PRIMARY_SCH      3381462\n   PROX_SHOPPING_MALL   38038564\n   PROX_BUS_STOP        12081592\n   NO_Of_UNITS              1010\n   FAMILY_FRIENDLY       2072414\n   FREEHOLD              1813995\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 350.3088 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 1085.691 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 41982.22 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41546.74 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 41914.08 \n   Residual sum of squares: 2.528227e+14 \n   R-square value:  0.8912425 \n   Adjusted R-square value:  0.8561185 \n\n   ***********************************************************************\n   Program stops at: 2024-10-20 18:06:59.882378 \n\n\nThe AICc of the adaptive distance gwr is 41982.22, which is smaller than the 42263.61 derived with our fixed distance gwr.\n\n\nHX9/10.8.4 Visualising GWR output\nIn addition to regression residuals, the output feature class table includes the:\n\nCondition Number cond: This diagnostic evaluates local collinearity. In the presence of strong local collinearity, results become unstable. Results associated with condition numbers larger than \\(30\\) may be unreliable.\nLocal \\(R^2\\): Ranging between 0.0 and 1.0, local \\(R^2\\) indicates how well the local regression model fits observed \\(y\\) values. Very low values indicate the local model is performing poorly. Mapping the local \\(R^2\\) values may provide clues about important variables that may be missing from the regression model, as it allows us to pinpoint locations where the model predicts well, and locations where it predicts poorly.\nPredicted: these are the estimated (or fitted) \\(y\\) values computed by GWR.\nResiduals: To obtain the residual values, the fitted \\(y\\) values, \\(\\hat{y}\\), are subtracted from the observed \\(y\\) values. Standardised residuals have a mean of \\(0\\) and a standard deviation of \\(1\\). A cold-to-hot rendered map of standardised residuals can be produced using these values.\nCoefficient Standard Error: these values measure the reliability of each coefficient estimate. Confidence in these estimates is higher when standard errors are small in relation to the actual coefficient values. Large standard errors may indicate problems with local collinearity.\n\nThese are stored in a SpatialPointsDataFrame or SpatialPolygonsDataFrame object integrated with fit.points, GWR coefficient estimates, y value, predicted value, coefficient standard errors and t-values in its data slot in an object called SDF in the output list.\nThe following sections serve to map these values.\n\n\nHX9/10.8.5 Converting SDF into sf\nFirst, we need to convert SDF to an sf data frame. Subsequently, we can use glimpse() to display its content.\n\ncondo_resale.sf.adaptive &lt;- st_as_sf(gwr.adaptive$SDF) %&gt;%\n  st_transform(crs=3414)\ncondo_resale.sf.adaptive.svy21 &lt;- st_transform(condo_resale.sf.adaptive, 3414)\ncondo_resale.sf.adaptive.svy21  \n\nSimple feature collection with 1436 features and 51 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14940.85 ymin: 24765.67 xmax: 43352.45 ymax: 48382.81\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n    Intercept  AREA_SQM        AGE  PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n1   2050011.7  9561.892  -9514.634 -120681.9      319266.92       -393417.79\n2   1633128.2 16576.853 -58185.479 -149434.2      441102.18        325188.74\n3   3433608.2 13091.861 -26707.386 -259397.8     -120116.82        535855.81\n4    234358.9 20730.601 -93308.988 2426853.7      480825.28        314783.72\n5   2285804.9  6722.836 -17608.018 -316835.5       90764.78       -137384.61\n6  -3568877.4  6039.581 -26535.592  327306.1     -152531.19       -700392.85\n7  -2874842.4 16843.575 -59166.727 -983577.2     -177810.50       -122384.02\n8   2038086.0  6905.135 -17681.897 -285076.6       70259.40        -96012.78\n9   1718478.4  9580.703 -14401.128  105803.4     -657698.02       -123276.00\n10  3457054.0 14072.011 -31579.884 -234895.4       79961.45        548581.04\n   PROX_URA_GROWTH_AREA    PROX_MRT  PROX_PARK PROX_PRIMARY_SCH\n1            -159980.20  -299742.96 -172104.47        242668.03\n2            -142290.39 -2510522.23  523379.72       1106830.66\n3            -253621.21  -936853.28  209099.85        571462.33\n4           -2679297.89 -2039479.50 -759153.26       3127477.21\n5             303714.81   -44567.05  -10284.62         30413.56\n6             -28051.25   733566.47 1511488.92        320878.23\n7            1397676.38 -2745430.34  710114.74       1786570.95\n8             269368.71   -14552.99   73533.34         53359.73\n9            -361974.72  -476785.32 -132067.59        -40128.92\n10           -150024.38 -1503835.53  574155.47        108996.67\n   PROX_SHOPPING_MALL PROX_BUS_STOP  NO_Of_UNITS FAMILY_FRIENDLY  FREEHOLD\n1          300881.390     1210615.4  104.8290640       -9075.370  303955.6\n2          -87693.378     1843587.2 -288.3441183      310074.664  396221.3\n3         -126732.712     1411924.9   -9.5532945        5949.746  168821.7\n4          -29593.342     7225577.5 -161.3551620     1556178.531 1212515.6\n5           -7490.586      677577.0   42.2659674       58986.951  328175.2\n6          258583.881     1086012.6 -214.3671271      201992.641  471873.1\n7         -384251.210     5094060.5   -0.9212521      359659.512  408871.9\n8          -39634.902      735767.1   30.1741069       55602.506  347075.0\n9          276718.757     2815772.4  675.1615559      -30453.297  503872.8\n10        -454726.822     2123557.0  -21.3044311     -100935.586  213324.6\n         y    yhat    residual CV_Score Stud_residual Intercept_SE AREA_SQM_SE\n1  3000000 2886532   113468.16        0    0.38207013     516105.5    823.2860\n2  3880000 3466801   413198.52        0    1.01433140     488083.5    825.2380\n3  3325000 3616527  -291527.20        0   -0.83780678     963711.4    988.2240\n4  4250000 5435482 -1185481.63        0   -2.84614670     444185.5    617.4007\n5  1400000 1388166    11834.26        0    0.03404453    2119620.6   1376.2778\n6  1320000 1516702  -196701.94        0   -0.72065800   28572883.7   2348.0091\n7  3410000 3266881   143118.77        0    0.41291992     679546.6    893.5893\n8  1420000 1431955   -11955.27        0   -0.03033109    2217773.1   1415.2604\n9  2025000 1832799   192200.83        0    0.52018109     814281.8    943.8434\n10 2550000 2223364   326635.53        0    1.10559735    2410252.0   1271.4073\n      AGE_SE PROX_CBD_SE PROX_CHILDCARE_SE PROX_ELDERLYCARE_SE\n1   5889.782    37411.22          319111.1           120633.34\n2   6226.916    23615.06          299705.3            84546.69\n3   6510.236    56103.77          349128.5           129687.07\n4   6010.511   469337.41          304965.2           127150.69\n5   8180.361   410644.47          698720.6           327371.55\n6  14601.909  5272846.47         1141599.8          1653002.19\n7   8970.629   346164.20          530101.1           148598.71\n8   8661.309   438035.69          742532.8           399221.05\n9  11791.208    89148.35          704630.7           329683.30\n10  9941.980   173532.77          500976.2           281876.74\n   PROX_URA_GROWTH_AREA_SE PROX_MRT_SE PROX_PARK_SE PROX_PRIMARY_SCH_SE\n1                 56207.39    185181.3     205499.6            152400.7\n2                 76956.50    281133.9     229358.7            165150.7\n3                 95774.60    275483.7     314124.3            196662.6\n4                470762.12    279877.1     227249.4            240878.9\n5                474339.56    363830.0     364580.9            249087.7\n6               5496627.21    730453.2    1741712.0            683265.5\n7                371692.97    375511.9     297400.9            344602.8\n8                517977.91    423155.4     440984.4            261251.2\n9                153436.22    285325.4     304998.4            278258.5\n10               239182.57    571355.7     599131.8            331284.8\n   PROX_SHOPPING_MALL_SE PROX_BUS_STOP_SE NO_Of_UNITS_SE FAMILY_FRIENDLY_SE\n1               109268.8         600668.6       218.1258           131474.7\n2                98906.8         410222.1       208.9410           114989.1\n3               119913.3         464156.7       210.9828           146607.2\n4               177104.1         562810.8       361.7767           108726.6\n5               301032.9         740922.4       299.5034           160663.7\n6              2931208.6        1418333.3       602.5571           331727.0\n7               249969.5         821236.4       532.1978           129241.2\n8               351634.0         775038.4       338.6777           171895.1\n9               289872.7         850095.5       439.9037           220223.4\n10              265529.7         631399.2       259.0169           189125.5\n   FREEHOLD_SE Intercept_TV AREA_SQM_TV     AGE_TV PROX_CBD_TV\n1     115954.0    3.9720784   11.614302  -1.615447 -3.22582173\n2     130110.0    3.3460017   20.087361  -9.344188 -6.32792021\n3     141031.5    3.5629010   13.247868  -4.102368 -4.62353528\n4     138239.1    0.5276150   33.577223 -15.524302  5.17080808\n5     210641.1    1.0784029    4.884795  -2.152474 -0.77155660\n6     374347.3   -0.1249043    2.572214  -1.817269  0.06207388\n7     182216.9   -4.2305303   18.849348  -6.595605 -2.84136028\n8     216649.4    0.9189786    4.879056  -2.041481 -0.65080678\n9     220473.7    2.1104224   10.150733  -1.221345  1.18682383\n10    206346.2    1.4343123   11.068059  -3.176418 -1.35360852\n   PROX_CHILDCARE_TV PROX_ELDERLYCARE_TV PROX_URA_GROWTH_AREA_TV PROX_MRT_TV\n1         1.00048819          -3.2612693            -2.846248368 -1.61864578\n2         1.47178634           3.8462625            -1.848971738 -8.92998600\n3        -0.34404755           4.1319138            -2.648105057 -3.40075727\n4         1.57665606           2.4756745            -5.691404992 -7.28705261\n5         0.12990138          -0.4196596             0.640289855 -0.12249416\n6        -0.13361179          -0.4237096            -0.005103357  1.00426206\n7        -0.33542751          -0.8235874             3.760298131 -7.31116712\n8         0.09462126          -0.2405003             0.520038994 -0.03439159\n9        -0.93339393          -0.3739225            -2.359121712 -1.67102293\n10        0.15961128           1.9461735            -0.627237944 -2.63204802\n   PROX_PARK_TV PROX_PRIMARY_SCH_TV PROX_SHOPPING_MALL_TV PROX_BUS_STOP_TV\n1   -0.83749312           1.5923022            2.75358842        2.0154464\n2    2.28192684           6.7019454           -0.88662640        4.4941192\n3    0.66565951           2.9058009           -1.05686949        3.0419145\n4   -3.34061770          12.9836105           -0.16709578       12.8383775\n5   -0.02820944           0.1220998           -0.02488294        0.9145046\n6    0.86781794           0.4696245            0.08821750        0.7656963\n7    2.38773567           5.1844351           -1.53719231        6.2029165\n8    0.16674816           0.2042469           -0.11271635        0.9493299\n9   -0.43301073          -0.1442145            0.95462153        3.3123012\n10   0.95831249           0.3290120           -1.71252687        3.3632555\n   NO_Of_UNITS_TV FAMILY_FRIENDLY_TV FREEHOLD_TV  Local_R2\n1     0.480589953        -0.06902748    2.621347 0.8846744\n2    -1.380026395         2.69655779    3.045280 0.8899773\n3    -0.045279967         0.04058290    1.197050 0.8947007\n4    -0.446007570        14.31276425    8.771149 0.9073605\n5     0.141120178         0.36714544    1.557983 0.9510057\n6    -0.355762335         0.60891234    1.260522 0.9247586\n7    -0.001731033         2.78285441    2.243875 0.8310458\n8     0.089093858         0.32346758    1.602012 0.9463936\n9     1.534793921        -0.13828365    2.285410 0.8380365\n10   -0.082251138        -0.53369623    1.033819 0.9080753\n                    geometry\n1  POINT (22085.12 29951.54)\n2   POINT (25656.84 34546.2)\n3   POINT (23963.99 32890.8)\n4  POINT (27044.28 32319.77)\n5  POINT (41042.56 33743.64)\n6   POINT (39717.04 32943.1)\n7   POINT (28419.1 33513.37)\n8  POINT (40763.57 33879.61)\n9  POINT (23595.63 28884.78)\n10 POINT (24586.56 33194.31)\n\ngwr.adaptive.output &lt;- as.data.frame(gwr.adaptive$SDF)\ncondo_resale.sf.adaptive &lt;- cbind(condo_resale.res.sf, as.matrix(gwr.adaptive.output))\nglimpse(condo_resale.sf.adaptive)\n\nRows: 1,436\nColumns: 77\n$ POSTCODE                &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472…\n$ SELLING_PRICE           &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ AREA_SQM                &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 1…\n$ AGE                     &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22,…\n$ PROX_CBD                &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783…\n$ PROX_CHILDCARE          &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543…\n$ PROX_ELDERLYCARE        &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.…\n$ PROX_URA_GROWTH_AREA    &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.4106…\n$ PROX_HAWKER_MARKET      &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969…\n$ PROX_KINDERGARTEN       &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076…\n$ PROX_MRT                &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.…\n$ PROX_PARK               &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.…\n$ PROX_PRIMARY_SCH        &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.…\n$ PROX_TOP_PRIMARY_SCH    &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.…\n$ PROX_SHOPPING_MALL      &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.…\n$ PROX_SUPERMARKET        &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.…\n$ PROX_BUS_STOP           &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340…\n$ NO_Of_UNITS             &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34…\n$ FAMILY_FRIENDLY         &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ LOG_SELLING_PRICE       &lt;dbl&gt; 14.91412, 15.17135, 15.01698, 15.26243, 14.151…\n$ MLR_RES                 &lt;dbl&gt; -1489099.55, 415494.57, 194129.69, 1088992.71,…\n$ Intercept               &lt;dbl&gt; 2050011.67, 1633128.24, 3433608.17, 234358.91,…\n$ AREA_SQM.1              &lt;dbl&gt; 9561.892, 16576.853, 13091.861, 20730.601, 672…\n$ AGE.1                   &lt;dbl&gt; -9514.634, -58185.479, -26707.386, -93308.988,…\n$ PROX_CBD.1              &lt;dbl&gt; -120681.94, -149434.22, -259397.77, 2426853.66…\n$ PROX_CHILDCARE.1        &lt;dbl&gt; 319266.925, 441102.177, -120116.816, 480825.28…\n$ PROX_ELDERLYCARE.1      &lt;dbl&gt; -393417.795, 325188.741, 535855.806, 314783.72…\n$ PROX_URA_GROWTH_AREA.1  &lt;dbl&gt; -159980.203, -142290.389, -253621.206, -267929…\n$ PROX_MRT.1              &lt;dbl&gt; -299742.96, -2510522.23, -936853.28, -2039479.…\n$ PROX_PARK.1             &lt;dbl&gt; -172104.47, 523379.72, 209099.85, -759153.26, …\n$ PROX_PRIMARY_SCH.1      &lt;dbl&gt; 242668.03, 1106830.66, 571462.33, 3127477.21, …\n$ PROX_SHOPPING_MALL.1    &lt;dbl&gt; 300881.390, -87693.378, -126732.712, -29593.34…\n$ PROX_BUS_STOP.1         &lt;dbl&gt; 1210615.44, 1843587.22, 1411924.90, 7225577.51…\n$ NO_Of_UNITS.1           &lt;dbl&gt; 104.8290640, -288.3441183, -9.5532945, -161.35…\n$ FAMILY_FRIENDLY.1       &lt;dbl&gt; -9075.370, 310074.664, 5949.746, 1556178.531, …\n$ FREEHOLD.1              &lt;dbl&gt; 303955.61, 396221.27, 168821.75, 1212515.58, 3…\n$ y                       &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ yhat                    &lt;dbl&gt; 2886531.8, 3466801.5, 3616527.2, 5435481.6, 13…\n$ residual                &lt;dbl&gt; 113468.16, 413198.52, -291527.20, -1185481.63,…\n$ CV_Score                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ Stud_residual           &lt;dbl&gt; 0.38207013, 1.01433140, -0.83780678, -2.846146…\n$ Intercept_SE            &lt;dbl&gt; 516105.5, 488083.5, 963711.4, 444185.5, 211962…\n$ AREA_SQM_SE             &lt;dbl&gt; 823.2860, 825.2380, 988.2240, 617.4007, 1376.2…\n$ AGE_SE                  &lt;dbl&gt; 5889.782, 6226.916, 6510.236, 6010.511, 8180.3…\n$ PROX_CBD_SE             &lt;dbl&gt; 37411.22, 23615.06, 56103.77, 469337.41, 41064…\n$ PROX_CHILDCARE_SE       &lt;dbl&gt; 319111.1, 299705.3, 349128.5, 304965.2, 698720…\n$ PROX_ELDERLYCARE_SE     &lt;dbl&gt; 120633.34, 84546.69, 129687.07, 127150.69, 327…\n$ PROX_URA_GROWTH_AREA_SE &lt;dbl&gt; 56207.39, 76956.50, 95774.60, 470762.12, 47433…\n$ PROX_MRT_SE             &lt;dbl&gt; 185181.3, 281133.9, 275483.7, 279877.1, 363830…\n$ PROX_PARK_SE            &lt;dbl&gt; 205499.6, 229358.7, 314124.3, 227249.4, 364580…\n$ PROX_PRIMARY_SCH_SE     &lt;dbl&gt; 152400.7, 165150.7, 196662.6, 240878.9, 249087…\n$ PROX_SHOPPING_MALL_SE   &lt;dbl&gt; 109268.8, 98906.8, 119913.3, 177104.1, 301032.…\n$ PROX_BUS_STOP_SE        &lt;dbl&gt; 600668.6, 410222.1, 464156.7, 562810.8, 740922…\n$ NO_Of_UNITS_SE          &lt;dbl&gt; 218.1258, 208.9410, 210.9828, 361.7767, 299.50…\n$ FAMILY_FRIENDLY_SE      &lt;dbl&gt; 131474.73, 114989.07, 146607.22, 108726.62, 16…\n$ FREEHOLD_SE             &lt;dbl&gt; 115954.0, 130110.0, 141031.5, 138239.1, 210641…\n$ Intercept_TV            &lt;dbl&gt; 3.9720784, 3.3460017, 3.5629010, 0.5276150, 1.…\n$ AREA_SQM_TV             &lt;dbl&gt; 11.614302, 20.087361, 13.247868, 33.577223, 4.…\n$ AGE_TV                  &lt;dbl&gt; -1.6154474, -9.3441881, -4.1023685, -15.524301…\n$ PROX_CBD_TV             &lt;dbl&gt; -3.22582173, -6.32792021, -4.62353528, 5.17080…\n$ PROX_CHILDCARE_TV       &lt;dbl&gt; 1.000488185, 1.471786337, -0.344047555, 1.5766…\n$ PROX_ELDERLYCARE_TV     &lt;dbl&gt; -3.26126929, 3.84626245, 4.13191383, 2.4756745…\n$ PROX_URA_GROWTH_AREA_TV &lt;dbl&gt; -2.846248368, -1.848971738, -2.648105057, -5.6…\n$ PROX_MRT_TV             &lt;dbl&gt; -1.61864578, -8.92998600, -3.40075727, -7.2870…\n$ PROX_PARK_TV            &lt;dbl&gt; -0.83749312, 2.28192684, 0.66565951, -3.340617…\n$ PROX_PRIMARY_SCH_TV     &lt;dbl&gt; 1.59230221, 6.70194543, 2.90580089, 12.9836104…\n$ PROX_SHOPPING_MALL_TV   &lt;dbl&gt; 2.753588422, -0.886626400, -1.056869486, -0.16…\n$ PROX_BUS_STOP_TV        &lt;dbl&gt; 2.0154464, 4.4941192, 3.0419145, 12.8383775, 0…\n$ NO_Of_UNITS_TV          &lt;dbl&gt; 0.480589953, -1.380026395, -0.045279967, -0.44…\n$ FAMILY_FRIENDLY_TV      &lt;dbl&gt; -0.06902748, 2.69655779, 0.04058290, 14.312764…\n$ FREEHOLD_TV             &lt;dbl&gt; 2.6213469, 3.0452799, 1.1970499, 8.7711485, 1.…\n$ Local_R2                &lt;dbl&gt; 0.8846744, 0.8899773, 0.8947007, 0.9073605, 0.…\n$ coords.x1               &lt;dbl&gt; 22085.12, 25656.84, 23963.99, 27044.28, 41042.…\n$ coords.x2               &lt;dbl&gt; 29951.54, 34546.20, 32890.80, 32319.77, 33743.…\n$ geometry                &lt;POINT [m]&gt; POINT (22085.12 29951.54), POINT (25656.…\n\nsummary(gwr.adaptive$SDF$yhat)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n  171347  1102001  1385528  1751842  1982307 13887901 \n\n\n\n\nHX9/10.8.6 Visualising local R^2\n\ntm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid. See sf::st_is_valid\n\n\n\n\n\n\n\n\n\n\n\nHX9/10.8.7 Visualising coefficient estimates\n\nAREA_SQM_SE &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_SE\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nAREA_SQM_TV &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_TV\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\ntmap_arrange(AREA_SQM_SE, AREA_SQM_TV, \n             asp=1, ncol=2,\n             sync = TRUE)\n\nWarning: The shape mpsz_svy21 is invalid. See sf::st_is_valid\nWarning: The shape mpsz_svy21 is invalid. See sf::st_is_valid\n\n\n\n\n\n\n\n\n\n\n\nHX9/10.8.8 Visualising individual URA planning Regions\n\ntm_shape(mpsz_svy21[mpsz_svy21$REGION_N==\"CENTRAL REGION\", ])+\n  tm_polygons()+\ntm_shape(condo_resale.sf.adaptive) + \n  tm_bubbles(col = \"Local_R2\",\n           size = 0.15,\n           border.col = \"gray60\",\n           border.lwd = 1)\n\nWarning: The shape mpsz_svy21[mpsz_svy21$REGION_N == \"CENTRAL REGION\", ] is\ninvalid. See sf::st_is_valid"
  },
  {
    "objectID": "index.html#featured-in-class-exercises",
    "href": "index.html#featured-in-class-exercises",
    "title": "IS415: Geospatial Analytics and Applications",
    "section": "Featured In-Class Exercises",
    "text": "Featured In-Class Exercises\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Title\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nDate\n\n\nTitle\n\n\nAuthor\n\n\n\n\n\n\nOct 28, 2024\n\n\nCE10: Geographically Weighted Regression\n\n\nKendrick Teo\n\n\n\n\nOct 21, 2024\n\n\nCE8: Spatially Constrained Clustering Analysis\n\n\nKendrick Teo\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "InClass/ICE8/in-class-8.html",
    "href": "InClass/ICE8/in-class-8.html",
    "title": "CE8: Spatially Constrained Clustering Analysis",
    "section": "",
    "text": "pacman::p_load(spdep, sp, tmap, sf, ClustGeo, cluster, factoextra, NbClust, tidyverse, GGally)"
  },
  {
    "objectID": "InClass/ICE8/in-class-8.html#ce8.1-loading-r-packages",
    "href": "InClass/ICE8/in-class-8.html#ce8.1-loading-r-packages",
    "title": "CE8: Spatially Constrained Clustering Analysis",
    "section": "",
    "text": "pacman::p_load(spdep, sp, tmap, sf, ClustGeo, cluster, factoextra, NbClust, tidyverse, GGally)"
  },
  {
    "objectID": "InClass/ICE8/in-class-8.html#ce8.2-importing-the-data",
    "href": "InClass/ICE8/in-class-8.html#ce8.2-importing-the-data",
    "title": "CE8: Spatially Constrained Clustering Analysis",
    "section": "CE8.2 Importing the data",
    "text": "CE8.2 Importing the data\n\nshan_sf &lt;- read_rds(\"data/rds/shan_sf.rds\")\nshan_ict &lt;- read_rds(\"data/rds/shan_ict.rds\")\nshan_sf_cluster &lt;- read_rds(\"data/rds/shan_sf_cluster.rds\")"
  },
  {
    "objectID": "InClass/ICE8/in-class-8.html#ce8.3-conventional-hierarchical-clustering",
    "href": "InClass/ICE8/in-class-8.html#ce8.3-conventional-hierarchical-clustering",
    "title": "CE8: Spatially Constrained Clustering Analysis",
    "section": "CE8.3 Conventional Hierarchical Clustering",
    "text": "CE8.3 Conventional Hierarchical Clustering\n\nproxmat &lt;- dist(shan_ict, method = 'euclidean')\nhclust_ward &lt;- hclust(proxmat, method = 'ward.D')\ngroups &lt;- as.factor(cutree(hclust_ward, k = 6))"
  },
  {
    "objectID": "InClass/ICE8/in-class-8.html#ce8.4-append-to-geospatial-data",
    "href": "InClass/ICE8/in-class-8.html#ce8.4-append-to-geospatial-data",
    "title": "CE8: Spatially Constrained Clustering Analysis",
    "section": "CE8.4 Append to geospatial data",
    "text": "CE8.4 Append to geospatial data\n\nshan_sf_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER` = `as.matrix.groups.`) %&gt;% # Tidy your data\n  select(-c(3:4, 7:9)) %&gt;%\n  rename(TS = TS.x)"
  },
  {
    "objectID": "InClass/ICE8/in-class-8.html#ce8.5-create-clustering-dendogram",
    "href": "InClass/ICE8/in-class-8.html#ce8.5-create-clustering-dendogram",
    "title": "CE8: Spatially Constrained Clustering Analysis",
    "section": "CE8.5 Create clustering dendogram",
    "text": "CE8.5 Create clustering dendogram\n\nplot(hclust_ward, cex = 0.6)\nrect.hclust(hclust_ward, k = 6, border = 2:5)"
  },
  {
    "objectID": "InClass/ICE8/in-class-8.html#ce8.6-cluster-map",
    "href": "InClass/ICE8/in-class-8.html#ce8.6-cluster-map",
    "title": "CE8: Spatially Constrained Clustering Analysis",
    "section": "CE8.6 Cluster map",
    "text": "CE8.6 Cluster map\n\nqtm(shan_sf_cluster, \"CLUSTER\")"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html",
    "href": "InClass/ICE10/ICE10.html",
    "title": "CE10: Geographically Weighted Regression",
    "section": "",
    "text": "pacman::p_load(olsrr, ggstatsplot, sf, tmap, tidyverse, gtsummary, performance, see, sfdep)\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/InClass/ICE10/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\ncondo_resale &lt;- read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ncondo_resale_sf &lt;- st_as_sf(condo_resale, coords = c(\"LONGITUDE\", \"LATITUDE\"), crs=4326) %&gt;% st_transform(crs=3414)"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.1-getting-started",
    "href": "InClass/ICE10/ICE10.html#ce10.1-getting-started",
    "title": "CE10: Geographically Weighted Regression",
    "section": "",
    "text": "pacman::p_load(olsrr, ggstatsplot, sf, tmap, tidyverse, gtsummary, performance, see, sfdep)\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/InClass/ICE10/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\ncondo_resale &lt;- read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ncondo_resale_sf &lt;- st_as_sf(condo_resale, coords = c(\"LONGITUDE\", \"LATITUDE\"), crs=4326) %&gt;% st_transform(crs=3414)"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.2-correlation-analysis-with-ggstatplot",
    "href": "InClass/ICE10/ICE10.html#ce10.2-correlation-analysis-with-ggstatplot",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.2 Correlation Analysis with ggstatplot",
    "text": "CE10.2 Correlation Analysis with ggstatplot\n\nggcorrmat(condo_resale[, 5:23])"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.3-multiple-linear-regression-method",
    "href": "InClass/ICE10/ICE10.html#ce10.3-multiple-linear-regression-method",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.3 Multiple Linear Regression method",
    "text": "CE10.3 Multiple Linear Regression method\n\ncondo_mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + \n                  AGE   + PROX_CBD + PROX_CHILDCARE + \n                  PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n                  PROX_HAWKER_MARKET    + PROX_KINDERGARTEN + \n                  PROX_MRT  + PROX_PARK + PROX_PRIMARY_SCH + \n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + \n                  PROX_SUPERMARKET + PROX_BUS_STOP + \n                  NO_Of_UNITS + FAMILY_FRIENDLY + \n                  FREEHOLD + LEASEHOLD_99YR, \n                data=condo_resale_sf)\nsummary(condo_mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD + \n    LEASEHOLD_99YR, data = condo_resale_sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3471036  -286903   -22426   239412 12254549 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           543071.4   136210.9   3.987 7.03e-05 ***\nAREA_SQM               12688.7      370.1  34.283  &lt; 2e-16 ***\nAGE                   -24566.0     2766.0  -8.881  &lt; 2e-16 ***\nPROX_CBD              -78122.0     6791.4 -11.503  &lt; 2e-16 ***\nPROX_CHILDCARE       -333219.0   111020.3  -3.001 0.002734 ** \nPROX_ELDERLYCARE      170950.0    42110.8   4.060 5.19e-05 ***\nPROX_URA_GROWTH_AREA   38507.6    12523.7   3.075 0.002147 ** \nPROX_HAWKER_MARKET     23801.2    29299.9   0.812 0.416739    \nPROX_KINDERGARTEN     144098.0    82738.7   1.742 0.081795 .  \nPROX_MRT             -322775.9    58528.1  -5.515 4.14e-08 ***\nPROX_PARK             564487.9    66563.0   8.481  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      186170.5    65515.2   2.842 0.004553 ** \nPROX_TOP_PRIMARY_SCH    -477.1    20598.0  -0.023 0.981525    \nPROX_SHOPPING_MALL   -207721.5    42855.5  -4.847 1.39e-06 ***\nPROX_SUPERMARKET      -48074.7    77145.3  -0.623 0.533273    \nPROX_BUS_STOP         675755.0   138552.0   4.877 1.20e-06 ***\nNO_Of_UNITS             -216.2       90.3  -2.394 0.016797 *  \nFAMILY_FRIENDLY       142128.3    47055.1   3.020 0.002569 ** \nFREEHOLD              300646.5    77296.5   3.890 0.000105 ***\nLEASEHOLD_99YR        -77137.4    77570.9  -0.994 0.320192    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1416 degrees of freedom\nMultiple R-squared:  0.652, Adjusted R-squared:  0.6474 \nF-statistic: 139.6 on 19 and 1416 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.4-tidy-linear-regression-report-with-ols",
    "href": "InClass/ICE10/ICE10.html#ce10.4-tidy-linear-regression-report-with-ols",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.4 Tidy linear regression report with OLS",
    "text": "CE10.4 Tidy linear regression report with OLS\n\nols_regress(condo_mlr)\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     750537.537 \nR-Squared                    0.652       MSE                571262902261.223 \nAdj. R-Squared               0.647       Coef. Var                    43.160 \nPred R-Squared               0.637       AIC                       42971.173 \nMAE                     412117.987       SBC                       43081.835 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.515738e+15          19        7.977571e+13    139.648    0.0000 \nResidual      8.089083e+14        1416    571262902261.223                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     543071.420    136210.918                   3.987    0.000     275874.535     810268.305 \n            AREA_SQM      12688.669       370.119        0.579     34.283    0.000      11962.627      13414.710 \n                 AGE     -24566.001      2766.041       -0.166     -8.881    0.000     -29991.980     -19140.022 \n            PROX_CBD     -78121.985      6791.377       -0.267    -11.503    0.000     -91444.227     -64799.744 \n      PROX_CHILDCARE    -333219.036    111020.303       -0.087     -3.001    0.003    -551000.984    -115437.089 \n    PROX_ELDERLYCARE     170949.961     42110.748        0.083      4.060    0.000      88343.803     253556.120 \nPROX_URA_GROWTH_AREA      38507.622     12523.661        0.059      3.075    0.002      13940.700      63074.545 \n  PROX_HAWKER_MARKET      23801.197     29299.923        0.019      0.812    0.417     -33674.725      81277.120 \n   PROX_KINDERGARTEN     144097.972     82738.669        0.030      1.742    0.082     -18205.570     306401.514 \n            PROX_MRT    -322775.874     58528.079       -0.123     -5.515    0.000    -437586.937    -207964.811 \n           PROX_PARK     564487.876     66563.011        0.148      8.481    0.000     433915.162     695060.590 \n    PROX_PRIMARY_SCH     186170.524     65515.193        0.072      2.842    0.005      57653.253     314687.795 \nPROX_TOP_PRIMARY_SCH       -477.073     20597.972       -0.001     -0.023    0.982     -40882.894      39928.747 \n  PROX_SHOPPING_MALL    -207721.520     42855.500       -0.109     -4.847    0.000    -291788.613    -123654.427 \n    PROX_SUPERMARKET     -48074.679     77145.257       -0.012     -0.623    0.533    -199405.956     103256.599 \n       PROX_BUS_STOP     675755.044    138551.991        0.133      4.877    0.000     403965.817     947544.272 \n         NO_Of_UNITS       -216.180        90.302       -0.046     -2.394    0.017       -393.320        -39.040 \n     FAMILY_FRIENDLY     142128.272     47055.082        0.056      3.020    0.003      49823.107     234433.438 \n            FREEHOLD     300646.543     77296.529        0.117      3.890    0.000     149018.525     452274.561 \n      LEASEHOLD_99YR     -77137.375     77570.869       -0.030     -0.994    0.320    -229303.551      75028.801 \n-----------------------------------------------------------------------------------------------------------------"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.5-stewpise-regression",
    "href": "InClass/ICE10/ICE10.html#ce10.5-stewpise-regression",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.5 Stewpise regression",
    "text": "CE10.5 Stewpise regression\nStepwise regression involves constructing a regression model by selecting independent variables step by step. It involves adding or removing potential explanatory variables in succession and testing for statistical significance after each iteration. Three methods are available: ols_step_forward_p, ols_step_backward_p, and ols_step_both_p.\n\nCE10.5.1 Forward stepwise\n\ncondo_fw_mlr &lt;- ols_step_forward_p(\n  condo_mlr,\n  p_val = 0.05,\n  details = FALSE)\ncondo_fw_mlr\n\n\n                                     Stepwise Summary                                      \n-----------------------------------------------------------------------------------------\nStep    Variable                   AIC          SBC         SBIC         R2       Adj. R2 \n-----------------------------------------------------------------------------------------\n 0      Base Model              44449.068    44459.608    40371.745    0.00000    0.00000 \n 1      AREA_SQM                43587.753    43603.562    39510.883    0.45184    0.45146 \n 2      PROX_CBD                43243.523    43264.602    39167.182    0.56928    0.56868 \n 3      PROX_PARK               43177.691    43204.039    39101.331    0.58915    0.58829 \n 4      FREEHOLD                43125.474    43157.092    39049.179    0.60438    0.60327 \n 5      AGE                     43069.222    43106.109    38993.167    0.62010    0.61878 \n 6      PROX_ELDERLYCARE        43046.515    43088.672    38970.548    0.62659    0.62502 \n 7      PROX_SHOPPING_MALL      43020.990    43068.417    38945.209    0.63367    0.63188 \n 8      PROX_URA_GROWTH_AREA    43009.092    43061.788    38933.407    0.63720    0.63517 \n 9      PROX_MRT                42999.058    43057.024    38923.483    0.64023    0.63796 \n 10     PROX_BUS_STOP           42984.951    43048.186    38909.582    0.64424    0.64175 \n 11     FAMILY_FRIENDLY         42981.085    43049.590    38905.797    0.64569    0.64296 \n 12     NO_Of_UNITS             42975.246    43049.021    38900.092    0.64762    0.64465 \n 13     PROX_CHILDCARE          42971.858    43050.902    38896.812    0.64894    0.64573 \n 14     PROX_PRIMARY_SCH        42966.758    43051.072    38891.872    0.65067    0.64723 \n-----------------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.591 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.591                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n-----------------------------------------------------------------------------------------------------------------\n\nplot(condo_fw_mlr)\n\n\n\n\n\n\n\n\n\n\nCE10.5.2 Backward stepwise\n\ncondo_bw_mlr &lt;- ols_step_backward_p(\n  condo_mlr,\n  p_val = 0.05,\n  details = FALSE)\ncondo_fw_mlr\n\n\n                                     Stepwise Summary                                      \n-----------------------------------------------------------------------------------------\nStep    Variable                   AIC          SBC         SBIC         R2       Adj. R2 \n-----------------------------------------------------------------------------------------\n 0      Base Model              44449.068    44459.608    40371.745    0.00000    0.00000 \n 1      AREA_SQM                43587.753    43603.562    39510.883    0.45184    0.45146 \n 2      PROX_CBD                43243.523    43264.602    39167.182    0.56928    0.56868 \n 3      PROX_PARK               43177.691    43204.039    39101.331    0.58915    0.58829 \n 4      FREEHOLD                43125.474    43157.092    39049.179    0.60438    0.60327 \n 5      AGE                     43069.222    43106.109    38993.167    0.62010    0.61878 \n 6      PROX_ELDERLYCARE        43046.515    43088.672    38970.548    0.62659    0.62502 \n 7      PROX_SHOPPING_MALL      43020.990    43068.417    38945.209    0.63367    0.63188 \n 8      PROX_URA_GROWTH_AREA    43009.092    43061.788    38933.407    0.63720    0.63517 \n 9      PROX_MRT                42999.058    43057.024    38923.483    0.64023    0.63796 \n 10     PROX_BUS_STOP           42984.951    43048.186    38909.582    0.64424    0.64175 \n 11     FAMILY_FRIENDLY         42981.085    43049.590    38905.797    0.64569    0.64296 \n 12     NO_Of_UNITS             42975.246    43049.021    38900.092    0.64762    0.64465 \n 13     PROX_CHILDCARE          42971.858    43050.902    38896.812    0.64894    0.64573 \n 14     PROX_PRIMARY_SCH        42966.758    43051.072    38891.872    0.65067    0.64723 \n-----------------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.591 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.591                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n-----------------------------------------------------------------------------------------------------------------\n\nplot(condo_fw_mlr)\n\n\n\n\n\n\n\n\n\n\nCE10.5.3 Stepwise\n\ncondo_sb_mlr &lt;- ols_step_both_p(\n  condo_mlr,\n  p_val = 0.05,\n  details = FALSE)\ncondo_sb_mlr\n\n\n                                       Stepwise Summary                                        \n---------------------------------------------------------------------------------------------\nStep    Variable                       AIC          SBC         SBIC         R2       Adj. R2 \n---------------------------------------------------------------------------------------------\n 0      Base Model                  44449.068    44459.608    40371.745    0.00000    0.00000 \n 1      AREA_SQM (+)                43587.753    43603.562    39510.883    0.45184    0.45146 \n 2      PROX_CBD (+)                43243.523    43264.602    39167.182    0.56928    0.56868 \n 3      PROX_PARK (+)               43177.691    43204.039    39101.331    0.58915    0.58829 \n 4      FREEHOLD (+)                43125.474    43157.092    39049.179    0.60438    0.60327 \n 5      AGE (+)                     43069.222    43106.109    38993.167    0.62010    0.61878 \n 6      PROX_ELDERLYCARE (+)        43046.515    43088.672    38970.548    0.62659    0.62502 \n 7      PROX_SHOPPING_MALL (+)      43020.990    43068.417    38945.209    0.63367    0.63188 \n 8      PROX_URA_GROWTH_AREA (+)    43009.092    43061.788    38933.407    0.63720    0.63517 \n 9      PROX_MRT (+)                42999.058    43057.024    38923.483    0.64023    0.63796 \n 10     PROX_BUS_STOP (+)           42984.951    43048.186    38909.582    0.64424    0.64175 \n 11     FAMILY_FRIENDLY (+)         42981.085    43049.590    38905.797    0.64569    0.64296 \n 12     NO_Of_UNITS (+)             42975.246    43049.021    38900.092    0.64762    0.64465 \n 13     PROX_CHILDCARE (+)          42971.858    43050.902    38896.812    0.64894    0.64573 \n 14     PROX_PRIMARY_SCH (+)        42966.758    43051.072    38891.872    0.65067    0.64723 \n 15     PROX_KINDERGARTEN (+)       42965.558    43055.141    38890.764    0.65145    0.64777 \n---------------------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751161.087 \nR-Squared                    0.651       MSE                570600646491.086 \nAdj. R-Squared               0.648       Coef. Var                    43.135 \nPred R-Squared               0.638       AIC                       42965.558 \nMAE                     413583.799       SBC                       43055.141 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.514394e+15          15        1.009596e+14    176.936    0.0000 \nResidual      8.102529e+14        1420    570600646491.086                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     459826.675    114616.014                   4.012    0.000     234991.777     684661.574 \n            AREA_SQM      12720.174       368.610        0.581     34.509    0.000      11997.096      13443.252 \n            PROX_CBD     -75676.065      5816.474       -0.258    -13.011    0.000     -87085.870     -64266.259 \n           PROX_PARK     575749.528     65523.382        0.151      8.787    0.000     447216.504     704282.552 \n            FREEHOLD     360203.286     48768.851        0.140      7.386    0.000     264536.552     455870.021 \n                 AGE     -24697.719      2752.751       -0.167     -8.972    0.000     -30097.615     -19297.824 \n    PROX_ELDERLYCARE     182435.081     39910.469        0.088      4.571    0.000     104145.268     260724.893 \n  PROX_SHOPPING_MALL    -224513.955     36588.872       -0.117     -6.136    0.000    -296288.004    -152739.906 \nPROX_URA_GROWTH_AREA      40145.474     11758.824        0.062      3.414    0.001      17078.942      63212.007 \n            PROX_MRT    -311753.202     57670.032       -0.119     -5.406    0.000    -424880.814    -198625.590 \n       PROX_BUS_STOP     711858.014    135420.040        0.140      5.257    0.000     446213.188     977502.840 \n     FAMILY_FRIENDLY     144034.218     46874.683        0.057      3.073    0.002      52083.153     235985.283 \n         NO_Of_UNITS       -236.270        88.032       -0.051     -2.684    0.007       -408.956        -63.583 \n      PROX_CHILDCARE    -336118.857    108331.761       -0.088     -3.103    0.002    -548626.339    -123611.374 \n    PROX_PRIMARY_SCH     162183.897     60202.895        0.063      2.694    0.007      44087.730     280280.063 \n   PROX_KINDERGARTEN     141915.768     79726.155        0.029      1.780    0.075     -14477.927     298309.464 \n-----------------------------------------------------------------------------------------------------------------"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.6-comparing-performance",
    "href": "InClass/ICE10/ICE10.html#ce10.6-comparing-performance",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.6 Comparing performance",
    "text": "CE10.6 Comparing performance\n\nmetric &lt;- compare_performance(condo_mlr, \n                    condo_fw_mlr$model,\n                    condo_bw_mlr$model,\n                    condo_sb_mlr$model)\n\nmetric$Name &lt;- gsub(\".*\\\\\\\\([a-zA-Z0-9_]+)\\\\\\\\, \\\\\\\\model\\\\\\\\.*\", \"\\\\1\", metric$Name)"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.7-visualising-model-parameters",
    "href": "InClass/ICE10/ICE10.html#ce10.7-visualising-model-parameters",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.7 Visualising model parameters",
    "text": "CE10.7 Visualising model parameters\n\nggcoefstats(condo_sb_mlr$model,\n            sort = \"ascending\")\n\nNumber of labels is greater than default palette color count.\n• Select another color `palette` (and/or `package`)."
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.8-checking-for-multilinearity",
    "href": "InClass/ICE10/ICE10.html#ce10.8-checking-for-multilinearity",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.8 Checking for multilinearity",
    "text": "CE10.8 Checking for multilinearity\n\ncheck_collinearity(condo_sb_mlr$model)\n\n# Check for Multicollinearity\n\nLow Correlation\n\n                 Term  VIF   VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n             AREA_SQM 1.15 [1.10, 1.24]         1.07      0.87     [0.81, 0.91]\n             PROX_CBD 1.60 [1.50, 1.73]         1.27      0.62     [0.58, 0.67]\n            PROX_PARK 1.21 [1.15, 1.30]         1.10      0.83     [0.77, 0.87]\n             FREEHOLD 1.46 [1.37, 1.57]         1.21      0.68     [0.64, 0.73]\n                  AGE 1.41 [1.33, 1.52]         1.19      0.71     [0.66, 0.75]\n     PROX_ELDERLYCARE 1.52 [1.42, 1.63]         1.23      0.66     [0.61, 0.70]\n   PROX_SHOPPING_MALL 1.49 [1.40, 1.60]         1.22      0.67     [0.62, 0.72]\n PROX_URA_GROWTH_AREA 1.33 [1.26, 1.43]         1.16      0.75     [0.70, 0.79]\n             PROX_MRT 1.96 [1.83, 2.13]         1.40      0.51     [0.47, 0.55]\n        PROX_BUS_STOP 2.89 [2.66, 3.15]         1.70      0.35     [0.32, 0.38]\n      FAMILY_FRIENDLY 1.38 [1.30, 1.48]         1.18      0.72     [0.67, 0.77]\n          NO_Of_UNITS 1.45 [1.37, 1.56]         1.21      0.69     [0.64, 0.73]\n       PROX_CHILDCARE 3.29 [3.02, 3.59]         1.81      0.30     [0.28, 0.33]\n     PROX_PRIMARY_SCH 2.21 [2.05, 2.40]         1.49      0.45     [0.42, 0.49]\n    PROX_KINDERGARTEN 1.11 [1.06, 1.20]         1.05      0.90     [0.84, 0.94]\n\nplot(check_collinearity(condo_sb_mlr$model)) +\n  theme(axis.text.x = element_text(\n    angle = 45, hjust = 1))\n\nVariable `Component` is not in your data frame :/"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.9-linearity-assumption-test",
    "href": "InClass/ICE10/ICE10.html#ce10.9-linearity-assumption-test",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.9 Linearity assumption test",
    "text": "CE10.9 Linearity assumption test\n\nout &lt;- plot(check_model(condo_sb_mlr$model, \n                        panel = FALSE))\n\nFor confidence bands, please install `qqplotr`.\n\nout[[2]]"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.10-normality-assumption-test",
    "href": "InClass/ICE10/ICE10.html#ce10.10-normality-assumption-test",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.10 Normality assumption test",
    "text": "CE10.10 Normality assumption test\n\nplot(check_normality(condo_sb_mlr$model))\n\nFor confidence bands, please install `qqplotr`."
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.11-checking-of-outliers",
    "href": "InClass/ICE10/ICE10.html#ce10.11-checking-of-outliers",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.11 Checking of outliers",
    "text": "CE10.11 Checking of outliers\n\noutliers &lt;- check_outliers(condo_sb_mlr$model,\n                           method = \"cook\")\noutliers\n\nOK: No outliers detected.\n- Based on the following method and threshold: cook (1).\n- For variable: (Whole model)"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.12-visualising-spatial-non-stationary",
    "href": "InClass/ICE10/ICE10.html#ce10.12-visualising-spatial-non-stationary",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.12 Visualising spatial non-stationary",
    "text": "CE10.12 Visualising spatial non-stationary\n\nmlr_output &lt;- as.data.frame(condo_fw_mlr$model$residuals) %&gt;%\n  rename(`FW_MLR_RES` = `condo_fw_mlr$model$residuals`)\n\ncondo_resale_sf &lt;- cbind(condo_resale_sf, \n                        mlr_output$FW_MLR_RES) %&gt;%\n  rename(`MLR_RES` = `mlr_output.FW_MLR_RES`)\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(mpsz)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale_sf) +  \n  tm_dots(col = \"MLR_RES\",\n          alpha = 0.6,\n          style=\"quantile\") \n\nWarning: The shape mpsz is invalid (after reprojection). See sf::st_is_valid\n\n\nVariable(s) \"MLR_RES\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting"
  },
  {
    "objectID": "InClass/ICE10/ICE10.html#ce10.13-spatial-stationary-test-morans-i",
    "href": "InClass/ICE10/ICE10.html#ce10.13-spatial-stationary-test-morans-i",
    "title": "CE10: Geographically Weighted Regression",
    "section": "CE10.13 Spatial stationary test (Moran’s I)",
    "text": "CE10.13 Spatial stationary test (Moran’s I)\n\ncondo_resale_sf &lt;- condo_resale_sf %&gt;%\n  mutate(nb = st_knn(geometry, k=6,\n                     longlat = FALSE),\n         wt = st_weights(nb,\n                         style = \"W\"),\n         .before = 1)\n\nglobal_moran_perm(condo_resale_sf$MLR_RES, \n                  condo_resale_sf$nb, \n                  condo_resale_sf$wt, \n                  alternative = \"two.sided\", \n                  nsim = 99)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 100 \n\nstatistic = 0.32254, observed rank = 100, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided"
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html",
    "href": "TakeHome/TakeHome3/take-home-3.html",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "",
    "text": "The objective of Take-Home Exercise 3 is to prototype a module to be built for the Geospatial Analytics project, which will serve to analyse housing prices in Johor Bahru.\nSince separating from Malaysia in 1965, Singapore has seen a rapid development in its economy and quality of life the likes of which no one else has seen. So it made sense for the neighbouring city of Johor Bahru, Malaysia, to capitalise on the spillover effects of Singapore’s prosperity by itself becoming a lifestyle hub for visiting Singaporeans, and an emerging business satellite for companies from Singapore and the region. New malls have sprouted all over the state capital, and new investments were made by the state and federal governments to boost the city’s economy, such as the development areas of Iskandar Puteri and Pasir Gudang, the Johor Bahru-Singapore rapid transit link and the Iskandar Puteri stop on the since-shelved Kuala Lumpur-Singapore High Speed Rail, among many others. In particular, Johor Bahru became a place where Singaporeans could buy houses at prices cheaper than in their hometown - even more so when housing prices in the country began to fly through the roof in recent times. Even while this phenomenon led to further economic growth, there were concerns that the presence of these Singaporean buyers would put inflationary pressure on the city.\nAdmist all this, this project aims to explore the trajectory and factors influencing housing prices in Johor Bahru. Using the measures of local and global spatial autocorrelation and a hedonic pricing model, we will perform geospatial data analysis on property transaction data in Johor Bahru and its northwestern neighbour Kulai. As the group member in charge of exploratory data analysis, this take-home exercise serves to prototype the module for displaying the measures of spatial correlation, including Local Moran’s I, LISA and the Gertis-Ord \\(G^*_i\\) statistics. In addition, geocoding and simple feature engineering tasks will be performed to ensure the dataset is ready for machine learning use going forward.\nThe scope of today’s exercise will be as follows:\n\nLoad and clean the geospatial and aspatial data required for the analysis\nGeocode the aspatial property transaction data\nPrepare the aspatial data for machine learning by performing simple feature engineering tasks\nCreate a hexagonal grid of the study area prior to performing analysis\nPerform exploratory data analysis\nDerive the local measures of spatial autocorrelation, and perform hot/cold spot analysis\n\nScreenshots from the Shiny UI corresponding to each step will be displayed as it is performed in this exercise.\n\npacman::p_load(olsrr, ggstatsplot, sf, tmap, tidyverse, gtsummary, performance, see, sfdep, spdep, tidygeocoder)"
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.1-introduction",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.1-introduction",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "",
    "text": "The objective of Take-Home Exercise 3 is to prototype a module to be built for the Geospatial Analytics project, which will serve to analyse housing prices in Johor Bahru.\nSince separating from Malaysia in 1965, Singapore has seen a rapid development in its economy and quality of life the likes of which no one else has seen. So it made sense for the neighbouring city of Johor Bahru, Malaysia, to capitalise on the spillover effects of Singapore’s prosperity by itself becoming a lifestyle hub for visiting Singaporeans, and an emerging business satellite for companies from Singapore and the region. New malls have sprouted all over the state capital, and new investments were made by the state and federal governments to boost the city’s economy, such as the development areas of Iskandar Puteri and Pasir Gudang, the Johor Bahru-Singapore rapid transit link and the Iskandar Puteri stop on the since-shelved Kuala Lumpur-Singapore High Speed Rail, among many others. In particular, Johor Bahru became a place where Singaporeans could buy houses at prices cheaper than in their hometown - even more so when housing prices in the country began to fly through the roof in recent times. Even while this phenomenon led to further economic growth, there were concerns that the presence of these Singaporean buyers would put inflationary pressure on the city.\nAdmist all this, this project aims to explore the trajectory and factors influencing housing prices in Johor Bahru. Using the measures of local and global spatial autocorrelation and a hedonic pricing model, we will perform geospatial data analysis on property transaction data in Johor Bahru and its northwestern neighbour Kulai. As the group member in charge of exploratory data analysis, this take-home exercise serves to prototype the module for displaying the measures of spatial correlation, including Local Moran’s I, LISA and the Gertis-Ord \\(G^*_i\\) statistics. In addition, geocoding and simple feature engineering tasks will be performed to ensure the dataset is ready for machine learning use going forward.\nThe scope of today’s exercise will be as follows:\n\nLoad and clean the geospatial and aspatial data required for the analysis\nGeocode the aspatial property transaction data\nPrepare the aspatial data for machine learning by performing simple feature engineering tasks\nCreate a hexagonal grid of the study area prior to performing analysis\nPerform exploratory data analysis\nDerive the local measures of spatial autocorrelation, and perform hot/cold spot analysis\n\nScreenshots from the Shiny UI corresponding to each step will be displayed as it is performed in this exercise.\n\npacman::p_load(olsrr, ggstatsplot, sf, tmap, tidyverse, gtsummary, performance, see, sfdep, spdep, tidygeocoder)"
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.2-overview",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.2-overview",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.2 Overview",
    "text": "TH3.2 Overview\n\nTH3.2.1 Geographically weighted regression\n\n\nTH3.2.2 Public housing in Singapore"
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.2-loading-data",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.2-loading-data",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.2 Loading data",
    "text": "TH3.2 Loading data\nToday’s exercise will involve going through the entire data acquisition process from start to finish. This includes sourcing and cleaning the data before it is used for analysis.\n\nTH3.2.1 Loading geospatial data\nWe will be using Malaysia’s municipality polygons, sourced from the United Nations Humanitarian Data Exchange.\n\nadm3_my &lt;- st_read(dsn = 'shiny/data/geospatial/myadm3', layer = 'geoBoundaries-MYS-ADM3') %&gt;% \n  st_transform(3377)\n\nReading layer `geoBoundaries-MYS-ADM3' from data source \n  `/Users/kendricktty/Gits/smu_cs/is415-site/TakeHome/TakeHome3/shiny/data/geospatial/myadm3' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1859 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 98.93646 ymin: 0.8538234 xmax: 115.6782 ymax: 6.726112\nGeodetic CRS:  WGS 84\n\nqtm(adm3_my)\n\n\n\n\n\n\n\n\nThe overall shape of the plot is as above, corresponding to the geography of Peninsula (West) Malaysia, as well as the eastern states of Sabah and Sarawak.\n\n\nTH3.2.2 Loading property transaction data\n\nproperty_transaction_data &lt;- read_csv('shiny/data/aspatial/Open Transaction Data.csv')\n\nNew names:\nRows: 20517 Columns: 14\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(12): Property Type, District, Mukim, Scheme Name/Area, Road Name, Month... num\n(1): Land/Parcel Area lgl (1): ...14\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `Unit` -&gt; `Unit...9`\n• `Unit` -&gt; `Unit...11`\n• `` -&gt; `...14`\n\nhead(property_transaction_data)\n\n# A tibble: 6 × 14\n  `Property Type`                District   Mukim `Scheme Name/Area` `Road Name`\n  &lt;chr&gt;                          &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;              &lt;chr&gt;      \n1 1 - 1 1/2 Storey Semi-Detached Johor Bah… Band… KAW ABDUL SAMAD/M… JLN ISMAIL \n2 1 - 1 1/2 Storey Semi-Detached Johor Bah… Band… KAW ABDUL SAMAD/M… JLN ABDUL …\n3 1 - 1 1/2 Storey Semi-Detached Johor Bah… Band… KAW ABDUL SAMAD/M… JLN YUSOF …\n4 1 - 1 1/2 Storey Semi-Detached Johor Bah… Band… KIM TENG PARK      JLN BERLIAN\n5 1 - 1 1/2 Storey Semi-Detached Johor Bah… Band… KIM TENG PARK      JLN UNGKU …\n6 1 - 1 1/2 Storey Semi-Detached Johor Bah… Band… LARKIN GARDEN      JLN DATO J…\n# ℹ 9 more variables: `Month, Year of Transaction Date` &lt;chr&gt;, Tenure &lt;chr&gt;,\n#   `Land/Parcel Area` &lt;dbl&gt;, Unit...9 &lt;chr&gt;, `Main Floor Area` &lt;chr&gt;,\n#   Unit...11 &lt;chr&gt;, `Unit Level` &lt;chr&gt;, `Transaction Price` &lt;chr&gt;, ...14 &lt;lgl&gt;"
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.3-data-preprocessing",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.3-data-preprocessing",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.3 Data Preprocessing",
    "text": "TH3.3 Data Preprocessing\n\nTH3.3.1 Filtering out Mukims outside Johor Bahru\nWe are only concerned with Mukims within Johor Bahru and Kulai district - the latter of which contains Johor Bahru’s main Senai international airport. Anything else will need to be filtered out.\n\njohor_kulai_mukims &lt;- c(\"MUKIM JELUTONG\", \"MUKIM PLENTONG\", \"MUKIM PULAI\", \"MUKIM SUNGAI TIRAM\", \"MUKIM TANJUNG KUPANG\", \"MUKIM TEBRAU\", \"BANDAR JOHOR BAHRU\", \"MUKIM BUKIT BATU\", \"MUKIM KULAI\", \"BANDAR KULAI\", \"MUKIM SEDENAK\", \"MUKIM SENAI\")\nadm3_jb_kulai &lt;- adm3_my %&gt;%\n  filter(shapeName %in% johor_kulai_mukims)\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(adm3_jb_kulai) +\n  tm_polygons()\n\n\n\n\n\nAs we can see, there are still some stray polygons located very far north from Johor Bahru and Kulai proper that we have to remove. A quick inspection of the dataframe in memory indicates they are associated with the Mukims of Pulai and Jelutong, and carry the IDs 4, 5, 6, 16.\nThe code chunk below will break up the multipolygons into simple polygons, and remove the strays. The result is the correct, contiguous borders of the Mukims in Johor Bahru and Kulai districts.\n\nbroken_up_jb &lt;- adm3_jb_kulai %&gt;%\n  st_cast(\"POLYGON\")\n\nWarning in st_cast.sf(., \"POLYGON\"): repeating attributes for all\nsub-geometries for which they may not be constant\n\nstray_polygons &lt;- c(4, 5, 6, 16)\nadm3_jb_kulai &lt;- broken_up_jb %&gt;%\n  filter(!row_number() %in% stray_polygons)\n\ntm_shape(adm3_jb_kulai) +\n  tm_polygons() +\n  tm_basemap(\"OpenStreetMap\")\n\n\n\n\nwrite_rds(adm3_jb_kulai, 'shiny/data/rds/adm3_jb_kulai.rds')\n\n\n\nTH3.3.2 Geocoding Property Data\nThe raw dataset encodes information about street names, but we need latitudes and longitudes to plot their locations on a map. Therefore, it would be necessary to geocode the data. A dataset as large as ours took at least 2 hours to geocode, so it would be useful to save it as an RDS for later.\n\nproperty_transaction_sf &lt;- property_transaction_data %&gt;%\n  mutate(Address = if_else(\n    !is.na(`Road Name`),\n    paste(`Road Name`, District, sep = \" \"),          # Concatenate \"Road Name\" and \"District\" if \"Road Name\" is not NA\n    paste(`Scheme Name/Area`, District, sep = \" \")    # Else, concatenate \"Scheme Name/Area\" and \"District\"\n  )) %&gt;%\n  geocode(address = Address, method = \"osm\", lat = \"latitude\", long = \"longitude\")\n\nwrite_rds(property_transaction_sf, \"shiny/data/rds/property_transaction_sf.rds\")\n\nI learned the hard way to encode all longitudes and latitudes with WGS 84 first before transforming it into my desired coordinate system.\n\nproperty &lt;- read_rds(\"shiny/data/rds/property_transaction_sf_notnull.rds\") %&gt;%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %&gt;% st_transform(3377)\n\n\n\nTH3.3.3 Simple Feature Engineering\nFinally, to make our dataset compatible for machine learning use, we need to engineer features based on the two categorical variables we want to ingest: the Property Type and tenure.\nSince Property Type is multiclass categorical, we need to perform one-hot encoding. The following code chunk performs one-hot encoding on the Property Type feature.\n\ndummies &lt;- model.matrix(~ `Property Type` - 1, data = property) %&gt;% as.data.frame()\ncolnames(dummies) &lt;- gsub(\"Property Type\", \"\", colnames(dummies))\nproperty &lt;- property %&gt;%\n  bind_cols(dummies)\n\nSince Tenure is binary categorical (the property is either freehold or leasehold), we can perform binary encoding on this feature.\n\nproperty &lt;- property %&gt;%\n  mutate(is_leasehold = ifelse(Tenure == \"Leasehold\", 1, 0))\n\nFinally, to help us join the property data with our polygon data later, we need to modify the “Mukim” column in the property data column to match that in the polygon data column.\n\nproperty &lt;- property %&gt;%\n  mutate(Mukim = if_else(\n    !startsWith(Mukim, \"Bandar\"),\n    paste(\"Mukim\", Mukim),\n    Mukim\n  )) %&gt;%\n  mutate(Mukim = toupper(Mukim))\n\nWe also need to parse the number in the Transaction Price column and convert the price from Malaysian Ringgit to US dollars. Following this, we will save the dataset we have as an RDS file so that the human-readable data is accessible to the Shiny server.\n\nproperty &lt;- property %&gt;%\n  mutate(\n    `Price_MYR` = parse_number(`Transaction Price`),\n    `Price_SGD` = `Price_MYR` * 0.3333333,\n    `Price_USD` = `Price_MYR` * 0.21\n  ) %&gt;%\n  select(-`Transaction Price`)\n\nwrite_rds(property, \"shiny/data/rds/property_preprocessed.rds\")\n\nThe last step is to remove the columns we will not need.\n\nproperty &lt;- property %&gt;%\n  select(-`Property Type`, -`District`, -`Road Name`, -`Month, Year of Transaction Date`, -`Tenure`, -`Unit...9`, -`Unit...11`, -`Unit Level`, -`Address`, -`...14`)\n\nTo visualise the results, we can now plot our work onto a map.\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(adm3_jb_kulai)+\n  tm_polygons(alpha = 0.3) +\ntm_shape(property) +  \n  tm_dots(col = \"Price_USD\",\n          alpha = 0.6,\n          style=\"kmeans\",\n          palette = \"Purples\",\n          n = 10) +\n  tm_view(set.zoom.limits = c(11,14)) +\n  tm_basemap('OpenStreetMap')\n\n\n\n\n\nThe basemap will be the first thing a user sees when they visit the project website. Future functionality to be implemented will include a colour scheme customisation and currency customisation, where the property prices can be displayed in either Malaysian ringgit, Singapore dollars or US dollars.\n\n\n\nThe basemap as it would appear in a Shiny UI."
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.4-preparing-for-hotcold-spot-analysis",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.4-preparing-for-hotcold-spot-analysis",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.4 Preparing for hot/cold spot analysis",
    "text": "TH3.4 Preparing for hot/cold spot analysis\n\nTH3.4.1 Creating spatial grids\nJohor Bahru is a relatively less dense location than Singapore to its south, so directly performing hot/cold spot analysis on its smaller number of Mukims would not make much sense. Instead, we will create a spatial grid subdividing the area into hexagons of equal diameter, and count the price of property sales located within each zone. The result is a hexagonal grid spanning the districts of Johor Bahru and Kulai, as shown below.\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\njb_kulai_hex &lt;- st_make_grid(adm3_jb_kulai, cellsize = c(750, 750), what = \"polygons\", square = FALSE) %&gt;%\n  st_sf() %&gt;%\n  mutate(index = as.factor(row_number()))\n\njb_kulai_border &lt;- adm3_jb_kulai %&gt;% st_union()\njb_kulai_grid &lt;- st_intersection(jb_kulai_hex, jb_kulai_border)\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n# Check if hex grid intersects any polygons using st_intersects\n# Returns a list of intersecting hexagons\nintersection_list = jb_kulai_hex$index[lengths(st_intersects(jb_kulai_hex, jb_kulai_grid)) &gt; 0]\n\n# Filter for the intersecting hexagons\njb_kulai_grid = jb_kulai_hex %&gt;%\n  filter(index %in% intersection_list)\n\ntm_shape(jb_kulai_grid) +\n  tm_polygons(alpha = 0.2)\n\n\n\n\n\n\n\n\n\njoined &lt;- st_join(jb_kulai_hex, adm3_jb_kulai, join = st_intersects, left = FALSE)\naggregated &lt;- joined %&gt;%\n  group_by(index) %&gt;%\n  summarise(`Mukim` = first(`shapeName`))\n\njb_kulai_grid$Mukim &lt;- aggregated$Mukim\njb_kulai_grid &lt;- jb_kulai_grid %&gt;%\n  mutate(index = as.factor(row_number()))\n\njb_kulai_grid &lt;- jb_kulai_grid[, c(\"Mukim\", setdiff(names(jb_kulai_grid), \"Mukim\"))]\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(jb_kulai_grid) +\n  tm_fill(col = \"Mukim\",\n          alpha = 0.7)+\n  tm_basemap(\"OpenStreetMap\")\n\n\n\n\n\n\n\nTH3.4.2 Exploratory Data Analysis\nWith our hexagonal grid, we can now perform exploratory data analysis. Using st_intersects allows us to map each point to a cell in the hexagonal grid.\n\nintersections &lt;- st_intersects(jb_kulai_grid, property)\njb_kulai_grid$density &lt;- lengths(intersections)\ntmap_mode('plot')\n\ntmap mode set to plotting\n\ntm_shape(jb_kulai_grid) + \n  tm_fill(col = \"density\",\n          palette = \"Purples\",\n          style = \"quantile\",\n          n = 10,\n          title = \"Property density\"\n          ) +\n  tm_borders(col = \"grey\") +\n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\n\n\n\n\n\n\n\n\nThe following code chunk allows us to aggregate the average, median and maximum property prices within each hexagonal cell.\n\n# Extract average and maximum property price for each cell\naggregate_price &lt;- function(i, method = \"median\") {\n  if (length(i) == 0 || all(is.na(property$`Transaction Price`[i]))) return(0)\n  \n  if (method == \"mean\") {\n    return(mean(property$`Transaction Price`[i], na.rm = TRUE))\n  } else if (method == \"max\") {\n    return(mean(property$`Transaction Price`[i], na.rm = TRUE))\n  } else if (method == \"median\") {\n    return(median(property$`Transaction Price`[i], na.rm = TRUE))\n  } else {\n    stop(\"Invalid method: Choose either 'mean' or 'max'.\")\n  }\n}\n\navg_prices &lt;- sapply(intersections, aggregate_price, method = \"mean\")\njb_kulai_grid$avg_price &lt;- avg_prices\n\nmedian_prices &lt;- sapply(intersections, aggregate_price, method = \"median\")\njb_kulai_grid$median_price &lt;- median_prices\n\nmax_prices &lt;- sapply(intersections, aggregate_price, method = \"max\")\njb_kulai_grid$max_price &lt;- max_prices\n\n# sectors &lt;- sapply(intersections, function(i) {\n#   if (length(i) == 0) return(NA)\n#   \n#   # Get the Scheme Name/Area values for the properties within the grid cell\n#   schemes &lt;- property$`Scheme Name/Area`[i]\n#   \n#   # Find the most frequent scheme name\n#   most_frequent &lt;- sort(table(schemes), decreasing = TRUE)\n#   most_common_scheme &lt;- names(most_frequent)[1]\n#   \n#   return(most_common_scheme)\n# })\n# jb_kulai_grid$sector &lt;- sectors\n\n\n#|eval: False\nwrite_rds(jb_kulai_grid, \"shiny/data/rds/jb_kulai_grid.rds\")\n\nWith these values calculated, we can plot them, along with our hexagonal grid, onto a map.\n\nmedians_map &lt;- tm_shape(jb_kulai_grid) + \n  tm_fill(col = \"median_price\",\n          palette = \"YlGn\",\n          style = \"kmeans\",\n          n = 10,\n          title = \"Median Property Price\"\n          ) +\n  tm_borders(col = \"grey\") +\n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\n\naverages_map &lt;- tm_shape(jb_kulai_grid) + \n  tm_fill(col = \"avg_price\",\n          palette = \"Purples\",\n          style = \"kmeans\",\n          n = 10,\n          title = \"Average Property Price\"\n          ) +\n  tm_borders(col = \"grey\") +\n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\n\nmaximums_map &lt;- tm_shape(jb_kulai_grid) + \n  tm_fill(col = \"max_price\",\n          palette = \"YlOrRd\",\n          style = \"kmeans\",\n          n = 10,\n          title = \"Median Property Price\"\n          ) +\n  tm_borders(col = \"grey\") +\n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\n\ntmap_arrange(medians_map, averages_map, maximums_map, ncol = 3)\n\nSome legend labels were too wide. These labels have been resized to 0.47, 0.47, 0.44, 0.41, 0.41, 0.41, 0.41, 0.41, 0.41. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\nSome legend labels were too wide. These labels have been resized to 0.47, 0.47, 0.44, 0.41, 0.41, 0.41, 0.41, 0.41, 0.41. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\nSome legend labels were too wide. These labels have been resized to 0.47, 0.47, 0.44, 0.41, 0.41, 0.41, 0.41, 0.41, 0.41. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\n\n# Plot the medians onto an interactive OpenStreetMap\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\nmedians_map +\n  tm_basemap('OpenStreetMap')\n\nlegend.postion is used for plot mode. Use view.legend.position in tm_view to set the legend position in view mode.\n\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\nThe highest median property prices in the study area appear clustered towards the centre of town (Bandar Johor Bahru), or towards Iskandar Puteri (within Pulai) towards the West. Notice their proximity to the two land border crossings with Singapore: the JB Sentral-Woodlands crossing (the causeway) connects with Bandar Johor Bahru, while the Tanjung Kupang-Tuas crossing (the second link) is towards the west - near Pulai. Pasir Gudang to the east (within Plentong) is the most recent area in Johor Bahru to be prominently industrialised, but the residential properties there do not fetch nearly as high a price - indicating a relative lack of demand.\nAs for Kulai, areas with higher median property prices appear clustered towards Bandar Kulai, or Senai - the location of Johor’s international airport and a major industrial hub.\nIn the Shiny application, the hexagonal map will be overlayed on an OpenStreetMap view of Johor Bahru and Kulai. It will be possible to adjust the transparency of the grid, along with the colour scheme, classification method, and whether to display the average, median or maximum property prices within a grid cell.\n\n\n\nWhen ported to the Shiny application, it will be possible to toggle between average, median or maximum property prices within a grid cell."
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.5-computing-local-morans-i",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.5-computing-local-morans-i",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.5 Computing Local Moran’s I",
    "text": "TH3.5 Computing Local Moran’s I\nWith exploratory data analysis complete, we can proceed to compute the measures of local spatial autocorrelation. We will first derive the local Moran’s I values for the median property price values with the following code chunk.\n\n# Compute queen contiguity weights - no need to account for islands\nwm_q &lt;- poly2nb(jb_kulai_grid, queen=TRUE)\nrswm_q &lt;- nb2listw(wm_q, style = \"W\", zero.policy = TRUE)\n\n# Compute local Moran's I\nfips &lt;- order(jb_kulai_grid$index)\nlocalMI &lt;- localmoran(jb_kulai_grid$median_price, rswm_q)\n\n\nTH3.5.1 Mapping Local Moran’s I\n\njb_kulai.localMI &lt;- cbind(jb_kulai_grid, localMI) %&gt;%\n  rename(Pr.Ii = Pr.z....E.Ii..)\n\nlocalMI_map &lt;- tm_shape(jb_kulai.localMI) + \n    tm_fill(col = \"Ii\",\n          style = \"pretty\",\n          palette = \"YlGn\",\n          n = 7,\n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\np_values &lt;- tm_shape(jb_kulai.localMI) +\n    tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-RdBu\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(localMI_map, p_values, asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\n\n\nTH3.5.2 Creating LISA cluster map\n\nquadrant &lt;- vector(mode = \"numeric\", length = nrow(localMI))\njb_kulai_grid$lag &lt;- lag.listw(rswm_q, jb_kulai_grid$median_price)\nDV &lt;- jb_kulai_grid$lag - mean(jb_kulai_grid$median_price)\nLM_I &lt;- localMI[,1] - mean(localMI[, 1])\nsignif &lt;- 0.05\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4\nquadrant[localMI[,5]&gt;signif] &lt;- 0\njb_kulai.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#fdae61\", \"#abd9e9\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\n\ncluster_map &lt;- tm_shape(jb_kulai.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\ntmap_arrange(medians_map, cluster_map, asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\nIn the Shiny app, it will be possible to calculate the local Moran’s I and LISA cluster map for the average, median or maximum property price statistics, and display them as an overlay on an OpenStreetMap view of Johor Bahru and Kulai. It will also be possible to customise parameters such as the contiguity method (queen or rook), Lisa classification or derivative statistics - including p-values.\n\n\n\nParameters and input data are customisable in the Shiny app."
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.6-hot-and-cold-spot-analysis",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.6-hot-and-cold-spot-analysis",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.6 Hot and Cold Spot Analysis",
    "text": "TH3.6 Hot and Cold Spot Analysis\nThe next local indicator of spatial autocorrelation to explore is hot and cold spot analysis with Gertis and Ord’s G-statistics, or \\(G^*_i\\) statistics.\n\n# Compute distance weight matrix\njb_kulai_wgs &lt;- jb_kulai_grid %&gt;% st_transform(4326)\nlongitude &lt;- map_dbl(jb_kulai_wgs$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(jb_kulai_wgs$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Compute adaptive distance weight matrix\nknn &lt;- knn2nb(knearneigh(coords, k = 8))\nknn_lw &lt;- nb2listw(knn, style = \"B\")\n# Compute Gi* statistics\ngi &lt;- localG(jb_kulai_wgs$median_price, knn_lw)\njb_kulai.gi &lt;- cbind(jb_kulai_wgs, as.matrix(gi)) %&gt;% rename(gstat = as.matrix.gi.)\n\n\ngi_map &lt;- tm_shape(jb_kulai.gi) + \n  tm_fill(\n    col = \"gstat\", \n    palette = \"-RdBu\", \n    title = \"drug_use local Gi\",\n    breaks = seq(from = -10, to = 10, by = 2)\n  ) + \n  tm_borders(alpha = 0.5) + \n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\ntmap_arrange(medians_map, gi_map)\n\nVariable(s) \"gstat\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\nVariable(s) \"gstat\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.7-hot-and-cold-spot-analysis",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.7-hot-and-cold-spot-analysis",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.7 Hot and Cold Spot Analysis",
    "text": "TH3.7 Hot and Cold Spot Analysis\nThe next local indicator of spatial autocorrelation to explore is hot and cold spot analysis with Gertis and Ord’s G-statistics, or \\(G^*_i\\) statistics.\n\n# Compute distance weight matrix\njb_kulai_wgs &lt;- jb_kulai_grid %&gt;% st_transform(4326)\nlongitude &lt;- map_dbl(jb_kulai_wgs$geometry, ~st_centroid(.x)[[1]])\nlatitude &lt;- map_dbl(jb_kulai_wgs$geometry, ~st_centroid(.x)[[2]])\ncoords &lt;- cbind(longitude, latitude)\n# Compute adaptive distance weight matrix\nknn &lt;- knn2nb(knearneigh(coords, k = 8))\nknn_lw &lt;- nb2listw(knn, style = \"B\")\n# Compute Gi* statistics\ngi &lt;- localG(jb_kulai_wgs$median_price, knn_lw)\njb_kulai.gi &lt;- cbind(jb_kulai_wgs, as.matrix(gi)) %&gt;% rename(gstat = as.matrix.gi.)\n\n\ngi_map &lt;- tm_shape(jb_kulai.gi) + \n  tm_fill(\n    col = \"gstat\", \n    palette = \"-RdBu\", \n    title = \"Local Gi\",\n    breaks = seq(from = -10, to = 10, by = 2)\n  ) + \n  tm_borders(alpha = 0.5) + \n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\ntmap_arrange(medians_map, gi_map)\n\nVariable(s) \"gstat\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\nVariable(s) \"gstat\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nIn the Shiny app, just as with the local Moran’s I and LISA cluster maps, the hot/cold spot map for the average, median or maximum property price statistics can be plotted and displayed as an overlay on an OpenStreetMap view of Johor Bahru and Kulai. It will also be possible to select the bandwidth type (fixed or adaptive), and the value of k for adaptive bandwidth k-means clustering.\n\n\n\nParameters and input data are customisable in the Shiny app."
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#annex-a-local-morans-i-coefficient-matrix",
    "href": "TakeHome/TakeHome3/take-home-3.html#annex-a-local-morans-i-coefficient-matrix",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "Annex A: Local Moran’s I Coefficient Matrix",
    "text": "Annex A: Local Moran’s I Coefficient Matrix\n\nprintCoefmat(data.frame(\n  localMI[fips,],\n  row.names=jb_kulai_grid$index[fips]),\n  check.names = FALSE\n)\n\n              Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..\n1     1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2     1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3     1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n4     1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n5     1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n6     1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n7     1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n8     1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n9     1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n10    1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n11    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n12    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n13    1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n14    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n15    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n16    1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n17    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n18    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n19    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n20    1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n21    1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n22    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n23    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n24    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n25    1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n26    1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n27    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n28    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n29    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n30    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n31    1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n32    1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n33    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n34    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n35    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n36    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n37    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n38    1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n39    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n40    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n41    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n42    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n43    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n44    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n45    1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n46    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n47    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n48    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n49    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n50    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n51    1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n52    1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n53    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n54    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n55    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n56    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n57    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n58    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n59    1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n60    1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n61    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n62    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n63    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n64    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n65    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n66    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n67    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n68    1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n69    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n70    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n71    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n72    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n73    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n74    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n75    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n76    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n77    1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n78    1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n79    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n80    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n81    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n82    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n83    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n84    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n85    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n86    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n87    1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n88    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n89    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n90    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n91    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n92    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n93    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n94    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n95    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n96    1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n97    1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n98    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n99    1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n100   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n101   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n102   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n103   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n104   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n105   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n106   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n107   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n108   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n109   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n110   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n111   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n112   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n113   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n114   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n115   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n116   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n117   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n118   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n119   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n120   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n121   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n122   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n123   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n124   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n125   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n126   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n127   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n128   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n129   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n130   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n131   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n132   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n133   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n134   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n135   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n136   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n137   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n138   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n139   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n140   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n141   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n142   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n143   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n144   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n145   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n146   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n147   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n148   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n149   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n150   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n151   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n152   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n153   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n154   1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420\n155   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n156   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n157   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n158   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n159   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n160   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n161   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n162   1.0722e-01 -4.5915e-05  3.0937e-02  6.0985e-01         0.5420\n163   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n164   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n165   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n166   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n167   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n168   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n169   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n170   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n171   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n172   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n173   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n174   2.3142e-02 -4.5915e-05  3.0937e-02  1.3183e-01         0.8951\n175   1.0722e-01 -4.5915e-05  3.0937e-02  6.0985e-01         0.5420\n176   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n177   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n178   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n179   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n180   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n181   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n182   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n183   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n184   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n185   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n186   1.0174e-01 -4.5915e-05  3.0937e-02  5.7868e-01         0.5628\n187  -1.5646e-01 -1.0859e-04  7.3161e-02 -5.7803e-01         0.5632\n188   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n189   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n190   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n191   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n192   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n193   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n194   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n195   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n196   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n197   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n198   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n199  -1.8387e-01 -1.3503e-04  9.0975e-02 -6.0917e-01         0.5424\n200   1.0722e-01 -4.5915e-05  3.0937e-02  6.0985e-01         0.5420\n201   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n202   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n203   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n204   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n205   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n206   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n207   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n208   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n209   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n210   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n211   1.0174e-01 -4.5915e-05  3.0937e-02  5.7868e-01         0.5628\n212   2.3142e-02 -4.5915e-05  3.0937e-02  1.3183e-01         0.8951\n213   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n214   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n215   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n216   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n217   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n218   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n219   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n220   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n221   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n222   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n223   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n224   1.0174e-01 -4.5915e-05  3.0937e-02  5.7868e-01         0.5628\n225   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n226   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n227   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n228   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n229   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n230   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n231   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n232   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n233   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n234   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n235   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n236   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n237   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n238   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n239   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n240   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n241   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n242   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n243   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n244   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n245   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n246   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n247   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n248   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n249   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n250   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n251   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n252   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n253   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n254   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n255   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n256   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n257   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n258   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n259   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n260   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n261   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n262   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n263   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n264   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n265   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n266   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n267   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n268   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n269   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n270   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n271   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n272   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n273   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n274   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n275   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n276   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n277   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n278   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n279   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n280   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n281   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n282   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n283   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n284   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n285   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n286   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n287   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n288   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n289   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n290   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n291   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n292   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n293   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n294   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n295   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n296   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n297   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n298   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n299   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n300   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n301   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n302   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n303   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n304   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n305   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n306   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n307   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n308   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n309   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n310   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n311   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n312   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n313   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n314   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n315   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n316   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n317   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n318   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n319   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n320   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n321   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n322   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n323   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n324   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n325   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n326   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n327   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n328   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n329   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n330   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n331   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n332   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n333   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n334   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n335   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n336   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n337   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n338   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n339   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n340   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n341   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n342   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n343   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n344   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n345   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n346   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n347   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n348   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n349   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n350   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n351   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n352   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n353   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n354   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n355   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n356   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n357   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n358   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n359   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n360   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n361   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n362   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n363   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n364   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n365   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n366   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n367   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n368   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n369   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n370   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n371   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n372   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n373   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n374   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n375   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n376   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n377   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n378   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n379   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n380   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n381   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n382   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n383   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n384   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n385   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n386   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n387   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n388   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n389   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n390   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n391   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n392   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n393   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n394   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n395   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n396   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n397   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n398   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n399   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n400   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n401   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n402   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n403   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n404   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n405   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n406   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n407   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n408   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n409   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n410   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n411   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n412   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n413   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n414   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n415   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n416   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n417   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n418   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n419   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n420   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n421   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n422   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n423   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n424   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n425   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n426   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n427   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n428   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n429   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n430   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n431   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n432   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n433   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n434   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n435   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n436   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n437   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n438   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n439   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n440   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n441   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n442   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n443   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n444   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n445   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n446   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n447   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n448   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n449   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n450   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n451   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n452   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n453   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n454   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n455   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n456   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n457   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n458   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n459   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n460   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n461   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n462   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n463   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n464   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n465   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n466   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n467   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n468   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n469   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n470   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n471   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n472   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n473   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n474   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n475   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n476   1.5048e-01 -4.5915e-05  3.0937e-02  8.5579e-01         0.3921\n477   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n478   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n479   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n480   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n481   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n482   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n483   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n484   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n485   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n486   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n487   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n488   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n489   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n490   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n491   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n492   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n493   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n494   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n495   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n496   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n497   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n498   1.5048e-01 -4.5915e-05  3.0937e-02  8.5579e-01         0.3921\n499   3.1062e-02 -4.5915e-05  3.0937e-02  1.7686e-01         0.8596\n500   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n501   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n502   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n503   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n504   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n505   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n506   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n507   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n508   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n509   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n510   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n511   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n512   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n513   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n514   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n515   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n516   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n517   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n518   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n519   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n520   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n521  -9.3655e-03 -9.1343e-07  6.1550e-04 -3.7746e-01         0.7058\n522  -2.1335e-02 -4.5915e-05  3.0937e-02 -1.2103e-01         0.9037\n523   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n524   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n525   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n526   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n527   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n528   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n529   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n530   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n531   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n532   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n533   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n534   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n535   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n536   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n537   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n538   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n539   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n540   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n541   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n542   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n543   1.5048e-01 -4.5915e-05  3.0937e-02  8.5579e-01         0.3921\n544   1.5690e-02 -3.7450e-04  2.5226e-01  3.1984e-02         0.9745\n545  -4.9361e-02 -4.5915e-05  3.0937e-02 -2.8037e-01         0.7792\n546   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n547   2.7894e-02 -4.5915e-05  3.0937e-02  1.5885e-01         0.8738\n548   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n549   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n550   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n551   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n552   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n553   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n554   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n555   1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420\n556   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n557   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n558   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n559   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n560   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n561   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n562   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n563   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n564   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n565   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n566   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n567  -1.5769e-01 -4.5915e-05  3.0937e-02 -8.9626e-01         0.3701\n568   4.4560e-01 -1.5426e-04  1.0393e-01  1.3827e+00         0.1668\n569   3.8374e-02 -4.5915e-05  3.0937e-02  2.1843e-01         0.8271\n570   2.7894e-02 -4.5915e-05  3.0937e-02  1.5885e-01         0.8738\n571   2.7894e-02 -4.5915e-05  3.0937e-02  1.5885e-01         0.8738\n572   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n573   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n574   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n575   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n576   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n577   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n578   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n579   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n580   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n581   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n582   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n583   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n584   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n585   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n586   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n587   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n588   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n589   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n590   6.5303e-02 -4.5915e-05  3.0937e-02  3.7153e-01         0.7102\n591   3.5840e-01 -6.6492e-05  4.4802e-02  1.6935e+00         0.0904\n592  -1.6001e-02 -6.4944e-04  4.3733e-01 -2.3214e-02         0.9815\n593   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n594  -7.6172e-01 -7.7156e-04  5.1950e-01 -1.0557e+00         0.2911\n595   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n596   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n597   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n598   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n599   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n600   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n601   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n602   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n603   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n604   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n605   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n606   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n607   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n608   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n609   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n610   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n611   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n612   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n613   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n614   2.2164e-01 -3.8385e-04  2.5855e-01  4.3665e-01         0.6624\n615   5.0332e-01 -1.8915e-04  1.2743e-01  1.4105e+00         0.1584\n616   3.8374e-02 -4.5915e-05  3.0937e-02  2.1843e-01         0.8271\n617   2.7894e-02 -4.5915e-05  3.0937e-02  1.5885e-01         0.8738\n618   2.7894e-02 -4.5915e-05  3.0937e-02  1.5885e-01         0.8738\n619   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n620   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n621   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n622   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n623   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n624   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n625   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n626   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n627   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n628   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n629   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n630   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n631   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n632   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n633   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n634   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n635   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n636   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n637   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n638  -6.6786e-02 -4.5915e-05  3.0937e-02 -3.7944e-01         0.7044\n639   2.9907e-01 -4.6529e-05  3.1351e-02  1.6893e+00         0.0912\n640  -1.2369e-01 -4.5915e-05  3.0937e-02 -7.0297e-01         0.4821\n641   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n642   2.7894e-02 -4.5915e-05  3.0937e-02  1.5885e-01         0.8738\n643   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n644   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n645   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n646   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n647   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n648   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n649   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n650   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n651   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n652   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n653   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n654   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n655   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n656   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n657   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n658   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n659   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n660   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n661   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n662   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n663   3.4618e-01 -4.8951e-04  3.2968e-01  6.0376e-01         0.5460\n664  -3.5914e-02 -6.6492e-05  4.4802e-02 -1.6936e-01         0.8655\n665   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n666   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n667   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n668   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n669   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n670   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n671   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n672   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n673   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n674   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n675   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n676   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n677   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n678   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n679   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n680   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n681   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n682   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n683   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n684   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n685   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n686   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n687   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n688   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n689   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n690  -1.2857e-01 -4.5915e-05  3.0937e-02 -7.3068e-01         0.4650\n691  -1.8584e-01 -4.5915e-05  3.0937e-02 -1.0563e+00         0.2908\n692   1.1758e-01 -4.5915e-05  3.0937e-02  6.6874e-01         0.5037\n693   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n694   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n695   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n696   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n697   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n698   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n699   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n700   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n701   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n702   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n703   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n704   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n705   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n706   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n707   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n708   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n709   1.0783e-01 -4.5915e-05  3.0937e-02  6.1332e-01         0.5397\n710   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n711   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n712   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n713   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n714   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n715   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n716   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n717   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n718   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n719   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n720   1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n721   4.8956e-02 -2.9284e-04  1.9727e-01  1.1088e-01         0.9117\n722   1.1758e-01 -4.5915e-05  3.0937e-02  6.6874e-01         0.5037\n723   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n724   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n725   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n726   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n727   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n728   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n729   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n730   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n731   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n732   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n733   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n734   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n735   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n736   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n737   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n738   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n739   3.4718e-02 -4.5915e-05  3.0937e-02  1.9765e-01         0.8433\n740   1.0783e-01 -4.5915e-05  3.0937e-02  6.1332e-01         0.5397\n741   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n742   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n743   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n744   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n745   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n746   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n747   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n748   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n749   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n750   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n751  -1.0428e-01 -8.5022e-05  5.7286e-02 -4.3536e-01         0.6633\n752   7.6636e-02 -4.5915e-05  3.0937e-02  4.3596e-01         0.6629\n753   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n754   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n755   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n756   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n757   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n758   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n759   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n760   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n761   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n762   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n763   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n764   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n765   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n766   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n767   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n768   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n769   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n770   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n771   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n772   7.6148e-02 -4.5915e-05  4.6429e-02  3.5361e-01         0.7236\n773   6.1989e-02 -1.0583e-04  7.1302e-02  2.3254e-01         0.8161\n774   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n775   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n776   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n777   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n778   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n779   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n780   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n781   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n782   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n783   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n784   1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n785   3.5235e-03 -4.5915e-05  3.0937e-02  2.0294e-02         0.9838\n786   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n787   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n788   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n789   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n790   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n791   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n792   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n793   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n794   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n795   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n796   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n797   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n798   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n799   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n800   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n801   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n802   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n803   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n804   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n805   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n806   6.2195e-02 -8.5022e-05  5.7286e-02  2.6021e-01         0.7947\n807  -4.5705e-02 -4.5915e-05  3.0937e-02 -2.5959e-01         0.7952\n808   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n809   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n810   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n811   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n812   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n813   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n814   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n815   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n816   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n817   4.2639e-02 -4.5915e-05  3.0937e-02  2.4268e-01         0.8083\n818   1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n819   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n820   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n821   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n822   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n823   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n824   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n825   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n826   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n827   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n828   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n829   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n830   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n831   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n832   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n833   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n834   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n835   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n836   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n837   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n838   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n839   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n840   7.6148e-02 -4.5915e-05  4.6429e-02  3.5361e-01         0.7236\n841  -1.3740e-01 -7.1916e-04  4.8425e-01 -1.9642e-01         0.8443\n842   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n843   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n844   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n845   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n846   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n847   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n848   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n849   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n850   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n851   4.2639e-02 -4.5915e-05  3.0937e-02  2.4268e-01         0.8083\n852   4.2639e-02 -4.5915e-05  3.0937e-02  2.4268e-01         0.8083\n853   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n854   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n855   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n856   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n857   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n858   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n859   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n860   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n861   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n862   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n863   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n864   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n865   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n866   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n867   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n868   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n869   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n870   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n871   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n872   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n873   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n874   1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n875   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n876  -4.0831e-02 -4.5915e-05  3.0937e-02 -2.3188e-01         0.8166\n877   3.2281e-02 -4.5915e-05  3.0937e-02  1.8379e-01         0.8542\n878   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n879   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n880   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n881   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n882   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n883   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n884   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n885   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n886   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n887  -2.4500e-01 -6.0275e-04  4.0591e-01 -3.8360e-01         0.7013\n888   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n889   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n890   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n891   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n892   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n893   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n894   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n895   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n896   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n897   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n898   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n899   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n900   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n901   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n902   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n903   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n904   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n905   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n906   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n907   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n908   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n909   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n910   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n911   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n912   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n913  -8.9573e-02 -4.5915e-05  3.0937e-02 -5.0899e-01         0.6108\n914   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n915  -2.7427e-02 -4.5915e-05  3.0937e-02 -1.5567e-01         0.8763\n916   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n917   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n918   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n919   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n920   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n921   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n922   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n923  -2.0960e-01 -4.5915e-05  3.0937e-02 -1.1914e+00         0.2335\n924  -1.7548e-01 -4.5915e-05  3.0937e-02 -9.9740e-01         0.3186\n925   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n926   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n927   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n928   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n929   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n930   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n931   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n932   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n933   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n934   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n935   1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n936   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n937   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n938   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n939   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n940   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n941   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n942   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n943   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n944   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n945   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n946   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n947   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n948   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n949   1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n950  -2.6209e-02 -4.5915e-05  3.0937e-02 -1.4875e-01         0.8818\n951   6.3963e-02 -4.5915e-05  3.0937e-02  3.6391e-01         0.7159\n952  -1.7853e-01 -4.5915e-05  3.0937e-02 -1.0147e+00         0.3102\n953  -2.7427e-02 -4.5915e-05  3.0937e-02 -1.5567e-01         0.8763\n954   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n955   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n956   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n957   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n958   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n959   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n960   5.1778e-02 -4.5915e-05  3.0937e-02  2.9464e-01         0.7683\n961   1.0963e+00 -3.6425e-04  2.4536e-01  2.2139e+00         0.0268\n962  -3.5713e-02 -4.5915e-05  3.0937e-02 -2.0278e-01         0.8393\n963   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n964   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n965   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n966   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n967   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n968   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n969   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n970   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n971   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n972   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n973   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n974   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n975   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n976   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n977   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n978   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n979   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n980   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n981   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n982   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n983   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n984   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n985   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n986   5.0559e-02 -4.5915e-05  4.6429e-02  2.3485e-01         0.8143\n987  -1.2486e-02 -3.9542e-04  2.6634e-01 -2.3427e-02         0.9813\n988   3.4718e-02 -4.5915e-05  3.0937e-02  1.9765e-01         0.8433\n989   8.7144e-01 -1.5905e-03  1.0700e+00  8.4398e-01         0.3987\n990   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n991   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n992   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n993   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n994   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n995   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n996   1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n997   7.4988e-01 -5.0856e-04  3.4251e-01  1.2822e+00         0.1998\n998   5.6079e-01 -2.2759e-04  1.5333e-01  1.4328e+00         0.1519\n999   6.4207e-02 -4.5915e-05  3.0937e-02  3.6530e-01         0.7149\n1000  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1001  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1002  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1003  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1004  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1005  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1006  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1007  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1008  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1009  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1010  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n1011  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1012  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1013  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1014  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1015  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1016  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1017  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1018  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1019  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1020  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1021  8.7115e-02 -4.5915e-05  3.0937e-02  4.9554e-01         0.6202\n1022  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1023  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1024  2.8118e-01 -1.6779e-04  1.1304e-01  8.3680e-01         0.4027\n1025 -1.4928e-01 -4.5915e-05  3.0937e-02 -8.4846e-01         0.3962\n1026  1.2876e+00 -6.9085e-04  4.6519e-01  1.8888e+00         0.0589\n1027 -2.1021e-01 -4.5915e-05  3.0937e-02 -1.1948e+00         0.2321\n1028  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1029  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1030  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1031  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1032  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1033  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1034 -1.3064e-01 -4.5915e-05  3.0937e-02 -7.4246e-01         0.4578\n1035  1.9474e+00 -1.3338e-03  8.9759e-01  2.0569e+00         0.0397\n1036 -1.8872e-02 -3.9330e-04  2.6492e-01 -3.5901e-02         0.9714\n1037  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1038  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1039  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1040  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1041  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1042  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1043  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1044  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1045  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1046  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1047  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1048  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1049  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1050  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1051  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1052  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1053  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1054  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1055  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1056  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1057  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1058 -2.9864e-02 -4.5915e-05  3.0937e-02 -1.6953e-01         0.8654\n1059 -1.0368e-02 -4.5915e-05  3.0937e-02 -5.8684e-02         0.9532\n1060  6.8837e-02 -4.5915e-05  3.7134e-02  3.5746e-01         0.7207\n1061  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1062  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1063 -2.1221e-01 -4.5915e-05  3.7134e-02 -1.1010e+00         0.2709\n1064  7.3628e-01 -1.7477e-04  1.1774e-01  2.1463e+00         0.0319\n1065 -3.1854e-01 -4.5915e-05  3.0937e-02 -1.8107e+00         0.0702\n1066  1.4719e+00 -1.1033e-03  7.4262e-01  1.7093e+00         0.0874\n1067  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1068  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1069  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1070  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1071  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1072  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1073  9.8447e-02 -4.5915e-05  3.0937e-02  5.5997e-01         0.5755\n1074  8.8798e-01 -1.9655e-04  1.3242e-01  2.4408e+00         0.0147\n1075 -5.0314e-01 -4.5915e-05  3.0937e-02 -2.8603e+00         0.0042\n1076 -1.5242e-02 -4.5915e-05  3.0937e-02 -8.6395e-02         0.9312\n1077  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1078  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1079  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1080  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1081  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1082  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1083  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1084  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1085  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1086  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1087  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1088  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1089  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1090  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1091  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1092  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1093  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1094  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1095  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1096  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1097  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1098  3.0361e-03 -4.5915e-05  3.0937e-02  1.7522e-02         0.9860\n1099  2.7585e-01 -2.1962e-04  1.4795e-01  7.1772e-01         0.4729\n1100 -1.0907e-01 -4.5915e-05  3.0937e-02 -6.1984e-01         0.5354\n1101 -8.1948e-01 -4.5915e-05  4.6429e-02 -3.8029e+00         0.0001\n1102  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n1103  3.9592e-02 -4.5915e-05  3.7134e-02  2.0570e-01         0.8370\n1104  9.9982e-01 -3.7657e-04  2.5365e-01  1.9860e+00         0.0470\n1105  7.2416e-01 -3.9542e-04  2.6634e-01  1.4040e+00         0.1603\n1106  9.5532e-01 -3.9436e-04  2.6563e-01  1.8543e+00         0.0637\n1107 -1.0907e-01 -4.5915e-05  3.0937e-02 -6.1984e-01         0.5354\n1108  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1109  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1110  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1111  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1112  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1113  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1114  2.1328e-01 -1.5228e-04  1.0259e-01  6.6633e-01         0.5052\n1115  1.0242e+00 -2.2759e-04  1.5333e-01  2.6161e+00         0.0089\n1116  1.7798e-01 -1.1251e-04  7.5805e-02  6.4685e-01         0.5177\n1117  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1118  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1119  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1120  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1121  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1122  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1123  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1124  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1125  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1126  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1127  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1128  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1129  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1130  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1131  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1132  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1133  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1134  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1135  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1136  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1137  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1138  1.2002e-01 -4.5915e-05  3.0937e-02  6.8259e-01         0.4949\n1139  4.4843e-01 -3.5415e-04  2.3855e-01  9.1886e-01         0.3582\n1140  4.4623e-01 -2.1179e-04  1.4268e-01  1.1819e+00         0.2372\n1141 -1.4156e-01 -2.1179e-04  1.7126e-01 -3.4156e-01         0.7327\n1142 -9.8800e-01 -4.5915e-05  4.6429e-02 -4.5850e+00         0.0000\n1143 -6.3572e-01 -4.5915e-05  3.0937e-02 -3.6140e+00         0.0003\n1144  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1145  1.6345e-01 -3.9542e-04  2.6634e-01  3.1748e-01         0.7509\n1146  1.2563e+00 -2.9650e-04  1.9973e-01  2.8117e+00         0.0049\n1147  8.9616e-01 -2.9650e-04  1.9973e-01  2.0059e+00         0.0449\n1148 -3.7215e-01 -4.5915e-05  3.0937e-02 -2.1156e+00         0.0344\n1149 -3.5957e-02 -4.5915e-05  3.0937e-02 -2.0417e-01         0.8382\n1150  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1151  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1152  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1153  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1154  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1155 -1.3658e-02 -4.5915e-05  3.0937e-02 -7.7389e-02         0.9383\n1156  9.9628e-01 -2.0106e-04  1.3546e-01  2.7075e+00         0.0068\n1157  6.1428e-01 -1.6779e-04  1.1304e-01  1.8275e+00         0.0676\n1158  1.8633e-02 -4.5915e-05  3.0937e-02  1.0620e-01         0.9154\n1159  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1160  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1161  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1162  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1163  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1164  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1165  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1166  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1167  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1168  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n1169  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1170  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1171  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1172  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1173  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1174  1.0539e-01 -4.5915e-05  3.0937e-02  5.9946e-01         0.5489\n1175  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1176  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1177  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1178  1.5100e-02 -4.5915e-05  3.0937e-02  8.6108e-02         0.9314\n1179  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1180  8.7038e-02 -5.8080e-05  3.9134e-02  4.4027e-01         0.6597\n1181  9.1730e-01 -2.1179e-04  1.4268e-01  2.4290e+00         0.0151\n1182  2.3741e-01 -2.2759e-04  1.5333e-01  6.0688e-01         0.5439\n1183 -2.6192e-01 -4.5915e-05  3.7134e-02 -1.3590e+00         0.1742\n1184  4.2181e+00 -1.9561e-02  1.2923e+01  1.1788e+00         0.2385\n1185  3.4474e-02 -4.5915e-05  3.0937e-02  1.9626e-01         0.8444\n1186  6.3963e-02 -4.5915e-05  3.0937e-02  3.6391e-01         0.7159\n1187  1.1561e+00 -3.9542e-04  2.6634e-01  2.2410e+00         0.0250\n1188  1.4179e+00 -3.9542e-04  2.6634e-01  2.7482e+00         0.0060\n1189  3.5620e-01 -6.6492e-05  4.4802e-02  1.6832e+00         0.0923\n1190  2.6340e-01 -3.1515e-04  2.1229e-01  5.7236e-01         0.5671\n1191 -2.0116e-02 -4.5915e-05  3.0937e-02 -1.1411e-01         0.9092\n1192  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1193  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1194  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1195  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1196  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1197  5.3731e-01 -3.1515e-04  2.1229e-01  1.1669e+00         0.2433\n1198  1.6002e+00 -8.8506e-04  5.9585e-01  2.0742e+00         0.0381\n1199  2.4727e-01 -1.5426e-04  1.0393e-01  7.6749e-01         0.4428\n1200  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1201  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1202  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1203  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1204  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1205  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1206  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1207  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1208  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1209  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1210  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1211  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n1212  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1213  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1214  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1215  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1216  1.0539e-01 -4.5915e-05  3.0937e-02  5.9946e-01         0.5489\n1217 -2.8646e-02 -4.5915e-05  3.0937e-02 -1.6260e-01         0.8708\n1218  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1219  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1220 -1.7499e-01 -4.5915e-05  3.0937e-02 -9.9463e-01         0.3199\n1221  1.5100e-02 -4.5915e-05  3.0937e-02  8.6108e-02         0.9314\n1222 -3.1083e-02 -4.5915e-05  3.0937e-02 -1.7646e-01         0.8599\n1223  6.9154e-01 -1.4130e-04  9.5197e-02  2.2418e+00         0.0250\n1224  4.8549e-01 -2.1179e-04  1.4268e-01  1.2858e+00         0.1985\n1225 -1.7487e-01 -4.5915e-05  3.0937e-02 -9.9394e-01         0.3203\n1226  2.2776e+00 -3.1704e-04  2.1357e-01  4.9292e+00         0.0000\n1227  3.0090e+00 -6.9365e-04  4.6708e-01  4.4037e+00         0.0000\n1228  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1229 -1.8291e-01 -4.5915e-05  3.0937e-02 -1.0397e+00         0.2985\n1230  9.6591e-01 -2.5237e-04  1.7001e-01  2.3432e+00         0.0191\n1231  7.2911e-01 -2.6091e-04  1.7576e-01  1.7398e+00         0.0819\n1232  3.7476e-01 -8.5022e-05  5.7286e-02  1.5661e+00         0.1173\n1233  7.2306e-01 -2.9650e-04  1.9973e-01  1.6186e+00         0.1055\n1234  8.9552e-02 -4.5915e-05  3.0937e-02  5.0940e-01         0.6105\n1235  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1236  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1237  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1238  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1239 -3.3520e-02 -4.5915e-05  3.0937e-02 -1.9031e-01         0.8491\n1240  1.1156e+00 -2.3163e-04  1.5605e-01  2.8247e+00         0.0047\n1241  5.8535e-01 -8.5022e-05  5.7286e-02  2.4460e+00         0.0144\n1242  2.0096e-02 -4.5915e-05  3.0937e-02  1.1451e-01         0.9088\n1243  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1244  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1245  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1246  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1247  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1248  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1249  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1250  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1251  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1252  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1253  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1254  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1255  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1256  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1257  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1258  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1259  2.9204e-02 -1.1708e-04  7.8884e-02  1.0440e-01         0.9169\n1260  5.1778e-02 -4.5915e-05  3.0937e-02  2.9464e-01         0.7683\n1261  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1262 -1.7779e-01 -4.5915e-05  3.0937e-02 -1.0106e+00         0.3122\n1263  1.9291e-02 -9.3492e-04  6.2939e-01  2.5495e-02         0.9797\n1264  9.5645e-02 -4.5915e-05  3.0937e-02  5.4404e-01         0.5864\n1265  2.8467e-01 -4.2963e-05  2.8949e-02  1.6734e+00         0.0943\n1266  9.0191e-01 -3.5415e-04  2.3855e-01  1.8473e+00         0.0647\n1267 -1.1586e-02 -4.5915e-05  3.0937e-02 -6.5611e-02         0.9477\n1268  7.2734e-01 -8.3811e-04  5.6427e-01  9.6937e-01         0.3324\n1269  3.0964e+00 -4.3674e-04  2.9416e-01  5.7098e+00         0.0000\n1270 -1.2881e-01 -4.5915e-05  3.0937e-02 -7.3207e-01         0.4641\n1271  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1272  1.2030e-01 -4.2347e-04  2.8523e-01  2.2605e-01         0.8212\n1273  4.1242e-01 -3.7450e-04  2.5226e-01  8.2189e-01         0.4111\n1274  2.2145e-01 -8.2581e-05  5.5641e-02  9.3915e-01         0.3477\n1275  1.1699e+00 -2.5237e-04  1.7001e-01  2.8379e+00         0.0045\n1276  3.7383e-01 -2.0410e-04  1.3750e-01  1.0087e+00         0.3131\n1277  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1278  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1279  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1280  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1281  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1282  5.4614e-01 -2.7842e-04  1.8756e-01  1.2617e+00         0.2071\n1283  8.4488e-01 -1.7126e-04  1.1538e-01  2.4878e+00         0.0129\n1284  2.1368e-01 -1.0583e-04  7.1302e-02  8.0064e-01         0.4233\n1285  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1286  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1287  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1288  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1289  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1290  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1291  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1292  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1293  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1294  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1295  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1296  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1297  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1298  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1299  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1300  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1301  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1302  3.5327e-02 -4.5915e-05  3.0937e-02  2.0111e-01         0.8406\n1303 -1.1757e-01 -5.0856e-04  3.4251e-01 -2.0003e-01         0.8415\n1304 -5.4531e-01 -4.5915e-05  3.0937e-02 -3.1000e+00         0.0019\n1305  1.2297e-02 -4.5915e-05  3.0937e-02  7.0174e-02         0.9441\n1306  8.1397e-01 -1.2121e-03  8.1578e-01  9.0254e-01         0.3668\n1307  1.5100e-02 -4.5915e-05  3.0937e-02  8.6108e-02         0.9314\n1308 -1.5122e-02 -1.6779e-04  1.1304e-01 -4.4476e-02         0.9645\n1309  1.4465e+00 -3.9542e-04  2.6634e-01  2.8036e+00         0.0051\n1310 -1.3710e-01 -4.5915e-05  3.0937e-02 -7.7918e-01         0.4359\n1311 -2.6992e-01 -4.5915e-05  3.0937e-02 -1.5343e+00         0.1250\n1312  7.3124e-01 -1.8189e-04  1.2254e-01  2.0895e+00         0.0367\n1313  1.0699e+00 -8.3811e-04  5.6427e-01  1.4254e+00         0.1540\n1314  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1315  6.0795e-02 -4.5915e-05  3.0937e-02  3.4590e-01         0.7294\n1316 -1.6220e-01 -4.5915e-05  3.0937e-02 -9.2189e-01         0.3566\n1317 -1.1090e-01 -4.5915e-05  3.0937e-02 -6.3023e-01         0.5285\n1318  4.5316e-01 -2.6091e-04  1.7576e-01  1.0815e+00         0.2795\n1319  1.9230e+00 -7.7750e-04  5.2350e-01  2.6589e+00         0.0078\n1320 -1.3100e-01 -4.5915e-05  3.0937e-02 -7.4454e-01         0.4566\n1321  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1322  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1323  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1324  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1325 -6.7122e-03 -4.5915e-05  3.0937e-02 -3.7900e-02         0.9698\n1326  8.8563e-01 -2.9650e-04  1.9973e-01  1.9823e+00         0.0474\n1327  5.7022e-01 -2.4397e-04  1.6435e-01  1.4071e+00         0.1594\n1328  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n1329  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1330  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1331  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1332  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1333  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1334  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1335  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1336  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1337  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1338  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1339  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1340  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1341  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1342  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1343  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1344  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1345  3.6163e-02 -7.3174e-05  4.9304e-02  1.6319e-01         0.8704\n1346 -6.7934e-01 -4.5915e-05  3.0937e-02 -3.8621e+00         0.0001\n1347 -5.4531e-01 -4.5915e-05  3.0937e-02 -3.1000e+00         0.0019\n1348  1.9678e-02 -9.7279e-04  6.5486e-01  2.5519e-02         0.9796\n1349 -1.7499e-01 -4.5915e-05  3.0937e-02 -9.9463e-01         0.3199\n1350  9.5645e-02 -4.5915e-05  3.0937e-02  5.4404e-01         0.5864\n1351  7.6993e-01 -3.5415e-04  2.3855e-01  1.5771e+00         0.1148\n1352  6.0822e-01 -2.8739e-04  1.9360e-01  1.3830e+00         0.1667\n1353  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n1354  1.3684e+00 -6.9085e-04  4.6519e-01  2.0073e+00         0.0447\n1355 -3.5497e-01 -4.5915e-05  3.0937e-02 -2.0179e+00         0.0436\n1356 -2.9551e-01 -4.5915e-05  3.0937e-02 -1.6798e+00         0.0930\n1357  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1358  6.0795e-02 -4.5915e-05  3.0937e-02  3.4590e-01         0.7294\n1359  6.6400e-02 -4.5915e-05  3.0937e-02  3.7777e-01         0.7056\n1360  8.5195e-03 -4.5915e-05  3.0937e-02  4.8698e-02         0.9612\n1361  9.3632e-01 -4.3897e-04  2.9566e-01  1.7228e+00         0.0849\n1362  8.5092e-01 -1.9655e-04  1.3242e-01  2.3389e+00         0.0193\n1363 -5.8622e-02 -4.5915e-05  3.0937e-02 -3.3303e-01         0.7391\n1364  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1365  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1366  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1367  7.2089e-04 -4.5915e-05  3.0937e-02  4.3595e-03         0.9965\n1368  5.3656e-01 -1.4130e-04  9.5197e-02  1.7395e+00         0.0819\n1369  3.7887e-01 -7.5473e-05  5.0852e-02  1.6804e+00         0.0929\n1370  1.2556e-01 -5.0237e-05  3.3850e-02  6.8272e-01         0.4948\n1371  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1372  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1373  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1374  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1375  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1376  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1377  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1378  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1379  1.2976e-01 -4.5915e-05  3.0937e-02  7.3802e-01         0.4605\n1380  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1381  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1382  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n1383  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1384  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1385  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1386  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1387  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1388  1.1575e-01 -4.5915e-05  3.0937e-02  6.5835e-01         0.5103\n1389 -1.8288e-02 -4.5915e-05  3.0937e-02 -1.0371e-01         0.9174\n1390 -4.2009e+00 -2.3468e-02  1.5442e+01 -1.0631e+00         0.2878\n1391  1.2297e-02 -4.5915e-05  3.0937e-02  7.0174e-02         0.9441\n1392 -1.7779e-01 -4.5915e-05  3.0937e-02 -1.0106e+00         0.3122\n1393  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1394 -2.1335e-02 -4.5915e-05  3.0937e-02 -1.2103e-01         0.9037\n1395  8.2962e-01 -1.2121e-03  8.1578e-01  9.1987e-01         0.3576\n1396  7.7367e-02 -4.5915e-05  3.0937e-02  4.4012e-01         0.6599\n1397  6.0590e-01 -5.8327e-04  3.9280e-01  9.6768e-01         0.3332\n1398 -1.9924e-01 -4.5915e-05  3.0937e-02 -1.1325e+00         0.2574\n1399  5.6415e-01 -7.7750e-04  5.2350e-01  7.8080e-01         0.4349\n1400  2.6188e-02 -4.5915e-05  3.0937e-02  1.4915e-01         0.8814\n1401  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1402  1.2733e-01 -4.5915e-05  3.0937e-02  7.2416e-01         0.4690\n1403  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1404 -1.7487e-01 -4.5915e-05  3.0937e-02 -9.9394e-01         0.3203\n1405  8.4932e-01 -3.9542e-04  2.6634e-01  1.6465e+00         0.0997\n1406  7.7784e-01 -4.2787e-04  2.8819e-01  1.4497e+00         0.1471\n1407  6.6887e-02 -4.5915e-05  3.0937e-02  3.8054e-01         0.7035\n1408  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1409  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1410 -1.2113e-01 -4.5915e-05  3.0937e-02 -6.8842e-01         0.4912\n1411 -2.7954e-01 -4.5915e-05  3.0937e-02 -1.5890e+00         0.1121\n1412  4.9874e-01 -1.1421e-04  7.6952e-02  1.7983e+00         0.0721\n1413  2.0233e-01 -3.3117e-05  2.2315e-02  1.3547e+00         0.1755\n1414 -3.5957e-02 -4.5915e-05  3.0937e-02 -2.0417e-01         0.8382\n1415  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1416  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1417  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1418  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1419  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1420  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1421  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1422  1.2976e-01 -4.5915e-05  3.0937e-02  7.3802e-01         0.4605\n1423  1.2976e-01 -4.5915e-05  3.0937e-02  7.3802e-01         0.4605\n1424  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1425  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1426  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1427  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1428  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1429  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1430  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1431  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1432  1.1575e-01 -4.5915e-05  3.0937e-02  6.5835e-01         0.5103\n1433 -5.4531e-01 -4.5915e-05  3.0937e-02 -3.1000e+00         0.0019\n1434 -6.9884e-01 -4.5915e-05  3.0937e-02 -3.9729e+00         0.0001\n1435  1.2297e-02 -4.5915e-05  3.0937e-02  7.0174e-02         0.9441\n1436  9.3208e-02 -4.5915e-05  3.0937e-02  5.3018e-01         0.5960\n1437  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1438 -1.2125e-01 -4.5915e-05  3.0937e-02 -6.8912e-01         0.4908\n1439 -1.1272e-01 -4.5915e-05  3.0937e-02 -6.4062e-01         0.5218\n1440 -1.8898e-02 -4.5915e-05  3.0937e-02 -1.0718e-01         0.9146\n1441  6.0590e-01 -5.8327e-04  3.9280e-01  9.6768e-01         0.3332\n1442  2.7407e-02 -4.5915e-05  3.0937e-02  1.5608e-01         0.8760\n1443 -1.1386e-01 -7.9244e-04  5.3355e-01 -1.5479e-01         0.8770\n1444  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1445  1.2733e-01 -4.5915e-05  3.0937e-02  7.2416e-01         0.4690\n1446 -1.1638e-01 -4.5915e-05  3.0937e-02 -6.6140e-01         0.5084\n1447  5.6652e-02 -4.5915e-05  3.0937e-02  3.2235e-01         0.7472\n1448 -3.1378e-01 -4.5915e-05  3.0937e-02 -1.7837e+00         0.0745\n1449  7.5763e-01 -1.9655e-04  1.3242e-01  2.0826e+00         0.0373\n1450  2.0249e-01 -3.7038e-04  2.4948e-01  4.0614e-01         0.6846\n1451  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1452  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1453 -9.4447e-02 -4.5915e-05  3.0937e-02 -5.3670e-01         0.5915\n1454 -3.1833e-01 -1.1372e-03  7.6541e-01 -3.6255e-01         0.7169\n1455  1.1628e+00 -1.2875e-03  8.6646e-01  1.2506e+00         0.2111\n1456  4.4456e-02 -5.2386e-06  3.5299e-03  7.4834e-01         0.4543\n1457  2.0311e-01 -6.6492e-05  4.4802e-02  9.5989e-01         0.3371\n1458  9.5645e-02 -4.5915e-05  3.0937e-02  5.4404e-01         0.5864\n1459  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1460  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1461  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1462  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1463  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1464  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1465  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1466 -1.3273e-01 -3.0120e-05  2.0295e-02 -9.3151e-01         0.3516\n1467  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1468  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1469  1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420\n1470  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1471  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1472  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1473  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1474  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1475  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1476  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1477  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1478 -6.9884e-01 -4.5915e-05  3.0937e-02 -3.9729e+00         0.0001\n1479 -5.3434e-01 -4.5915e-05  3.0937e-02 -3.0376e+00         0.0024\n1480 -2.8524e-02 -4.5915e-05  3.0937e-02 -1.6191e-01         0.8714\n1481  9.3208e-02 -4.5915e-05  3.0937e-02  5.3018e-01         0.5960\n1482  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1483 -4.2751e-03 -4.5915e-05  3.0937e-02 -2.4045e-02         0.9808\n1484  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1485  1.0134e-01 -5.0237e-05  3.3850e-02  5.5109e-01         0.5816\n1486  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n1487 -2.0533e-01 -4.5915e-05  3.0937e-02 -1.1671e+00         0.2432\n1488  2.6188e-02 -4.5915e-05  3.0937e-02  1.4915e-01         0.8814\n1489  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1490  1.2508e-01 -3.6257e-05  2.4430e-02  8.0045e-01         0.4235\n1491 -2.0899e-01 -4.5915e-05  3.0937e-02 -1.1879e+00         0.2349\n1492  1.6810e-01 -4.6160e-04  3.1090e-01  3.0231e-01         0.7624\n1493 -3.1135e-01 -4.5915e-05  3.0937e-02 -1.7699e+00         0.0768\n1494  7.5274e-01 -4.8480e-04  3.2651e-01  1.3182e+00         0.1874\n1495  6.6887e-02 -4.5915e-05  3.0937e-02  3.8054e-01         0.7035\n1496  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1497  2.7407e-02 -4.5915e-05  3.0937e-02  1.5608e-01         0.8760\n1498  8.2751e-01 -3.9542e-04  2.6634e-01  1.6042e+00         0.1087\n1499 -4.3454e-01 -4.5915e-05  3.0937e-02 -2.4703e+00         0.0135\n1500 -4.8523e-01 -4.5915e-05  3.0937e-02 -2.7585e+00         0.0058\n1501  3.0433e-01 -1.0583e-04  7.1302e-02  1.1401e+00         0.2542\n1502  3.1466e-02 -1.6779e-04  1.1304e-01  9.4089e-02         0.9250\n1503  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1504  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1505  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1506  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1507  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1508  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1509  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1510  1.0783e-01 -4.5915e-05  3.0937e-02  6.1332e-01         0.5397\n1511  1.0783e-01 -4.5915e-05  3.0937e-02  6.1332e-01         0.5397\n1512  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1513  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1514  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1515  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1516  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1517  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1518  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1519  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1520  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1521  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1522  4.0572e+00 -7.1916e-04  4.8425e-01  5.8314e+00         0.0000\n1523 -5.0253e-01 -4.5915e-05  3.0937e-02 -2.8568e+00         0.0043\n1524 -1.2755e-01 -1.8189e-04  1.2254e-01 -3.6385e-01         0.7160\n1525  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1526 -1.3831e-01 -4.5915e-05  3.0937e-02 -7.8610e-01         0.4318\n1527  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1528  3.1062e-02 -4.5915e-05  3.0937e-02  1.7686e-01         0.8596\n1529 -1.8898e-02 -4.5915e-05  3.0937e-02 -1.0718e-01         0.9146\n1530 -8.2018e-02 -4.5915e-05  3.0937e-02 -4.6604e-01         0.6412\n1531 -1.2491e-01 -4.5915e-05  3.0937e-02 -7.0990e-01         0.4778\n1532  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1533 -5.7891e-02 -4.5915e-05  3.0937e-02 -3.2887e-01         0.7423\n1534  1.3519e+00 -2.1666e-03  1.4567e+00  1.1219e+00         0.2619\n1535 -2.7540e-01 -4.5915e-05  3.0937e-02 -1.5655e+00         0.1175\n1536  7.2059e-01 -3.9542e-04  2.6634e-01  1.3970e+00         0.1624\n1537  2.9508e-01 -1.0583e-04  7.1302e-02  1.1055e+00         0.2690\n1538 -6.4714e-02 -4.5915e-05  3.0937e-02 -3.6766e-01         0.7131\n1539  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1540  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1541  5.0900e-01 -7.7750e-04  5.2350e-01  7.0456e-01         0.4811\n1542 -3.6642e-01 -4.5915e-05  3.0937e-02 -2.0830e+00         0.0373\n1543  1.0625e+00 -2.0976e-03  1.4105e+00  8.9643e-01         0.3700\n1544  3.1822e-03 -2.4304e-08  1.6377e-05  7.8635e-01         0.4317\n1545  2.7068e-01 -5.8080e-05  3.9134e-02  1.3686e+00         0.1711\n1546  2.7407e-02 -4.5915e-05  3.0937e-02  1.5608e-01         0.8760\n1547  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1548  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1549  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1550  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1551  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1552  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1553  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1554  3.7860e-02 -3.9085e-06  2.6337e-03  7.3782e-01         0.4606\n1555  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1556  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1557  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1558  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n1559  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1560  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1561  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1562  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1563  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1564  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1565 -6.1208e-01 -4.5915e-05  3.0937e-02 -3.4796e+00         0.0005\n1566  1.0587e+01 -1.3736e-02  9.1284e+00  3.5085e+00         0.0005\n1567 -2.7316e-01 -3.9436e-04  2.6563e-01 -5.2925e-01         0.5966\n1568  9.3208e-02 -4.5915e-05  3.0937e-02  5.3018e-01         0.5960\n1569 -5.1119e-01 -4.5915e-05  3.0937e-02 -2.9060e+00         0.0037\n1570 -5.0387e-01 -4.5915e-05  3.0937e-02 -2.8645e+00         0.0042\n1571 -8.9573e-02 -4.5915e-05  3.0937e-02 -5.0899e-01         0.6108\n1572  3.1062e-02 -4.5915e-05  3.0937e-02  1.7686e-01         0.8596\n1573 -1.6732e-01 -4.5915e-05  3.0937e-02 -9.5099e-01         0.3416\n1574  3.0760e-01 -8.5022e-05  5.7286e-02  1.2855e+00         0.1986\n1575 -1.6025e-01 -4.5915e-05  3.0937e-02 -9.1081e-01         0.3624\n1576 -1.6460e-02 -4.5915e-05  3.0937e-02 -9.3323e-02         0.9256\n1577  6.8808e-01 -1.2890e-04  8.6849e-02  2.3353e+00         0.0195\n1578  1.3424e+00 -6.9085e-04  4.6519e-01  1.9692e+00         0.0489\n1579  9.4760e-01 -3.5415e-04  2.3855e-01  1.9409e+00         0.0523\n1580  4.2324e-01 -1.1708e-04  7.8884e-02  1.5073e+00         0.1317\n1581 -9.6884e-02 -4.5915e-05  3.0937e-02 -5.5056e-01         0.5819\n1582  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1583  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1584 -3.5957e-02 -4.5915e-05  3.0937e-02 -2.0417e-01         0.8382\n1585  1.0403e+00 -4.1691e-04  2.8081e-01  1.9639e+00         0.0495\n1586 -2.4067e-01 -4.5915e-05  3.0937e-02 -1.3680e+00         0.1713\n1587  3.7610e-01 -1.2890e-04  8.6849e-02  1.2767e+00         0.2017\n1588 -3.0366e-02 -3.9542e-04  2.6634e-01 -5.8072e-02         0.9537\n1589 -3.5914e-02 -6.6492e-05  4.4802e-02 -1.6936e-01         0.8655\n1590  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1591  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1592  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1593  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1594  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1595  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1596  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1597  1.6388e-01 -4.5915e-05  3.0937e-02  9.3199e-01         0.3513\n1598  1.6388e-01 -4.5915e-05  3.0937e-02  9.3199e-01         0.3513\n1599  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1600  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1601  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1602  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1603  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1604  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1605  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1606  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1607  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1608  1.0583e+01 -1.8012e-02  1.1918e+01  3.0708e+00         0.0021\n1609 -5.0253e-01 -4.5915e-05  3.0937e-02 -2.8568e+00         0.0043\n1610 -2.8524e-02 -4.5915e-05  3.0937e-02 -1.6191e-01         0.8714\n1611 -1.8706e-01 -4.5915e-05  3.0937e-02 -1.0632e+00         0.2877\n1612  8.6512e+00 -4.1143e-03  2.7610e+00  5.2090e+00         0.0000\n1613 -3.6374e-01 -4.5915e-05  3.0937e-02 -2.0678e+00         0.0387\n1614  3.5306e-01 -1.7477e-04  1.1774e-01  1.0294e+00         0.3033\n1615  2.7407e-02 -4.5915e-05  3.0937e-02  1.5608e-01         0.8760\n1616  1.5638e+00 -1.2837e-03  8.6389e-01  1.6839e+00         0.0922\n1617  7.2464e-01 -1.0583e-04  7.1302e-02  2.7142e+00         0.0066\n1618 -1.8218e-01 -4.5915e-05  3.0937e-02 -1.0355e+00         0.3004\n1619  4.5787e-01 -2.4397e-04  1.6435e-01  1.1300e+00         0.2585\n1620  1.2230e+00 -1.6779e-04  1.1304e-01  3.6379e+00         0.0003\n1621  5.0061e-01 -5.2145e-05  3.5135e-02  2.6710e+00         0.0076\n1622  9.9199e-01 -2.6091e-04  1.7576e-01  2.3668e+00         0.0179\n1623  6.2195e-02 -8.5022e-05  5.7286e-02  2.6021e-01         0.7947\n1624  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1625  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1626  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1627  2.6258e-01 -5.0237e-05  3.3850e-02  1.4275e+00         0.1534\n1628  3.1353e-01 -3.8804e-04  2.6137e-01  6.1403e-01         0.5392\n1629  3.6990e-01 -5.6066e-05  3.7777e-02  1.9034e+00         0.0570\n1630 -1.9924e-01 -4.5915e-05  3.0937e-02 -1.1325e+00         0.2574\n1631 -7.0076e-02 -4.5915e-05  3.0937e-02 -3.9815e-01         0.6905\n1632  1.1758e-01 -4.5915e-05  3.0937e-02  6.6874e-01         0.5037\n1633  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1634  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1635  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1636  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1637  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1638  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1639  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1640  1.6388e-01 -4.5915e-05  3.0937e-02  9.3199e-01         0.3513\n1641  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1642  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1643  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1644  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1645  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1646  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1647  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1648  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1649 -4.5855e-01 -4.5915e-05  3.0937e-02 -2.6067e+00         0.0091\n1650 -1.0252e+00 -4.5915e-05  3.0937e-02 -5.8282e+00         0.0000\n1651  6.4085e-02 -4.5915e-05  3.0937e-02  3.6461e-01         0.7154\n1652  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1653  5.5157e+00 -5.5962e-03  3.7498e+00  2.8513e+00         0.0044\n1654  7.6885e+00 -5.3594e-03  3.5920e+00  4.0595e+00         0.0000\n1655  1.7251e+00 -1.1211e-03  7.5457e-01  1.9872e+00         0.0469\n1656 -2.4676e-01 -4.5915e-05  3.0937e-02 -1.4027e+00         0.1607\n1657  4.9295e-01 -7.7750e-04  5.2350e-01  6.8239e-01         0.4950\n1658  1.9935e+00 -5.6032e-04  3.7735e-01  3.2461e+00         0.0012\n1659  1.9434e+00 -2.6914e-03  1.8087e+00  1.4470e+00         0.1479\n1660  3.3779e-01 -2.2759e-04  1.5333e-01  8.6323e-01         0.3880\n1661  9.3435e-01 -2.3982e-04  1.6156e-01  2.3252e+00         0.0201\n1662  1.7155e+00 -5.0856e-04  3.4251e-01  2.9321e+00         0.0034\n1663  8.5820e-01 -2.7842e-04  1.8756e-01  1.9823e+00         0.0474\n1664  2.3796e-01 -8.5022e-05  5.7286e-02  9.9458e-01         0.3199\n1665  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n1666  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1667  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1668  3.4718e-02 -4.5915e-05  3.0937e-02  1.9765e-01         0.8433\n1669  4.4805e-01 -6.0130e-05  4.0515e-02  2.2263e+00         0.0260\n1670 -2.2763e-01 -4.5915e-05  3.0937e-02 -1.2939e+00         0.1957\n1671  3.5984e-01 -8.5022e-05  5.7286e-02  1.5038e+00         0.1326\n1672 -1.0883e-01 -4.5915e-05  3.0937e-02 -6.1845e-01         0.5363\n1673  1.1758e-01 -4.5915e-05  3.0937e-02  6.6874e-01         0.5037\n1674  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1675  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1676  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1677  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1678  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1679  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1680  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1681  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1682  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1683  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1684  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1685  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1686  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1687  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1688  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1689  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1690 -4.5855e-01 -4.5915e-05  3.0937e-02 -2.6067e+00         0.0091\n1691  3.2403e-02 -4.5915e-05  3.0937e-02  1.8448e-01         0.8536\n1692  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1693 -1.8706e-01 -4.5915e-05  3.0937e-02 -1.0632e+00         0.2877\n1694  1.4420e+01 -5.2236e-03  3.5015e+00  7.7092e+00         0.0000\n1695 -1.0364e+00 -4.5915e-05  3.0937e-02 -5.8919e+00         0.0000\n1696  3.7602e+00 -1.1033e-03  7.4262e-01  4.3647e+00         0.0000\n1697 -2.8454e-01 -4.5915e-05  3.0937e-02 -1.6174e+00         0.1058\n1698  1.4820e+00 -3.0575e-04  2.0596e-01  3.2662e+00         0.0011\n1699  3.4436e+00 -1.1033e-03  7.4262e-01  3.9973e+00         0.0001\n1700 -6.1549e-01 -4.5915e-05  3.0937e-02 -3.4990e+00         0.0005\n1701  9.7126e-01 -2.2759e-04  1.5333e-01  2.4810e+00         0.0131\n1702  1.0088e+00 -3.1515e-04  2.1229e-01  2.1902e+00         0.0285\n1703  9.5690e-01 -6.3592e-04  4.2823e-01  1.4632e+00         0.1434\n1704  5.3230e-01 -2.4397e-04  1.6435e-01  1.3136e+00         0.1890\n1705  3.9592e-02 -4.5915e-05  3.0937e-02  2.2536e-01         0.8217\n1706  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1707  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1708  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1709  1.8763e-01 -1.5426e-04  1.0393e-01  5.8251e-01         0.5602\n1710  3.8897e-01 -2.4815e-04  1.6717e-01  9.5195e-01         0.3411\n1711  5.4347e-01 -4.1691e-04  2.8081e-01  1.0264e+00         0.3047\n1712  2.7593e-01 -9.5140e-05  6.4102e-02  1.0902e+00         0.2756\n1713 -1.9872e-02 -4.5915e-05  3.0937e-02 -1.1272e-01         0.9103\n1714  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1715  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1716  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1717  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1718  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1719  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1720  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1721  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1722  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1723  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1724  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1725  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1726  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1727  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1728  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1729  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1730 -5.7647e-02 -4.5915e-05  3.0937e-02 -3.2748e-01         0.7433\n1731  3.2403e-02 -4.5915e-05  3.0937e-02  1.8448e-01         0.8536\n1732 -1.3819e-01 -4.5915e-05  3.0937e-02 -7.8541e-01         0.4322\n1733  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1734 -8.1156e-01 -4.5915e-05  3.0937e-02 -4.6137e+00         0.0000\n1735  8.0087e+00 -1.5693e-03  1.0558e+00  7.7958e+00         0.0000\n1736  4.7424e+00 -2.5280e-03  1.6991e+00  3.6402e+00         0.0003\n1737  2.3091e+00 -7.7750e-04  5.2350e-01  3.1926e+00         0.0014\n1738 -5.2678e-01 -4.5915e-05  3.0937e-02 -2.9947e+00         0.0027\n1739  1.7750e+00 -3.5415e-04  2.3855e-01  3.6350e+00         0.0003\n1740  3.1037e+00 -1.0473e-03  7.0500e-01  3.6978e+00         0.0002\n1741  1.2364e+00 -5.2066e-04  3.5066e-01  2.0888e+00         0.0367\n1742  7.5318e-01 -2.7842e-04  1.8756e-01  1.7398e+00         0.0819\n1743  9.2177e-01 -5.4528e-04  3.6723e-01  1.5220e+00         0.1280\n1744 -3.9908e-01 -4.5915e-05  3.0937e-02 -2.2687e+00         0.0233\n1745 -1.2125e-01 -4.5915e-05  3.0937e-02 -6.8912e-01         0.4908\n1746  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1747  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1748  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1749  1.7659e-02 -4.5915e-05  3.0937e-02  1.0066e-01         0.9198\n1750  4.8563e-01 -1.0583e-04  7.1302e-02  1.8191e+00         0.0689\n1751 -2.5468e-01 -4.5915e-05  3.0937e-02 -1.4477e+00         0.1477\n1752  1.1250e+00 -2.4397e-04  1.6435e-01  2.7755e+00         0.0055\n1753  4.2895e-01 -2.1024e-04  1.4164e-01  1.1403e+00         0.2541\n1754  7.7367e-02 -4.5915e-05  3.0937e-02  4.4012e-01         0.6599\n1755  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1756  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1757  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1758  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1759  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1760  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1761  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1762  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1763  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1764  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n1765  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1766  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1767  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1768  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1769 -2.7089e-01 -4.5915e-05  3.0937e-02 -1.5399e+00         0.1236\n1770 -3.0111e-01 -4.5915e-05  3.0937e-02 -1.7117e+00         0.0870\n1771 -6.0181e-02 -7.1773e-04  4.8328e-01 -8.5536e-02         0.9318\n1772 -1.9205e-01 -4.5915e-05  3.0937e-02 -1.0916e+00         0.2750\n1773  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1774  7.8420e+00 -2.5819e-03  1.7353e+00  5.9550e+00         0.0000\n1775  5.2538e+00 -1.3652e-03  9.1865e-01  5.4829e+00         0.0000\n1776  5.5957e+00 -2.4747e-03  1.6634e+00  4.3406e+00         0.0000\n1777  1.3721e+00 -7.1916e-04  4.8425e-01  1.9727e+00         0.0485\n1778  1.6534e+00 -6.8805e-04  4.6331e-01  2.4301e+00         0.0151\n1779  1.6543e+00 -2.7842e-04  1.8756e-01  3.8205e+00         0.0001\n1780  1.9619e+00 -3.7244e-04  2.5087e-01  3.9177e+00         0.0001\n1781  8.7967e-01 -9.5140e-05  6.4102e-02  3.4748e+00         0.0005\n1782 -4.8194e-01 -4.5915e-05  3.0937e-02 -2.7398e+00         0.0061\n1783 -2.5651e-01 -4.5915e-05  3.0937e-02 -1.4581e+00         0.1448\n1784  4.5568e-02 -4.8480e-04  3.2651e-01  8.0594e-02         0.9358\n1785  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1786  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1787  1.3708e-01 -4.5915e-05  3.0937e-02  7.7958e-01         0.4356\n1788  4.9340e-02 -4.5915e-05  3.0937e-02  2.8078e-01         0.7789\n1789  2.1114e-01 -1.1708e-04  7.8884e-02  7.5217e-01         0.4519\n1790  1.3850e-01 -1.5426e-04  1.0393e-01  4.3008e-01         0.6671\n1791  9.3556e-01 -4.2787e-04  2.8819e-01  1.7435e+00         0.0812\n1792  1.1366e+00 -2.6091e-04  1.7576e-01  2.7118e+00         0.0067\n1793  2.7836e-01 -2.8739e-04  1.9360e-01  6.3330e-01         0.5265\n1794  8.1022e-02 -4.5915e-05  3.0937e-02  4.6090e-01         0.6449\n1795  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1796  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1797  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1798  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1799  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1800  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1801  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1802  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1803  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1804  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1805  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1806  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1807 -2.7427e-02 -4.5915e-05  3.0937e-02 -1.5567e-01         0.8763\n1808  3.5936e+00 -2.1616e-03  1.4534e+00  2.9826e+00         0.0029\n1809 -2.1106e-01 -4.5915e-05  3.0937e-02 -1.1997e+00         0.2303\n1810  7.8840e-01 -9.3329e-04  6.2829e-01  9.9582e-01         0.3193\n1811 -1.4307e-01 -4.5915e-05  3.0937e-02 -8.1312e-01         0.4161\n1812 -3.6984e-01 -4.5915e-05  3.0937e-02 -2.1024e+00         0.0355\n1813  1.5316e+01 -5.3672e-03  3.5972e+00  8.0780e+00         0.0000\n1814 -1.2445e+00 -4.5915e-05  3.0937e-02 -7.0752e+00         0.0000\n1815  3.2110e+00 -7.0493e-04  4.7467e-01  4.6616e+00         0.0000\n1816  1.4921e+00 -5.5780e-04  3.7566e-01  2.4353e+00         0.0149\n1817  1.6802e+00 -5.0856e-04  3.4251e-01  2.8718e+00         0.0041\n1818  2.8371e+00 -7.7750e-04  5.2350e-01  3.9223e+00         0.0001\n1819  3.0452e+00 -7.7750e-04  5.2350e-01  4.2099e+00         0.0000\n1820  9.6486e-01 -2.4397e-04  1.6435e-01  2.3806e+00         0.0173\n1821  9.6075e-02 -4.2963e-05  2.8949e-02  5.6493e-01         0.5721\n1822 -1.1644e-01 -2.1179e-04  1.4268e-01 -3.0769e-01         0.7583\n1823  5.4215e-02 -4.5915e-05  3.0937e-02  3.0849e-01         0.7577\n1824  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1825  6.3963e-02 -4.5915e-05  3.0937e-02  3.6391e-01         0.7159\n1826 -9.6884e-02 -4.5915e-05  3.0937e-02 -5.5056e-01         0.5819\n1827 -1.9559e-01 -4.5915e-05  3.0937e-02 -1.1117e+00         0.2663\n1828  2.1114e-01 -1.1708e-04  7.8884e-02  7.5217e-01         0.4519\n1829 -1.2247e-01 -4.5915e-05  3.0937e-02 -6.9604e-01         0.4864\n1830  3.6946e+00 -9.3329e-04  6.2829e-01  4.6623e+00         0.0000\n1831  9.8744e-01 -2.1179e-04  1.4268e-01  2.6147e+00         0.0089\n1832 -2.2727e-01 -4.5915e-05  3.0937e-02 -1.2918e+00         0.1964\n1833  8.1022e-02 -4.5915e-05  3.0937e-02  4.6090e-01         0.6449\n1834  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1835  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1836  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1837  8.8334e-02 -4.5915e-05  3.0937e-02  5.0247e-01         0.6153\n1838  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1839  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1840  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1841  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1842  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1843  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1844  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1845  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1846  3.9439e+00 -1.5905e-03  1.0700e+00  3.8142e+00         0.0001\n1847  2.1304e+00 -2.1616e-03  1.4534e+00  1.7689e+00         0.0769\n1848 -1.3819e-01 -4.5915e-05  3.0937e-02 -7.8541e-01         0.4322\n1849  6.0565e-01 -1.4880e-03  1.0012e+00  6.0678e-01         0.5440\n1850  6.4207e-02 -4.5915e-05  3.0937e-02  3.6530e-01         0.7149\n1851  6.4786e+00 -3.2731e-03  2.1983e+00  4.3718e+00         0.0000\n1852  1.0165e+01 -3.7467e-03  2.5152e+00  6.4121e+00         0.0000\n1853  4.0626e+00 -1.2685e-03  8.5364e-01  4.3984e+00         0.0000\n1854  1.1240e+00 -1.2890e-04  8.6849e-02  3.8144e+00         0.0001\n1855  1.6195e+00 -3.1515e-04  2.1229e-01  3.5157e+00         0.0004\n1856  9.8833e-01 -1.4771e-04  9.9515e-02  3.1334e+00         0.0017\n1857  4.6373e+00 -2.1666e-03  1.4567e+00  3.8439e+00         0.0001\n1858  2.9398e+00 -1.2685e-03  8.5364e-01  3.1832e+00         0.0015\n1859  6.1643e-01 -6.4944e-04  4.3733e-01  9.3311e-01         0.3508\n1860  2.7407e-02 -4.5915e-05  3.0937e-02  1.5608e-01         0.8760\n1861 -4.3268e-02 -4.5915e-05  3.0937e-02 -2.4573e-01         0.8059\n1862  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1863  3.6546e-02 -4.5915e-05  3.0937e-02  2.0804e-01         0.8352\n1864  3.1333e-02 -1.5120e-05  1.0188e-02  3.1057e-01         0.7561\n1865  3.4667e-01 -5.3290e-04  3.5889e-01  5.7956e-01         0.5622\n1866  8.9381e-02 -8.0176e-05  5.4021e-02  3.8490e-01         0.7003\n1867  1.7659e-02 -4.5915e-05  3.0937e-02  1.0066e-01         0.9198\n1868  1.1762e+00 -1.9655e-04  1.3242e-01  3.2327e+00         0.0012\n1869  2.6383e+00 -3.7450e-04  2.5226e-01  5.2536e+00         0.0000\n1870  8.3762e-01 -2.4397e-04  1.6435e-01  2.0667e+00         0.0388\n1871  5.3181e-02 -2.6091e-04  1.7576e-01  1.2747e-01         0.8986\n1872  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1873  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1874  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1875  8.8334e-02 -4.5915e-05  3.0937e-02  5.0247e-01         0.6153\n1876 -7.7875e-02 -4.5915e-05  3.0937e-02 -4.4248e-01         0.6581\n1877  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1878  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1879  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1880  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1881  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1882  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1883 -3.8702e-01 -4.5915e-05  3.0937e-02 -2.2001e+00         0.0278\n1884  6.2613e+00 -2.3567e-03  1.5843e+00  4.9763e+00         0.0000\n1885 -5.7647e-02 -4.5915e-05  3.0937e-02 -3.2748e-01         0.7433\n1886 -1.9205e-01 -4.5915e-05  3.0937e-02 -1.0916e+00         0.2750\n1887  6.2798e-02 -3.9330e-04  2.6492e-01  1.2277e-01         0.9023\n1888 -1.0663e-01 -4.5915e-05  3.0937e-02 -6.0598e-01         0.5445\n1889  1.2016e+01 -4.1143e-03  2.7610e+00  7.2340e+00         0.0000\n1890  4.7593e+00 -1.4819e-03  9.9704e-01  4.7678e+00         0.0000\n1891  3.0864e+00 -7.7750e-04  5.2350e-01  4.2668e+00         0.0000\n1892  1.5373e+00 -3.3436e-04  2.2523e-01  3.2400e+00         0.0012\n1893  1.2674e+00 -3.5415e-04  2.3855e-01  2.5957e+00         0.0094\n1894  2.0886e+00 -5.6665e-04  3.8161e-01  3.3819e+00         0.0007\n1895  3.6104e+00 -7.7750e-04  5.2350e-01  4.9910e+00         0.0000\n1896  1.0693e+00 -1.1708e-04  7.8884e-02  3.8074e+00         0.0001\n1897 -2.3214e-01 -4.5915e-05  3.0937e-02 -1.3195e+00         0.1870\n1898 -1.3710e-01 -4.5915e-05  3.0937e-02 -7.7918e-01         0.4359\n1899  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1900  1.0966e-01 -4.5915e-05  3.0937e-02  6.2371e-01         0.5328\n1901  1.0498e-01 -8.5022e-05  5.7286e-02  4.3895e-01         0.6607\n1902  8.3539e-01 -2.1179e-04  1.4268e-01  2.2122e+00         0.0270\n1903  2.3891e-01 -1.8189e-04  1.2254e-01  6.8301e-01         0.4946\n1904  3.3500e-02 -4.5915e-05  3.0937e-02  1.9072e-01         0.8487\n1905  9.0771e-02 -4.5915e-05  3.0937e-02  5.1633e-01         0.6056\n1906  5.0277e+00 -8.7367e-03  5.8356e+00  2.0849e+00         0.0371\n1907  1.5612e+00 -3.2468e-04  2.1871e-01  3.3390e+00         0.0008\n1908  8.7412e-01 -2.1179e-04  1.4268e-01  2.3147e+00         0.0206\n1909 -2.9621e-02 -4.5915e-05  3.0937e-02 -1.6814e-01         0.8665\n1910  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1911  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1912  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1913  6.5187e-02 -2.1179e-04  1.4268e-01  1.7314e-01         0.8625\n1914  1.9608e-02 -4.5915e-05  3.0937e-02  1.1174e-01         0.9110\n1915  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1916  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1917  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1918  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1919  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1920  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1921  2.9740e+00 -5.1698e-03  3.4656e+00  1.6003e+00         0.1095\n1922 -3.1049e-01 -4.5915e-05  3.0937e-02 -1.7650e+00         0.0776\n1923  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1924 -1.4307e-01 -4.5915e-05  3.0937e-02 -8.1312e-01         0.4161\n1925  6.4207e-02 -4.5915e-05  3.0937e-02  3.6530e-01         0.7149\n1926 -7.0250e-01 -4.5915e-05  3.0937e-02 -3.9937e+00         0.0001\n1927  8.1389e+00 -1.6118e-03  1.0844e+00  7.8175e+00         0.0000\n1928  4.1473e+00 -1.1033e-03  7.4262e-01  4.8139e+00         0.0000\n1929  2.1725e+00 -5.5780e-04  3.7566e-01  3.5455e+00         0.0004\n1930  1.8963e+00 -6.6310e-04  4.4652e-01  2.8389e+00         0.0045\n1931  6.3163e-01 -1.1708e-04  7.8884e-02  2.2493e+00         0.0245\n1932  2.2663e+00 -4.3897e-04  2.9566e-01  4.1688e+00         0.0000\n1933  3.1178e+00 -9.2516e-04  6.2283e-01  3.9518e+00         0.0001\n1934  9.3012e-01 -2.6959e-04  1.8161e-01  2.1832e+00         0.0290\n1935 -1.4319e-01 -4.5915e-05  3.0937e-02 -8.1382e-01         0.4158\n1936 -3.9613e-02 -4.5915e-05  3.0937e-02 -2.2495e-01         0.8220\n1937  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1938 -6.4883e-02 -9.7758e-05  6.5866e-02 -2.5243e-01         0.8007\n1939  4.0650e-01 -7.2265e-05  4.8691e-02  1.8425e+00         0.0654\n1940  9.8378e-01 -2.1179e-04  1.4268e-01  2.6050e+00         0.0092\n1941  2.1314e-02 -4.5915e-05  3.0937e-02  1.2144e-01         0.9033\n1942  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1943 -3.6740e-01 -4.5915e-05  3.0937e-02 -2.0885e+00         0.0367\n1944  4.7551e+00 -8.6299e-04  5.8101e-01  6.2395e+00         0.0000\n1945  1.3956e+00 -4.9305e-04  3.3207e-01  2.4227e+00         0.0154\n1946  4.0913e-01 -3.0389e-04  2.0471e-01  9.0493e-01         0.3655\n1947  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1948  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1949  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1950  3.8374e-02 -4.5915e-05  3.0937e-02  2.1843e-01         0.8271\n1951 -1.6757e-01 -8.7556e-04  5.8947e-01 -2.1712e-01         0.8281\n1952  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1953  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1954  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1955  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n1956  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1957 -2.4569e-01 -4.5915e-05  3.7134e-02 -1.2747e+00         0.2024\n1958 -4.2662e-01 -4.5915e-05  3.0937e-02 -2.4252e+00         0.0153\n1959  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1960  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1961 -3.7179e-01 -4.5915e-05  3.0937e-02 -2.1135e+00         0.0346\n1962  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1963  5.2624e+00 -2.7750e-03  1.8647e+00  3.8558e+00         0.0001\n1964  3.0299e+00 -3.9542e-04  2.6634e-01  5.8718e+00         0.0000\n1965  3.7841e+00 -1.1390e-03  7.6662e-01  4.3232e+00         0.0000\n1966  2.0703e+00 -5.0856e-04  3.4251e-01  3.5384e+00         0.0004\n1967  7.6959e-01 -1.1708e-04  7.8884e-02  2.7405e+00         0.0061\n1968  9.7452e-01 -1.3752e-04  9.2653e-02  3.2020e+00         0.0014\n1969  2.8453e+00 -9.3329e-04  6.2829e-01  3.5907e+00         0.0003\n1970  1.7331e+00 -5.2676e-04  3.5476e-01  2.9106e+00         0.0036\n1971  2.3857e-01 -2.5237e-04  1.7001e-01  5.7920e-01         0.5625\n1972 -1.1668e+00 -1.8103e-03  1.2176e+00 -1.0557e+00         0.2911\n1973  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1974  1.0966e-01 -4.5915e-05  3.0937e-02  6.2371e-01         0.5328\n1975  1.2510e-01 -6.6492e-05  4.4802e-02  5.9132e-01         0.5543\n1976  1.0749e+00 -1.7518e-03  1.1783e+00  9.9181e-01         0.3213\n1977 -9.9321e-02 -4.5915e-05  3.0937e-02 -5.6441e-01         0.5725\n1978  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1979  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1980 -8.7333e-01 -4.5915e-05  3.0937e-02 -4.9650e+00         0.0000\n1981  2.6678e+00 -7.4804e-04  5.0368e-01  3.7601e+00         0.0002\n1982  5.5770e-01 -5.9622e-04  4.0151e-01  8.8107e-01         0.3783\n1983  7.5173e-02 -4.5915e-05  3.0937e-02  4.2765e-01         0.6689\n1984  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1985  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1986  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1987  4.7753e-02 -1.7265e-05  1.1633e-02  4.4290e-01         0.6578\n1988  1.9608e-02 -4.5915e-05  3.0937e-02  1.1174e-01         0.9110\n1989  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1990  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1991  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n1992  1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420\n1993  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n1994 -3.5357e-01 -4.5915e-05  4.6429e-02 -1.6407e+00         0.1009\n1995  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n1996  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n1997 -3.9153e-01 -4.5915e-05  3.0937e-02 -2.2257e+00         0.0260\n1998 -2.5018e-01 -4.5915e-05  3.0937e-02 -1.4221e+00         0.1550\n1999 -8.5917e-02 -4.5915e-05  3.0937e-02 -4.8821e-01         0.6254\n2000  5.1735e+00 -4.1143e-03  2.7610e+00  3.1160e+00         0.0018\n2001  3.1680e+00 -8.6926e-04  5.8523e-01  4.1423e+00         0.0000\n2002  1.9406e+00 -5.0856e-04  3.4251e-01  3.3167e+00         0.0009\n2003  1.7502e+00 -4.3897e-04  2.9566e-01  3.2195e+00         0.0013\n2004  8.1981e-01 -8.5022e-05  5.7286e-02  3.4256e+00         0.0006\n2005  1.8638e+00 -3.9436e-04  2.6563e-01  3.6171e+00         0.0003\n2006  2.1038e+00 -5.8327e-04  3.9280e-01  3.3577e+00         0.0008\n2007  1.0559e+00 -2.4397e-04  1.6435e-01  2.6051e+00         0.0092\n2008 -2.2239e-01 -4.5915e-05  3.0937e-02 -1.2641e+00         0.2062\n2009 -3.9613e-02 -4.5915e-05  3.0937e-02 -2.2495e-01         0.8220\n2010  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2011 -2.9255e-02 -4.5915e-05  3.0937e-02 -1.6606e-01         0.8681\n2012 -2.4518e-01 -4.5915e-05  3.0937e-02 -1.3937e+00         0.1634\n2013  4.2333e-01 -1.9655e-04  1.3242e-01  1.1639e+00         0.2445\n2014  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2015  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2016  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2017  1.7696e+00 -7.8437e-03  5.2439e+00  7.7618e-01         0.4376\n2018 -2.4518e-01 -4.5915e-05  3.0937e-02 -1.3937e+00         0.1634\n2019 -6.7395e-02 -4.5915e-05  3.0937e-02 -3.8291e-01         0.7018\n2020  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2021  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2022  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2023  1.3586e-01 -4.5915e-05  3.0937e-02  7.7265e-01         0.4397\n2024 -3.0352e-02 -4.5915e-05  3.0937e-02 -1.7230e-01         0.8632\n2025  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2026  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2027  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2028  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2029  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n2030 -2.8646e-02 -4.5915e-05  3.0937e-02 -1.6260e-01         0.8708\n2031 -5.8154e-01 -7.8531e-03  5.2502e+00 -2.5037e-01         0.8023\n2032  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2033 -4.1005e-01 -4.5915e-05  3.0937e-02 -2.3310e+00         0.0198\n2034  2.1958e+00 -4.1691e-04  2.8081e-01  4.1445e+00         0.0000\n2035  2.6590e+00 -8.6926e-04  5.8523e-01  3.4769e+00         0.0005\n2036  1.7387e+00 -6.2255e-04  4.1923e-01  2.6863e+00         0.0072\n2037  1.5198e+00 -3.9542e-04  2.6634e-01  2.9457e+00         0.0032\n2038  3.6900e+00 -1.4860e-03  9.9980e-01  3.6919e+00         0.0002\n2039  1.3576e+00 -2.1962e-04  1.4795e-01  3.5300e+00         0.0004\n2040  1.1089e+00 -2.1101e-04  1.4216e-01  2.9417e+00         0.0033\n2041  5.0391e-01 -1.1138e-04  7.5045e-02  1.8399e+00         0.0658\n2042 -3.9613e-02 -4.5915e-05  3.0937e-02 -2.2495e-01         0.8220\n2043  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2044  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2045 -1.5075e-01 -7.5473e-05  5.0852e-02 -6.6815e-01         0.5040\n2046 -2.9173e-01 -4.5915e-05  3.0937e-02 -1.6583e+00         0.0973\n2047 -5.2895e-02 -4.5915e-05  3.0937e-02 -3.0046e-01         0.7638\n2048  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2049  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2050 -2.4993e-01 -4.5915e-05  3.0937e-02 -1.4207e+00         0.1554\n2051 -4.0590e-01 -4.5915e-05  3.0937e-02 -2.3075e+00         0.0210\n2052  4.3248e-02 -4.5915e-05  3.0937e-02  2.4614e-01         0.8056\n2053  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2054  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2055  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2056  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2057  1.3586e-01 -4.5915e-05  3.0937e-02  7.7265e-01         0.4397\n2058  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2059  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2060  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2061  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2062 -2.5286e-01 -8.5022e-05  5.7286e-02 -1.0561e+00         0.2909\n2063  8.9167e-01 -5.8327e-04  3.9280e-01  1.4237e+00         0.1545\n2064 -2.5018e-01 -4.5915e-05  3.0937e-02 -1.4221e+00         0.1550\n2065  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2066 -4.3137e-01 -4.5915e-05  3.0937e-02 -2.4522e+00         0.0142\n2067  2.6198e+00 -5.0856e-04  3.4251e-01  4.4773e+00         0.0000\n2068 -7.4393e-01 -4.5915e-05  3.0937e-02 -4.2292e+00         0.0000\n2069  1.8077e+00 -3.9542e-04  2.6634e-01  3.5035e+00         0.0005\n2070  3.0187e+00 -1.6012e-03  1.0772e+00  2.9101e+00         0.0036\n2071  2.3579e+00 -5.0856e-04  3.4251e-01  4.0297e+00         0.0001\n2072  1.1396e+00 -2.5237e-04  1.7001e-01  2.7645e+00         0.0057\n2073  1.3478e+00 -3.9542e-04  2.6634e-01  2.6124e+00         0.0090\n2074 -7.4950e-02 -4.5915e-05  3.0937e-02 -4.2586e-01         0.6702\n2075  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2076  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2077  1.1514e-01 -4.5915e-05  3.0937e-02  6.5488e-01         0.5125\n2078  2.5579e-02 -4.5915e-05  3.0937e-02  1.4569e-01         0.8842\n2079  1.8577e-01 -7.5473e-05  5.0852e-02  8.2412e-01         0.4099\n2080  1.1283e-01 -4.5915e-05  3.0937e-02  6.4172e-01         0.5211\n2081  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2082  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2083 -2.4993e-01 -4.5915e-05  3.0937e-02 -1.4207e+00         0.1554\n2084  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2085  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2086  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2087  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2088  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2089  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2090  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2091  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2092  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2093  7.6148e-02 -4.5915e-05  4.6429e-02  3.5361e-01         0.7236\n2094 -2.8646e-02 -4.5915e-05  3.0937e-02 -1.6260e-01         0.8708\n2095 -3.9153e-01 -4.5915e-05  3.0937e-02 -2.2257e+00         0.0260\n2096  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2097  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2098  1.0817e+00 -9.0901e-04  6.1197e-01  1.3839e+00         0.1664\n2099  2.8879e+00 -1.0336e-03  6.9574e-01  3.4635e+00         0.0005\n2100  2.1251e+00 -5.8327e-04  3.9280e-01  3.3917e+00         0.0007\n2101  1.0498e+00 -1.5426e-04  1.0393e-01  3.2568e+00         0.0011\n2102  5.7717e+00 -1.4860e-03  9.9980e-01  5.7738e+00         0.0000\n2103  1.6373e+00 -5.2066e-04  3.5066e-01  2.7658e+00         0.0057\n2104  8.8530e-01 -2.1569e-04  1.4531e-01  2.3230e+00         0.0202\n2105  1.3895e+00 -1.0857e-03  7.3076e-01  1.6267e+00         0.1038\n2106  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2107  2.0583e-02 -4.5915e-05  3.0937e-02  1.1728e-01         0.9066\n2108  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2109  1.1514e-01 -4.5915e-05  3.0937e-02  6.5488e-01         0.5125\n2110 -7.9518e-02 -1.6435e-04  1.1073e-01 -2.3847e-01         0.8115\n2111  1.5721e-02 -8.4531e-05  5.6955e-02  6.6228e-02         0.9472\n2112  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2113  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2114  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2115  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2116  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2117  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2118  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2119  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2120  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2121  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2122  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2123  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2124  7.6148e-02 -4.5915e-05  4.6429e-02  3.5361e-01         0.7236\n2125  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n2126  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2127  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2128  1.7049e-02 -4.5915e-05  3.0937e-02  9.7192e-02         0.9226\n2129  3.4721e+00 -9.3329e-04  6.2829e-01  4.3816e+00         0.0000\n2130  3.0132e+00 -8.6926e-04  5.8523e-01  3.9399e+00         0.0001\n2131  2.7696e+00 -1.0508e-03  7.0732e-01  3.2944e+00         0.0010\n2132 -9.6582e-01 -4.5915e-05  3.0937e-02 -5.4908e+00         0.0000\n2133  2.7782e+00 -4.1691e-04  2.8081e-01  5.2434e+00         0.0000\n2134  9.5612e-01 -2.3571e-04  1.5879e-01  2.4000e+00         0.0164\n2135  1.1645e+00 -1.4771e-04  9.9515e-02  3.6919e+00         0.0002\n2136 -1.7974e-01 -4.5915e-05  3.0937e-02 -1.0217e+00         0.3069\n2137 -1.6707e-01 -4.5915e-05  3.0937e-02 -9.4960e-01         0.3423\n2138  2.0583e-02 -4.5915e-05  3.0937e-02  1.1728e-01         0.9066\n2139  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2140  9.6254e-02 -4.5915e-05  3.0937e-02  5.4750e-01         0.5840\n2141  1.3748e-01 -8.5022e-05  5.7286e-02  5.7474e-01         0.5655\n2142  5.9211e-02 -4.5915e-05  3.0937e-02  3.3689e-01         0.7362\n2143  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2144  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2145  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2146  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2147  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2148  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2149  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2150  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2151  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2152  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2153  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2154  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2155  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2156  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2157  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2158 -4.7037e-01 -4.5915e-05  3.0937e-02 -2.6739e+00         0.0075\n2159  4.2888e+00 -7.7750e-04  5.2350e-01  5.9287e+00         0.0000\n2160  2.9357e+00 -9.3003e-04  6.2610e-01  3.7113e+00         0.0002\n2161  1.0485e+00 -3.9542e-04  2.6634e-01  2.0324e+00         0.0421\n2162  2.3045e+00 -1.1498e-02  7.6585e+00  8.3687e-01         0.4027\n2163  6.4441e-01 -3.0111e-04  2.0283e-01  1.4315e+00         0.1523\n2164  9.9638e-01 -1.3379e-04  9.0143e-02  3.3191e+00         0.0009\n2165  1.2254e+00 -1.1211e-03  7.5457e-01  1.4119e+00         0.1580\n2166 -1.5635e-01 -4.5915e-05  3.0937e-02 -8.8864e-01         0.3742\n2167  7.9686e-03 -8.6299e-04  5.8101e-01  1.1586e-02         0.9908\n2168  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2169  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2170  2.3142e-02 -4.5915e-05  3.0937e-02  1.3183e-01         0.8951\n2171 -2.9041e-02 -2.4551e-05  1.6543e-02 -2.2560e-01         0.8215\n2172  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2173  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2174  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2175  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2176  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2177  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2178  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2179  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2180  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2181  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2182  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2183  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2184  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2185  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2186  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2187  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2188  3.7150e+00 -3.9117e-03  2.6255e+00  2.2952e+00         0.0217\n2189  3.5538e+00 -1.9022e-03  1.2793e+00  3.1437e+00         0.0017\n2190  1.6234e+00 -3.9330e-04  2.6492e-01  3.1549e+00         0.0016\n2191 -1.0359e+00 -4.5915e-05  3.0937e-02 -5.8891e+00         0.0000\n2192 -7.8304e-01 -4.5915e-05  3.0937e-02 -4.4516e+00         0.0000\n2193  5.1863e-01 -1.0041e-04  6.7654e-02  1.9943e+00         0.0461\n2194  2.6044e+00 -8.6926e-04  5.8523e-01  3.4055e+00         0.0007\n2195 -3.1159e-01 -4.5915e-05  3.0937e-02 -1.7712e+00         0.0765\n2196  2.3212e+00 -1.1753e-03  7.9101e-01  2.6112e+00         0.0090\n2197  2.0583e-02 -4.5915e-05  3.0937e-02  1.1728e-01         0.9066\n2198  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2199  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2200  5.9089e-02 -4.5915e-05  3.0937e-02  3.3620e-01         0.7367\n2201  1.3220e-01 -4.5915e-05  3.0937e-02  7.5187e-01         0.4521\n2202  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2203  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2204  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2205  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2206  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2207  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2208  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2209  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2210  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2211  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2212  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2213  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2214  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2215  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2216 -2.2361e-01 -4.5915e-05  3.0937e-02 -1.2711e+00         0.2037\n2217  3.5647e+00 -8.8189e-04  5.9372e-01  4.6275e+00         0.0000\n2218 -6.4961e-01 -4.5915e-05  3.0937e-02 -3.6930e+00         0.0002\n2219  2.9049e+00 -7.3209e-04  4.9294e-01  4.1384e+00         0.0000\n2220 -9.7265e-01 -4.5915e-05  3.0937e-02 -5.5296e+00         0.0000\n2221 -3.1147e-01 -4.5915e-05  3.0937e-02 -1.7705e+00         0.0766\n2222  3.1378e+00 -2.1172e-03  1.4236e+00  2.6316e+00         0.0085\n2223 -8.1131e-01 -4.5915e-05  3.0937e-02 -4.6123e+00         0.0000\n2224  2.6274e+00 -7.3065e-04  4.9197e-01  3.7469e+00         0.0002\n2225 -4.9193e-01 -4.5915e-05  3.0937e-02 -2.7966e+00         0.0052\n2226  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2227  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2228  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2229  1.3220e-01 -4.5915e-05  3.0937e-02  7.5187e-01         0.4521\n2230  6.7619e-02 -4.5915e-05  3.0937e-02  3.8470e-01         0.7005\n2231  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2232  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2233  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2234  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2235  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2236  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2237  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2238  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2239  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2240  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2241  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2242  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2243  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2244  1.1600e+00 -1.8189e-04  1.2254e-01  3.3144e+00         0.0009\n2245  8.6552e-01 -1.0041e-04  6.7654e-02  3.3280e+00         0.0009\n2246  1.2950e+00 -3.3436e-04  2.2523e-01  2.7293e+00         0.0063\n2247  3.0711e+00 -7.4015e-03  4.9504e+00  1.3836e+00         0.1665\n2248  1.2987e-01 -1.5905e-03  1.0700e+00  1.2709e-01         0.8989\n2249 -4.7292e-01 -4.5915e-05  3.0937e-02 -2.6885e+00         0.0072\n2250  3.9739e+00 -1.1918e-03  8.0211e-01  4.4384e+00         0.0000\n2251  1.8237e+00 -7.8345e-04  5.2750e-01  2.5120e+00         0.0120\n2252  3.1257e+00 -4.1349e-03  2.7747e+00  1.8790e+00         0.0602\n2253  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2254  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2255  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2256  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2257  6.7619e-02 -4.5915e-05  3.0937e-02  3.8470e-01         0.7005\n2258 -4.9361e-02 -4.5915e-05  3.0937e-02 -2.8037e-01         0.7792\n2259  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2260  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2261  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2262  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2263  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2264  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2265  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2266  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2267  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2268  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2269  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2270 -6.7639e-02 -4.5915e-05  3.0937e-02 -3.8429e-01         0.7008\n2271  1.6865e+00 -4.1691e-04  2.8081e-01  3.1834e+00         0.0015\n2272  1.2069e+00 -3.9542e-04  2.6634e-01  2.3394e+00         0.0193\n2273  2.9356e+00 -4.8011e-04  3.2336e-01  5.1633e+00         0.0000\n2274 -8.3970e-01 -4.5915e-05  3.0937e-02 -4.7738e+00         0.0000\n2275  7.3912e-01 -2.0870e-04  1.4060e-01  1.9717e+00         0.0486\n2276  1.9517e+00 -4.9661e-04  3.3447e-01  3.3755e+00         0.0007\n2277  4.0063e+00 -3.4587e-03  2.3225e+00  2.6311e+00         0.0085\n2278  2.0755e+00 -9.6615e-04  6.5040e-01  2.5747e+00         0.0100\n2279 -1.3905e-01 -4.5915e-05  3.0937e-02 -7.9026e-01         0.4294\n2280  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2281  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2282  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2283  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2284 -1.9389e-01 -3.6425e-04  2.4536e-01 -3.9069e-01         0.6960\n2285  6.8837e-02 -4.5915e-05  3.0937e-02  3.9162e-01         0.6953\n2286  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2287  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2288  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2289  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2290  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2291  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2292  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2293  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2294  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2295  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2296  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2297  1.4232e+00 -8.0752e-04  5.4369e-01  1.9313e+00         0.0534\n2298  1.8983e+00 -4.5022e-04  3.0323e-01  3.4482e+00         0.0006\n2299  1.5157e+00 -5.3290e-04  3.5889e-01  2.5309e+00         0.0114\n2300  2.6561e+00 -5.8973e-04  3.9714e-01  4.2156e+00         0.0000\n2301  1.2150e+00 -3.0575e-04  2.0596e-01  2.6780e+00         0.0074\n2302  8.3677e-01 -3.0575e-04  2.0596e-01  1.8445e+00         0.0651\n2303  2.5551e+00 -4.3452e-04  2.9266e-01  4.7238e+00         0.0000\n2304 -6.1939e-01 -4.5915e-05  3.0937e-02 -3.5212e+00         0.0004\n2305 -3.1208e-01 -4.5915e-05  3.0937e-02 -1.7740e+00         0.0761\n2306  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2307  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2308  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2309  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2310 -2.3772e-02 -4.5915e-05  3.0937e-02 -1.3489e-01         0.8927\n2311  1.3709e-01 -3.5415e-04  2.3855e-01  2.8140e-01         0.7784\n2312  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2313  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2314  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2315  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2316  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2317  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2318  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2319  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2320  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2321 -4.7341e-01 -4.5915e-05  3.0937e-02 -2.6913e+00         0.0071\n2322  2.1539e+00 -3.8489e-04  2.5925e-01  4.2310e+00         0.0000\n2323  2.1216e+00 -5.8327e-04  3.9280e-01  3.3861e+00         0.0007\n2324  1.1894e+00 -3.9542e-04  2.6634e-01  2.3054e+00         0.0211\n2325  1.3533e+00 -5.2066e-04  3.5066e-01  2.2863e+00         0.0222\n2326  9.6415e-01 -2.1179e-04  1.4268e-01  2.5530e+00         0.0107\n2327  1.2831e+00 -3.1515e-04  2.1229e-01  2.7854e+00         0.0053\n2328  1.6092e+00 -9.7279e-04  6.5486e-01  1.9898e+00         0.0466\n2329  1.2784e-02 -4.5915e-05  3.0937e-02  7.2945e-02         0.9418\n2330  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2331  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2332  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2333  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2334  9.4426e-02 -4.5915e-05  3.0937e-02  5.3711e-01         0.5912\n2335 -3.0647e-01 -4.5915e-05  3.0937e-02 -1.7421e+00         0.0815\n2336 -4.8142e-02 -4.5915e-05  3.0937e-02 -2.7345e-01         0.7845\n2337  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2338  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2339  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2340  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2341  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2342  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2343  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2344 -1.2491e-01 -4.5915e-05  3.0937e-02 -7.0990e-01         0.4778\n2345  2.9389e+00 -1.1753e-03  7.9101e-01  3.3057e+00         0.0009\n2346  2.9219e+00 -1.4860e-03  9.9980e-01  2.9237e+00         0.0035\n2347 -6.4644e-01 -4.5915e-05  3.0937e-02 -3.6750e+00         0.0002\n2348  1.2808e+00 -3.3436e-04  2.2523e-01  2.6995e+00         0.0069\n2349  1.2661e+00 -3.2757e-04  2.2066e-01  2.6961e+00         0.0070\n2350  6.0227e-01 -7.5473e-05  5.0852e-02  2.6711e+00         0.0076\n2351  1.2610e+00 -2.9466e-04  1.9850e-01  2.8311e+00         0.0046\n2352  1.2297e-02 -4.5915e-05  3.0937e-02  7.0174e-02         0.9441\n2353  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2354  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2355  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2356  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2357  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2358 -2.6743e-01 -1.7477e-04  1.1774e-01 -7.7886e-01         0.4361\n2359 -5.5811e-02 -3.5415e-04  2.3855e-01 -1.1354e-01         0.9096\n2360  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2361  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2362  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2363  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2364  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2365  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2366  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2367  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2368  2.3634e+00 -3.7467e-03  2.5152e+00  1.4926e+00         0.1355\n2369  1.1218e+00 -3.9542e-04  2.6634e-01  2.1745e+00         0.0297\n2370  1.7232e+00 -1.1753e-03  7.9101e-01  1.9388e+00         0.0525\n2371  4.5320e-01 -6.2215e-05  4.1920e-02  2.2138e+00         0.0268\n2372  1.0174e+00 -2.7399e-04  1.8457e-01  2.3689e+00         0.0178\n2373  8.1886e-01 -4.8480e-04  3.2651e-01  1.4339e+00         0.1516\n2374  1.5151e+00 -4.2787e-04  2.8819e-01  2.8231e+00         0.0048\n2375 -2.4335e-01 -4.5915e-05  3.0937e-02 -1.3833e+00         0.1666\n2376  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2377  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2378  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2379  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2380  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2381  9.4426e-02 -4.5915e-05  3.0937e-02  5.3711e-01         0.5912\n2382  1.2942e-02 -1.5120e-05  1.0188e-02  1.2837e-01         0.8979\n2383  6.8837e-02 -4.5915e-05  3.0937e-02  3.9162e-01         0.6953\n2384  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2385  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2386  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2387  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2388  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2389  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2390 -3.3206e-01 -4.5915e-05  3.0937e-02 -1.8876e+00         0.0591\n2391  4.4895e-01 -2.2483e-05  1.5150e-02  3.6477e+00         0.0003\n2392 -3.3084e-01 -4.5915e-05  3.0937e-02 -1.8807e+00         0.0600\n2393  9.7711e-01 -1.0336e-03  6.9574e-01  1.1727e+00         0.2409\n2394  5.7180e-01 -1.5426e-04  1.0393e-01  1.7742e+00         0.0760\n2395  4.8896e-01 -1.0583e-04  7.1302e-02  1.8315e+00         0.0670\n2396  4.6713e-01 -1.0583e-04  7.1302e-02  1.7498e+00         0.0802\n2397  1.1714e+00 -6.3592e-04  4.2823e-01  1.7910e+00         0.0733\n2398 -1.5854e-01 -4.5915e-05  3.0937e-02 -9.0111e-01         0.3675\n2399  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2400  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2401  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2402  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2403  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2404  4.5685e-02 -4.5915e-05  3.0937e-02  2.6000e-01         0.7949\n2405  2.0096e-02 -4.5915e-05  3.0937e-02  1.1451e-01         0.9088\n2406  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2407  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2408  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2409  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2410  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2411  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2412  1.0101e+00 -1.4860e-03  9.9980e-01  1.0117e+00         0.3117\n2413  1.1322e-02 -4.5915e-05  3.0937e-02  6.4632e-02         0.9485\n2414 -3.0464e-01 -4.5915e-05  3.0937e-02 -1.7318e+00         0.0833\n2415  4.7259e-01 -8.5022e-05  5.7286e-02  1.9749e+00         0.0483\n2416  4.5601e-01 -8.5022e-05  5.7286e-02  1.9056e+00         0.0567\n2417 -1.8462e-01 -4.5915e-05  3.0937e-02 -1.0494e+00         0.2940\n2418  1.5880e+00 -8.6926e-04  5.8523e-01  2.0769e+00         0.0378\n2419 -4.0469e-01 -4.5915e-05  3.0937e-02 -2.3005e+00         0.0214\n2420 -1.5854e-01 -4.5915e-05  3.0937e-02 -9.0111e-01         0.3675\n2421  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2422  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2423  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2424  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2425  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2426  1.3708e-01 -4.5915e-05  3.0937e-02  7.7958e-01         0.4356\n2427  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2428  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2429  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2430  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2431  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2432  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2433 -2.1335e-02 -4.5915e-05  3.0937e-02 -1.2103e-01         0.9037\n2434 -7.3975e-02 -4.5915e-05  3.0937e-02 -4.2032e-01         0.6743\n2435  1.2489e-01 -4.5915e-05  3.0937e-02  7.1030e-01         0.4775\n2436  3.2660e-01 -5.2145e-05  3.5135e-02  1.7427e+00         0.0814\n2437  3.1548e-01 -5.0237e-05  3.3850e-02  1.7150e+00         0.0864\n2438  3.4813e-01 -1.2890e-04  8.6849e-02  1.1817e+00         0.2373\n2439 -3.2962e-01 -4.5915e-05  3.0937e-02 -1.8738e+00         0.0610\n2440  7.2574e-01 -2.2759e-04  1.5333e-01  1.8540e+00         0.0637\n2441  4.6251e-01 -4.7017e-03  3.1532e+00  2.6311e-01         0.7925\n2442  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2443  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2444  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2445  8.3459e-02 -4.5915e-05  3.0937e-02  4.7476e-01         0.6350\n2446  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2447  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2448  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2449  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2450  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2451  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2452  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2453  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2454 -2.1335e-02 -4.5915e-05  3.0937e-02 -1.2103e-01         0.9037\n2455  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2456  7.5448e-02 -4.2963e-05  2.8949e-02  4.4369e-01         0.6573\n2457  4.3777e-01 -8.5022e-05  5.7286e-02  1.8294e+00         0.0673\n2458  8.3846e-01 -2.4397e-04  1.6435e-01  2.0688e+00         0.0386\n2459 -3.0525e-01 -4.5915e-05  3.0937e-02 -1.7352e+00         0.0827\n2460  9.6772e-01 -2.3571e-04  1.5879e-01  2.4291e+00         0.0151\n2461 -5.8868e-01 -4.5915e-05  3.0937e-02 -3.3466e+00         0.0008\n2462 -5.5615e-01 -4.5915e-05  3.0937e-02 -3.1617e+00         0.0016\n2463  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2464  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2465  8.3459e-02 -4.5915e-05  3.0937e-02  4.7476e-01         0.6350\n2466  8.3459e-02 -4.5915e-05  3.0937e-02  4.7476e-01         0.6350\n2467  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2468  9.3208e-02 -4.5915e-05  3.0937e-02  5.3018e-01         0.5960\n2469  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2470  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2471  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2472  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2473  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2474  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2475  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2476 -6.0328e-02 -4.5915e-05  3.0937e-02 -3.4272e-01         0.7318\n2477  8.4620e-01 -2.7842e-04  1.8756e-01  1.9546e+00         0.0506\n2478  6.2252e-01 -1.0583e-04  7.1302e-02  2.3317e+00         0.0197\n2479  1.0373e+00 -5.7047e-04  3.8418e-01  1.6745e+00         0.0940\n2480  4.0933e-01 -9.3329e-04  6.2829e-01  5.1759e-01         0.6047\n2481  6.7027e-01 -2.1962e-04  1.4795e-01  1.7431e+00         0.0813\n2482  2.9702e+00 -1.9255e-03  1.2950e+00  2.6118e+00         0.0090\n2483  1.9730e-02 -4.5915e-05  3.0937e-02  1.1243e-01         0.9105\n2484  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2485  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2486 -4.2833e-01 -2.4397e-04  1.6435e-01 -1.0559e+00         0.2910\n2487  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2488  9.3208e-02 -4.5915e-05  3.0937e-02  5.3018e-01         0.5960\n2489  9.3208e-02 -4.5915e-05  3.0937e-02  5.3018e-01         0.5960\n2490  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2491  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2492  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2493  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2494  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2495  9.3208e-02 -4.5915e-05  3.0937e-02  5.3018e-01         0.5960\n2496  3.8200e-01 -1.8189e-04  1.2254e-01  1.0918e+00         0.2749\n2497  1.3178e+00 -3.9542e-04  2.6634e-01  2.5542e+00         0.0106\n2498  1.3329e+00 -3.1515e-04  2.1229e-01  2.8935e+00         0.0038\n2499  6.8700e-01 -2.1179e-04  1.4268e-01  1.8193e+00         0.0689\n2500  7.1502e-01 -1.0583e-04  7.1302e-02  2.6781e+00         0.0074\n2501 -6.6228e-01 -4.5915e-05  3.0937e-02 -3.7651e+00         0.0002\n2502  1.2893e+00 -8.7399e-04  5.8841e-01  1.6819e+00         0.0926\n2503  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2504  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2505  8.3459e-02 -4.5915e-05  3.0937e-02  4.7476e-01         0.6350\n2506  8.3459e-02 -4.5915e-05  3.0937e-02  4.7476e-01         0.6350\n2507  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2508 -3.6984e-01 -1.8189e-04  1.2254e-01 -1.0560e+00         0.2910\n2509  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2510  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2511  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2512  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2513  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2514  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2515  7.6417e-02 -1.8189e-04  1.2254e-01  2.1882e-01         0.8268\n2516  1.7378e+00 -3.5415e-04  2.3855e-01  3.5588e+00         0.0004\n2517  1.2738e+00 -4.0610e-04  2.7353e-01  2.4364e+00         0.0148\n2518  1.0246e+00 -1.4130e-04  9.5197e-02  3.3212e+00         0.0009\n2519 -5.0144e-01 -4.5915e-05  3.0937e-02 -2.8506e+00         0.0044\n2520  6.2790e+00 -1.5905e-03  1.0700e+00  6.0716e+00         0.0000\n2521  2.2127e+00 -5.0856e-04  3.4251e-01  3.7816e+00         0.0002\n2522 -9.6031e-02 -4.5915e-05  3.0937e-02 -5.4571e-01         0.5853\n2523  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2524  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2525  8.3459e-02 -4.5915e-05  3.0937e-02  4.7476e-01         0.6350\n2526  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2527  9.3208e-02 -4.5915e-05  3.0937e-02  5.3018e-01         0.5960\n2528 -8.6321e-04 -4.5915e-05  3.0937e-02 -4.6466e-03         0.9963\n2529  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2530  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2531  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2532 -8.8963e-02 -4.5915e-05  3.0937e-02 -5.0553e-01         0.6132\n2533 -5.1362e-01 -4.5915e-05  3.0937e-02 -2.9199e+00         0.0035\n2534 -7.8779e-01 -4.5915e-05  3.0937e-02 -4.4786e+00         0.0000\n2535  2.8831e+00 -5.3290e-04  3.5889e-01  4.8135e+00         0.0000\n2536  1.6559e+00 -8.6926e-04  5.8523e-01  2.1656e+00         0.0303\n2537  1.1652e+00 -2.9650e-04  1.9973e-01  2.6080e+00         0.0091\n2538  1.4915e+00 -8.5022e-05  5.7286e-02  6.2321e+00         0.0000\n2539  5.9569e+00 -9.3329e-04  6.2829e-01  7.5164e+00         0.0000\n2540  1.3232e+00 -3.4418e-04  2.3184e-01  2.7488e+00         0.0060\n2541  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2542  1.5901e-01 -4.5915e-05  3.0937e-02  9.0428e-01         0.3658\n2543  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2544  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2545  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2546 -8.6321e-04 -4.5915e-05  3.0937e-02 -4.6466e-03         0.9963\n2547 -8.6618e-03 -4.5915e-05  3.0937e-02 -4.8985e-02         0.9609\n2548  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2549  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2550 -2.2635e-01 -4.5915e-05  4.6429e-02 -1.0503e+00         0.2936\n2551 -1.0090e+00 -4.5915e-05  3.0937e-02 -5.7360e+00         0.0000\n2552  1.8472e+00 -4.8480e-04  3.2651e-01  3.2334e+00         0.0012\n2553  5.9433e+00 -4.9761e-03  3.3364e+00  3.2565e+00         0.0011\n2554 -6.5741e-01 -4.5915e-05  3.0937e-02 -3.7374e+00         0.0002\n2555  2.0529e+00 -6.1989e-04  4.1744e-01  3.1783e+00         0.0015\n2556  6.3937e-01 -7.7750e-04  5.2350e-01  8.8475e-01         0.3763\n2557  1.6215e+01 -3.0737e-02  2.0075e+01  3.6259e+00         0.0003\n2558  3.0841e+00 -8.8189e-04  5.9372e-01  4.0037e+00         0.0001\n2559 -2.4676e-01 -4.5915e-05  3.0937e-02 -1.4027e+00         0.1607\n2560  6.8837e-02 -4.5915e-05  3.0937e-02  3.9162e-01         0.6953\n2561 -4.3268e-02 -4.5915e-05  3.0937e-02 -2.4573e-01         0.8059\n2562  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2563  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2564  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2565 -1.7402e-01 -1.9062e-04  1.2842e-01 -4.8509e-01         0.6276\n2566  8.5409e-02 -4.5915e-05  3.0937e-02  4.8584e-01         0.6271\n2567  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2568  4.5923e+00 -2.8457e-03  1.9121e+00  3.3231e+00         0.0009\n2569  7.8749e+00 -9.4484e-03  6.3065e+00  3.1396e+00         0.0017\n2570  1.5018e+00 -1.1571e-03  7.7877e-01  1.7031e+00         0.0886\n2571  3.4136e+00 -3.9117e-03  2.6255e+00  2.1091e+00         0.0349\n2572  5.6408e-01 -2.3571e-04  1.5879e-01  1.4161e+00         0.1567\n2573  1.8970e+00 -7.7750e-04  5.2350e-01  2.6229e+00         0.0087\n2574 -1.3639e+00 -4.5915e-05  3.0937e-02 -7.7541e+00         0.0000\n2575  5.9948e+00 -8.0752e-04  5.4369e-01  8.1313e+00         0.0000\n2576  6.8921e+00 -1.4049e-03  9.4532e-01  7.0900e+00         0.0000\n2577 -2.0704e-01 -4.5915e-05  3.0937e-02 -1.1768e+00         0.2393\n2578 -4.0283e-02 -8.2911e-07  5.5868e-04 -1.7042e+00         0.0883\n2579 -1.9169e-01 -4.5915e-05  3.0937e-02 -1.0895e+00         0.2759\n2580  2.6676e-02 -4.5915e-05  3.0937e-02  1.5192e-01         0.8792\n2581  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2582  9.1746e-02 -4.5915e-05  3.0937e-02  5.2187e-01         0.6018\n2583 -2.0571e-01 -2.3082e-04  1.5550e-01 -5.2107e-01         0.6023\n2584  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2585  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2586 -7.8175e-01 -4.5915e-05  3.7134e-02 -4.0565e+00         0.0000\n2587  1.6431e+01 -8.1971e-03  5.4782e+00  7.0238e+00         0.0000\n2588 -7.6586e-01 -4.5915e-05  3.0937e-02 -4.3539e+00         0.0000\n2589 -7.3662e-01 -4.5915e-05  3.0937e-02 -4.1877e+00         0.0000\n2590 -4.3320e-01 -4.5915e-05  3.0937e-02 -2.4626e+00         0.0138\n2591  1.4772e+00 -4.1691e-04  2.8081e-01  2.7884e+00         0.0053\n2592 -5.3190e-01 -4.5915e-05  3.0937e-02 -3.0238e+00         0.0025\n2593  7.8941e+00 -1.2837e-03  8.6389e-01  8.4947e+00         0.0000\n2594  3.4355e+00 -2.6959e-04  1.8161e-01  8.0621e+00         0.0000\n2595  3.5254e+00 -3.3436e-04  2.2523e-01  7.4292e+00         0.0000\n2596  4.2490e-01 -1.6779e-04  1.1304e-01  1.2643e+00         0.2061\n2597  2.5061e+00 -1.4049e-03  9.4532e-01  2.5790e+00         0.0099\n2598 -3.6947e-01 -4.5915e-05  3.0937e-02 -2.1003e+00         0.0357\n2599  2.6676e-02 -4.5915e-05  3.0937e-02  1.5192e-01         0.8792\n2600  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2601 -8.6618e-03 -4.5915e-05  3.0937e-02 -4.8985e-02         0.9609\n2602  8.5409e-02 -4.5915e-05  3.0937e-02  4.8584e-01         0.6271\n2603  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2604 -2.2849e-01 -4.5915e-05  6.1921e-02 -9.1802e-01         0.3586\n2605  8.7508e+00 -4.1212e-03  2.7655e+00  5.2646e+00         0.0000\n2606  4.5054e+00 -7.7750e-04  5.2350e-01  6.2281e+00         0.0000\n2607 -6.1950e-04 -4.5915e-05  3.0937e-02 -3.2611e-03         0.9974\n2608  3.7621e-01 -5.8080e-05  3.9134e-02  1.9021e+00         0.0572\n2609 -4.5879e-01 -4.5915e-05  3.0937e-02 -2.6081e+00         0.0091\n2610  1.8347e+00 -2.9650e-04  1.9973e-01  4.1060e+00         0.0000\n2611  4.3829e+00 -3.2427e-03  2.1779e+00  2.9721e+00         0.0030\n2612  2.4499e+00 -6.2255e-04  4.1923e-01  3.7847e+00         0.0002\n2613  1.5907e+01 -3.8587e-02  2.4998e+01  3.1893e+00         0.0014\n2614  1.9215e+00 -1.1826e-03  7.9593e-01  2.1551e+00         0.0312\n2615  2.8682e+00 -1.2590e-03  8.4727e-01  3.1174e+00         0.0018\n2616  2.2409e+00 -9.9622e-04  6.7061e-01  2.7377e+00         0.0062\n2617  1.4528e-01 -7.8644e-04  5.2951e-01  2.0073e-01         0.8409\n2618  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2619  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2620  8.5409e-02 -4.5915e-05  3.0937e-02  4.8584e-01         0.6271\n2621  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2622  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2623  7.8824e-01 -1.4860e-03  9.9980e-01  7.8981e-01         0.4296\n2624  4.9620e+00 -1.1033e-03  7.4262e-01  5.7593e+00         0.0000\n2625 -1.5050e-01 -4.5915e-05  3.0937e-02 -8.5538e-01         0.3923\n2626  5.1778e-02 -4.5915e-05  3.0937e-02  2.9464e-01         0.7683\n2627  6.4631e-01 -5.2066e-04  3.5066e-01  1.0923e+00         0.2747\n2628  3.5050e+00 -8.2274e-04  5.5393e-01  4.7104e+00         0.0000\n2629 -9.4133e-01 -4.5915e-05  3.0937e-02 -5.3515e+00         0.0000\n2630  6.9859e+00 -2.2848e-03  1.5361e+00  5.6385e+00         0.0000\n2631 -1.5652e+00 -4.5915e-05  3.0937e-02 -8.8986e+00         0.0000\n2632  7.1162e+00 -9.6615e-04  6.5040e-01  8.8251e+00         0.0000\n2633 -7.6720e-01 -4.5915e-05  3.0937e-02 -4.3616e+00         0.0000\n2634  4.9537e+00 -2.1666e-03  1.4567e+00  4.1061e+00         0.0000\n2635  9.1113e-01 -1.7273e-03  1.1619e+00  8.4687e-01         0.3971\n2636  2.6676e-02 -4.5915e-05  3.0937e-02  1.5192e-01         0.8792\n2637  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2638  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2639  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2640  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2641  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2642 -1.2491e-01 -4.5915e-05  4.6429e-02 -5.7949e-01         0.5623\n2643 -8.1606e-01 -4.5915e-05  3.0937e-02 -4.6394e+00         0.0000\n2644  2.3040e+00 -1.0336e-03  6.9574e-01  2.7634e+00         0.0057\n2645  1.0052e-01 -4.5915e-05  3.0937e-02  5.7175e-01         0.5675\n2646  2.7643e-01 -6.6492e-05  4.4802e-02  1.3063e+00         0.1915\n2647  1.6682e+00 -3.9542e-04  2.6634e-01  3.2332e+00         0.0012\n2648  5.4488e+00 -8.9372e-03  5.9684e+00  2.2340e+00         0.0255\n2649  3.7246e+00 -2.5819e-03  1.7353e+00  2.8294e+00         0.0047\n2650  3.1252e+00 -5.7047e-04  3.8418e-01  5.0430e+00         0.0000\n2651  5.6000e+00 -5.5529e-04  3.7396e-01  9.1584e+00         0.0000\n2652  2.8912e+00 -1.1607e-03  7.8121e-01  3.2724e+00         0.0011\n2653  3.1260e+00 -9.3329e-04  6.2829e-01  3.9449e+00         0.0001\n2654 -6.1976e-01 -4.5915e-05  3.0937e-02 -3.5233e+00         0.0004\n2655 -1.9424e-01 -4.5915e-05  3.0937e-02 -1.1041e+00         0.2696\n2656  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2657  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2658  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2659  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2660  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2661 -2.1630e-01 -4.5915e-05  3.0937e-02 -1.2295e+00         0.2189\n2662  1.2090e+00 -1.8189e-04  1.2254e-01  3.4543e+00         0.0006\n2663 -3.1500e-01 -4.5915e-05  3.0937e-02 -1.7906e+00         0.0734\n2664 -1.4563e-01 -4.5915e-05  3.0937e-02 -8.2767e-01         0.4079\n2665  1.4501e+00 -3.9542e-04  2.6634e-01  2.8105e+00         0.0049\n2666  4.7137e+00 -1.2875e-03  8.6646e-01  5.0654e+00         0.0000\n2667 -6.5010e-01 -4.5915e-05  3.0937e-02 -3.6958e+00         0.0002\n2668  3.0327e+00 -5.8844e-04  3.9627e-01  4.8185e+00         0.0000\n2669  6.3593e+00 -3.2731e-03  2.1983e+00  4.2913e+00         0.0000\n2670  3.0345e+00 -1.0682e-03  7.1899e-01  3.5800e+00         0.0003\n2671  1.6278e+00 -4.1691e-04  2.8081e-01  3.0725e+00         0.0021\n2672  1.6569e+00 -8.6926e-04  5.8523e-01  2.1670e+00         0.0302\n2673 -2.4957e-01 -4.5915e-05  3.0937e-02 -1.4186e+00         0.1560\n2674  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2675  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2676  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2677  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2678  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2679  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2680  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2681  3.9689e-01 -1.2875e-03  8.6646e-01  4.2777e-01         0.6688\n2682  1.7831e+00 -2.0443e-03  1.3747e+00  1.5226e+00         0.1279\n2683  1.2678e-01 -1.4130e-04  9.5197e-02  4.1136e-01         0.6808\n2684  6.1847e-01 -1.8189e-04  1.2254e-01  1.7673e+00         0.0772\n2685  2.1240e+00 -5.7047e-04  3.8418e-01  3.4277e+00         0.0006\n2686  1.6861e+00 -2.9650e-04  1.9973e-01  3.7734e+00         0.0002\n2687 -4.7268e-01 -4.5915e-05  3.0937e-02 -2.6871e+00         0.0072\n2688  5.7246e+00 -2.1666e-03  1.4567e+00  4.7448e+00         0.0000\n2689  4.5535e+00 -1.7384e-03  1.1694e+00  4.2125e+00         0.0000\n2690  1.1542e+00 -1.9655e-04  1.3242e-01  3.1724e+00         0.0015\n2691  2.0870e+00 -7.0493e-04  4.7467e-01  3.0302e+00         0.0024\n2692 -4.0152e-01 -4.5915e-05  3.0937e-02 -2.2825e+00         0.0225\n2693 -1.1394e-01 -4.5915e-05  3.0937e-02 -6.4755e-01         0.5173\n2694  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2695  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2696  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n2697  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2698  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2699  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2700 -1.7731e-01 -4.5915e-05  3.0937e-02 -1.0078e+00         0.3136\n2701 -9.2890e-01 -4.5915e-05  3.0937e-02 -5.2809e+00         0.0000\n2702 -6.2890e-01 -4.5915e-05  3.0937e-02 -3.5752e+00         0.0003\n2703  7.6272e-01 -1.4130e-04  9.5197e-02  2.4725e+00         0.0134\n2704  1.6879e+00 -3.9542e-04  2.6634e-01  3.2713e+00         0.0011\n2705  9.8597e-01 -1.1138e-04  7.5045e-02  3.5996e+00         0.0003\n2706 -1.5294e-01 -4.5915e-05  3.0937e-02 -8.6924e-01         0.3847\n2707  1.7971e+00 -5.3290e-04  3.5889e-01  3.0007e+00         0.0027\n2708  4.8931e+00 -1.2875e-03  8.6646e-01  5.2581e+00         0.0000\n2709 -6.9555e-01 -4.5915e-05  3.0937e-02 -3.9542e+00         0.0001\n2710  1.7678e+00 -3.9119e-04  2.6350e-01  3.4445e+00         0.0006\n2711 -6.7081e-01 -4.5915e-05  3.0937e-02 -3.8136e+00         0.0001\n2712  6.3179e-01 -1.6118e-03  1.0844e+00  6.0827e-01         0.5430\n2713  1.0052e-01 -4.5915e-05  3.0937e-02  5.7175e-01         0.5675\n2714  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2715  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n2716  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n2717  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2718  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2719  6.6400e-02 -4.5915e-05  3.0937e-02  3.7777e-01         0.7056\n2720  1.0985e+00 -9.0099e-04  6.0657e-01  1.4116e+00         0.1581\n2721  2.7403e+00 -1.0998e-03  7.4024e-01  3.1863e+00         0.0014\n2722  2.0619e+00 -9.6284e-04  6.4817e-01  2.5623e+00         0.0104\n2723  1.2867e+00 -2.2359e-04  1.5063e-01  3.3159e+00         0.0009\n2724  2.1325e+00 -6.6310e-04  4.4652e-01  3.1923e+00         0.0014\n2725  5.6604e-01 -3.1515e-04  2.1229e-01  1.2292e+00         0.2190\n2726  4.6535e-01 -3.5415e-04  2.3855e-01  9.5351e-01         0.3403\n2727  1.8843e+00 -3.2468e-04  2.1871e-01  4.0298e+00         0.0001\n2728  1.7168e+00 -3.7450e-04  2.5226e-01  3.4189e+00         0.0006\n2729  1.4723e+00 -4.7895e-04  3.2257e-01  2.5932e+00         0.0095\n2730  2.1052e+00 -5.3290e-04  3.5889e-01  3.5149e+00         0.0004\n2731  2.6766e+00 -1.4860e-03  9.9980e-01  2.6783e+00         0.0074\n2732  5.0252e-02 -1.4130e-04  9.5197e-02  1.6333e-01         0.8703\n2733  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2734  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2735 -2.5286e-01 -8.5022e-05  5.7286e-02 -1.0561e+00         0.2909\n2736  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2737  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2738  6.6917e-03 -4.5915e-05  4.6429e-02  3.1269e-02         0.9751\n2739 -3.9494e-01 -4.5915e-05  3.0937e-02 -2.2451e+00         0.0248\n2740  2.8978e+00 -2.0684e-03  1.3909e+00  2.4588e+00         0.0139\n2741  2.0491e+00 -5.3290e-04  3.5889e-01  3.4214e+00         0.0006\n2742  2.7491e+00 -9.3329e-04  6.2829e-01  3.4695e+00         0.0005\n2743  2.4134e+00 -7.7750e-04  5.2350e-01  3.3367e+00         0.0008\n2744  1.3069e+00 -3.2468e-04  2.1871e-01  2.7951e+00         0.0052\n2745 -3.0623e-01 -4.5915e-05  3.0937e-02 -1.7408e+00         0.0817\n2746  1.1021e+00 -2.1179e-04  1.4268e-01  2.9182e+00         0.0035\n2747  1.7453e+00 -3.7450e-04  2.5226e-01  3.4757e+00         0.0005\n2748  1.5066e+00 -5.0856e-04  3.4251e-01  2.5752e+00         0.0100\n2749  2.5287e+00 -7.0493e-04  4.7467e-01  3.6713e+00         0.0002\n2750  3.1109e+00 -1.2875e-03  8.6646e-01  3.3434e+00         0.0008\n2751 -5.6797e-01 -4.5915e-05  3.0937e-02 -3.2289e+00         0.0012\n2752  1.0052e-01 -4.5915e-05  3.0937e-02  5.7175e-01         0.5675\n2753  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2754  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n2755  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n2756  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2757  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2758  3.0662e-01 -3.7450e-04  2.5226e-01  6.1125e-01         0.5410\n2759 -8.0315e-01 -4.5915e-05  3.0937e-02 -4.5659e+00         0.0000\n2760  3.4657e+00 -4.9661e-04  3.3447e-01  5.9934e+00         0.0000\n2761  2.9530e+00 -7.7750e-04  5.2350e-01  4.0824e+00         0.0000\n2762  2.1944e+00 -5.7047e-04  3.8418e-01  3.5413e+00         0.0004\n2763  1.7735e+00 -5.0856e-04  3.4251e-01  3.0312e+00         0.0024\n2764  5.8801e-01 -2.2599e-04  1.5224e-01  1.5076e+00         0.1317\n2765  7.3467e-01 -3.7450e-04  2.5226e-01  1.4635e+00         0.1433\n2766  9.3284e-01 -2.4397e-04  1.6435e-01  2.3016e+00         0.0214\n2767  1.3029e+00 -3.5415e-04  2.3855e-01  2.6684e+00         0.0076\n2768  2.2659e+00 -5.5780e-04  3.7566e-01  3.6979e+00         0.0002\n2769  2.7985e+00 -1.1033e-03  7.4262e-01  3.2487e+00         0.0012\n2770  3.8016e+00 -2.2316e-03  1.5004e+00  3.1055e+00         0.0019\n2771  1.0052e-01 -4.5915e-05  3.0937e-02  5.7175e-01         0.5675\n2772  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2773  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2774  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n2775  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2776  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2777 -5.3017e-02 -4.5915e-05  6.1921e-02 -2.1287e-01         0.8314\n2778  2.4896e+00 -3.2914e-03  2.2106e+00  1.6767e+00         0.0936\n2779  3.0882e+00 -5.0856e-04  3.4251e-01  5.2777e+00         0.0000\n2780  3.3845e+00 -5.7685e-04  3.8848e-01  5.4311e+00         0.0000\n2781  2.4459e+00 -5.6538e-04  3.8076e-01  3.9647e+00         0.0001\n2782  1.6952e+00 -4.5362e-04  3.0552e-01  3.0678e+00         0.0022\n2783  1.3450e+00 -2.5237e-04  1.7001e-01  3.2626e+00         0.0011\n2784  1.1992e-01 -7.9638e-06  5.3662e-03  1.6372e+00         0.1016\n2785  8.9229e-01 -3.0203e-04  2.0346e-01  1.9789e+00         0.0478\n2786  1.6989e+00 -6.7690e-04  4.5581e-01  2.5173e+00         0.0118\n2787  1.2090e+00 -4.9069e-04  3.3048e-01  2.1040e+00         0.0354\n2788  2.1998e+00 -3.8489e-04  2.5925e-01  4.3210e+00         0.0000\n2789 -9.2013e-01 -4.5915e-05  3.0937e-02 -5.2310e+00         0.0000\n2790 -3.9006e-01 -4.5915e-05  3.0937e-02 -2.2174e+00         0.0266\n2791  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2792  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2793  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2794  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2795  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2796  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2797 -5.5613e-01 -4.5915e-05  3.7134e-02 -2.8857e+00         0.0039\n2798  3.0436e+00 -7.3353e-04  4.9391e-01  4.3318e+00         0.0000\n2799  8.6345e+00 -6.7688e-03  4.5302e+00  4.0600e+00         0.0000\n2800  2.6137e+00 -6.0275e-04  4.0591e-01  4.1034e+00         0.0000\n2801  1.4366e+00 -3.1515e-04  2.1229e-01  3.1187e+00         0.0018\n2802  6.4342e-01 -6.0130e-05  4.0515e-02  3.1969e+00         0.0014\n2803  8.5525e-01 -1.0583e-04  7.1302e-02  3.2033e+00         0.0014\n2804  4.6254e-01 -9.0010e-05  6.0646e-02  1.8786e+00         0.0603\n2805 -6.0648e-01 -4.5915e-05  3.0937e-02 -3.4478e+00         0.0006\n2806 -8.0741e-01 -4.5915e-05  3.0937e-02 -4.5902e+00         0.0000\n2807  2.0853e+00 -8.6926e-04  5.8523e-01  2.7270e+00         0.0064\n2808  1.6945e+00 -7.0493e-04  4.7467e-01  2.4606e+00         0.0139\n2809  5.8760e-01 -4.2523e-03  2.8531e+00  3.5039e-01         0.7260\n2810  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2811  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2812  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2813  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2814  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2815  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2816  2.2350e+00 -1.4614e-03  9.8330e-01  2.2554e+00         0.0241\n2817  5.3396e+00 -1.0682e-03  7.1899e-01  6.2985e+00         0.0000\n2818  4.2134e+00 -8.3194e-04  5.6012e-01  5.6309e+00         0.0000\n2819  2.2434e+00 -7.7750e-04  5.2350e-01  3.1018e+00         0.0019\n2820  4.6849e-01 -3.3047e-04  2.2261e-01  9.9366e-01         0.3204\n2821  3.4837e+00 -2.6914e-03  1.8087e+00  2.5923e+00         0.0095\n2822  6.9240e-01 -2.4397e-04  1.6435e-01  1.7085e+00         0.0875\n2823  6.0436e-01 -5.7047e-04  3.8418e-01  9.7598e-01         0.3291\n2824  4.5322e+00 -3.2003e-03  2.1496e+00  3.0935e+00         0.0020\n2825 -6.8641e-01 -4.5915e-05  3.0937e-02 -3.9022e+00         0.0001\n2826  2.7200e+00 -7.1916e-04  4.8425e-01  3.9097e+00         0.0001\n2827 -4.5684e-01 -4.5915e-05  3.0937e-02 -2.5970e+00         0.0094\n2828 -1.4319e-01 -4.5915e-05  3.0937e-02 -8.1382e-01         0.4158\n2829  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2830  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2831  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2832  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2833  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2834 -2.2556e-01 -4.5915e-05  6.1921e-02 -9.0627e-01         0.3648\n2835  2.2358e+00 -5.0856e-04  3.4251e-01  3.8211e+00         0.0001\n2836  4.5807e+00 -6.3592e-04  4.2823e-01  7.0009e+00         0.0000\n2837  2.2711e+00 -6.4672e-04  4.3550e-01  3.4424e+00         0.0006\n2838  2.4424e-01 -2.4551e-05  1.6543e-02  1.8991e+00         0.0575\n2839 -7.3722e-01 -4.5915e-05  3.0937e-02 -4.1911e+00         0.0000\n2840  3.3652e+00 -4.8480e-04  3.2651e-01  5.8902e+00         0.0000\n2841 -4.6196e-01 -4.5915e-05  3.0937e-02 -2.6261e+00         0.0086\n2842 -8.5140e-01 -4.5915e-05  3.0937e-02 -4.8403e+00         0.0000\n2843  6.9463e+00 -3.5853e-03  2.4072e+00  4.4794e+00         0.0000\n2844  2.0768e+00 -3.7760e-04  2.5434e-01  4.1187e+00         0.0000\n2845  2.0431e+00 -8.1359e-04  5.4778e-01  2.7616e+00         0.0058\n2846 -1.4319e-01 -4.5915e-05  3.0937e-02 -8.1382e-01         0.4158\n2847  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2848  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2849  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2850  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2851  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2852 -2.2186e-01 -4.5915e-05  3.7134e-02 -1.1511e+00         0.2497\n2853  3.9985e+00 -3.9117e-03  2.6255e+00  2.4701e+00         0.0135\n2854  3.6081e+00 -1.2308e-03  8.2830e-01  3.9658e+00         0.0001\n2855  1.1174e+00 -5.2066e-04  3.5066e-01  1.8878e+00         0.0590\n2856 -1.9510e-01 -4.5915e-05  3.0937e-02 -1.1089e+00         0.2675\n2857  6.7097e+00 -2.5387e-03  1.7063e+00  5.1385e+00         0.0000\n2858  2.0735e+00 -7.7750e-04  5.2350e-01  2.8668e+00         0.0041\n2859  1.2562e+00 -9.5953e-04  6.4594e-01  1.5642e+00         0.1178\n2860  7.8381e+00 -2.8315e-03  1.9026e+00  5.6846e+00         0.0000\n2861  3.5736e+00 -6.7690e-04  4.5581e-01  5.2942e+00         0.0000\n2862  3.7594e+00 -7.1630e-04  4.8232e-01  5.4142e+00         0.0000\n2863 -1.8754e-01 -4.5915e-05  3.0937e-02 -1.0660e+00         0.2864\n2864  5.4215e-02 -4.5915e-05  3.0937e-02  3.0849e-01         0.7577\n2865  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2866  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2867  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2868  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2869  1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420\n2870 -2.6504e-01 -4.5915e-05  3.0937e-02 -1.5066e+00         0.1319\n2871  3.0312e+00 -7.7750e-04  5.2350e-01  4.1905e+00         0.0000\n2872 -9.2159e-01 -4.5915e-05  3.0937e-02 -5.2393e+00         0.0000\n2873 -1.6147e-01 -4.5915e-05  3.0937e-02 -9.1773e-01         0.3588\n2874  1.1612e+00 -1.5905e-03  1.0700e+00  1.1241e+00         0.2610\n2875  7.6292e+00 -4.9761e-03  3.3364e+00  4.1795e+00         0.0000\n2876 -4.9973e-01 -4.5915e-05  3.0937e-02 -2.8409e+00         0.0045\n2877  3.0922e+00 -8.0752e-04  5.4369e-01  4.1948e+00         0.0000\n2878  7.4439e+00 -2.4747e-03  1.6634e+00  5.7736e+00         0.0000\n2879  6.3154e+00 -3.1522e-03  2.1174e+00  4.3423e+00         0.0000\n2880  2.6829e+00 -1.5693e-03  1.0558e+00  2.6126e+00         0.0090\n2881 -7.0076e-02 -4.5915e-05  3.0937e-02 -3.9815e-01         0.6905\n2882 -9.6884e-02 -4.5915e-05  3.0937e-02 -5.5056e-01         0.5819\n2883  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2884  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2885  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2886  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2887 -2.8941e-01 -4.5915e-05  3.0937e-02 -1.6452e+00         0.0999\n2888  2.8409e+00 -2.6914e-03  1.8087e+00  2.1144e+00         0.0345\n2889  1.3464e+00 -7.7750e-04  5.2350e-01  1.8619e+00         0.0626\n2890 -2.7427e-02 -4.5915e-05  3.0937e-02 -1.5567e-01         0.8763\n2891  2.6477e+00 -3.9542e-04  2.6634e-01  5.1311e+00         0.0000\n2892  1.7106e+00 -2.4397e-04  1.6435e-01  4.2201e+00         0.0000\n2893  2.1115e+00 -7.9244e-04  5.3355e-01  2.8918e+00         0.0038\n2894  3.9726e+00 -9.3329e-04  6.2829e-01  5.0130e+00         0.0000\n2895  3.9413e+00 -6.3592e-04  4.2823e-01  6.0238e+00         0.0000\n2896  5.2552e+00 -1.4229e-03  9.5745e-01  5.3722e+00         0.0000\n2897 -4.4295e-01 -4.5915e-05  3.0937e-02 -2.5181e+00         0.0118\n2898  6.3158e-01 -4.8480e-04  3.2651e-01  1.1061e+00         0.2687\n2899 -1.9680e-01 -4.5915e-05  3.0937e-02 -1.1186e+00         0.2633\n2900  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2901  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2902  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2903 -2.4067e-01 -4.5915e-05  3.0937e-02 -1.3680e+00         0.1713\n2904  2.8166e+00 -1.4860e-03  9.9980e-01  2.8183e+00         0.0048\n2905 -1.4319e-01 -4.5915e-05  3.0937e-02 -8.1382e-01         0.4158\n2906 -8.3507e-01 -4.5915e-05  3.0937e-02 -4.7474e+00         0.0000\n2907  2.9382e+00 -6.0275e-04  4.0591e-01  4.6128e+00         0.0000\n2908  1.0029e+00 -1.8189e-04  1.2254e-01  2.8654e+00         0.0042\n2909  2.3786e+00 -6.3592e-04  4.2823e-01  3.6357e+00         0.0003\n2910  3.3741e+00 -7.2777e-04  4.9004e-01  4.8210e+00         0.0000\n2911  4.9033e+00 -9.9958e-04  6.7288e-01  5.9787e+00         0.0000\n2912  2.1770e+00 -4.3897e-04  2.9566e-01  4.0045e+00         0.0001\n2913  9.8225e-01 -4.1691e-04  2.8081e-01  1.8544e+00         0.0637\n2914  1.4062e+00 -6.9085e-04  4.6519e-01  2.0628e+00         0.0391\n2915 -4.5705e-02 -4.5915e-05  3.0937e-02 -2.5959e-01         0.7952\n2916  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2917  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2918 -3.7325e-01 -4.5915e-05  3.0937e-02 -2.1218e+00         0.0339\n2919  1.1883e+00 -9.3329e-04  6.2829e-01  1.5004e+00         0.1335\n2920 -3.8300e-01 -4.5915e-05  3.0937e-02 -2.1772e+00         0.0295\n2921  2.3412e+00 -3.5415e-04  2.3855e-01  4.7942e+00         0.0000\n2922  2.5626e+00 -1.0682e-03  7.1899e-01  3.0234e+00         0.0025\n2923  1.6718e+00 -3.9542e-04  2.6634e-01  3.2401e+00         0.0012\n2924  1.1112e+00 -8.5022e-05  5.7286e-02  4.6428e+00         0.0000\n2925  4.8198e+00 -1.6986e-03  1.1426e+00  4.5105e+00         0.0000\n2926  3.7675e+00 -9.8949e-04  6.6609e-01  4.6174e+00         0.0000\n2927  1.8451e+00 -8.6926e-04  5.8523e-01  2.4131e+00         0.0158\n2928  1.1837e+00 -2.6091e-04  1.7576e-01  2.8241e+00         0.0047\n2929  2.9598e-01 -1.9255e-03  1.2950e+00  2.6179e-01         0.7935\n2930  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2931  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2932  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2933  3.2763e-01 -1.3379e-04  9.0143e-02  1.0917e+00         0.2750\n2934  1.5221e-02 -4.5915e-05  3.0937e-02  8.6801e-02         0.9308\n2935  7.4245e-02 -1.3848e-02  9.2022e+00  2.9040e-02         0.9768\n2936  1.7201e+00 -3.9542e-04  2.6634e-01  3.3337e+00         0.0009\n2937  1.7186e+00 -4.2787e-04  2.8819e-01  3.2021e+00         0.0014\n2938  2.1011e+00 -5.5780e-04  3.7566e-01  3.4290e+00         0.0006\n2939  3.2178e+00 -8.6926e-04  5.8523e-01  4.2074e+00         0.0000\n2940  5.3966e+00 -1.4573e-03  9.8056e-01  5.4513e+00         0.0000\n2941  2.2889e+00 -5.0856e-04  3.4251e-01  3.9119e+00         0.0001\n2942  1.2262e+00 -2.9650e-04  1.9973e-01  2.7445e+00         0.0061\n2943  8.5132e-01 -1.1708e-04  7.8884e-02  3.0315e+00         0.0024\n2944 -4.5705e-02 -4.5915e-05  3.0937e-02 -2.5959e-01         0.7952\n2945  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n2946  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2947  1.0198e-01 -4.5915e-05  3.0937e-02  5.8006e-01         0.5619\n2948 -1.7828e-01 -4.5915e-05  3.0937e-02 -1.0133e+00         0.3109\n2949 -3.8300e-01 -4.5915e-05  3.0937e-02 -2.1772e+00         0.0295\n2950  1.0186e+00 -8.5022e-05  5.7286e-02  4.2563e+00         0.0000\n2951  1.6195e+00 -4.8480e-04  3.2651e-01  2.8350e+00         0.0046\n2952  1.1452e+00 -1.8189e-04  1.2254e-01  3.2721e+00         0.0011\n2953  3.3177e+00 -1.8330e-03  1.2329e+00  2.9896e+00         0.0028\n2954  2.9549e+00 -4.8011e-04  3.2336e-01  5.1972e+00         0.0000\n2955  3.8775e+00 -7.0493e-04  4.7467e-01  5.6290e+00         0.0000\n2956  1.4823e+00 -3.3925e-04  2.2852e-01  3.1014e+00         0.0019\n2957  7.3001e-01 -1.4130e-04  9.5197e-02  2.3665e+00         0.0180\n2958 -2.7235e-01 -4.5915e-05  3.0937e-02 -1.5482e+00         0.1216\n2959  1.7659e-02 -4.5915e-05  3.0937e-02  1.0066e-01         0.9198\n2960  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n2961  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n2962 -9.5422e-02 -4.5915e-05  3.0937e-02 -5.4225e-01         0.5876\n2963 -6.5202e-02 -4.5915e-05  3.0937e-02 -3.7044e-01         0.7111\n2964 -4.5611e-01 -4.5915e-05  3.0937e-02 -2.5929e+00         0.0095\n2965  2.6959e+00 -4.3897e-04  2.9566e-01  4.9587e+00         0.0000\n2966  1.1799e+00 -4.6735e-04  3.1477e-01  2.1039e+00         0.0354\n2967  1.8037e+00 -4.5248e-04  3.0476e-01  3.2680e+00         0.0011\n2968  1.7968e+00 -3.8699e-04  2.6066e-01  3.5201e+00         0.0004\n2969  7.7518e+00 -3.2305e-03  2.1698e+00  5.2647e+00         0.0000\n2970  2.4167e+00 -5.5780e-04  3.7566e-01  3.9439e+00         0.0001\n2971  6.4338e-01 -8.5022e-05  5.7286e-02  2.6885e+00         0.0072\n2972  5.7823e-01 -6.3592e-04  4.2823e-01  8.8459e-01         0.3764\n2973  1.7659e-02 -4.5915e-05  3.0937e-02  1.0066e-01         0.9198\n2974 -1.5973e-02 -4.5915e-05  3.7134e-02 -8.2652e-02         0.9341\n2975  9.8082e-02 -4.5915e-05  3.0937e-02  5.5789e-01         0.5769\n2976  5.1250e-01 -2.9650e-04  1.9973e-01  1.1474e+00         0.2512\n2977  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n2978 -1.4032e+00 -4.5915e-05  3.0937e-02 -7.9772e+00         0.0000\n2979 -1.1028e+00 -4.5915e-05  3.0937e-02 -6.2695e+00         0.0000\n2980  1.2968e+00 -3.5415e-04  2.3855e-01  2.6559e+00         0.0079\n2981  9.7527e-01 -1.3503e-04  9.0975e-02  3.2339e+00         0.0012\n2982  1.7807e+00 -2.1179e-04  1.4268e-01  4.7147e+00         0.0000\n2983  6.2087e+00 -1.9255e-03  1.2950e+00  5.4577e+00         0.0000\n2984  1.2758e+00 -2.9650e-04  1.9973e-01  2.8553e+00         0.0043\n2985  8.9186e-01 -1.5426e-04  1.0393e-01  2.7670e+00         0.0057\n2986 -1.6268e-01 -4.5915e-05  3.0937e-02 -9.2466e-01         0.3551\n2987  8.2633e-02 -9.0099e-04  6.0657e-01  1.0726e-01         0.9146\n2988  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n2989  8.2753e-01 -1.5426e-04  1.0393e-01  2.5674e+00         0.0102\n2990  2.9319e-01 -5.8327e-04  3.9280e-01  4.6874e-01         0.6393\n2991 -5.6480e-01 -4.5915e-05  3.0937e-02 -3.2108e+00         0.0013\n2992  1.5359e+01 -2.3468e-02  1.5442e+01  3.9143e+00         0.0001\n2993  6.2514e-01 -1.6095e-04  1.0844e-01  1.8989e+00         0.0576\n2994  7.5568e-01 -2.3571e-04  1.5879e-01  1.8970e+00         0.0578\n2995  8.9943e-01 -2.2599e-04  1.5224e-01  2.3057e+00         0.0211\n2996  6.3915e+00 -3.2640e-03  2.1922e+00  4.3190e+00         0.0000\n2997  2.1982e+00 -5.3290e-04  3.5889e-01  3.6701e+00         0.0002\n2998  1.9630e+00 -6.9085e-04  4.6519e-01  2.8791e+00         0.0040\n2999  1.1643e+00 -1.5426e-04  1.0393e-01  3.6122e+00         0.0003\n3000 -3.0135e-01 -4.5915e-05  3.0937e-02 -1.7130e+00         0.0867\n3001 -3.7313e-01 -4.5915e-05  4.6429e-02 -1.7314e+00         0.0834\n3002 -2.7113e-01 -4.5915e-05  3.0937e-02 -1.5412e+00         0.1233\n3003  2.7705e+00 -7.7750e-04  5.2350e-01  3.8302e+00         0.0001\n3004 -1.9071e-01 -4.5915e-05  3.0937e-02 -1.0840e+00         0.2784\n3005  1.4384e+01 -1.8822e-02  1.2444e+01  4.0828e+00         0.0000\n3006  1.3872e+00 -1.1708e-04  7.8884e-02  4.9395e+00         0.0000\n3007  5.2837e-01 -3.1515e-04  2.1229e-01  1.1475e+00         0.2512\n3008  5.6295e-01 -1.0583e-04  7.1302e-02  2.1087e+00         0.0350\n3009  1.0702e+00 -1.1708e-04  7.8884e-02  3.8109e+00         0.0001\n3010  3.0302e+00 -5.0856e-04  3.4251e-01  5.1786e+00         0.0000\n3011  8.8133e-01 -8.5022e-05  5.7286e-02  3.6826e+00         0.0002\n3012  2.8655e+00 -4.5931e-04  3.0936e-01  5.1528e+00         0.0000\n3013  6.6262e-01 -3.3436e-04  2.2523e-01  1.3969e+00         0.1624\n3014  8.2949e-01 -1.4411e-03  9.6965e-01  8.4384e-01         0.3988\n3015  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3016  4.1911e+00 -5.4771e-03  3.6705e+00  2.1904e+00         0.0285\n3017 -5.3434e-01 -4.5915e-05  3.0937e-02 -3.0376e+00         0.0024\n3018  1.5803e+00 -1.8189e-04  1.2254e-01  4.5151e+00         0.0000\n3019 -1.5834e+00 -4.5915e-05  3.0937e-02 -9.0018e+00         0.0000\n3020  3.9872e-01 -1.1708e-04  7.8884e-02  1.4200e+00         0.1556\n3021 -4.0859e-01 -4.5915e-05  3.0937e-02 -2.3227e+00         0.0202\n3022  1.0925e+00 -4.7313e-04  3.1866e-01  1.9363e+00         0.0528\n3023  2.1775e+00 -2.9650e-04  1.9973e-01  4.8730e+00         0.0000\n3024  1.7645e+00 -6.0931e-04  4.1033e-01  2.7556e+00         0.0059\n3025  3.1670e+00 -1.6986e-03  1.1426e+00  2.9644e+00         0.0030\n3026  4.3292e+00 -4.6798e-03  3.1386e+00  2.4463e+00         0.0144\n3027 -3.0745e-01 -4.5915e-05  3.0937e-02 -1.7477e+00         0.0805\n3028 -5.5457e-01 -4.5915e-05  6.1921e-02 -2.2284e+00         0.0259\n3029 -3.5570e-01 -4.5915e-05  3.0937e-02 -2.0220e+00         0.0432\n3030  3.0686e+00 -6.9085e-04  4.6519e-01  4.5001e+00         0.0000\n3031  9.7660e-01 -5.9622e-04  4.0151e-01  1.5422e+00         0.1230\n3032  1.1000e+00 -8.2581e-05  5.5641e-02  4.6636e+00         0.0000\n3033  1.9129e-01 -7.2489e-04  4.8810e-01  2.7484e-01         0.7834\n3034 -3.1476e-01 -4.5915e-05  3.0937e-02 -1.7893e+00         0.0736\n3035  6.5715e-01 -5.8327e-04  3.9280e-01  1.0494e+00         0.2940\n3036  1.1172e+00 -4.3897e-04  2.9566e-01  2.0554e+00         0.0398\n3037  2.4461e+00 -1.1033e-03  7.4262e-01  2.8398e+00         0.0045\n3038  6.4919e-01 -8.5022e-05  5.7286e-02  2.7127e+00         0.0067\n3039  4.1380e+00 -1.4049e-03  9.4532e-01  4.2574e+00         0.0000\n3040 -5.0095e-01 -4.5915e-05  3.0937e-02 -2.8478e+00         0.0044\n3041  3.0364e-01 -8.6926e-04  7.0245e-01  3.6332e-01         0.7164\n3042  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3043  2.9240e+00 -9.5623e-04  6.4372e-01  3.6456e+00         0.0003\n3044  1.4284e+00 -4.3897e-04  2.9566e-01  2.6277e+00         0.0086\n3045  8.0293e-01 -2.7487e-04  1.8517e-01  1.8666e+00         0.0620\n3046  2.5106e-01 -8.5022e-05  5.7286e-02  1.0493e+00         0.2940\n3047 -1.9485e-01 -4.5915e-05  3.0937e-02 -1.1076e+00         0.2681\n3048  9.4480e-01 -8.1968e-04  5.5188e-01  1.2729e+00         0.2031\n3049 -2.1264e-01 -4.5915e-05  3.0937e-02 -1.2087e+00         0.2268\n3050  1.4745e+00 -1.8330e-03  1.2329e+00  1.3296e+00         0.1837\n3051  3.7418e-01 -7.5473e-05  5.0852e-02  1.6596e+00         0.0970\n3052  7.1317e-01 -1.0583e-04  7.1302e-02  2.6712e+00         0.0076\n3053  9.4289e-01 -1.2057e-04  8.1233e-02  3.3086e+00         0.0009\n3054 -1.9187e-01 -2.4106e-05  1.6243e-02 -1.5053e+00         0.1323\n3055 -1.4246e-01 -4.5915e-05  3.0937e-02 -8.0966e-01         0.4181\n3056  1.9003e+00 -6.8107e-04  4.5861e-01  2.8070e+00         0.0050\n3057  8.4843e-01 -4.7661e-04  3.2101e-01  1.4983e+00         0.1340\n3058  1.9401e-01 -9.5140e-05  6.4102e-02  7.6667e-01         0.4433\n3059 -1.0956e-01 -4.5915e-05  3.0937e-02 -6.2261e-01         0.5335\n3060  3.6419e-01 -6.3592e-04  4.2823e-01  5.5750e-01         0.5772\n3061 -3.1232e-01 -4.5915e-05  3.0937e-02 -1.7754e+00         0.0758\n3062 -1.6756e-01 -4.5915e-05  3.0937e-02 -9.5237e-01         0.3409\n3063 -2.9429e-01 -4.5915e-05  3.0937e-02 -1.6729e+00         0.0944\n3064  5.4589e-02 -1.0583e-04  7.1302e-02  2.0483e-01         0.8377\n3065  2.9423e-01 -1.2890e-04  8.6849e-02  9.9884e-01         0.3179\n3066  1.7375e-01 -5.5780e-04  3.7566e-01  2.8439e-01         0.7761\n3067 -4.5465e-01 -4.5915e-05  6.1921e-02 -1.8269e+00         0.0677\n3068  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3069  5.5189e-01 -7.4804e-04  5.0368e-01  7.7869e-01         0.4362\n3070  3.0197e-01 -8.5022e-05  5.7286e-02  1.2620e+00         0.2070\n3071 -1.2723e-01 -4.5915e-05  3.0937e-02 -7.2306e-01         0.4696\n3072 -4.4712e-02 -6.6492e-05  4.4802e-02 -2.1093e-01         0.8329\n3073  3.9592e-02 -4.5915e-05  3.0937e-02  2.2536e-01         0.8217\n3074  5.7326e-01 -3.9542e-04  2.6634e-01  1.1115e+00         0.2663\n3075  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n3076 -4.0831e-02 -4.5915e-05  3.0937e-02 -2.3188e-01         0.8166\n3077  3.7155e-02 -4.5915e-05  3.0937e-02  2.1150e-01         0.8325\n3078 -5.3017e-02 -4.5915e-05  3.0937e-02 -3.0116e-01         0.7633\n3079 -1.1711e-01 -4.5915e-05  3.0937e-02 -6.6556e-01         0.5057\n3080  1.3127e-01 -6.3324e-04  6.3995e-01  1.6489e-01         0.8690\n3081  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3082  2.9844e-02 -4.5915e-05  3.0937e-02  1.6993e-01         0.8651\n3083 -4.7256e-01 -4.5915e-05  3.0937e-02 -2.6864e+00         0.0072\n3084 -1.8045e-02 -4.5915e-05  3.0937e-02 -1.0233e-01         0.9185\n3085  4.2029e-02 -4.5915e-05  3.0937e-02  2.3921e-01         0.8109\n3086  1.1758e-01 -4.5915e-05  3.0937e-02  6.6874e-01         0.5037\n3087 -8.2261e-02 -4.5915e-05  3.0937e-02 -4.6743e-01         0.6402\n3088 -8.7040e-02 -8.5022e-05  5.7286e-02 -3.6330e-01         0.7164\n3089  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3090  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3091  1.0783e-01 -4.5915e-05  3.0937e-02  6.1332e-01         0.5397\n3092  1.0296e-01 -4.5915e-05  3.0937e-02  5.8560e-01         0.5581\n3093 -1.5606e-01 -4.5915e-05  3.7134e-02 -8.0959e-01         0.4182\n3094  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3095 -3.7593e-01 -4.5915e-05  3.0937e-02 -2.1370e+00         0.0326\n3096 -3.0769e-01 -4.5915e-05  3.0937e-02 -1.7491e+00         0.0803\n3097  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3098  1.1758e-01 -4.5915e-05  3.0937e-02  6.6874e-01         0.5037\n3099  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3100 -9.1493e-03 -4.5915e-05  3.0937e-02 -5.1756e-02         0.9587\n3101  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n3102  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3103  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3104  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3105  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3106  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3107  5.9089e-02 -4.5915e-05  3.0937e-02  3.3620e-01         0.7367\n3108  1.6233e+00 -2.9461e-03  1.9794e+00  1.1559e+00         0.2477\n3109 -1.1248e-01 -4.5915e-05  3.0937e-02 -6.3924e-01         0.5227\n3110  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3111  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3112  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3113  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n3114  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3115  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3116  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3117  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3118  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3119  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3120  1.0358e+00 -4.3897e-04  2.9566e-01  1.9057e+00         0.0567\n3121  1.8029e+00 -5.8327e-04  3.9280e-01  2.8775e+00         0.0040\n3122  2.8869e-02 -4.5915e-05  3.0937e-02  1.6439e-01         0.8694\n3123  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3124  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3125  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3126  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3127  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3128  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3129  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3130  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3131  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3132 -1.8328e-01 -4.5915e-05  3.0937e-02 -1.0417e+00         0.2975\n3133  1.7842e+00 -3.8280e-04  2.5785e-01  3.5145e+00         0.0004\n3134  8.1543e-01 -7.5976e-04  5.1156e-01  1.1412e+00         0.2538\n3135  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3136  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3137  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3138  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3139  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3140  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3141  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3142  6.8593e-02 -4.5915e-05  3.0937e-02  3.9024e-01         0.6964\n3143  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3144  6.4816e-02 -4.5915e-05  3.0937e-02  3.6876e-01         0.7123\n3145  8.9492e-01 -3.9119e-04  2.6350e-01  1.7442e+00         0.0811\n3146  1.4079e+00 -5.2066e-04  3.5066e-01  2.3784e+00         0.0174\n3147 -1.9290e-01 -4.5915e-05  3.0937e-02 -1.0965e+00         0.2729\n3148  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3149  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3150  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3151  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3152  1.3342e-01 -4.5915e-05  3.0937e-02  7.5880e-01         0.4480\n3153  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3154  6.8593e-02 -4.5915e-05  3.0937e-02  3.9024e-01         0.6964\n3155 -4.8630e-02 -4.5915e-05  6.1921e-02 -1.9524e-01         0.8452\n3156  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3157  5.3174e-01 -3.8804e-04  2.6137e-01  1.0409e+00         0.2979\n3158 -5.1655e-01 -4.5915e-05  3.0937e-02 -2.9365e+00         0.0033\n3159  1.0445e+00 -2.9650e-04  1.9973e-01  2.3378e+00         0.0194\n3160 -2.3772e-02 -4.5915e-05  3.0937e-02 -1.3489e-01         0.8927\n3161  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3162  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3163  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3164  1.3342e-01 -4.5915e-05  3.0937e-02  7.5880e-01         0.4480\n3165  1.3342e-01 -4.5915e-05  3.0937e-02  7.5880e-01         0.4480\n3166  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3167 -5.1752e-01 -3.5616e-04  2.8796e-01 -9.6375e-01         0.3352\n3168  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3169 -1.7767e-01 -4.5915e-05  3.0937e-02 -1.0099e+00         0.3126\n3170  1.2793e+00 -4.1691e-04  2.8081e-01  2.4149e+00         0.0157\n3171  6.2709e-01 -9.5140e-05  6.4102e-02  2.4772e+00         0.0132\n3172  7.6142e-01 -3.1515e-04  2.1229e-01  1.6533e+00         0.0983\n3173  8.8334e-02 -4.5915e-05  3.0937e-02  5.0247e-01         0.6153\n3174  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3175  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3176  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3177 -1.2857e-01 -2.1980e-05  1.4811e-02 -1.0562e+00         0.2909\n3178  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3179  6.8593e-02 -4.5915e-05  3.0937e-02  3.9024e-01         0.6964\n3180  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3181  6.6400e-02 -4.5915e-05  3.0937e-02  3.7777e-01         0.7056\n3182  1.3148e+00 -4.0610e-04  2.7353e-01  2.5147e+00         0.0119\n3183  1.1476e+00 -4.2787e-04  2.8819e-01  2.1385e+00         0.0325\n3184  1.1050e+00 -3.5415e-04  2.3855e-01  2.2631e+00         0.0236\n3185  4.9334e-01 -2.1179e-04  1.4268e-01  1.3066e+00         0.1913\n3186  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3187  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3188  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3189  1.3342e-01 -4.5915e-05  3.0937e-02  7.5880e-01         0.4480\n3190  1.3342e-01 -4.5915e-05  3.0937e-02  7.5880e-01         0.4480\n3191  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3192  9.9818e-03 -4.5915e-05  4.6429e-02  4.6538e-02         0.9629\n3193  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3194  5.6206e-01 -3.7450e-04  2.5226e-01  1.1198e+00         0.2628\n3195  1.5469e+00 -3.7450e-04  2.5226e-01  3.0807e+00         0.0021\n3196  1.2049e+00 -5.0856e-04  3.4251e-01  2.0597e+00         0.0394\n3197  1.6974e+00 -7.0493e-04  4.7467e-01  2.4647e+00         0.0137\n3198 -6.2765e-02 -4.5915e-05  3.0937e-02 -3.5658e-01         0.7214\n3199  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3200  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3201  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3202  1.3342e-01 -4.5915e-05  3.0937e-02  7.5880e-01         0.4480\n3203  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3204  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3205  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3206 -4.9361e-02 -4.5915e-05  3.0937e-02 -2.8037e-01         0.7792\n3207  1.8711e+00 -6.0931e-04  4.1033e-01  2.9219e+00         0.0035\n3208  1.3569e+00 -2.8739e-04  1.9360e-01  3.0847e+00         0.0020\n3209 -6.7520e-01 -4.5915e-05  3.0937e-02 -3.8385e+00         0.0001\n3210  2.3388e+00 -6.9085e-04  4.6519e-01  3.4301e+00         0.0006\n3211  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3212  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3213  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3214  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3215  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3216  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3217  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3218  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3219  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3220  5.3883e-01 -3.4418e-04  2.3184e-01  1.1198e+00         0.2628\n3221  1.2064e+00 -2.4397e-04  1.6435e-01  2.9765e+00         0.0029\n3222  1.3235e+00 -3.9119e-04  2.6350e-01  2.5791e+00         0.0099\n3223  3.2087e+00 -5.8327e-04  3.9280e-01  5.1206e+00         0.0000\n3224 -3.6289e-01 -4.5915e-05  3.0937e-02 -2.0629e+00         0.0391\n3225  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3226  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3227  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3228  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3229  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3230  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3231  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3232  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3233  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3234  7.0056e-02 -4.5915e-05  3.0937e-02  3.9855e-01         0.6902\n3235  9.7619e-01 -3.7450e-04  2.5226e-01  1.9444e+00         0.0518\n3236  1.2209e+00 -4.2787e-04  2.8819e-01  2.2750e+00         0.0229\n3237  2.7211e+00 -1.2875e-03  8.6646e-01  2.9247e+00         0.0034\n3238  3.5128e+00 -6.4352e-03  4.3083e+00  1.6955e+00         0.0900\n3239  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3240  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3241  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3242  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3243  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3244  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3245  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3246  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3247  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3248  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3249 -2.2727e-01 -4.5915e-05  3.0937e-02 -1.2918e+00         0.1964\n3250  8.9010e-01 -1.8189e-04  1.2254e-01  2.5433e+00         0.0110\n3251  8.8893e-01 -9.8286e-05  6.6222e-02  3.4547e+00         0.0006\n3252  4.2343e+00 -1.2121e-03  8.1578e-01  4.6894e+00         0.0000\n3253 -2.1179e-01 -4.5915e-05  3.0937e-02 -1.2039e+00         0.2286\n3254  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3255  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3256  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3257  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3258  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3259  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3260  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3261  1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420\n3262  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3263  9.1989e-02 -4.5915e-05  3.0937e-02  5.2325e-01         0.6008\n3264  8.1022e-02 -4.5915e-05  3.0937e-02  4.6090e-01         0.6449\n3265  4.8171e-01 -8.5022e-05  5.7286e-02  2.0130e+00         0.0441\n3266  8.5203e-01 -1.3815e-04  9.3074e-02  2.7932e+00         0.0052\n3267  2.7035e+00 -9.3329e-04  6.2829e-01  3.4119e+00         0.0006\n3268 -5.0729e-01 -4.5915e-05  3.0937e-02 -2.8838e+00         0.0039\n3269  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3270  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3271  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3272  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3273  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3274  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3275  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3276  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3277  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3278 -1.5242e-02 -4.5915e-05  3.0937e-02 -8.6395e-02         0.9312\n3279  9.1989e-02 -4.5915e-05  3.0937e-02  5.2325e-01         0.6008\n3280 -4.2094e-02 -2.6091e-04  1.7576e-01 -9.9784e-02         0.9205\n3281  1.3004e+00 -4.5022e-04  3.0323e-01  2.3624e+00         0.0182\n3282  1.0536e+00 -2.0410e-04  1.3750e-01  2.8419e+00         0.0045\n3283  1.0661e+00 -2.6523e-04  1.7868e-01  2.5227e+00         0.0116\n3284  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3285  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3286  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3287  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3288  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3289  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3290  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3291  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3292  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3293  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3294  7.8585e-02 -4.5915e-05  3.0937e-02  4.4705e-01         0.6548\n3295  8.7821e-02 -1.8915e-04  1.2743e-01  2.4654e-01         0.8053\n3296 -1.1586e-02 -4.5915e-05  3.0937e-02 -6.5611e-02         0.9477\n3297  6.6637e-01 -1.9655e-04  1.3242e-01  1.8318e+00         0.0670\n3298  1.2075e+00 -7.7750e-04  5.2350e-01  1.6700e+00         0.0949\n3299  1.6110e+00 -4.0074e-04  2.6993e-01  3.1016e+00         0.0019\n3300 -2.0472e-01 -4.5915e-05  3.0937e-02 -1.1637e+00         0.2446\n3301  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3302  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3303  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3304  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3305  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3306  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3307  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3308  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3309  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3310  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3311  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3312  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3313  7.3541e-02 -2.7842e-04  1.8756e-01  1.7045e-01         0.8647\n3314 -2.2483e-01 -4.5915e-05  3.0937e-02 -1.2780e+00         0.2013\n3315 -3.0647e-01 -4.5915e-05  3.0937e-02 -1.7421e+00         0.0815\n3316  6.4277e-01 -2.1024e-04  1.4164e-01  1.7085e+00         0.0876\n3317  4.5021e-01 -8.5022e-05  5.7286e-02  1.8814e+00         0.0599\n3318  1.6317e+00 -6.3592e-04  4.2823e-01  2.4944e+00         0.0126\n3319  4.6903e-02 -4.5915e-05  3.0937e-02  2.6692e-01         0.7895\n3320  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3321  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3322  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3323  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3324  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3325  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3326  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3327  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3328  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3329  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3330  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3331  7.8585e-02 -4.5915e-05  3.0937e-02  4.4705e-01         0.6548\n3332  6.4549e-01 -3.9542e-04  2.6634e-01  1.2515e+00         0.2107\n3333  1.6373e-01 -1.8189e-04  1.2254e-01  4.6824e-01         0.6396\n3334  5.1503e-01 -2.6091e-04  1.7576e-01  1.2291e+00         0.2190\n3335 -2.1484e-01 -4.5915e-05  3.0937e-02 -1.2212e+00         0.2220\n3336  1.3361e+00 -5.6412e-04  3.7991e-01  2.1686e+00         0.0301\n3337  7.5731e-01 -5.5780e-04  3.7566e-01  1.2365e+00         0.2163\n3338  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3339  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3340  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3341  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3342  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3343  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3344  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3345  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3346  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3347  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3348  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3349  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3350  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3351 -2.1874e-01 -4.5915e-05  3.0937e-02 -1.2433e+00         0.2137\n3352  4.6489e-01 -2.4397e-04  1.6435e-01  1.1473e+00         0.2512\n3353  4.0719e-01 -1.9655e-04  1.3242e-01  1.1195e+00         0.2629\n3354 -3.0014e-01 -4.5915e-05  3.0937e-02 -1.7061e+00         0.0880\n3355 -3.0038e-01 -4.5915e-05  3.0937e-02 -1.7075e+00         0.0877\n3356  1.3622e+00 -3.6222e-04  2.4399e-01  2.7585e+00         0.0058\n3357 -9.2010e-02 -4.5915e-05  3.0937e-02 -5.2285e-01         0.6011\n3358  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3359  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3360  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3361  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3362  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3363  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3364  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3365  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3366  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3367  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3368  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3369  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3370  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3371  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n3372  4.3118e-01 -2.4397e-04  1.6435e-01  1.0642e+00         0.2872\n3373  1.3359e-01 -7.5473e-05  5.0852e-02  5.9273e-01         0.5534\n3374  5.9685e-01 -3.3436e-04  2.2523e-01  1.2583e+00         0.2083\n3375  1.2400e-01 -8.0176e-05  5.4021e-02  5.3385e-01         0.5934\n3376  6.7907e-01 -2.7842e-04  1.8756e-01  1.5686e+00         0.1167\n3377  2.4765e-01 -5.5780e-04  3.7566e-01  4.0496e-01         0.6855\n3378  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n3379  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3380  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3381  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3382  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3383  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3384  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3385  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3386  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3387  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3388  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3389  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3390  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3391  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3392  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3393  7.8777e-02 -8.5022e-05  5.7286e-02  3.2949e-01         0.7418\n3394 -2.4311e-01 -4.5915e-05  3.0937e-02 -1.3819e+00         0.1670\n3395 -2.0412e-01 -4.5915e-05  3.0937e-02 -1.1602e+00         0.2460\n3396  4.2530e-01 -2.1179e-04  1.4268e-01  1.1265e+00         0.2600\n3397  6.0060e-01 -1.9283e-04  1.2991e-01  1.6669e+00         0.0955\n3398 -3.8665e-01 -4.5915e-05  3.0937e-02 -2.1980e+00         0.0279\n3399 -1.2247e-01 -4.5915e-05  3.0937e-02 -6.9604e-01         0.4864\n3400  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n3401  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3402  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3403  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3404  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3405  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3406  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3407  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3408  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3409  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3410  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3411  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3412  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3413 -9.4447e-02 -4.5915e-05  3.0937e-02 -5.3670e-01         0.5915\n3414  2.7733e-01 -9.5140e-05  6.4102e-02  1.0957e+00         0.2732\n3415  3.7155e-02 -4.5915e-05  3.0937e-02  2.1150e-01         0.8325\n3416  6.6601e-02 -2.9650e-04  1.9973e-01  1.4969e-01         0.8810\n3417  5.0032e-01 -1.5426e-04  1.0393e-01  1.5525e+00         0.1206\n3418  8.0512e-01 -2.9650e-04  1.9973e-01  1.8022e+00         0.0715\n3419 -2.4189e-01 -4.5915e-05  3.0937e-02 -1.3750e+00         0.1691\n3420 -1.2186e-01 -8.5022e-05  5.7286e-02 -5.0879e-01         0.6109\n3421  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3422  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3423  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3424  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3425  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3426  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3427  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3428  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3429  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3430  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3431  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3432  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3433  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3434  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n3435  2.5780e-01 -5.8080e-05  3.9134e-02  1.3035e+00         0.1924\n3436  1.8700e-02 -1.0583e-04  7.1302e-02  7.0428e-02         0.9439\n3437  7.6148e-02 -4.5915e-05  3.0937e-02  4.3319e-01         0.6649\n3438 -2.8454e-01 -4.5915e-05  3.0937e-02 -1.6174e+00         0.1058\n3439  8.8341e-01 -2.4397e-04  1.6435e-01  2.1797e+00         0.0293\n3440  4.5974e-01 -2.1962e-04  1.4795e-01  1.1958e+00         0.2318\n3441  1.4518e-01 -2.0410e-04  1.3750e-01  3.9206e-01         0.6950\n3442  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n3443  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3444  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3445  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3446  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3447  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3448  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3449  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3450  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3451  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3452  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3453  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3454  1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420\n3455  1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420\n3456  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3457 -1.9323e-01 -5.8327e-04  3.9280e-01 -3.0738e-01         0.7586\n3458  2.3956e-01 -3.8209e-05  2.5746e-02  1.4932e+00         0.1354\n3459  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n3460 -6.7122e-03 -4.5915e-05  3.0937e-02 -3.7900e-02         0.9698\n3461  5.1661e-01 -1.8189e-04  1.2254e-01  1.4763e+00         0.1399\n3462  6.7284e-01 -2.2759e-04  1.5333e-01  1.7189e+00         0.0856\n3463  5.6763e-01 -1.8915e-04  1.2743e-01  1.5906e+00         0.1117\n3464 -7.1295e-02 -4.5915e-05  3.0937e-02 -4.0507e-01         0.6854\n3465  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3466  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3467  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3468  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3469  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3470  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3471  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3472  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3473  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3474  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3475  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3476  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3477  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3478  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n3479  2.0298e-01 -5.8080e-05  3.9134e-02  1.0264e+00         0.3047\n3480  5.3672e-02 -5.0237e-05  3.3850e-02  2.9199e-01         0.7703\n3481  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3482  1.0721e-01 -1.2890e-04  8.6849e-02  3.6422e-01         0.7157\n3483  4.0689e-01 -1.3815e-04  9.3074e-02  1.3342e+00         0.1821\n3484  5.4450e-01 -1.8189e-04  1.2254e-01  1.5560e+00         0.1197\n3485  1.7312e-01 -1.5426e-04  1.0393e-01  5.3747e-01         0.5909\n3486  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3487  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3488  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3489  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3490  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3491  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3492  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3493  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3494  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3495  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3496  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3497  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3498  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3499 -2.1335e-02 -4.5915e-05  3.0937e-02 -1.2103e-01         0.9037\n3500  5.7200e-03 -2.2759e-04  1.5333e-01  1.5189e-02         0.9879\n3501  1.2245e-01 -4.5915e-05  3.0937e-02  6.9645e-01         0.4861\n3502  3.3500e-02 -4.5915e-05  3.0937e-02  1.9072e-01         0.8487\n3503  4.9921e-01 -1.5426e-04  1.0393e-01  1.5490e+00         0.1214\n3504 -2.7479e-01 -4.5915e-05  3.0937e-02 -1.5620e+00         0.1183\n3505  3.1565e-01 -1.6779e-04  1.1304e-01  9.3933e-01         0.3476\n3506 -3.2789e-02 -4.5915e-05  3.0937e-02 -1.8616e-01         0.8523\n3507  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3508  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3509  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3510  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3511  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3512  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3513  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3514  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3515  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3516  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3517  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3518  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3519  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3520  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3521 -7.1295e-02 -4.5915e-05  3.0937e-02 -4.0507e-01         0.6854\n3522 -6.0328e-02 -4.5915e-05  3.0937e-02 -3.4272e-01         0.7318\n3523  1.2002e-01 -4.5915e-05  3.0937e-02  6.8259e-01         0.4949\n3524  1.7719e-01 -7.0911e-05  4.7779e-02  8.1095e-01         0.4174\n3525  6.9084e-02 -2.2170e-06  1.4939e-03  1.7875e+00         0.0739\n3526  9.7323e-02 -1.0041e-04  6.7654e-02  3.7456e-01         0.7080\n3527 -1.9607e-01 -4.5915e-05  3.0937e-02 -1.1145e+00         0.2651\n3528  5.4946e-02 -4.5915e-05  3.0937e-02  3.1265e-01         0.7545\n3529  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3530  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3531  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3532  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3533  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3534  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3535  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3536  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3537  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3538  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3539  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3540  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3541 -1.0977e-02 -4.5915e-05  3.0937e-02 -6.2148e-02         0.9504\n3542 -1.6147e-01 -4.5915e-05  3.0937e-02 -9.1773e-01         0.3588\n3543 -5.1798e-02 -4.5915e-05  3.0937e-02 -2.9423e-01         0.7686\n3544 -1.6460e-02 -4.5915e-05  3.0937e-02 -9.3323e-02         0.9256\n3545  7.3074e-01 -1.7126e-04  1.1538e-01  2.1518e+00         0.0314\n3546  2.0494e-01 -6.8684e-05  4.6278e-02  9.5296e-01         0.3406\n3547 -5.4235e-02 -4.5915e-05  3.0937e-02 -3.0809e-01         0.7580\n3548  1.3329e-01 -4.7778e-04  3.2179e-01  2.3580e-01         0.8136\n3549  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3550  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3551  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3552  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3553  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3554  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3555  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3556  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3557  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3558  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3559  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3560  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3561  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3562  8.0413e-02 -4.5915e-05  3.0937e-02  4.5744e-01         0.6474\n3563  1.5930e-01 -1.7477e-04  1.1774e-01  4.6476e-01         0.6421\n3564  9.6999e-02 -1.2890e-04  8.6849e-02  3.2958e-01         0.7417\n3565 -1.5749e-02 -5.8080e-05  3.9134e-02 -7.9319e-02         0.9368\n3566  2.0285e-01 -6.2215e-05  4.1920e-02  9.9105e-01         0.3217\n3567  9.5817e-01 -9.0099e-04  6.0657e-01  1.2314e+00         0.2182\n3568 -3.0474e-02 -4.5915e-05  3.0937e-02 -1.7299e-01         0.8627\n3569  1.3482e-01 -8.5022e-05  5.7286e-02  5.6366e-01         0.5730\n3570 -9.9077e-02 -4.5915e-05  3.0937e-02 -5.6303e-01         0.5734\n3571  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3572  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3573  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3574  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3575  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3576  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3577  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3578  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3579  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3580  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3581  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3582  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3583  4.9556e-01 -2.6523e-04  1.7868e-01  1.1730e+00         0.2408\n3584  3.3513e-01 -8.5022e-05  5.7286e-02  1.4006e+00         0.1613\n3585  4.0954e-01 -1.6095e-04  1.0844e-01  1.2442e+00         0.2134\n3586 -1.7914e-01 -4.5915e-05  3.0937e-02 -1.0182e+00         0.3086\n3587  6.8540e-01 -5.0856e-04  3.4251e-01  1.1720e+00         0.2412\n3588  6.5629e-02 -7.5473e-05  5.0852e-02  2.9137e-01         0.7708\n3589  1.1270e-01 -4.5915e-05  3.0937e-02  6.4103e-01         0.5215\n3590  7.2182e-02 -7.2489e-04  4.8810e-01  1.0436e-01         0.9169\n3591  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3592  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3593  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3594  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3595  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3596  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3597  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3598  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3599  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3600  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3601  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3602  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3603 -1.3125e-01 -4.5915e-05  3.0937e-02 -7.4592e-01         0.4557\n3604  7.1708e-01 -1.6095e-04  1.0844e-01  2.1781e+00         0.0294\n3605  3.8900e-01 -1.2292e-04  8.2819e-02  1.3522e+00         0.1763\n3606  3.6344e-01 -1.2890e-04  8.6849e-02  1.2337e+00         0.2173\n3607  2.6452e-01 -5.8080e-05  3.9134e-02  1.3374e+00         0.1811\n3608 -1.8706e-01 -4.5915e-05  3.0937e-02 -1.0632e+00         0.2877\n3609  1.1514e-01 -4.5915e-05  3.0937e-02  6.5488e-01         0.5125\n3610 -4.1319e-02 -4.5915e-05  3.0937e-02 -2.3465e-01         0.8145\n3611  3.1794e-02 -4.5915e-05  3.0937e-02  1.8102e-01         0.8564\n3612  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3613  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3614  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3615  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3616  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3617  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3618  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3619  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3620  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3621  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3622  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3623  4.9826e-02 -1.5630e-03  1.0515e+00  5.0114e-02         0.9600\n3624  1.0520e-01 -1.5162e-04  1.0215e-01  3.2962e-01         0.7417\n3625  4.1724e-01 -1.7477e-04  1.1774e-01  1.2165e+00         0.2238\n3626  4.4518e-01 -1.3195e-04  8.8900e-02  1.4935e+00         0.1353\n3627 -3.4547e-01 -4.5915e-05  3.0937e-02 -1.9638e+00         0.0495\n3628  1.1514e-01 -4.5915e-05  3.0937e-02  6.5488e-01         0.5125\n3629  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3630  3.1794e-02 -4.5915e-05  3.0937e-02  1.8102e-01         0.8564\n3631  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3632  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3633  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3634  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3635  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3636  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3637  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3638  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3639  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3640  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3641  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3642 -2.5843e-02 -4.5915e-05  3.0937e-02 -1.4667e-01         0.8834\n3643 -2.0204e-01 -4.5915e-05  3.0937e-02 -1.1484e+00         0.2508\n3644 -2.3897e-01 -4.5915e-05  3.0937e-02 -1.3583e+00         0.1744\n3645  4.1538e-01 -8.5022e-05  5.7286e-02  1.7359e+00         0.0826\n3646  1.3754e+00 -5.3290e-04  3.5889e-01  2.2967e+00         0.0216\n3647 -9.1493e-03 -4.5915e-05  3.0937e-02 -5.1756e-02         0.9587\n3648  6.3597e-02 -4.5915e-05  3.0937e-02  3.6184e-01         0.7175\n3649  6.4694e-02 -4.5915e-05  3.0937e-02  3.6807e-01         0.7128\n3650  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3651  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3652  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3653  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3654  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3655  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3656  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3657  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3658  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3659  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3660  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3661  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3662  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3663 -2.5843e-02 -4.5915e-05  3.0937e-02 -1.4667e-01         0.8834\n3664  7.1791e-03 -4.5915e-05  3.0937e-02  4.1077e-02         0.9672\n3665  2.8356e-01 -8.5022e-05  5.7286e-02  1.1851e+00         0.2360\n3666  8.0320e-01 -1.6779e-04  1.1304e-01  2.3894e+00         0.0169\n3667  5.6015e-01 -1.2875e-03  8.6646e-01  6.0315e-01         0.5464\n3668 -2.9011e-02 -4.5915e-05  3.0937e-02 -1.6468e-01         0.8692\n3669 -1.8279e-01 -4.5915e-05  3.0937e-02 -1.0390e+00         0.2988\n3670 -4.0100e-02 -4.5915e-05  3.0937e-02 -2.2772e-01         0.8199\n3671  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3672  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3673  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3674  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3675  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3676  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3677  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3678  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3679  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3680  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3681  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3682  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3683  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3684 -8.6753e-02 -1.7477e-04  1.1774e-01 -2.5231e-01         0.8008\n3685  3.4690e-01 -7.3174e-05  4.9304e-02  1.5626e+00         0.1181\n3686  1.6316e+00 -7.3787e-04  4.9683e-01  2.3158e+00         0.0206\n3687 -1.0176e-01 -4.5915e-05  3.0937e-02 -5.7827e-01         0.5631\n3688  4.1759e-01 -3.9861e-04  2.6849e-01  8.0668e-01         0.4199\n3689  4.5265e-01 -3.8909e-04  2.6208e-01  8.8496e-01         0.3762\n3690  8.1022e-02 -4.5915e-05  3.0937e-02  4.6090e-01         0.6449\n3691  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3692  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3693  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3694  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3695  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3696  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3697  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3698  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3699  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3700  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3701  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3702  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3703  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3704  9.4426e-02 -4.5915e-05  3.0937e-02  5.3711e-01         0.5912\n3705  2.3463e-01 -6.6492e-05  4.4802e-02  1.1088e+00         0.2675\n3706  7.5226e-01 -1.5426e-04  1.0393e-01  2.3340e+00         0.0196\n3707 -2.4774e-01 -4.5915e-05  3.0937e-02 -1.4082e+00         0.1591\n3708  2.8572e-01 -1.8189e-04  1.2254e-01  8.1673e-01         0.4141\n3709  8.4782e-01 -4.2567e-04  2.8671e-01  1.5842e+00         0.1132\n3710  4.4793e-01 -2.6091e-04  1.7576e-01  1.0691e+00         0.2850\n3711  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3712  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3713  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3714  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3715  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3716  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3717  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3718  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3719  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3720  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3721  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3722  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3723  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3724 -5.1798e-02 -4.5915e-05  3.0937e-02 -2.9423e-01         0.7686\n3725  2.9769e-01 -6.6492e-05  4.4802e-02  1.4067e+00         0.1595\n3726  3.1566e-01 -1.3195e-04  8.8900e-02  1.0591e+00         0.2895\n3727 -4.2751e-03 -4.5915e-05  3.0937e-02 -2.4045e-02         0.9808\n3728  6.3977e-01 -2.9650e-04  1.9973e-01  1.4322e+00         0.1521\n3729  7.9511e-01 -3.0855e-04  2.0785e-01  1.7447e+00         0.0810\n3730 -6.0328e-02 -4.5915e-05  3.0937e-02 -3.4272e-01         0.7318\n3731  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3732  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3733  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3734  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3735  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3736  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3737  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3738  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3739  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3740  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3741  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3742  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3743  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3744  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3745 -7.4907e-02 -1.0583e-04  7.1302e-02 -2.8013e-01         0.7794\n3746  1.7003e-01 -4.6160e-04  3.1090e-01  3.0577e-01         0.7598\n3747  1.0235e-01 -4.5915e-05  3.0937e-02  5.8214e-01         0.5605\n3748  3.5352e-02 -2.1179e-04  1.4268e-01  9.4152e-02         0.9250\n3749 -1.6037e-01 -4.5915e-05  3.0937e-02 -9.1150e-01         0.3620\n3750  1.0775e-01 -5.8327e-04  3.9280e-01  1.7285e-01         0.8628\n3751  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3752  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3753  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3754  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3755  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3756  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3757  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3758  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3759  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3760  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3761  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3762  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3763  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3764  1.0783e-01 -4.5915e-05  3.0937e-02  6.1332e-01         0.5397\n3765 -8.9573e-02 -4.5915e-05  3.0937e-02 -5.0899e-01         0.6108\n3766 -2.6818e-02 -4.5915e-05  3.0937e-02 -1.5221e-01         0.8790\n3767  8.8334e-02 -4.5915e-05  3.0937e-02  5.0247e-01         0.6153\n3768 -2.1335e-02 -4.5915e-05  3.0937e-02 -1.2103e-01         0.9037\n3769 -6.6786e-02 -4.5915e-05  3.0937e-02 -3.7944e-01         0.7044\n3770  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n3771  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3772  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3773  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3774  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3775  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3776  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3777  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3778  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3779  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3780  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3781  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3782  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3783  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3784  1.0783e-01 -4.5915e-05  3.0937e-02  6.1332e-01         0.5397\n3785  5.6652e-02 -4.5915e-05  3.0937e-02  3.2235e-01         0.7472\n3786  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3787  8.8334e-02 -4.5915e-05  3.0937e-02  5.0247e-01         0.6153\n3788  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3789  4.4466e-02 -4.5915e-05  3.0937e-02  2.5307e-01         0.8002\n3790  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3791  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3792  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3793  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3794  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3795  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3796  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3797  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3798  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3799  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3800  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3801  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3802  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3803  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3804  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3805  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3806  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3807  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3808  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3809  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3810  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3811  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3812  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3813  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3814  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3815  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3816  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3817  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3818  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3819  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3820  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3821  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3822  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3823  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3824  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3825  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3826  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3827  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3828  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3829  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3830  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3831  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3832  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3833  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3834  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3835  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3836  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3837  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3838  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3839  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3840  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3841  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3842  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3843  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3844  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3845  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3846  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3847  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3848  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3849  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3850  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3851  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3852  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3853  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3854  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3855  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3856  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3857  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3858  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3859  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3860  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3861  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3862  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3863  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3864  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3865  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3866  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3867  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3868  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3869  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3870  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3871  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3872  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3873  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3874  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3875  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3876  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3877  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3878  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3879  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3880  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3881  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3882  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3883  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3884  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3885  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3886  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3887  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3888  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3889  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3890  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3891  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3892  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3893  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3894  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3895  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3896  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3897  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3898  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3899  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3900  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3901  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3902  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3903  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3904  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3905  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3906  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3907  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3908  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3909  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3910  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3911  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3912  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3913  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3914  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3915  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3916  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3917  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3918  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3919  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3920  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3921  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3922  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3923  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3924  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3925  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3926  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3927  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3928  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3929  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3930  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3931  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3932  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3933  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3934  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3935  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3936  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3937  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3938  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3939  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3940  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3941  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3942  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3943  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3944  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3945  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n3946  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3947  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3948  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3949  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3950  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3951  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3952  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3953  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3954  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3955  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3956  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3957  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3958  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3959  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3960  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3961  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3962  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3963  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3964  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3965  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3966  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3967  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3968  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3969  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3970  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3971  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3972  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3973  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3974  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n3975  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3976  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3977  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3978  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3979  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3980  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3981  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3982  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3983  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3984  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3985  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3986  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3987  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3988  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n3989  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3990  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3991  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3992  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3993  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3994  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3995  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3996  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3997  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3998  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n3999  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4000  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n4001  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4002  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4003  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4004  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4005  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4006  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4007  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4008  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4009  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4010  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4011  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4012  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n4013  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4014  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4015  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4016  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4017  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4018  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4019  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4020  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4021  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4022  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4023  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n4024  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4025  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4026  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4027  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4028  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4029  1.8582e-01 -4.5915e-05  3.0937e-02  1.0567e+00         0.2907\n4030  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4031  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4032  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n4033  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4034  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4035  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4036  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4037  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4038  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4039  1.8582e-01 -4.5915e-05  3.7134e-02  9.6451e-01         0.3348\n4040  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n4041  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4042  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4043  1.8582e-01 -4.5915e-05  4.6429e-02  8.6257e-01         0.3884\n4044  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4045  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4046  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4047  1.8582e-01 -4.5915e-05  6.1921e-02  7.4692e-01         0.4551\n4048  1.8582e-01 -4.5915e-05  9.2904e-02  6.0978e-01         0.5420"
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.4-preparing-for-analysis",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.4-preparing-for-analysis",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.4 Preparing for analysis",
    "text": "TH3.4 Preparing for analysis\n\nTH3.4.1 Creating spatial grids\nJohor Bahru is a relatively less dense location than Singapore to its south, so directly performing hot/cold spot analysis on its smaller number of Mukims would not make much sense. Instead, we will create a spatial grid subdividing the area into hexagons of equal diameter, and count the price of property sales located within each zone. The result is a hexagonal grid spanning the districts of Johor Bahru and Kulai, as shown below.\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\njb_kulai_hex &lt;- st_make_grid(adm3_jb_kulai, cellsize = c(750, 750), what = \"polygons\", square = FALSE) %&gt;%\n  st_sf() %&gt;%\n  mutate(index = as.factor(row_number()))\n\njb_kulai_border &lt;- adm3_jb_kulai %&gt;% st_union()\njb_kulai_grid &lt;- st_intersection(jb_kulai_hex, jb_kulai_border)\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n# Check if hex grid intersects any polygons using st_intersects\n# Returns a list of intersecting hexagons\nintersection_list = jb_kulai_hex$index[lengths(st_intersects(jb_kulai_hex, jb_kulai_grid)) &gt; 0]\n\n# Filter for the intersecting hexagons\njb_kulai_grid = jb_kulai_hex %&gt;%\n  filter(index %in% intersection_list)\n\ntm_shape(jb_kulai_grid) +\n  tm_polygons(alpha = 0.2)\n\n\n\n\n\n\n\n\n\njoined &lt;- st_join(jb_kulai_hex, adm3_jb_kulai, join = st_intersects, left = FALSE)\naggregated &lt;- joined %&gt;%\n  group_by(index) %&gt;%\n  summarise(`Mukim` = first(`shapeName`))\n\njb_kulai_grid$Mukim &lt;- aggregated$Mukim\njb_kulai_grid &lt;- jb_kulai_grid %&gt;%\n  mutate(index = as.factor(row_number()))\n\njb_kulai_grid &lt;- jb_kulai_grid[, c(\"Mukim\", setdiff(names(jb_kulai_grid), \"Mukim\"))]\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(jb_kulai_grid) +\n  tm_fill(col = \"Mukim\",\n          alpha = 0.7)+\n  tm_basemap(\"OpenStreetMap\")\n\n\n\n\n\n\n\nTH3.4.2 Exploratory Data Analysis\nWith our hexagonal grid, we can now perform exploratory data analysis. Using st_intersects allows us to map each point to a cell in the hexagonal grid. First up, we will save and plot the density of property sales in each hexagonal grid.\n\nintersections &lt;- st_intersects(jb_kulai_grid, property)\njb_kulai_grid$density &lt;- lengths(intersections)\ntmap_mode('plot')\n\ntmap mode set to plotting\n\ntm_shape(jb_kulai_grid) + \n  tm_fill(col = \"density\",\n          palette = \"Greys\",\n          style = \"kmeans\",\n          n = 5,\n          title = \"Property density\"\n          ) +\n  tm_borders(col = \"grey\") +\n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\n\n\n\n\n\n\n\n\nThe following code chunk allows us to aggregate the average, median and maximum property prices within each hexagonal cell.\n\n# Extract average and maximum property price for each cell\naggregate_price &lt;- function(i, method = \"median\") {\n  if (length(i) == 0 || all(is.na(property$`Price_USD`[i]))) return(0)\n  \n  if (method == \"mean\") {\n    return(mean(property$`Price_USD`[i], na.rm = TRUE))\n  } else if (method == \"max\") {\n    return(mean(property$`Price_USD`[i], na.rm = TRUE))\n  } else if (method == \"median\") {\n    return(median(property$`Price_USD`[i], na.rm = TRUE))\n  } else {\n    stop(\"Invalid method: Choose either 'mean' or 'max'.\")\n  }\n}\n\navg_prices &lt;- sapply(intersections, aggregate_price, method = \"mean\")\njb_kulai_grid$avg_price &lt;- avg_prices\n\nmedian_prices &lt;- sapply(intersections, aggregate_price, method = \"median\")\njb_kulai_grid$median_price &lt;- median_prices\n\nmax_prices &lt;- sapply(intersections, aggregate_price, method = \"max\")\njb_kulai_grid$max_price &lt;- max_prices\n\n# sectors &lt;- sapply(intersections, function(i) {\n#   if (length(i) == 0) return(NA)\n#   \n#   # Get the Scheme Name/Area values for the properties within the grid cell\n#   schemes &lt;- property$`Scheme Name/Area`[i]\n#   \n#   # Find the most frequent scheme name\n#   most_frequent &lt;- sort(table(schemes), decreasing = TRUE)\n#   most_common_scheme &lt;- names(most_frequent)[1]\n#   \n#   return(most_common_scheme)\n# })\n# jb_kulai_grid$sector &lt;- sectors\n\n\nwrite_rds(jb_kulai_grid, \"shiny/data/rds/jb_kulai_grid.rds\")\n\nWith these values calculated, we can plot them, along with our hexagonal grid, onto a map.\n\nMedian PriceAverage PriceMaximum Price\n\n\n\nmedians_map &lt;- tm_shape(jb_kulai_grid) + \n  tm_fill(col = \"median_price\",\n          palette = \"YlGn\",\n          style = \"kmeans\",\n          n = 10,\n          title = \"Median Property Price\"\n          ) +\n  tm_borders(col = \"grey\") +\n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\nmedians_map\n\n\n\n\n\n\n\n\n\n\n\ntm_shape(jb_kulai_grid) + \n  tm_fill(col = \"avg_price\",\n          palette = \"Purples\",\n          style = \"kmeans\",\n          n = 10,\n          title = \"Average Property Price\"\n          ) +\n  tm_borders(col = \"grey\") +\n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\n\n\n\n\n\n\n\n\n\n\n\ntm_shape(jb_kulai_grid) + \n  tm_fill(col = \"max_price\",\n          palette = \"YlOrRd\",\n          style = \"kmeans\",\n          n = 10,\n          title = \"Median Property Price\"\n          ) +\n  tm_borders(col = \"grey\") +\n  tm_legend(position = c(\"RIGHT\", \"BOTTOM\"))\n\n\n\n\n\n\n\n\n\n\n\nHere’s what the median property price data looks like overlayed on OpenStreetMap.\n\n# Plot the medians onto an interactive OpenStreetMap\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\nmedians_map +\n  tm_basemap('OpenStreetMap')\n\nlegend.postion is used for plot mode. Use view.legend.position in tm_view to set the legend position in view mode.\n\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\nIn the Shiny application, the hexagonal map will be overlayed on an OpenStreetMap view of Johor Bahru and Kulai. It will be possible to adjust the transparency of the grid, along with the colour scheme, classification method, and whether to display the average, median or maximum property prices within a grid cell.\n\n\n\nWhen ported to the Shiny application, it will be possible to toggle between average, median or maximum property prices within a grid cell."
  },
  {
    "objectID": "TakeHome/TakeHome3/take-home-3.html#th3.8-conclusion",
    "href": "TakeHome/TakeHome3/take-home-3.html#th3.8-conclusion",
    "title": "TH3: Prototyping Modules for Geospatial Analytics Shiny Application",
    "section": "TH3.8 Conclusion",
    "text": "TH3.8 Conclusion\nThe highest median property prices in the study area appear clustered towards the centre of town (Bandar Johor Bahru), or towards Iskandar Puteri (within Pulai) towards the West. Notice their proximity to the two land border crossings with Singapore: the JB Sentral-Woodlands crossing (the causeway) connects with Bandar Johor Bahru, while the Tanjung Kupang-Tuas crossing (the second link) is towards the west - near Pulai. Pasir Gudang to the east (within Plentong) is the most recent area in Johor Bahru to be prominently industrialised, but the residential properties there do not fetch nearly as high a price - indicating a relative lack of demand. This corresponds to the hot/cold spot map - the significant hot spots are clustered towards the centres of Kulai and Johor Bahru - where the economic opportunities are the best - along with the new development area of Iskandar Puteri.\nAs for Kulai, areas with higher median property prices appear clustered towards Bandar Kulai, or Senai - the location of Johor’s international airport and a major industrial hub.\nThe above is a quick summary of the preprocessing and exploratory data analysis work that has been done so far, as well as a sneak peek into how these results can be displayed in the final Shiny application by means of prototyping.\nGoing forward, other measures of spatial autocorrelation will be included, including Global Moran’s I and Geary’s C. Other team members will also be working on other aspects of the project, including the extraction of data on nearby amenities like shopping malls, schools, hospitals and key transport nodes, as well as the hedonic pricing model that will use these variables to predict the housing prices of various locations in Johor Bahru and Kulai."
  },
  {
    "objectID": "HandsOn/hands-on-11.html",
    "href": "HandsOn/hands-on-11.html",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "",
    "text": "Predictive modelling uses statistical learning or machine learning techniques to predict outcomes. Geospatial predictive modelling attempts to describe the impact of geospatial factors, such as infrastructure, socio-cultural and topographic factors, that influence where events occur."
  },
  {
    "objectID": "HandsOn/hands-on-11.html#hx11.1-overview",
    "href": "HandsOn/hands-on-11.html#hx11.1-overview",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "",
    "text": "Predictive modelling uses statistical learning or machine learning techniques to predict outcomes. Geospatial predictive modelling attempts to describe the impact of geospatial factors, such as infrastructure, socio-cultural and topographic factors, that influence where events occur."
  },
  {
    "objectID": "HandsOn/hands-on-11.html#hx11.2-the-data",
    "href": "HandsOn/hands-on-11.html#hx11.2-the-data",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "HX11.2 The Data",
    "text": "HX11.2 The Data\nToday we will be analysing the effect of geospatial factors on HDB resale prices in Singapore. The data we will use is as follows:\n\nAspatial dataset:\n\nHDB Resale data: a list of HDB resale transacted prices in Singapore from Jan 2017 onwards. It is in csv format which can be downloaded from Data.gov.sg.\n\nGeospatial dataset:\n\nMP14_SUBZONE_WEB_PL: a polygon feature data providing information of URA 2014 Master Plan Planning Subzone boundary data. It is in ESRI shapefile format. This data set was also downloaded from Data.gov.sg\n\nLocational factors with geographic coordinates:\n\nDownloaded from Data.gov.sg.\n\nEldercare data is a list of eldercare in Singapore. It is in shapefile format.\nHawker Centre data is a list of hawker centres in Singapore. It is in geojson format.\nParks data is a list of parks in Singapore. It is in geojson format.\nSupermarket data is a list of supermarkets in Singapore. It is in geojson format.\nCHAS clinics data is a list of CHAS clinics in Singapore. It is in geojson format.\nChildcare service data is a list of childcare services in Singapore. It is in geojson format.\nKindergartens data is a list of kindergartens in Singapore. It is in geojson format.\n\nDownloaded from Datamall.lta.gov.sg.\n\nMRT data is a list of MRT/LRT stations in Singapore with the station names and codes. It is in shapefile format.\nBus stops data is a list of bus stops in Singapore. It is in shapefile format.\n\n\nLocational factors without geographic coordinates:\n\nDownloaded from Data.gov.sg.\n\nPrimary school data is extracted from the list on General information of schools from data.gov portal. It is in csv format.\n\nRetrieved/Scraped from other sources\n\nCBD coordinates obtained from Google.\nShopping malls data is a list of Shopping malls in Singapore obtained from Wikipedia.\nGood primary schools is a list of primary schools that are ordered in ranking in terms of popularity and this can be found at Local Salary Forum."
  },
  {
    "objectID": "HandsOn/hands-on-11.html#hx11.3-installing-and-loading-r-packages-and-data",
    "href": "HandsOn/hands-on-11.html#hx11.3-installing-and-loading-r-packages-and-data",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "HX11.3 Installing and loading R packages and data",
    "text": "HX11.3 Installing and loading R packages and data\n\npacman::p_load(sf, spdep, GWmodel, SpatialML, tmap, rsample, Metrics, tidyverse)\n\nToday’s data is already cleaned and saved as an RDS file, so we can simply read it using this code chunk.\n\nmdata &lt;- read_rds(\"data/rds/mdata.rds\")"
  },
  {
    "objectID": "HandsOn/hands-on-11.html#hx11.4-data-sampling",
    "href": "HandsOn/hands-on-11.html#hx11.4-data-sampling",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "HX11.4 Data Sampling",
    "text": "HX11.4 Data Sampling\n\nHX11.4.1 Train-test-split\nAs with any machine learning task, we should split our data into training and testing sets. We will create a training set from 65% of our data and designate the remainder as our testing set.\n\nset.seed(1234)\nresale_split &lt;- initial_split(mdata, prop = 6.5/10,)\ntrain_data &lt;- training(resale_split)\ntest_data &lt;- testing(resale_split)\n\n\n\nHX11.4.2 Correlational analysis\nAs always, we create a correlation matrix to examine for signs of multicollinearity.\n\nmdata_nogeo &lt;- mdata %&gt;%\n  st_drop_geometry()\ncorrplot::corrplot(cor(mdata_nogeo[, 2:17]), \n                   diag = FALSE, \n                   order = \"AOE\",\n                   tl.pos = \"td\", \n                   tl.cex = 0.5, \n                   method = \"number\", \n                   type = \"upper\")\n\n\n\n\n\n\n\n\n\n\nHX11.4.3 Non-spatial multiple linear regression\n\nprice_mlr &lt;- lm(resale_price ~ floor_area_sqm +\n                  storey_order + remaining_lease_mths +\n                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +\n                  PROX_MRT + PROX_PARK + PROX_MALL + \n                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                  WITHIN_1KM_PRISCH,\n                data=train_data)\nwrite_rds(price_mlr, \"data/rds/price_mlr.rds\")\nsummary(price_mlr)\n\n\nCall:\nlm(formula = resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths + \n    PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK + \n    PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN + \n    WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH, \n    data = train_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-205193  -39120   -1930   36545  472355 \n\nCoefficients:\n                           Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)              107601.073  10601.261  10.150  &lt; 2e-16 ***\nfloor_area_sqm             2780.698     90.579  30.699  &lt; 2e-16 ***\nstorey_order              14299.298    339.115  42.167  &lt; 2e-16 ***\nremaining_lease_mths        344.490      4.592  75.027  &lt; 2e-16 ***\nPROX_CBD                 -16930.196    201.254 -84.124  &lt; 2e-16 ***\nPROX_ELDERLYCARE         -14441.025    994.867 -14.516  &lt; 2e-16 ***\nPROX_HAWKER              -19265.648   1273.597 -15.127  &lt; 2e-16 ***\nPROX_MRT                 -32564.272   1744.232 -18.670  &lt; 2e-16 ***\nPROX_PARK                 -5712.625   1483.885  -3.850 0.000119 ***\nPROX_MALL                -14717.388   2007.818  -7.330 2.47e-13 ***\nPROX_SUPERMARKET         -26881.938   4189.624  -6.416 1.46e-10 ***\nWITHIN_350M_KINDERGARTEN   8520.472    632.812  13.464  &lt; 2e-16 ***\nWITHIN_350M_CHILDCARE     -4510.650    354.015 -12.741  &lt; 2e-16 ***\nWITHIN_350M_BUS             813.493    222.574   3.655 0.000259 ***\nWITHIN_1KM_PRISCH         -8010.834    491.512 -16.298  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 61650 on 10320 degrees of freedom\nMultiple R-squared:  0.7373,    Adjusted R-squared:  0.737 \nF-statistic:  2069 on 14 and 10320 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "HandsOn/hands-on-11.html#hx11.5-geographically-weighted-regression-with-gwr",
    "href": "HandsOn/hands-on-11.html#hx11.5-geographically-weighted-regression-with-gwr",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "HX11.5 Geographically weighted regression with gwr",
    "text": "HX11.5 Geographically weighted regression with gwr\nThe model we’ve just built is a simple multiple linear regression model taking in proximity distances as explicitly-defined features. In this section, a GWmodel will be created using the GWmodel package.\n\nHX11.5.1 Converting to SpatialPointDataFrame\n\ntrain_data_sp &lt;- as_Spatial(train_data)\ntrain_data_sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 10335 \nextent      : 11597.31, 42623.63, 28217.39, 48741.06  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 17\nnames       : resale_price, floor_area_sqm, storey_order, remaining_lease_mths,          PROX_CBD,     PROX_ELDERLYCARE,        PROX_HAWKER,           PROX_MRT,          PROX_PARK,   PROX_GOOD_PRISCH,        PROX_MALL,            PROX_CHAS,     PROX_SUPERMARKET, WITHIN_350M_KINDERGARTEN, WITHIN_350M_CHILDCARE, ... \nmin values  :       218000,             74,            1,                  555, 0.999393538715878, 1.98943787433087e-08, 0.0333358643817954, 0.0220407324774434, 0.0441643212802781, 0.0652540365486641,                0, 6.20621206270077e-09, 1.21715176356525e-07,                        0,                     0, ... \nmax values  :      1186888,            133,           17,                 1164,  19.6500691667807,     3.30163731686804,   2.86763031236184,   2.13060636038504,   2.41313695915468,   10.6223726149914, 2.27100643784442,    0.808332738794272,     1.57131703651196,                        7,                    20, ... \n\n\n\n\nHX11.5.2 Computing adaptive bandwidth\nNext, we will determine the optimal bandwidth with bw.gwr() and the CV method.\n\nbw_adaptive &lt;- bw.gwr(resale_price ~ floor_area_sqm +\n                  storey_order + remaining_lease_mths +\n                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +\n                  PROX_MRT + PROX_PARK + PROX_MALL + \n                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                  WITHIN_1KM_PRISCH,\n                  data=train_data_sp,\n                  approach=\"CV\",\n                  kernel=\"gaussian\",\n                  adaptive=TRUE,\n                  longlat=FALSE)\n\nTake a cup of tea and have a break, it will take a few minutes.\n          -----A kind suggestion from GWmodel development group\nAdaptive bandwidth: 6395 CV score: 3.60536e+13 \nAdaptive bandwidth: 3960 CV score: 3.320316e+13 \nAdaptive bandwidth: 2455 CV score: 2.928339e+13 \nAdaptive bandwidth: 1524 CV score: 2.550957e+13 \nAdaptive bandwidth: 950 CV score: 1.95632e+13 \nAdaptive bandwidth: 593 CV score: 1.58347e+13 \nAdaptive bandwidth: 375 CV score: 1.310042e+13 \nAdaptive bandwidth: 237 CV score: 1.113152e+13 \nAdaptive bandwidth: 155 CV score: 9.572037e+12 \nAdaptive bandwidth: 101 CV score: 8.457003e+12 \nAdaptive bandwidth: 71 CV score: 7.605058e+12 \nAdaptive bandwidth: 49 CV score: 6.965752e+12 \nAdaptive bandwidth: 38 CV score: 8.249935e+12 \nAdaptive bandwidth: 58 CV score: 7.275234e+12 \nAdaptive bandwidth: 45 CV score: 6.871439e+12 \nAdaptive bandwidth: 41 CV score: 6.7928e+12 \nAdaptive bandwidth: 40 CV score: 6.780447e+12 \nAdaptive bandwidth: 38 CV score: 8.249935e+12 \nAdaptive bandwidth: 40 CV score: 6.780447e+12 \n\n\nThe optimum number of neighbour points for adaptive bandwidth is 40.\n\nwrite_rds(bw_adaptive, \"data/rds/bw_adaptive.rds\")\n\n\n\nHX11.5.3 Constructing adaptive bandwdith GWR model\nWe can now go ahead and calibrate the adaptive-bandwidth GWR hedonic pricing model with Gaussian kernel.\n\ngwr_adaptive &lt;- gwr.basic(formula = resale_price ~\n                            floor_area_sqm + storey_order +\n                            remaining_lease_mths + PROX_CBD + \n                            PROX_ELDERLYCARE + PROX_HAWKER +\n                            PROX_MRT + PROX_PARK + PROX_MALL + \n                            PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                            WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                            WITHIN_1KM_PRISCH,\n                          data=train_data_sp,\n                          bw=bw_adaptive, \n                          kernel = 'gaussian', \n                          adaptive=TRUE,\n                          longlat = FALSE)\nwrite_rds(gwr_adaptive, \"data/rds/model/gwr_adaptive.rds\")\ngwr_adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-11-09 19:08:37.425373 \n   Call:\n   gwr.basic(formula = resale_price ~ floor_area_sqm + storey_order + \n    remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + \n    PROX_MRT + PROX_PARK + PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN + \n    WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH, \n    data = train_data_sp, bw = bw_adaptive, kernel = \"gaussian\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  resale_price\n   Independent variables:  floor_area_sqm storey_order remaining_lease_mths PROX_CBD PROX_ELDERLYCARE PROX_HAWKER PROX_MRT PROX_PARK PROX_MALL PROX_SUPERMARKET WITHIN_350M_KINDERGARTEN WITHIN_350M_CHILDCARE WITHIN_350M_BUS WITHIN_1KM_PRISCH\n   Number of data points: 10335\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n    Min      1Q  Median      3Q     Max \n-205193  -39120   -1930   36545  472355 \n\n   Coefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)              107601.073  10601.261  10.150  &lt; 2e-16 ***\n   floor_area_sqm             2780.698     90.579  30.699  &lt; 2e-16 ***\n   storey_order              14299.298    339.115  42.167  &lt; 2e-16 ***\n   remaining_lease_mths        344.490      4.592  75.027  &lt; 2e-16 ***\n   PROX_CBD                 -16930.196    201.254 -84.124  &lt; 2e-16 ***\n   PROX_ELDERLYCARE         -14441.025    994.867 -14.516  &lt; 2e-16 ***\n   PROX_HAWKER              -19265.648   1273.597 -15.127  &lt; 2e-16 ***\n   PROX_MRT                 -32564.272   1744.232 -18.670  &lt; 2e-16 ***\n   PROX_PARK                 -5712.625   1483.885  -3.850 0.000119 ***\n   PROX_MALL                -14717.388   2007.818  -7.330 2.47e-13 ***\n   PROX_SUPERMARKET         -26881.938   4189.624  -6.416 1.46e-10 ***\n   WITHIN_350M_KINDERGARTEN   8520.472    632.812  13.464  &lt; 2e-16 ***\n   WITHIN_350M_CHILDCARE     -4510.650    354.015 -12.741  &lt; 2e-16 ***\n   WITHIN_350M_BUS             813.493    222.574   3.655 0.000259 ***\n   WITHIN_1KM_PRISCH         -8010.834    491.512 -16.298  &lt; 2e-16 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 61650 on 10320 degrees of freedom\n   Multiple R-squared: 0.7373\n   Adjusted R-squared: 0.737 \n   F-statistic:  2069 on 14 and 10320 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 3.922202e+13\n   Sigma(hat): 61610.08\n   AIC:  257320.2\n   AICc:  257320.3\n   BIC:  247249\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 40 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                                   Min.     1st Qu.      Median     3rd Qu.\n   Intercept                -3.2478e+08 -4.7727e+05 -8.3004e+03  5.5025e+05\n   floor_area_sqm           -2.8714e+04  1.4475e+03  2.3011e+03  3.3900e+03\n   storey_order              3.3186e+03  8.5899e+03  1.0826e+04  1.3397e+04\n   remaining_lease_mths     -1.4431e+03  2.6063e+02  3.9048e+02  5.2865e+02\n   PROX_CBD                 -1.0837e+07 -5.7697e+04 -1.3787e+04  2.6552e+04\n   PROX_ELDERLYCARE         -3.2195e+07 -4.0643e+04  1.0562e+04  6.1054e+04\n   PROX_HAWKER              -2.3985e+08 -5.1365e+04  3.0026e+03  6.4287e+04\n   PROX_MRT                 -1.1632e+07 -1.0488e+05 -4.9373e+04  5.1037e+03\n   PROX_PARK                -6.5961e+06 -4.8671e+04 -8.8128e+02  5.3498e+04\n   PROX_MALL                -1.8112e+07 -7.4238e+04 -1.3982e+04  4.9779e+04\n   PROX_SUPERMARKET         -4.5761e+06 -6.3461e+04 -1.7429e+04  3.5616e+04\n   WITHIN_350M_KINDERGARTEN -4.1823e+05 -6.0040e+03  9.0209e+01  4.7127e+03\n   WITHIN_350M_CHILDCARE    -1.0273e+05 -2.2375e+03  2.6668e+02  2.6388e+03\n   WITHIN_350M_BUS          -1.1757e+05 -1.4719e+03  1.1626e+02  1.7584e+03\n   WITHIN_1KM_PRISCH        -6.6465e+05 -5.5959e+03  2.6916e+02  5.7500e+03\n                                  Max.\n   Intercept                1.6493e+08\n   floor_area_sqm           5.0907e+04\n   storey_order             2.9537e+04\n   remaining_lease_mths     1.8119e+03\n   PROX_CBD                 2.2411e+07\n   PROX_ELDERLYCARE         8.2444e+07\n   PROX_HAWKER              5.9654e+06\n   PROX_MRT                 2.0189e+08\n   PROX_PARK                1.5188e+07\n   PROX_MALL                1.0443e+07\n   PROX_SUPERMARKET         3.8330e+06\n   WITHIN_350M_KINDERGARTEN 6.6799e+05\n   WITHIN_350M_CHILDCARE    1.0802e+05\n   WITHIN_350M_BUS          3.7313e+04\n   WITHIN_1KM_PRISCH        5.0231e+05\n   ************************Diagnostic information*************************\n   Number of data points: 10335 \n   Effective number of parameters (2trace(S) - trace(S'S)): 1730.101 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 8604.899 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 238871.9 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 237036.9 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 238209.1 \n   Residual sum of squares: 4.829191e+12 \n   R-square value:  0.967657 \n   Adjusted R-square value:  0.9611534 \n\n   ***********************************************************************\n   Program stops at: 2024-11-09 19:09:58.907612"
  },
  {
    "objectID": "HandsOn/hands-on-11.html#hx11.6-evaluating-our-model",
    "href": "HandsOn/hands-on-11.html#hx11.6-evaluating-our-model",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "HX11.6 Evaluating our model",
    "text": "HX11.6 Evaluating our model\nEvery machine learning model should be quantitatively evaluated. To do the same for our GWR model, we first convert our testing data to a SpatialPointDataFrame.\n\ntest_data_sp &lt;- test_data %&gt;%\n  as_Spatial()\ntest_data_sp\n\n\nHX11.6.1 Computing adaptive bandwidth for test data\n\ngwr_bw_test_adaptive &lt;- bw.gwr(resale_price ~ floor_area_sqm +\n                  storey_order + remaining_lease_mths +\n                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +\n                  PROX_MRT + PROX_PARK + PROX_MALL + \n                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                  WITHIN_1KM_PRISCH,\n                  data=test_data_sp,\n                  approach=\"CV\",\n                  kernel=\"gaussian\",\n                  adaptive=TRUE,\n                  longlat=FALSE)\n\n\n\nHX11.6.2 Computing predicted values\n\ngwr_pred &lt;- gwr.predict(formula = resale_price ~\n                          floor_area_sqm + storey_order +\n                          remaining_lease_mths + PROX_CBD + \n                          PROX_ELDERLYCARE + PROX_HAWKER + \n                          PROX_MRT + PROX_PARK + PROX_MALL + \n                          PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                          WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + \n                          WITHIN_1KM_PRISCH, \n                        data=train_data_sp, \n                        predictdata = test_data_sp, \n                        bw=bw_adaptive, \n                        kernel = 'gaussian', \n                        adaptive=TRUE, \n                        longlat = FALSE)"
  },
  {
    "objectID": "HandsOn/hands-on-11.html#hx11.7-random-forest-model",
    "href": "HandsOn/hands-on-11.html#hx11.7-random-forest-model",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "HX11.7 Random Forest model",
    "text": "HX11.7 Random Forest model\nA random forest (RF) model aggregates the result of multiple decision trees (e.g. 100 of them), making it less prone to overfitting. It can be adapted for regression use.\nIn this section, we will build a random forest model to predict HDB resale prices in R. The package to be used is the ranger package.\n\nHX11.7.1 Prepare coordinates\nThe code chunk below extracts the coordinates of the training and test datasets. After that, we drop the geoetry column with st_drop_geometry().\n\ncoords &lt;- st_coordinates(mdata)\ncoords_train &lt;- st_coordinates(train_data)\ncoords_test &lt;- st_coordinates(test_data)\ntrain_data &lt;- train_data %&gt;% \n  st_drop_geometry()\n\ncoords_train &lt;- write_rds(coords_train, \"data/rds/model/coords_train.rds\" )\ncoords_test &lt;- write_rds(coords_test, \"data/rds/model/coords_test.rds\" )\n\n\nset.seed(1234)\nrf &lt;- ranger(resale_price ~ floor_area_sqm + storey_order + \n               remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE + \n               PROX_HAWKER + PROX_MRT + PROX_PARK + PROX_MALL + \n               PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n               WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + \n               WITHIN_1KM_PRISCH,\n             data=train_data)\nwrite_rds(rf, \"data/rds/model/rf.rds\")\nrf\n\nRanger result\n\nCall:\n ranger(resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths +      PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK +      PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +      WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH,      data = train_data) \n\nType:                             Regression \nNumber of trees:                  500 \nSample size:                      10335 \nNumber of independent variables:  14 \nMtry:                             3 \nTarget node size:                 5 \nVariable importance mode:         none \nSplitrule:                        variance \nOOB prediction error (MSE):       731404460 \nR squared (OOB):                  0.9493789"
  },
  {
    "objectID": "HandsOn/hands-on-11.html#hx11.8-geographical-random-forest-model",
    "href": "HandsOn/hands-on-11.html#hx11.8-geographical-random-forest-model",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "HX11.8 Geographical Random Forest model",
    "text": "HX11.8 Geographical Random Forest model\nIn this section, we will calibrate a geographical RF model using grf() from the SpatialML package.\n\nHX11.8.1 Calibrating using training data\n\nset.seed(1234)\ngwRF_adaptive &lt;- grf(formula = resale_price ~ floor_area_sqm + storey_order +\n                       remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE +\n                       PROX_HAWKER + PROX_MRT + PROX_PARK + PROX_MALL +\n                       PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                       WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                       WITHIN_1KM_PRISCH,\n                     dframe=train_data, \n                     bw=55,\n                     kernel=\"adaptive\",\n                     coords=coords_train)\n\n\nNumber of Observations: 10335\n\n\nNumber of Independent Variables: 14\n\n\nKernel: Adaptive\nNeightbours: 55\n\n\n\n--------------- Global ML Model Summary ---------------\n\n\nRanger result\n\nCall:\n ranger(resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths +      PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK +      PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +      WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH,      data = train_data, num.trees = 500, mtry = 4, importance = \"impurity\",      num.threads = NULL) \n\nType:                             Regression \nNumber of trees:                  500 \nSample size:                      10335 \nNumber of independent variables:  14 \nMtry:                             4 \nTarget node size:                 5 \nVariable importance mode:         impurity \nSplitrule:                        variance \nOOB prediction error (MSE):       697593819 \nR squared (OOB):                  0.9517189 \n\n\n\nImportance:\n\n\n          floor_area_sqm             storey_order     remaining_lease_mths \n            7.413197e+12             1.538950e+13             2.890637e+13 \n                PROX_CBD         PROX_ELDERLYCARE              PROX_HAWKER \n            5.310066e+13             7.285092e+12             5.568548e+12 \n                PROX_MRT                PROX_PARK                PROX_MALL \n            7.369745e+12             4.894344e+12             4.223286e+12 \n        PROX_SUPERMARKET WITHIN_350M_KINDERGARTEN    WITHIN_350M_CHILDCARE \n            2.793853e+12             1.018586e+12             1.710374e+12 \n         WITHIN_350M_BUS        WITHIN_1KM_PRISCH \n            1.589501e+12             6.794634e+12 \n\n\n\nMean Square Error (Not OOB): 173951416.766\n\n\nR-squared (Not OOB) %: 98.796\n\n\nAIC (Not OOB): 196129.252\n\n\nAICc (Not OOB): 196129.299\n\n\n\n--------------- Local Model Summary ---------------\n\n\n\nResiduals OOB:\n\n\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n-236112.0  -13033.7     444.4     593.8   14831.5  358041.7 \n\n\n\nResiduals Predicted (Not OOB):\n\n\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n-79279.83  -3510.70     54.56     50.98   3909.85  83074.08 \n\n\n\nLocal Variable Importance:\n\n\n                               Min          Max        Mean         StD\nfloor_area_sqm                   0 401562922035 18210850992 41426270899\nstorey_order             302736445 243728744368 16368419468 23620589843\nremaining_lease_mths     696564138 546463600727 34119912443 70328183398\nPROX_CBD                  55173040 382484896335 12154563393 29293290548\nPROX_ELDERLYCARE          45182031 344081962746 10597657883 24546405941\nPROX_HAWKER               43516026 342597797419 10551807020 23408387903\nPROX_MRT                  54234551 299075025906  9873129985 21055852211\nPROX_PARK                 49919822 322633843469  9353956995 19517077658\nPROX_MALL                 43296133 433263607933 11247374493 27537334970\nPROX_SUPERMARKET          52665827 417310417234 10802122271 26572460731\nWITHIN_350M_KINDERGARTEN         0 186468064682  2848177740 12928886968\nWITHIN_350M_CHILDCARE            0 255236737234  5526292324 18109971102\nWITHIN_350M_BUS                  0 193828795378  4747552546 11886064288\nWITHIN_1KM_PRISCH                0 178360608427  1778262602  7163381668\n\n\n\nMean squared error (OOB): 930426169.333\n\n\nR-squared (OOB) %: 93.56\n\n\nAIC (OOB): 213459.669\n\n\nAICc (OOB): 213459.716\n\n\nMean squared error Predicted (Not OOB): 73859413.696\n\n\nR-squared Predicted (Not OOB) %: 99.489\n\n\nAIC Predicted (Not OOB): 187276.161\n\n\nAICc Predicted (Not OOB): 187276.208\n\n\n\nCalculation time (in seconds): 5.6057\n\nwrite_rds(gwRF_adaptive, \"data/rds/model/gwRF_adaptive.rds\")\n\n\n\nHX11.8.2 Predicting using test data\n\nHX11.8.2.1 Preparing test data\nThe code chunk below will be used to combine the test data with its corresponding coordinates data\n\ntest_data &lt;- cbind(test_data, coords_test) %&gt;%\n  st_drop_geometry()\n\n\n\nHX11.8.2.2 Predicting using test data\nNext, we use predict.grf() from SpatialML to derive our predicted values with our gwRF adaptive model.\n\ngwRF_pred &lt;- predict.grf(gwRF_adaptive, \n                           test_data, \n                           x.var.name=\"X\",\n                           y.var.name=\"Y\", \n                           local.w=1,\n                           global.w=0)\nwrite_rds(gwRF_pred, \"data/rds/model/GRF_pred.rds\")\n\n\n\nHX11.8.2.3 Converting predicted output into data frame\nAs the output of predict.grf() is a vector, it is wiser to convert it to a data frame for further visualisation and analysis.\n\ngwRF_pred_df &lt;- as.data.frame(gwRF_pred)\n# cbind to test data\ntest_data_p &lt;- cbind(test_data, gwRF_pred_df)\nwrite_rds(test_data_p, \"data/rds/model/test_data_p.rds\")\n\n\n\n\nHX11.8.3 Evaluating our model\nAs with any regression task, we use root mean square error (RMSE) to evaluate our model. RMSE measures how far predicted values are from observed values in regression analysis. In the code chunk below, rmse() of Metrics is used to compute RMSE.\n\nrmse(test_data_p$resale_price, \n     test_data_p$gwRF_pred)\n\n[1] 27302.9\n\n\n\n\nHX11.8.4 Visualising our predicted values\nWe can also use a scatterplot to visualie our actual and predicted resale prices.\n\nggplot(data = test_data_p,\n       aes(x = gwRF_pred,\n           y = resale_price)) +\n  geom_point()"
  },
  {
    "objectID": "HandsOn/hands-on-11.html#references",
    "href": "HandsOn/hands-on-11.html#references",
    "title": "HX11: Geographically Weighted Predictive Models",
    "section": "References",
    "text": "References\n\nKam, T. S. (2024). 14 Geographically Weighted Predictive Models. R for Geospatial Data Science and Analytics. https://r4gdsa.netlify.app/chap14.html"
  }
]